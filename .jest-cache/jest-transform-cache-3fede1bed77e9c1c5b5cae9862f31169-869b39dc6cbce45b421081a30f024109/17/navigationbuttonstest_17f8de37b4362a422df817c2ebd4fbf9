ca4c8cdef83c24385ee78c40450f017f
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
jest.mock('wouter', () => ({
    useLocation: () => [mockLocation(), mockSetLocation],
    Link: ({ children, href, onClick, ...props }) => ((0, jsx_runtime_1.jsx)("a", { href: href, onClick: onClick, ...props, children: children })),
}));
// Mock asset imports
jest.mock('../../../client/src/assets/koveo-logo.jpg', () => '/mocked-logo.jpg');
// Mock authentication context
jest.mock('../../../client/src/hooks/use-auth', () => ({
    useAuth: () => ({
        user: { id: '1', email: 'test@test.com', role: 'admin' },
        isAuthenticated: true,
        login: jest.fn(),
        logout: jest.fn(),
    }),
}));
/**
 * Navigation Button Functionality Tests
 * Tests all navigation buttons throughout the application
 */
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const react_query_1 = require("@tanstack/react-query");
require("@testing-library/jest-dom");
// Mock wouter navigation
const mockLocation = jest.fn();
const mockSetLocation = jest.fn();
// Import components to test
const home_1 = __importDefault(require("../../../client/src/pages/home"));
const pricing_1 = __importDefault(require("../../../client/src/pages/pricing"));
const features_1 = __importDefault(require("../../../client/src/pages/features"));
const story_1 = __importDefault(require("../../../client/src/pages/story"));
const security_1 = __importDefault(require("../../../client/src/pages/security"));
describe('Navigation Buttons Functionality', () => {
    let queryClient;
    beforeEach(() => {
        queryClient = new react_query_1.QueryClient({
            defaultOptions: {
                queries: { retry: false },
                mutations: { retry: false },
            },
        });
        jest.clearAllMocks();
        mockLocation.mockReturnValue('/');
    });
    const renderWithProvider = (component) => {
        return (0, react_2.render)((0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: component }));
    };
    describe('Home Page Navigation Buttons', () => {
        it('should navigate to dashboard when "Go to Dashboard" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(home_1.default, {}));
            const dashboardButton = react_2.screen.getByTestId('button-go-to-dashboard');
            expect(dashboardButton).toBeInTheDocument();
            react_2.fireEvent.click(dashboardButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/dashboard');
            });
        });
        it('should start trial when "Start Trial" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(home_1.default, {}));
            const trialButton = react_2.screen.getByTestId('button-start-trial');
            expect(trialButton).toBeInTheDocument();
            react_2.fireEvent.click(trialButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
    });
    describe('Pricing Page Navigation Buttons', () => {
        it('should navigate to login when "Get Started" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(pricing_1.default, {}));
            const getStartedButton = react_2.screen.getByTestId('nav-get-started');
            expect(getStartedButton).toBeInTheDocument();
            react_2.fireEvent.click(getStartedButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/login');
            });
        });
    });
    describe('Features Page Navigation Buttons', () => {
        it('should navigate to trial when "Try Features" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(features_1.default, {}));
            const tryFeaturesButton = react_2.screen.getByTestId('button-try-features');
            expect(tryFeaturesButton).toBeInTheDocument();
            react_2.fireEvent.click(tryFeaturesButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
        it('should navigate to trial when "Start Now" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(features_1.default, {}));
            const startNowButton = react_2.screen.getByTestId('button-start-now');
            expect(startNowButton).toBeInTheDocument();
            react_2.fireEvent.click(startNowButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
    });
    describe('Story Page Navigation Buttons', () => {
        it('should navigate to registration when "Join Story" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(story_1.default, {}));
            const joinStoryButton = react_2.screen.getByTestId('button-join-story');
            expect(joinStoryButton).toBeInTheDocument();
            react_2.fireEvent.click(joinStoryButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
    });
    describe('Security Page Navigation Buttons', () => {
        it('should navigate to registration when "Secure Start" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(security_1.default, {}));
            const secureStartButton = react_2.screen.getByTestId('button-secure-start');
            expect(secureStartButton).toBeInTheDocument();
            react_2.fireEvent.click(secureStartButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
        it('should navigate to registration when "Secure Trial" button is clicked', async () => {
            renderWithProvider((0, jsx_runtime_1.jsx)(security_1.default, {}));
            const secureTrialButton = react_2.screen.getByTestId('button-secure-trial');
            expect(secureTrialButton).toBeInTheDocument();
            react_2.fireEvent.click(secureTrialButton);
            await (0, react_2.waitFor)(() => {
                expect(mockSetLocation).toHaveBeenCalledWith('/auth/register');
            });
        });
    });
    describe('Back Navigation Buttons', () => {
        it('should navigate back when back buttons are clicked', () => {
            // These would be tested in their respective component contexts
            const backButtonSelectors = [
                'button-back',
            ];
            backButtonSelectors.forEach(selector => {
                // Mock implementation - actual tests would render the specific components
                const mockBackClick = jest.fn();
                const backButton = document.createElement('button');
                backButton.setAttribute('data-testid', selector);
                backButton.onclick = mockBackClick;
                react_2.fireEvent.click(backButton);
                expect(mockBackClick).toHaveBeenCalled();
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2J1dHRvbi1mdW5jdGlvbmFsaXR5L25hdmlnYXRpb24tYnV0dG9ucy50ZXN0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFjQSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3pCLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFLGVBQWUsQ0FBQztJQUNwRCxJQUFJLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEdBQUcsS0FBSyxFQUFPLEVBQUUsRUFBRSxDQUFDLENBQ3BELDhCQUFHLElBQUksRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sS0FBTSxLQUFLLFlBQ3ZDLFFBQVEsR0FDUCxDQUNMO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFFSixxQkFBcUI7QUFDckIsSUFBSSxDQUFDLElBQUksQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0FBRWpGLDhCQUE4QjtBQUM5QixJQUFJLENBQUMsSUFBSSxDQUFDLG9DQUFvQyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDckQsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDZCxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtRQUN4RCxlQUFlLEVBQUUsSUFBSTtRQUNyQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUNsQixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUM7QUFsQ0o7OztHQUdHO0FBRUgsa0RBQTBCO0FBQzFCLGtEQUE0RTtBQUM1RSx1REFBeUU7QUFDekUscUNBQW1DO0FBRW5DLHlCQUF5QjtBQUN6QixNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDL0IsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBd0JsQyw0QkFBNEI7QUFDNUIsMEVBQXNEO0FBQ3RELGdGQUE0RDtBQUM1RCxrRkFBOEQ7QUFDOUQsNEVBQXdEO0FBQ3hELGtGQUE4RDtBQUU5RCxRQUFRLENBQUMsa0NBQWtDLEVBQUUsR0FBRyxFQUFFO0lBQ2hELElBQUksV0FBd0IsQ0FBQztJQUU3QixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsV0FBVyxHQUFHLElBQUkseUJBQVcsQ0FBQztZQUM1QixjQUFjLEVBQUU7Z0JBQ2QsT0FBTyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRTtnQkFDekIsU0FBUyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRTthQUM1QjtTQUNGLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNyQixZQUFZLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBRUgsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLFNBQTZCLEVBQUUsRUFBRTtRQUMzRCxPQUFPLElBQUEsY0FBTSxFQUNYLHVCQUFDLGlDQUFtQixJQUFDLE1BQU0sRUFBRSxXQUFXLFlBQ3JDLFNBQVMsR0FDVSxDQUN2QixDQUFDO0lBQ0osQ0FBQyxDQUFDO0lBRUYsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtRQUM1QyxFQUFFLENBQUMsdUVBQXVFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckYsa0JBQWtCLENBQUMsdUJBQUMsY0FBUSxLQUFHLENBQUMsQ0FBQztZQUVqQyxNQUFNLGVBQWUsR0FBRyxjQUFNLENBQUMsV0FBVyxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFFNUMsaUJBQVMsQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFakMsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUM3RCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZFLGtCQUFrQixDQUFDLHVCQUFDLGNBQVEsS0FBRyxDQUFDLENBQUM7WUFFakMsTUFBTSxXQUFXLEdBQUcsY0FBTSxDQUFDLFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQzdELE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBRXhDLGlCQUFTLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRTdCLE1BQU0sSUFBQSxlQUFPLEVBQUMsR0FBRyxFQUFFO2dCQUNqQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNqRSxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFO1FBQy9DLEVBQUUsQ0FBQywrREFBK0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RSxrQkFBa0IsQ0FBQyx1QkFBQyxpQkFBVyxLQUFHLENBQUMsQ0FBQztZQUVwQyxNQUFNLGdCQUFnQixHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUMvRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBRTdDLGlCQUFTLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFFbEMsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN6RCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsa0NBQWtDLEVBQUUsR0FBRyxFQUFFO1FBQ2hELEVBQUUsQ0FBQyxnRUFBZ0UsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM5RSxrQkFBa0IsQ0FBQyx1QkFBQyxrQkFBWSxLQUFHLENBQUMsQ0FBQztZQUVyQyxNQUFNLGlCQUFpQixHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMscUJBQXFCLENBQUMsQ0FBQztZQUNwRSxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBRTlDLGlCQUFTLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFFbkMsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkRBQTZELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0Usa0JBQWtCLENBQUMsdUJBQUMsa0JBQVksS0FBRyxDQUFDLENBQUM7WUFFckMsTUFBTSxjQUFjLEdBQUcsY0FBTSxDQUFDLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBRTNDLGlCQUFTLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRWhDLE1BQU0sSUFBQSxlQUFPLEVBQUMsR0FBRyxFQUFFO2dCQUNqQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNqRSxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsK0JBQStCLEVBQUUsR0FBRyxFQUFFO1FBQzdDLEVBQUUsQ0FBQyxxRUFBcUUsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNuRixrQkFBa0IsQ0FBQyx1QkFBQyxlQUFTLEtBQUcsQ0FBQyxDQUFDO1lBRWxDLE1BQU0sZUFBZSxHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUNoRSxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUU1QyxpQkFBUyxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUVqQyxNQUFNLElBQUEsZUFBTyxFQUFDLEdBQUcsRUFBRTtnQkFDakIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDakUsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtRQUNoRCxFQUFFLENBQUMsdUVBQXVFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckYsa0JBQWtCLENBQUMsdUJBQUMsa0JBQVksS0FBRyxDQUFDLENBQUM7WUFFckMsTUFBTSxpQkFBaUIsR0FBRyxjQUFNLENBQUMsV0FBVyxDQUFDLHFCQUFxQixDQUFDLENBQUM7WUFDcEUsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUU5QyxpQkFBUyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBRW5DLE1BQU0sSUFBQSxlQUFPLEVBQUMsR0FBRyxFQUFFO2dCQUNqQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNqRSxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVFQUF1RSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3JGLGtCQUFrQixDQUFDLHVCQUFDLGtCQUFZLEtBQUcsQ0FBQyxDQUFDO1lBRXJDLE1BQU0saUJBQWlCLEdBQUcsY0FBTSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFFOUMsaUJBQVMsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUVuQyxNQUFNLElBQUEsZUFBTyxFQUFDLEdBQUcsRUFBRTtnQkFDakIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDakUsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxFQUFFLENBQUMsb0RBQW9ELEVBQUUsR0FBRyxFQUFFO1lBQzVELCtEQUErRDtZQUMvRCxNQUFNLG1CQUFtQixHQUFHO2dCQUMxQixhQUFhO2FBQ2QsQ0FBQztZQUVGLG1CQUFtQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDckMsMEVBQTBFO2dCQUMxRSxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ2hDLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQ3BELFVBQVUsQ0FBQyxZQUFZLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUNqRCxVQUFVLENBQUMsT0FBTyxHQUFHLGFBQWEsQ0FBQztnQkFFbkMsaUJBQVMsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQzVCLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzNDLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvdGVzdHMvdW5pdC9idXR0b24tZnVuY3Rpb25hbGl0eS9uYXZpZ2F0aW9uLWJ1dHRvbnMudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBOYXZpZ2F0aW9uIEJ1dHRvbiBGdW5jdGlvbmFsaXR5IFRlc3RzXG4gKiBUZXN0cyBhbGwgbmF2aWdhdGlvbiBidXR0b25zIHRocm91Z2hvdXQgdGhlIGFwcGxpY2F0aW9uXG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUNsaWVudFByb3ZpZGVyIH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5cbi8vIE1vY2sgd291dGVyIG5hdmlnYXRpb25cbmNvbnN0IG1vY2tMb2NhdGlvbiA9IGplc3QuZm4oKTtcbmNvbnN0IG1vY2tTZXRMb2NhdGlvbiA9IGplc3QuZm4oKTtcblxuamVzdC5tb2NrKCd3b3V0ZXInLCAoKSA9PiAoe1xuICB1c2VMb2NhdGlvbjogKCkgPT4gW21vY2tMb2NhdGlvbigpLCBtb2NrU2V0TG9jYXRpb25dLFxuICBMaW5rOiAoeyBjaGlsZHJlbiwgaHJlZiwgb25DbGljaywgLi4ucHJvcHMgfTogYW55KSA9PiAoXG4gICAgPGEgaHJlZj17aHJlZn0gb25DbGljaz17b25DbGlja30gey4uLnByb3BzfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L2E+XG4gICksXG59KSk7XG5cbi8vIE1vY2sgYXNzZXQgaW1wb3J0c1xuamVzdC5tb2NrKCcuLi8uLi8uLi9jbGllbnQvc3JjL2Fzc2V0cy9rb3Zlby1sb2dvLmpwZycsICgpID0+ICcvbW9ja2VkLWxvZ28uanBnJyk7XG5cbi8vIE1vY2sgYXV0aGVudGljYXRpb24gY29udGV4dFxuamVzdC5tb2NrKCcuLi8uLi8uLi9jbGllbnQvc3JjL2hvb2tzL3VzZS1hdXRoJywgKCkgPT4gKHtcbiAgdXNlQXV0aDogKCkgPT4gKHtcbiAgICB1c2VyOiB7IGlkOiAnMScsIGVtYWlsOiAndGVzdEB0ZXN0LmNvbScsIHJvbGU6ICdhZG1pbicgfSxcbiAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXG4gICAgbG9naW46IGplc3QuZm4oKSxcbiAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbi8vIEltcG9ydCBjb21wb25lbnRzIHRvIHRlc3RcbmltcG9ydCBIb21lUGFnZSBmcm9tICcuLi8uLi8uLi9jbGllbnQvc3JjL3BhZ2VzL2hvbWUnO1xuaW1wb3J0IFByaWNpbmdQYWdlIGZyb20gJy4uLy4uLy4uL2NsaWVudC9zcmMvcGFnZXMvcHJpY2luZyc7XG5pbXBvcnQgRmVhdHVyZXNQYWdlIGZyb20gJy4uLy4uLy4uL2NsaWVudC9zcmMvcGFnZXMvZmVhdHVyZXMnO1xuaW1wb3J0IFN0b3J5UGFnZSBmcm9tICcuLi8uLi8uLi9jbGllbnQvc3JjL3BhZ2VzL3N0b3J5JztcbmltcG9ydCBTZWN1cml0eVBhZ2UgZnJvbSAnLi4vLi4vLi4vY2xpZW50L3NyYy9wYWdlcy9zZWN1cml0eSc7XG5cbmRlc2NyaWJlKCdOYXZpZ2F0aW9uIEJ1dHRvbnMgRnVuY3Rpb25hbGl0eScsICgpID0+IHtcbiAgbGV0IHF1ZXJ5Q2xpZW50OiBRdWVyeUNsaWVudDtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBxdWVyeUNsaWVudCA9IG5ldyBRdWVyeUNsaWVudCh7XG4gICAgICBkZWZhdWx0T3B0aW9uczoge1xuICAgICAgICBxdWVyaWVzOiB7IHJldHJ5OiBmYWxzZSB9LFxuICAgICAgICBtdXRhdGlvbnM6IHsgcmV0cnk6IGZhbHNlIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIG1vY2tMb2NhdGlvbi5tb2NrUmV0dXJuVmFsdWUoJy8nKTtcbiAgfSk7XG5cbiAgY29uc3QgcmVuZGVyV2l0aFByb3ZpZGVyID0gKGNvbXBvbmVudDogUmVhY3QuUmVhY3RFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuIHJlbmRlcihcbiAgICAgIDxRdWVyeUNsaWVudFByb3ZpZGVyIGNsaWVudD17cXVlcnlDbGllbnR9PlxuICAgICAgICB7Y29tcG9uZW50fVxuICAgICAgPC9RdWVyeUNsaWVudFByb3ZpZGVyPlxuICAgICk7XG4gIH07XG5cbiAgZGVzY3JpYmUoJ0hvbWUgUGFnZSBOYXZpZ2F0aW9uIEJ1dHRvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBuYXZpZ2F0ZSB0byBkYXNoYm9hcmQgd2hlbiBcIkdvIHRvIERhc2hib2FyZFwiIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKDxIb21lUGFnZSAvPik7XG4gICAgICBcbiAgICAgIGNvbnN0IGRhc2hib2FyZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLWdvLXRvLWRhc2hib2FyZCcpO1xuICAgICAgZXhwZWN0KGRhc2hib2FyZEJ1dHRvbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKGRhc2hib2FyZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja1NldExvY2F0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2Rhc2hib2FyZCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN0YXJ0IHRyaWFsIHdoZW4gXCJTdGFydCBUcmlhbFwiIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKDxIb21lUGFnZSAvPik7XG4gICAgICBcbiAgICAgIGNvbnN0IHRyaWFsQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3RhcnQtdHJpYWwnKTtcbiAgICAgIGV4cGVjdCh0cmlhbEJ1dHRvbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHRyaWFsQnV0dG9uKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrU2V0TG9jYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXV0aC9yZWdpc3RlcicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQcmljaW5nIFBhZ2UgTmF2aWdhdGlvbiBCdXR0b25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgdG8gbG9naW4gd2hlbiBcIkdldCBTdGFydGVkXCIgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoPFByaWNpbmdQYWdlIC8+KTtcbiAgICAgIFxuICAgICAgY29uc3QgZ2V0U3RhcnRlZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnbmF2LWdldC1zdGFydGVkJyk7XG4gICAgICBleHBlY3QoZ2V0U3RhcnRlZEJ1dHRvbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKGdldFN0YXJ0ZWRCdXR0b24pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tTZXRMb2NhdGlvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9sb2dpbicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGZWF0dXJlcyBQYWdlIE5hdmlnYXRpb24gQnV0dG9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIHRyaWFsIHdoZW4gXCJUcnkgRmVhdHVyZXNcIiBidXR0b24gaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcldpdGhQcm92aWRlcig8RmVhdHVyZXNQYWdlIC8+KTtcbiAgICAgIFxuICAgICAgY29uc3QgdHJ5RmVhdHVyZXNCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi10cnktZmVhdHVyZXMnKTtcbiAgICAgIGV4cGVjdCh0cnlGZWF0dXJlc0J1dHRvbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHRyeUZlYXR1cmVzQnV0dG9uKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrU2V0TG9jYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXV0aC9yZWdpc3RlcicpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIHRyaWFsIHdoZW4gXCJTdGFydCBOb3dcIiBidXR0b24gaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcldpdGhQcm92aWRlcig8RmVhdHVyZXNQYWdlIC8+KTtcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhcnROb3dCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdGFydC1ub3cnKTtcbiAgICAgIGV4cGVjdChzdGFydE5vd0J1dHRvbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHN0YXJ0Tm93QnV0dG9uKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrU2V0TG9jYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXV0aC9yZWdpc3RlcicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTdG9yeSBQYWdlIE5hdmlnYXRpb24gQnV0dG9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIHJlZ2lzdHJhdGlvbiB3aGVuIFwiSm9pbiBTdG9yeVwiIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKDxTdG9yeVBhZ2UgLz4pO1xuICAgICAgXG4gICAgICBjb25zdCBqb2luU3RvcnlCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1qb2luLXN0b3J5Jyk7XG4gICAgICBleHBlY3Qoam9pblN0b3J5QnV0dG9uKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgXG4gICAgICBmaXJlRXZlbnQuY2xpY2soam9pblN0b3J5QnV0dG9uKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrU2V0TG9jYXRpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXV0aC9yZWdpc3RlcicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBQYWdlIE5hdmlnYXRpb24gQnV0dG9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIHJlZ2lzdHJhdGlvbiB3aGVuIFwiU2VjdXJlIFN0YXJ0XCIgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoPFNlY3VyaXR5UGFnZSAvPik7XG4gICAgICBcbiAgICAgIGNvbnN0IHNlY3VyZVN0YXJ0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc2VjdXJlLXN0YXJ0Jyk7XG4gICAgICBleHBlY3Qoc2VjdXJlU3RhcnRCdXR0b24pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBcbiAgICAgIGZpcmVFdmVudC5jbGljayhzZWN1cmVTdGFydEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja1NldExvY2F0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2F1dGgvcmVnaXN0ZXInKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBuYXZpZ2F0ZSB0byByZWdpc3RyYXRpb24gd2hlbiBcIlNlY3VyZSBUcmlhbFwiIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKDxTZWN1cml0eVBhZ2UgLz4pO1xuICAgICAgXG4gICAgICBjb25zdCBzZWN1cmVUcmlhbEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXNlY3VyZS10cmlhbCcpO1xuICAgICAgZXhwZWN0KHNlY3VyZVRyaWFsQnV0dG9uKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VjdXJlVHJpYWxCdXR0b24pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tTZXRMb2NhdGlvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hdXRoL3JlZ2lzdGVyJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0JhY2sgTmF2aWdhdGlvbiBCdXR0b25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgYmFjayB3aGVuIGJhY2sgYnV0dG9ucyBhcmUgY2xpY2tlZCcsICgpID0+IHtcbiAgICAgIC8vIFRoZXNlIHdvdWxkIGJlIHRlc3RlZCBpbiB0aGVpciByZXNwZWN0aXZlIGNvbXBvbmVudCBjb250ZXh0c1xuICAgICAgY29uc3QgYmFja0J1dHRvblNlbGVjdG9ycyA9IFtcbiAgICAgICAgJ2J1dHRvbi1iYWNrJyxcbiAgICAgIF07XG5cbiAgICAgIGJhY2tCdXR0b25TZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XG4gICAgICAgIC8vIE1vY2sgaW1wbGVtZW50YXRpb24gLSBhY3R1YWwgdGVzdHMgd291bGQgcmVuZGVyIHRoZSBzcGVjaWZpYyBjb21wb25lbnRzXG4gICAgICAgIGNvbnN0IG1vY2tCYWNrQ2xpY2sgPSBqZXN0LmZuKCk7XG4gICAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYmFja0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGVzdGlkJywgc2VsZWN0b3IpO1xuICAgICAgICBiYWNrQnV0dG9uLm9uY2xpY2sgPSBtb2NrQmFja0NsaWNrO1xuICAgICAgICBcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGJhY2tCdXR0b24pO1xuICAgICAgICBleHBlY3QobW9ja0JhY2tDbGljaykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
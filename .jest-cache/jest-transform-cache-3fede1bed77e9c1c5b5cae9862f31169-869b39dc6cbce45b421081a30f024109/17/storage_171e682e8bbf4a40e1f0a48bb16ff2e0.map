{"file":"/home/runner/workspace/server/storage.ts","mappings":"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","names":[],"sources":["/home/runner/workspace/server/storage.ts"],"sourcesContent":["import {\n  type User,\n  type InsertUser,\n  type Organization,\n  type InsertOrganization,\n  type Building,\n  type InsertBuilding,\n  type Residence,\n  type InsertResidence,\n  type Contact,\n  type InsertContact,\n  type Document,\n  type InsertDocument,\n  type Pillar,\n  type InsertPillar,\n  type WorkspaceStatus,\n  type InsertWorkspaceStatus,\n  type QualityMetric,\n  type InsertQualityMetric,\n  type FrameworkConfiguration,\n  type InsertFrameworkConfiguration,\n  type ImprovementSuggestion,\n  type InsertImprovementSuggestion,\n  type Feature,\n  type InsertFeature,\n  type ActionableItem,\n  type InsertActionableItem,\n  type Invitation,\n  type InsertInvitation,\n  type InvitationAuditLog,\n  type InsertInvitationAuditLog,\n  type Permission,\n  type RolePermission,\n  type UserPermission,\n  type PasswordResetToken,\n  type InsertPasswordResetToken,\n  type Bug,\n  type InsertBug,\n  type FeatureRequest,\n  type InsertFeatureRequest,\n  type FeatureRequestUpvote,\n  type InsertFeatureRequestUpvote,\n} from '@shared/schema';\nimport {\n  type Demand,\n  type InsertDemand,\n  type DemandComment,\n  type InsertDemandComment,\n} from '@shared/schemas/operations';\nimport { randomUUID } from 'crypto';\n\nexport interface IStorage {\n  // User operations\n  getUsers(): Promise<User[]>;\n  getUsersWithAssignments(): Promise<Array<User & { organizations: Array<{ id: string; name: string; type: string }>; buildings: Array<{ id: string; name: string }>; residences: Array<{ id: string; unitNumber: string; buildingId: string; buildingName: string }> }>>;\n  getUsersByOrganizations(_userId: string): Promise<User[]>;\n  getUser(_id: string): Promise<User | undefined>;\n  getUserOrganizations(_userId: string): Promise<Array<{ organizationId: string }>>;\n  getUserResidences(_userId: string): Promise<Array<{ residenceId: string }>>;\n  getUserByEmail(_email: string): Promise<User | undefined>;\n  createUser(_user: InsertUser): Promise<User>;\n  updateUser(_id: string, _updates: Partial<User>): Promise<User | undefined>;\n\n  // Password reset operations\n  createPasswordResetToken(_token: InsertPasswordResetToken): Promise<PasswordResetToken>;\n  getPasswordResetToken(_token: string): Promise<PasswordResetToken | undefined>;\n  markPasswordResetTokenAsUsed(_tokenId: string): Promise<PasswordResetToken | undefined>;\n  cleanupExpiredPasswordResetTokens(): Promise<number>;\n\n  // Organization operations\n  getOrganizations(): Promise<Organization[]>;\n  getOrganization(_id: string): Promise<Organization | undefined>;\n  getOrganizationByName(_name: string): Promise<Organization | undefined>;\n  createOrganization(_organization: InsertOrganization): Promise<Organization>;\n  updateOrganization(\n    _id: string,\n    _updates: Partial<Organization>\n  ): Promise<Organization | undefined>;\n  getBuildingsByOrganization(_organizationId: string): Promise<Building[]>;\n\n  // Building operations\n  getBuildings(): Promise<Building[]>;\n  getBuilding(_id: string): Promise<Building | undefined>;\n  createBuilding(_building: InsertBuilding): Promise<Building>;\n  updateBuilding(_id: string, _updates: Partial<Building>): Promise<Building | undefined>;\n  deleteBuilding(_id: string): Promise<boolean>;\n\n  // Residence operations\n  getResidences(): Promise<Residence[]>;\n  getResidence(_id: string): Promise<Residence | undefined>;\n  getResidencesByBuilding(_buildingId: string): Promise<Residence[]>;\n  createResidence(_residence: InsertResidence): Promise<Residence>;\n  updateResidence(_id: string, _updates: Partial<Residence>): Promise<Residence | undefined>;\n  deleteResidence(_id: string): Promise<boolean>;\n\n  // Contact operations\n  getContacts(): Promise<Contact[]>;\n  getContactsByEntity(\n    _entityId: string,\n    _entity: 'organization' | 'building' | 'residence'\n  ): Promise<Contact[]>;\n  getContactsForResidence(_residenceId: string): Promise<Array<Contact & { user: User }>>;\n  createContact(_contact: InsertContact): Promise<Contact>;\n  updateContact(_id: string, _updates: Partial<Contact>): Promise<Contact | undefined>;\n  deleteContact(_id: string): Promise<boolean>;\n\n  // Document operations\n  getDocuments(_filters?: {\n    buildingId?: string;\n    residenceId?: string;\n    documentType?: string;\n    userId?: string;\n    userRole?: string;\n  }): Promise<Document[]>;\n  getDocument(_id: string): Promise<Document | undefined>;\n  createDocument(_document: InsertDocument): Promise<Document>;\n  updateDocument(_id: string, _updates: Partial<Document>): Promise<Document | undefined>;\n  deleteDocument(_id: string): Promise<boolean>;\n\n  // Permission operations\n  getPermissions(): Promise<Permission[]>;\n  getRolePermissions(): Promise<RolePermission[]>;\n  getUserPermissions(): Promise<UserPermission[]>;\n\n  // Development operations\n  getPillars(): Promise<Pillar[]>;\n  getPillar(_id: string): Promise<Pillar | undefined>;\n  createPillar(_pillar: InsertPillar): Promise<Pillar>;\n  updatePillar(_id: string, _pillar: Partial<Pillar>): Promise<Pillar | undefined>;\n  getWorkspaceStatuses(): Promise<WorkspaceStatus[]>;\n  getWorkspaceStatus(_component: string): Promise<WorkspaceStatus | undefined>;\n  createWorkspaceStatus(_status: InsertWorkspaceStatus): Promise<WorkspaceStatus>;\n  updateWorkspaceStatus(\n    _component: string,\n    _status: Partial<WorkspaceStatus>\n  ): Promise<WorkspaceStatus | undefined>;\n  getQualityMetrics(): Promise<QualityMetric[]>;\n  createQualityMetric(_metric: InsertQualityMetric): Promise<QualityMetric>;\n  getFrameworkConfigurations(): Promise<FrameworkConfiguration[]>;\n  createFrameworkConfiguration(\n    _config: InsertFrameworkConfiguration\n  ): Promise<FrameworkConfiguration>;\n  updateFrameworkConfiguration(\n    _key: string,\n    _config: Partial<FrameworkConfiguration>\n  ): Promise<FrameworkConfiguration | undefined>;\n  getImprovementSuggestions(): Promise<ImprovementSuggestion[]>;\n  createImprovementSuggestion(\n    _suggestion: InsertImprovementSuggestion\n  ): Promise<ImprovementSuggestion>;\n  updateImprovementSuggestion(\n    _id: string,\n    _updates: Partial<ImprovementSuggestion>\n  ): Promise<ImprovementSuggestion | undefined>;\n  getFeatures(): Promise<Feature[]>;\n  getFeature(_id: string): Promise<Feature | undefined>;\n  createFeature(_feature: InsertFeature): Promise<Feature>;\n  updateFeature(_id: string, _updates: Partial<Feature>): Promise<Feature | undefined>;\n  getActionableItems(): Promise<ActionableItem[]>;\n  createActionableItem(_item: InsertActionableItem): Promise<ActionableItem>;\n  updateActionableItem(\n    _id: string,\n    _updates: Partial<ActionableItem>\n  ): Promise<ActionableItem | undefined>;\n  deleteActionableItem(_id: string): Promise<boolean>;\n  getInvitations(): Promise<Invitation[]>;\n  createInvitation(_invitation: InsertInvitation): Promise<Invitation>;\n  getInvitationByToken(_token: string): Promise<Invitation | undefined>;\n  updateInvitation(_id: string, _updates: Partial<Invitation>): Promise<Invitation | undefined>;\n  getInvitationAuditLogs(): Promise<InvitationAuditLog[]>;\n  createInvitationAuditLog(_log: InsertInvitationAuditLog): Promise<InvitationAuditLog>;\n  getCommentsByDemand(_demandId: string): Promise<DemandComment[]>;\n  createDemandComment(_comment: InsertDemandComment): Promise<DemandComment>;\n  getBugs(): Promise<Bug[]>;\n  getBug(_id: string): Promise<Bug | undefined>;\n  createBug(_bug: InsertBug): Promise<Bug>;\n  updateBug(_id: string, _updates: Partial<Bug>): Promise<Bug | undefined>;\n  getFeatureRequests(): Promise<FeatureRequest[]>;\n  getFeatureRequestsForUser(_userId: string, _role: string, _organizationId?: string): Promise<FeatureRequest[]>;\n  getFeatureRequest(_id: string): Promise<FeatureRequest | undefined>;\n  getFeatureRequest(_id: string, _userId: string, _role: string, _organizationId?: string): Promise<FeatureRequest | undefined>;\n  createFeatureRequest(_request: InsertFeatureRequest): Promise<FeatureRequest>;\n  updateFeatureRequest(\n    _id: string,\n    _updates: Partial<FeatureRequest>\n  ): Promise<FeatureRequest | undefined>;\n  addFeatureRequestUpvote(\n    _featureRequestId: string,\n    _userId: string\n  ): Promise<{ success: boolean; message: string; data?: any }>;\n  removeFeatureRequestUpvote(\n    _featureRequestId: string,\n    _userId: string\n  ): Promise<{ success: boolean; message: string; data?: any }>;\n  \n  // Improvement suggestion operations\n  clearNewSuggestions(): Promise<void>;\n  updateSuggestionStatus(_id: string, _status: string): Promise<ImprovementSuggestion | undefined>;\n  getTopImprovementSuggestions(_limit: number): Promise<ImprovementSuggestion[]>;\n  \n  // Feature operations  \n  getFeaturesByStatus(_status: string): Promise<Feature[]>;\n  getPublicRoadmapFeatures(): Promise<Feature[]>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private organizations: Map<string, Organization>;\n  private buildings: Map<string, Building>;\n  private residences: Map<string, Residence>;\n  private pillars: Map<string, Pillar>;\n  private workspaceStatuses: Map<string, WorkspaceStatus>;\n  private qualityMetrics: Map<string, QualityMetric>;\n  private frameworkConfigs: Map<string, FrameworkConfiguration>;\n  private improvementSuggestions: Map<string, ImprovementSuggestion>;\n  private features: Map<string, Feature>;\n  private actionableItems: Map<string, ActionableItem>;\n  private invitations: Map<string, Invitation>;\n  private invitationAuditLogs: Map<string, InvitationAuditLog>;\n  private bugs: Map<string, Bug>;\n  private featureRequests: Map<string, FeatureRequest>;\n  private featureRequestUpvotes: Map<string, FeatureRequestUpvote>;\n\n  constructor() {\n    this.users = new Map();\n    this.organizations = new Map();\n    this.buildings = new Map();\n    this.residences = new Map();\n    this.pillars = new Map();\n    this.workspaceStatuses = new Map();\n    this.qualityMetrics = new Map();\n    this.frameworkConfigs = new Map();\n    this.improvementSuggestions = new Map();\n    this.features = new Map();\n    this.actionableItems = new Map();\n    this.invitations = new Map();\n    this.invitationAuditLogs = new Map();\n    this.bugs = new Map();\n    this.featureRequests = new Map();\n    this.featureRequestUpvotes = new Map();\n\n    // Initialize test user asynchronously\n    this.initializeTestUser().catch(console.error);\n  }\n\n  private async initializeTestUser() {\n    // Use known admin123 password for demo mode\n    const bcrypt = require('bcryptjs');\n    const securePassword = await bcrypt.hash('admin123', 12);\n\n    const user: User = {\n      id: '550e8400-e29b-41d4-a716-446655440000',\n      username: 'kevin.hervieux@koveo-gestion.com',\n      email: 'kevin.hervieux@koveo-gestion.com',\n      password: securePassword,\n      firstName: 'Kevin',\n      lastName: 'Hervieux',\n      phone: '',\n      profileImage: '',\n      language: 'fr',\n      role: 'admin',\n      isActive: true,\n      lastLoginAt: null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    this.users.set(user.id, user);\n  }\n\n  // User operations\n  async getUsers(): Promise<User[]> {\n    return Array.from(this.users.values());\n  }\n\n  async getUsersWithAssignments(): Promise<Array<User & { organizations: Array<{ id: string; name: string; type: string }>; buildings: Array<{ id: string; name: string }>; residences: Array<{ id: string; unitNumber: string; buildingId: string; buildingName: string }> }>> {\n    // For MemStorage, just return users with empty assignments arrays\n    const users = Array.from(this.users.values());\n    return users.map(user => ({\n      ...user,\n      organizations: [],\n      buildings: [],\n      residences: []\n    }));\n  }\n\n  async getUsersByOrganizations(_userId: string): Promise<User[]> {\n    return [];\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserOrganizations(_userId: string): Promise<Array<{ organizationId: string }>> {\n    return [];\n  }\n\n  async getUserResidences(_userId: string): Promise<Array<{ residenceId: string }>> {\n    return [];\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find((user) => user.email === email);\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = {\n      ...insertUser,\n      id,\n      phone: insertUser.phone || null,\n      profileImage: insertUser.profileImage || '',\n      role: insertUser.role || 'tenant',\n      language: insertUser.language || 'fr',\n      isActive: true,\n      lastLoginAt: null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.users.set(id, user);\n    return user;\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | undefined> {\n    const existingUser = this.users.get(id);\n    if (!existingUser) {\n      return undefined;\n    }\n\n    const updatedUser = {\n      ...existingUser,\n      ...updates,\n      updatedAt: new Date(),\n    };\n    this.users.set(id, updatedUser);\n    return updatedUser;\n  }\n\n  // Minimal implementations for other required methods\n  async createPasswordResetToken(_token: InsertPasswordResetToken): Promise<PasswordResetToken> {\n    return {\n      ..._token,\n      id: randomUUID(),\n      createdAt: new Date(),\n      usedAt: null,\n      isUsed: false,\n      ipAddress: _token.ipAddress || '',\n      userAgent: _token.userAgent || '',\n    };\n  }\n  async getPasswordResetToken(_token: string): Promise<PasswordResetToken | undefined> {\n    return undefined;\n  }\n  async markPasswordResetTokenAsUsed(_tokenId: string): Promise<PasswordResetToken | undefined> {\n    return undefined;\n  }\n  async cleanupExpiredPasswordResetTokens(): Promise<number> {\n    return 0;\n  }\n\n  async getOrganizations(): Promise<Organization[]> {\n    return Array.from(this.organizations.values());\n  }\n  async getOrganization(id: string): Promise<Organization | undefined> {\n    return this.organizations.get(id);\n  }\n  async getOrganizationByName(name: string): Promise<Organization | undefined> {\n    return Array.from(this.organizations.values()).find((org) => org.name === name);\n  }\n  async createOrganization(org: InsertOrganization): Promise<Organization> {\n    const id = randomUUID();\n    const organization: Organization = {\n      ...org,\n      id,\n      phone: org.phone || '',\n      email: org.email || '',\n      website: org.website || '',\n      registrationNumber: org.registrationNumber || '',\n      isActive: true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.organizations.set(id, organization);\n    return organization;\n  }\n  async updateOrganization(\n    id: string,\n    updates: Partial<Organization>\n  ): Promise<Organization | undefined> {\n    const existing = this.organizations.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.organizations.set(id, updated);\n    return updated;\n  }\n  async getBuildingsByOrganization(orgId: string): Promise<Building[]> {\n    return Array.from(this.buildings.values()).filter((b) => b.organizationId === orgId);\n  }\n\n  async getBuildings(): Promise<Building[]> {\n    return Array.from(this.buildings.values());\n  }\n  async getBuilding(id: string): Promise<Building | undefined> {\n    return this.buildings.get(id);\n  }\n  async createBuilding(building: InsertBuilding): Promise<Building> {\n    const id = randomUUID();\n    const newBuilding: Building = {\n      ...building,\n      id,\n      isActive: true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      totalUnits: building.totalUnits || 0,\n      totalFloors: building.totalFloors || 0,\n      yearBuilt: building.yearBuilt || 0,\n      buildingType: building.buildingType as 'apartment' | 'condo' | 'rental',\n      bankAccountNumber: building.bankAccountNumber || '',\n      bankAccountMinimums: building.bankAccountMinimums ? JSON.stringify(building.bankAccountMinimums) : '',\n      bankAccountUpdatedAt: new Date(),\n      inflationSettings: '',\n      parkingSpaces: building.parkingSpaces || 0,\n      storageSpaces: building.storageSpaces || 0,\n      amenities: building.amenities || null,\n      managementCompany: building.managementCompany || null,\n      bankAccountNotes: null,\n      bankAccountStartDate: null,\n      bankAccountStartAmount: null,\n    };\n    this.buildings.set(id, newBuilding);\n    return newBuilding;\n  }\n  async updateBuilding(id: string, updates: Partial<Building>): Promise<Building | undefined> {\n    const existing = this.buildings.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.buildings.set(id, updated);\n    return updated;\n  }\n  async deleteBuilding(id: string): Promise<boolean> {\n    const building = this.buildings.get(id);\n    if (!building) {\n      return false;\n    }\n    \n    // Soft delete by setting isActive to false\n    const updatedBuilding = {\n      ...building,\n      isActive: false,\n      updatedAt: new Date(),\n    };\n    \n    this.buildings.set(id, updatedBuilding);\n    return true;\n  }\n\n  async getResidences(): Promise<Residence[]> {\n    return Array.from(this.residences.values());\n  }\n  async getResidence(id: string): Promise<Residence | undefined> {\n    return this.residences.get(id);\n  }\n  async getResidencesByBuilding(buildingId: string): Promise<Residence[]> {\n    return Array.from(this.residences.values()).filter((r) => r.buildingId === buildingId);\n  }\n  async createResidence(residence: InsertResidence): Promise<Residence> {\n    const id = randomUUID();\n    const newResidence: Residence = {\n      ...residence,\n      id,\n      isActive: true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      floor: residence.floor || 0,\n      squareFootage: residence.squareFootage?.toString() || '0',\n      bedrooms: residence.bedrooms || 0,\n      bathrooms: residence.bathrooms?.toString() || '0',\n      balcony: residence.balcony || false,\n      parkingSpaceNumbers: residence.parkingSpaceNumbers || [],\n      storageSpaceNumbers: residence.storageSpaceNumbers || [],\n      ownershipPercentage: residence.ownershipPercentage?.toString() || '0',\n      monthlyFees: residence.monthlyFees?.toString() || '0',\n    };\n    this.residences.set(id, newResidence);\n    return newResidence;\n  }\n  async updateResidence(id: string, updates: Partial<Residence>): Promise<Residence | undefined> {\n    const existing = this.residences.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.residences.set(id, updated);\n    return updated;\n  }\n  async deleteResidence(id: string): Promise<boolean> {\n    return this.residences.delete(id);\n  }\n\n  async getContacts(): Promise<Contact[]> {\n    return [];\n  }\n  async getContactsByEntity(): Promise<Contact[]> {\n    return [];\n  }\n  async getContactsForResidence(): Promise<Array<Contact & { user: User }>> {\n    return [];\n  }\n  async createContact(contact: InsertContact): Promise<Contact> {\n    const id = randomUUID();\n    return {\n      ...contact,\n      id,\n      name: contact.name,\n      email: contact.email || '',\n      phone: contact.phone || '',\n      entity: contact.entity as 'organization' | 'building' | 'residence',\n      entityId: contact.entityId,\n      contactCategory: contact.contactCategory as 'resident' | 'manager' | 'tenant' | 'maintenance' | 'emergency' | 'other',\n      isActive: true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n  async updateContact(): Promise<Contact | undefined> {\n    return undefined;\n  }\n  async deleteContact(): Promise<boolean> {\n    return false;\n  }\n\n  async getDocuments(_filters?: {\n    buildingId?: string;\n    residenceId?: string;\n    documentType?: string;\n    userId?: string;\n    userRole?: string;\n  }): Promise<Document[]> {\n    return [];\n  }\n\n  async getDocument(_id: string): Promise<Document | undefined> {\n    return undefined;\n  }\n\n  async createDocument(doc: InsertDocument): Promise<Document> {\n    const id = randomUUID();\n    return {\n      ...doc,\n      id,\n      description: doc.description || '',\n      buildingId: doc.buildingId || '',\n      residenceId: doc.residenceId || '',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n\n  async updateDocument(_id: string, _updates: Partial<Document>): Promise<Document | undefined> {\n    return undefined;\n  }\n\n  async deleteDocument(_id: string): Promise<boolean> {\n    return false;\n  }\n\n  async getPermissions(): Promise<Permission[]> {\n    return [];\n  }\n  async getRolePermissions(): Promise<RolePermission[]> {\n    return [];\n  }\n  async getUserPermissions(): Promise<UserPermission[]> {\n    return [];\n  }\n\n  async getPillars(): Promise<Pillar[]> {\n    return Array.from(this.pillars.values()).sort((a, b) => parseInt(a.order) - parseInt(b.order));\n  }\n  async getPillar(id: string): Promise<Pillar | undefined> {\n    return this.pillars.get(id);\n  }\n  async createPillar(pillar: InsertPillar): Promise<Pillar> {\n    const id = randomUUID();\n    const newPillar: Pillar = {\n      ...pillar,\n      id,\n      name: pillar.name,\n      description: pillar.description || '',\n      status: pillar.status || 'pending',\n      order: pillar.order.toString(),\n      configuration: pillar.configuration || null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.pillars.set(id, newPillar);\n    return newPillar;\n  }\n  async updatePillar(id: string, updates: Partial<Pillar>): Promise<Pillar | undefined> {\n    const existing = this.pillars.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.pillars.set(id, updated);\n    return updated;\n  }\n\n  async getWorkspaceStatuses(): Promise<WorkspaceStatus[]> {\n    return Array.from(this.workspaceStatuses.values());\n  }\n  async getWorkspaceStatus(component: string): Promise<WorkspaceStatus | undefined> {\n    return this.workspaceStatuses.get(component);\n  }\n  async createWorkspaceStatus(status: InsertWorkspaceStatus): Promise<WorkspaceStatus> {\n    const id = randomUUID();\n    const newStatus: WorkspaceStatus = {\n      ...status,\n      id,\n      status: status.status,\n      component: status.component,\n      lastUpdated: new Date(),\n    };\n    this.workspaceStatuses.set(status.component, newStatus);\n    return newStatus;\n  }\n  async updateWorkspaceStatus(\n    component: string,\n    updates: Partial<WorkspaceStatus>\n  ): Promise<WorkspaceStatus | undefined> {\n    const existing = this.workspaceStatuses.get(component);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.workspaceStatuses.set(component, updated);\n    return updated;\n  }\n\n  async getQualityMetrics(): Promise<QualityMetric[]> {\n    return Array.from(this.qualityMetrics.values());\n  }\n  async createQualityMetric(metric: InsertQualityMetric): Promise<QualityMetric> {\n    const id = randomUUID();\n    const newMetric: QualityMetric = {\n      ...metric,\n      id,\n      timestamp: new Date(),\n    };\n    this.qualityMetrics.set(id, newMetric);\n    return newMetric;\n  }\n\n  async getFrameworkConfigurations(): Promise<FrameworkConfiguration[]> {\n    return Array.from(this.frameworkConfigs.values());\n  }\n  async createFrameworkConfiguration(\n    config: InsertFrameworkConfiguration\n  ): Promise<FrameworkConfiguration> {\n    const id = randomUUID();\n    const newConfig: FrameworkConfiguration = {\n      ...config,\n      id,\n      description: config.description || '',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.frameworkConfigs.set(config._key, newConfig);\n    return newConfig;\n  }\n  async updateFrameworkConfiguration(\n    key: string,\n    updates: Partial<FrameworkConfiguration>\n  ): Promise<FrameworkConfiguration | undefined> {\n    const existing = this.frameworkConfigs.get(key);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.frameworkConfigs.set(key, updated);\n    return updated;\n  }\n\n  async getImprovementSuggestions(): Promise<ImprovementSuggestion[]> {\n    return Array.from(this.improvementSuggestions.values());\n  }\n  async createImprovementSuggestion(\n    suggestion: InsertImprovementSuggestion\n  ): Promise<ImprovementSuggestion> {\n    const id = randomUUID();\n    const newSuggestion: ImprovementSuggestion = {\n      ...suggestion,\n      id,\n      filePath: suggestion.filePath || null,\n      status: suggestion.status as 'New' | 'Acknowledged' | 'Done',\n      category: suggestion.category as 'Code Quality' | 'Security' | 'Testing' | 'Documentation' | 'Performance' | 'Continuous Improvement' | 'Replit AI Agent Monitoring' | 'Replit App',\n      priority: (suggestion.priority as 'Low' | 'Medium' | 'High' | 'Critical') || 'Medium',\n      assignedTo: suggestion.assignedTo || null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      acknowledgedAt: null,\n      completedAt: null,\n    };\n    this.improvementSuggestions.set(id, newSuggestion);\n    return newSuggestion;\n  }\n  async updateImprovementSuggestion(\n    id: string,\n    updates: Partial<ImprovementSuggestion>\n  ): Promise<ImprovementSuggestion | undefined> {\n    const existing = this.improvementSuggestions.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.improvementSuggestions.set(id, updated);\n    return updated;\n  }\n\n  async getTopImprovementSuggestions(limit: number): Promise<ImprovementSuggestion[]> {\n    const suggestions = Array.from(this.improvementSuggestions.values());\n    // Sort by priority (Critical > High > Medium > Low) then by creation date\n    const priorityOrder: { [key: string]: number } = { 'Critical': 0, 'High': 1, 'Medium': 2, 'Low': 3 };\n    return suggestions\n      .sort((a, b) => {\n        const priorityA = priorityOrder[a.priority] ?? 999;\n        const priorityB = priorityOrder[b.priority] ?? 999;\n        const priorityDiff = priorityA - priorityB;\n        if (priorityDiff !== 0) return priorityDiff;\n        return new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();\n      })\n      .slice(0, limit);\n  }\n\n  async clearNewSuggestions(): Promise<void> {\n    for (const [id, suggestion] of this.improvementSuggestions.entries()) {\n      if (suggestion.status === 'New') {\n        this.improvementSuggestions.delete(id);\n      }\n    }\n  }\n\n  async updateSuggestionStatus(\n    id: string,\n    status: 'New' | 'Acknowledged' | 'Done'\n  ): Promise<ImprovementSuggestion | undefined> {\n    const suggestion = this.improvementSuggestions.get(id);\n    if (!suggestion) return undefined;\n\n    const updatedSuggestion = {\n      ...suggestion,\n      status,\n      updatedAt: new Date(),\n    };\n    this.improvementSuggestions.set(id, updatedSuggestion);\n    return updatedSuggestion;\n  }\n\n  async getFeatures(): Promise<Feature[]> {\n    return Array.from(this.features.values());\n  }\n  async getFeature(id: string): Promise<Feature | undefined> {\n    return this.features.get(id);\n  }\n  async createFeature(feature: InsertFeature): Promise<Feature> {\n    const id = randomUUID();\n    const newFeature: Feature = {\n      ...feature,\n      id,\n      isPublicRoadmap: feature.isPublicRoadmap ?? true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      requestedBy: feature.requestedBy || null,\n      assignedTo: feature.assignedTo || null,\n      estimatedHours: feature.estimatedHours || 0,\n      businessObjective: feature.businessObjective || '',\n      targetUsers: feature.targetUsers || '',\n      successMetrics: feature.successMetrics || '',\n      technicalComplexity: feature.technicalComplexity || '',\n      dependencies: feature.dependencies?.join(',') || '',\n      userFlow: feature.userFlow || '',\n      actualHours: null,\n      startDate: null,\n      completedDate: null,\n      tags: [],\n      metadata: {},\n      syncedAt: new Date(),\n    };\n    this.features.set(id, newFeature);\n    return newFeature;\n  }\n  async updateFeature(id: string, updates: Partial<Feature>): Promise<Feature | undefined> {\n    const existing = this.features.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.features.set(id, updated);\n    return updated;\n  }\n\n  async getFeaturesByStatus(\n    status: 'completed' | 'in-progress' | 'planned' | 'cancelled' | 'requested'\n  ): Promise<Feature[]> {\n    return Array.from(this.features.values()).filter((f) => f.status === status);\n  }\n\n  async getPublicRoadmapFeatures(): Promise<Feature[]> {\n    return Array.from(this.features.values()).filter((f) => f.isPublicRoadmap);\n  }\n\n  async getActionableItems(): Promise<ActionableItem[]> {\n    return Array.from(this.actionableItems.values());\n  }\n  async createActionableItem(item: InsertActionableItem): Promise<ActionableItem> {\n    const id = randomUUID();\n    const newItem: ActionableItem = {\n      ...item,\n      id,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      estimatedHours: item.estimatedHours || 0,\n      dependencies: item.dependencies || [],\n      completedAt: null,\n      startedAt: null,\n    };\n    this.actionableItems.set(id, newItem);\n    return newItem;\n  }\n  async updateActionableItem(\n    id: string,\n    updates: Partial<ActionableItem>\n  ): Promise<ActionableItem | undefined> {\n    const existing = this.actionableItems.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.actionableItems.set(id, updated);\n    return updated;\n  }\n  async deleteActionableItem(id: string): Promise<boolean> {\n    return this.actionableItems.delete(id);\n  }\n\n  async getInvitations(): Promise<Invitation[]> {\n    return Array.from(this.invitations.values());\n  }\n  async createInvitation(invitation: InsertInvitation): Promise<Invitation> {\n    const id = randomUUID();\n    const newInvitation: Invitation = {\n      ...invitation,\n      id,\n      token: randomUUID(),\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      status: 'pending',\n      ipAddress: '',\n      userAgent: '',\n      isUsed: false,\n      usedAt: null,\n      createdByUserId: invitation.invitedByUserId,\n      acceptedByUserId: null,\n      acceptedAt: null,\n      revokedAt: null,\n      revokedByUserId: null,\n      lastAccessedAt: null,\n    };\n    this.invitations.set(id, newInvitation);\n    return newInvitation;\n  }\n  async getInvitationByToken(token: string): Promise<Invitation | undefined> {\n    return Array.from(this.invitations.values()).find((inv) => inv.token === token);\n  }\n  async updateInvitation(\n    id: string,\n    updates: Partial<Invitation>\n  ): Promise<Invitation | undefined> {\n    const existing = this.invitations.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.invitations.set(id, updated);\n    return updated;\n  }\n\n  async getInvitationAuditLogs(): Promise<InvitationAuditLog[]> {\n    return Array.from(this.invitationAuditLogs.values());\n  }\n  async createInvitationAuditLog(log: InsertInvitationAuditLog): Promise<InvitationAuditLog> {\n    const id = randomUUID();\n    const newLog: InvitationAuditLog = { \n      ...log, \n      id, \n      createdAt: new Date(),\n      ipAddress: log.ipAddress || '',\n      userAgent: log.userAgent || '',\n      details: log.details || {},\n      previousStatus: log.previousStatus || 'pending',\n      newStatus: log.newStatus || 'pending'\n    };\n    this.invitationAuditLogs.set(id, newLog);\n    return newLog;\n  }\n\n  async getCommentsByDemand(): Promise<DemandComment[]> {\n    return [];\n  }\n  async createDemandComment(comment: InsertDemandComment): Promise<DemandComment> {\n    const id = randomUUID();\n    return {\n      ...comment,\n      id,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n\n  async getBugs(): Promise<Bug[]> {\n    return Array.from(this.bugs.values());\n  }\n  async getBug(id: string): Promise<Bug | undefined> {\n    return this.bugs.get(id);\n  }\n  async createBug(bug: InsertBug): Promise<Bug> {\n    const id = randomUUID();\n    const newBug: Bug = {\n      ...bug,\n      id,\n      status: 'new',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      reproductionSteps: bug.reproductionSteps || '',\n      assignedTo: null,\n      resolvedAt: null,\n      resolvedBy: null,\n      notes: null,\n      environment: bug.environment || '',\n    };\n    this.bugs.set(id, newBug);\n    return newBug;\n  }\n  async updateBug(id: string, updates: Partial<Bug>): Promise<Bug | undefined> {\n    const existing = this.bugs.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.bugs.set(id, updated);\n    return updated;\n  }\n\n  async getFeatureRequests(): Promise<FeatureRequest[]> {\n    const featureRequests = Array.from(this.featureRequests.values());\n    // Add attachment information to each feature request\n    const enrichedRequests = await Promise.all(\n      featureRequests.map(async (request) => {\n        // For now, return empty attachments - will be implemented once storage is fixed\n        const attachments: any[] = [];\n        return {\n          ...request,\n          attachmentCount: attachments.length,\n          attachments: []\n        };\n      })\n    );\n    return enrichedRequests;\n  }\n  \n  async getFeatureRequestsForUser(userId: string, role: string, organizationId?: string): Promise<FeatureRequest[]> {\n    // For now, just return all feature requests - proper filtering can be added later\n    return this.getFeatureRequests();\n  }\n  \n  async getFeatureRequest(id: string): Promise<FeatureRequest | undefined>;\n  async getFeatureRequest(id: string, userId?: string, role?: string, organizationId?: string): Promise<FeatureRequest | undefined> {\n    const request = this.featureRequests.get(id);\n    if (!request) return undefined;\n    \n    // For now, return empty attachments - will be implemented once storage is fixed\n    const attachments: any[] = [];\n    \n    return {\n      ...request,\n      attachmentCount: attachments.length,\n      attachments: []\n    };\n  }\n  async createFeatureRequest(request: InsertFeatureRequest): Promise<FeatureRequest> {\n    const id = randomUUID();\n    const newRequest: FeatureRequest = {\n      ...request,\n      id,\n      status: 'submitted',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      upvoteCount: 0,\n      assignedTo: null,\n      reviewedBy: null,\n      reviewedAt: null,\n      estimatedHours: null,\n      mergedIntoId: null,\n    };\n    this.featureRequests.set(id, newRequest);\n    return newRequest;\n  }\n  async updateFeatureRequest(\n    id: string,\n    updates: Partial<FeatureRequest>\n  ): Promise<FeatureRequest | undefined> {\n    const existing = this.featureRequests.get(id);\n    if (!existing) return undefined;\n    const updated = { ...existing, ...updates, updatedAt: new Date() };\n    this.featureRequests.set(id, updated);\n    return updated;\n  }\n\n  async addFeatureRequestUpvote(): Promise<{ success: boolean; message: string; data?: any }> {\n    return { success: true, message: 'Upvote added' };\n  }\n  async removeFeatureRequestUpvote(): Promise<{ success: boolean; message: string; data?: any }> {\n    return { success: true, message: 'Upvote removed' };\n  }\n\n\n}\n\n// Import the database storage implementation\nimport { OptimizedDatabaseStorage } from './optimized-db-storage';\n\n// Production fallback storage - try database first, fall back to memory if authentication fails\nclass ProductionFallbackStorage implements IStorage {\n  private dbStorage: OptimizedDatabaseStorage;\n  private memStorage: MemStorage;\n  private usingFallback: boolean = false;\n\n  constructor() {\n    this.dbStorage = new OptimizedDatabaseStorage();\n    this.memStorage = new MemStorage();\n  }\n\n  private async safeDbOperation<T>(operation: () => Promise<T>): Promise<T> {\n    if (this.usingFallback) {\n      throw new Error('Database unavailable, using memory storage');\n    }\n\n    try {\n      return await operation();\n    } catch (error: any) {\n      // Check if it's a database authentication error\n      if (\n        error.message?.includes('password authentication failed') ||\n        error.message?.includes('neondb_owner') ||\n        error.cause?.message?.includes('password authentication failed')\n      ) {\n        // Database authentication failed, switching to memory storage for production stability\n        this.usingFallback = true;\n\n        // Initialize memory storage with production admin user\n        await this.initializeFallbackData();\n        throw new Error('Database unavailable, using memory storage');\n      }\n      throw error;\n    }\n  }\n\n  private async initializeFallbackData(): Promise<void> {\n    // Create the production admin user in memory storage\n    const adminUser = {\n      id: 'f35647de-5f16-46f2-b30b-09e0469356b1',\n      username: 'kevin.hervieux',\n      email: 'kevin.hervieux@koveo-gestion.com',\n      password: '$2b$12$sAJXEcITZg5ItQou312JsucLyzByPC6lF7CLvrrLkhxKd1EyfSxda', // admin123\n      firstName: 'Kevin',\n      lastName: 'Hervieux',\n      phone: '',\n      profileImage: '',\n      language: 'fr' as const,\n      role: 'admin' as const,\n      isActive: true,\n      lastLoginAt: null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    await this.memStorage.createUser(adminUser);\n\n    // Create default organization for admin user\n    const defaultOrg = {\n      id: 'koveo-org-main',\n      name: 'Koveo Gestion',\n      type: 'property_management' as const,\n      address: '123 Quebec Street',\n      city: 'Montreal',\n      province: 'QC',\n      postalCode: 'H1A 1A1',\n      phone: '+1-514-555-0100',\n      email: 'contact@koveo-gestion.com',\n      website: 'https://koveo-gestion.com',\n      description: 'Main Koveo property management organization',\n      isActive: true,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    await this.memStorage.createOrganization(defaultOrg);\n\n    // Associate admin user with the organization\n    // For memory storage, we'll just ensure the user has access to the organization\n    // This is handled by the user's role being 'admin' which gives access to all organizations\n\n    // Production fallback initialized successfully\n  }\n\n  // User operations with fallback\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    // Debug logging removed\n    try {\n      const user = await this.safeDbOperation(() => this.dbStorage.getUserByEmail(email));\n      // Debug logging removed\n      return user;\n    } catch (error: any) {\n      // Error handling maintained without debug logging\n      throw error;\n    }\n  }\n\n  async getUsers(): Promise<User[]> {\n    return await this.safeDbOperation(() => this.dbStorage.getUsers());\n  }\n\n  async getUsersWithAssignments(): Promise<Array<User & { organizations: Array<{ id: string; name: string; type: string }>; buildings: Array<{ id: string; name: string }>; residences: Array<{ id: string; unitNumber: string; buildingId: string; buildingName: string }> }>> {\n    return await this.safeDbOperation(() => this.dbStorage.getUsersWithAssignments());\n  }\n\n  async getUsersByOrganizations(userId: string): Promise<User[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getUsersByOrganizations(userId));\n    } catch {\n      return this.memStorage.getUsersByOrganizations(userId);\n    }\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return await this.safeDbOperation(() => this.dbStorage.getUser(id));\n  }\n\n  async getUserOrganizations(userId: string): Promise<Array<{ organizationId: string }>> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getUserOrganizations(userId));\n    } catch {\n      return this.memStorage.getUserOrganizations(userId);\n    }\n  }\n\n  async getUserResidences(userId: string): Promise<Array<{ residenceId: string }>> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getUserResidences(userId));\n    } catch {\n      return this.memStorage.getUserResidences(userId);\n    }\n  }\n\n  async createUser(user: InsertUser): Promise<User> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createUser(user));\n    } catch {\n      return this.memStorage.createUser(user);\n    }\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | undefined> {\n    return await this.safeDbOperation(() => this.dbStorage.updateUser(id, updates));\n  }\n\n  // Password reset operations\n  async createPasswordResetToken(token: InsertPasswordResetToken): Promise<PasswordResetToken> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createPasswordResetToken(token));\n    } catch {\n      return this.memStorage.createPasswordResetToken(token);\n    }\n  }\n\n  async getPasswordResetToken(token: string): Promise<PasswordResetToken | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getPasswordResetToken(token));\n    } catch {\n      return this.memStorage.getPasswordResetToken(token);\n    }\n  }\n\n  async markPasswordResetTokenAsUsed(tokenId: string): Promise<PasswordResetToken | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.markPasswordResetTokenAsUsed(tokenId));\n    } catch {\n      return this.memStorage.markPasswordResetTokenAsUsed(tokenId);\n    }\n  }\n\n  async cleanupExpiredPasswordResetTokens(): Promise<number> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.cleanupExpiredPasswordResetTokens());\n    } catch {\n      return this.memStorage.cleanupExpiredPasswordResetTokens();\n    }\n  }\n\n  // Delegate all other methods to the appropriate storage\n  async getOrganizations(): Promise<Organization[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getOrganizations());\n    } catch {\n      return this.memStorage.getOrganizations();\n    }\n  }\n\n  async getOrganization(id: string): Promise<Organization | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getOrganization(id));\n    } catch {\n      return this.memStorage.getOrganization(id);\n    }\n  }\n\n  async createOrganization(org: InsertOrganization): Promise<Organization> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createOrganization(org));\n    } catch {\n      return this.memStorage.createOrganization(org);\n    }\n  }\n\n  async updateOrganization(\n    id: string,\n    updates: Partial<Organization>\n  ): Promise<Organization | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.updateOrganization(id, updates));\n    } catch {\n      return this.memStorage.updateOrganization(id, updates);\n    }\n  }\n\n  async deleteOrganization(id: string): Promise<boolean> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.deleteOrganization(id));\n    } catch {\n      return this.memStorage.deleteOrganization(id);\n    }\n  }\n\n  // Buildings\n  async getBuildings(): Promise<Building[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getBuildings());\n    } catch {\n      return this.memStorage.getBuildings();\n    }\n  }\n\n  async getBuildingsByOrganization(organizationId: string): Promise<Building[]> {\n    try {\n      return await this.safeDbOperation(() =>\n        this.dbStorage.getBuildingsByOrganization(organizationId)\n      );\n    } catch {\n      return this.memStorage.getBuildingsByOrganization(organizationId);\n    }\n  }\n\n  async getBuilding(id: string): Promise<Building | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getBuilding(id));\n    } catch {\n      return this.memStorage.getBuilding(id);\n    }\n  }\n\n  async createBuilding(building: InsertBuilding): Promise<Building> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createBuilding(building));\n    } catch {\n      return this.memStorage.createBuilding(building);\n    }\n  }\n\n  async updateBuilding(id: string, updates: Partial<Building>): Promise<Building | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.updateBuilding(id, updates));\n    } catch {\n      return this.memStorage.updateBuilding(id, updates);\n    }\n  }\n\n  async deleteBuilding(id: string): Promise<boolean> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.deleteBuilding(id));\n    } catch {\n      return this.memStorage.deleteBuilding(id);\n    }\n  }\n\n  // Residences\n  async getResidences(): Promise<Residence[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getResidences());\n    } catch {\n      return this.memStorage.getResidences();\n    }\n  }\n\n  async getResidencesByBuilding(buildingId: string): Promise<Residence[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getResidencesByBuilding(buildingId));\n    } catch {\n      return this.memStorage.getResidencesByBuilding(buildingId);\n    }\n  }\n\n  async getResidence(id: string): Promise<Residence | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getResidence(id));\n    } catch {\n      return this.memStorage.getResidence(id);\n    }\n  }\n\n  async createResidence(residence: InsertResidence): Promise<Residence> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createResidence(residence));\n    } catch {\n      return this.memStorage.createResidence(residence);\n    }\n  }\n\n  async updateResidence(id: string, updates: Partial<Residence>): Promise<Residence | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.updateResidence(id, updates));\n    } catch {\n      return this.memStorage.updateResidence(id, updates);\n    }\n  }\n\n  async deleteResidence(id: string): Promise<boolean> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.deleteResidence(id));\n    } catch {\n      return this.memStorage.deleteResidence(id);\n    }\n  }\n\n  // All other methods - implement fallback pattern for remaining interface methods\n  async getContacts(): Promise<Contact[]> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getContacts());\n    } catch {\n      return this.memStorage.getContacts();\n    }\n  }\n\n  async getContact(id: string): Promise<Contact | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.getContact(id));\n    } catch {\n      return this.memStorage.getContact(id);\n    }\n  }\n\n  async createContact(contact: InsertContact): Promise<Contact> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.createContact(contact));\n    } catch {\n      return this.memStorage.createContact(contact);\n    }\n  }\n\n  async updateContact(id: string, updates: Partial<Contact>): Promise<Contact | undefined> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.updateContact(id, updates));\n    } catch {\n      return this.memStorage.updateContact(id, updates);\n    }\n  }\n\n  async deleteContact(id: string): Promise<boolean> {\n    try {\n      return await this.safeDbOperation(() => this.dbStorage.deleteContact(id));\n    } catch {\n      return this.memStorage.deleteContact(id);\n    }\n  }\n\n  // Stub implementations for remaining interface methods - add all other required methods\n  async getDocuments(): Promise<Document[]> {\n    return [];\n  }\n  async getDocument(id: string): Promise<Document | undefined> {\n    return undefined;\n  }\n  async createDocument(doc: InsertDocument): Promise<Document> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateDocument(id: string, updates: Partial<Document>): Promise<Document | undefined> {\n    return undefined;\n  }\n  async deleteDocument(id: string): Promise<boolean> {\n    return false;\n  }\n  async getDocumentsByBuilding(buildingId: string): Promise<DocumentBuilding[]> {\n    return [];\n  }\n  async createDocumentBuilding(doc: InsertDocumentBuilding): Promise<DocumentBuilding> {\n    // Note: External storage integration removed\n    const id = randomUUID();\n    return {\n      ...doc,\n      id,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n  async deleteDocumentBuilding(documentId: string, buildingId: string): Promise<boolean> {\n    return false;\n  }\n  async getDocumentsByResident(residentId: string): Promise<DocumentResident[]> {\n    return [];\n  }\n  async createDocumentResident(doc: InsertDocumentResident): Promise<DocumentResident> {\n    // Note: External storage integration removed\n    const id = randomUUID();\n    return {\n      ...doc,\n      id,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n  async deleteDocumentResident(documentId: string, residentId: string): Promise<boolean> {\n    return false;\n  }\n  async getPillars(): Promise<Pillar[]> {\n    return [];\n  }\n  async getPillar(id: string): Promise<Pillar | undefined> {\n    return undefined;\n  }\n  async createPillar(pillar: InsertPillar): Promise<Pillar> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updatePillar(id: string, updates: Partial<Pillar>): Promise<Pillar | undefined> {\n    return undefined;\n  }\n  async getWorkspaceStatuses(): Promise<WorkspaceStatus[]> {\n    return [];\n  }\n  async getWorkspaceStatus(id: string): Promise<WorkspaceStatus | undefined> {\n    return undefined;\n  }\n  async createWorkspaceStatus(status: InsertWorkspaceStatus): Promise<WorkspaceStatus> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateWorkspaceStatus(\n    id: string,\n    updates: Partial<WorkspaceStatus>\n  ): Promise<WorkspaceStatus | undefined> {\n    return undefined;\n  }\n  async getQualityMetrics(): Promise<QualityMetric[]> {\n    return [];\n  }\n  async getQualityMetric(id: string): Promise<QualityMetric | undefined> {\n    return undefined;\n  }\n  async createQualityMetric(metric: InsertQualityMetric): Promise<QualityMetric> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateQualityMetric(\n    id: string,\n    updates: Partial<QualityMetric>\n  ): Promise<QualityMetric | undefined> {\n    return undefined;\n  }\n  async getFrameworkConfigurations(): Promise<FrameworkConfiguration[]> {\n    return [];\n  }\n  async getFrameworkConfiguration(id: string): Promise<FrameworkConfiguration | undefined> {\n    return undefined;\n  }\n  async createFrameworkConfiguration(\n    config: InsertFrameworkConfiguration\n  ): Promise<FrameworkConfiguration> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateFrameworkConfiguration(\n    id: string,\n    updates: Partial<FrameworkConfiguration>\n  ): Promise<FrameworkConfiguration | undefined> {\n    return undefined;\n  }\n  async getImprovementSuggestions(): Promise<ImprovementSuggestion[]> {\n    return [];\n  }\n  async getImprovementSuggestion(id: string): Promise<ImprovementSuggestion | undefined> {\n    return undefined;\n  }\n  async createImprovementSuggestion(\n    suggestion: InsertImprovementSuggestion\n  ): Promise<ImprovementSuggestion> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateImprovementSuggestion(\n    id: string,\n    updates: Partial<ImprovementSuggestion>\n  ): Promise<ImprovementSuggestion | undefined> {\n    return undefined;\n  }\n  async getFeatures(): Promise<Feature[]> {\n    return [];\n  }\n  async getFeature(id: string): Promise<Feature | undefined> {\n    return undefined;\n  }\n  async createFeature(feature: InsertFeature): Promise<Feature> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateFeature(id: string, updates: Partial<Feature>): Promise<Feature | undefined> {\n    return undefined;\n  }\n  async getActionableItems(): Promise<ActionableItem[]> {\n    return [];\n  }\n  async getActionableItem(id: string): Promise<ActionableItem | undefined> {\n    return undefined;\n  }\n  async createActionableItem(item: InsertActionableItem): Promise<ActionableItem> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateActionableItem(\n    id: string,\n    updates: Partial<ActionableItem>\n  ): Promise<ActionableItem | undefined> {\n    return undefined;\n  }\n  async getInvitations(): Promise<Invitation[]> {\n    return [];\n  }\n  async getInvitation(id: string): Promise<Invitation | undefined> {\n    return undefined;\n  }\n  async getInvitationByToken(token: string): Promise<Invitation | undefined> {\n    return undefined;\n  }\n  async createInvitation(invitation: InsertInvitation): Promise<Invitation> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateInvitation(\n    id: string,\n    updates: Partial<Invitation>\n  ): Promise<Invitation | undefined> {\n    return undefined;\n  }\n  async deleteInvitation(id: string): Promise<boolean> {\n    return false;\n  }\n  async getPermissions(): Promise<Permission[]> {\n    return [];\n  }\n  async getPermission(id: string): Promise<Permission | undefined> {\n    return undefined;\n  }\n  async getRolePermissions(role: string): Promise<RolePermission[]> {\n    return [];\n  }\n  async getUserPermissions(userId: string): Promise<UserPermission[]> {\n    return [];\n  }\n  async hasPermission(userId: string, permission: string): Promise<boolean> {\n    return true;\n  } // Admin fallback\n  async getBugs(): Promise<Bug[]> {\n    return [];\n  }\n  async getBug(id: string): Promise<Bug | undefined> {\n    return undefined;\n  }\n  async createBug(bug: InsertBug): Promise<Bug> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateBug(id: string, updates: Partial<Bug>): Promise<Bug | undefined> {\n    return undefined;\n  }\n  async getFeatureRequests(): Promise<FeatureRequest[]> {\n    return [];\n  }\n  async getFeatureRequest(id: string): Promise<FeatureRequest | undefined> {\n    return undefined;\n  }\n  async createFeatureRequest(request: InsertFeatureRequest): Promise<FeatureRequest> {\n    throw new Error('Not implemented in fallback');\n  }\n  async updateFeatureRequest(\n    id: string,\n    updates: Partial<FeatureRequest>\n  ): Promise<FeatureRequest | undefined> {\n    return undefined;\n  }\n  async addFeatureRequestUpvote(\n    featureRequestId: string,\n    userId: string\n  ): Promise<{ success: boolean; message: string; data?: any }> {\n    return { success: true, message: 'Fallback mode' };\n  }\n  async removeFeatureRequestUpvote(\n    featureRequestId: string,\n    userId: string\n  ): Promise<{ success: boolean; message: string; data?: any }> {\n    return { success: true, message: 'Fallback mode' };\n  }\n\n\n\n\n}\n\n// Use optimized database storage for production\nexport const storage = new OptimizedDatabaseStorage();\n\n// Export the OptimizedDatabaseStorage class for direct usage\nexport { OptimizedDatabaseStorage } from './optimized-db-storage';\n"],"version":3}
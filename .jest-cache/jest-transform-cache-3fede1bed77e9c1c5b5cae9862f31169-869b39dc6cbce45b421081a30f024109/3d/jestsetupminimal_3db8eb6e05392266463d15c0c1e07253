276f03298dceb6f7ed7cb97cde61e228
/**
 * Minimal Jest Setup for Testing Koveo Gestion Platform
 * Focused on preventing hanging and test failures
 */
// Mock the database module
jest.mock('./server/db', () => ({
    db: mockDb,
}));
// Mock drizzle-orm functions
jest.mock('drizzle-orm', () => ({
    eq: jest.fn(() => 'mock-condition'),
    and: jest.fn(() => 'mock-condition'),
    or: jest.fn(() => 'mock-condition'),
}));
// Mock bcrypt
jest.mock('bcryptjs', () => ({
    hash: jest.fn(() => Promise.resolve('mock-hash')),
    compare: jest.fn(() => Promise.resolve(true)),
}));
// Set test environment variables first
process.env.NODE_ENV = 'test';
process.env.TEST_TYPE = 'unit';
process.env.USE_MOCK_DB = 'true';
process.env.SKIP_DB_OPERATIONS = 'true';
// Mock fetch for tests
global.fetch = jest.fn();
// Create simple database mock
const mockDb = {
    insert: jest.fn(() => ({
        values: jest.fn(() => ({
            returning: jest.fn(() => Promise.resolve([{ id: 'mock-id' }])),
        })),
    })),
    select: jest.fn(() => ({
        from: jest.fn(() => ({
            where: jest.fn(() => Promise.resolve([])),
        })),
    })),
    update: jest.fn(() => ({
        set: jest.fn(() => ({
            where: jest.fn(() => Promise.resolve({ affectedRows: 1 })),
        })),
    })),
    delete: jest.fn(() => ({
        where: jest.fn(() => Promise.resolve({ affectedRows: 1 })),
    })),
};
console.log('âœ… Minimal Jest setup completed');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9qZXN0LnNldHVwLm1pbmltYWwudHMiLCJtYXBwaW5ncyI6IkFBQUE7OztHQUdHO0FBaUNILDJCQUEyQjtBQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzlCLEVBQUUsRUFBRSxNQUFNO0NBQ1gsQ0FBQyxDQUFDLENBQUM7QUFFSiw2QkFBNkI7QUFDN0IsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM5QixFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztJQUNuQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztJQUNwQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztDQUNwQyxDQUFDLENBQUMsQ0FBQztBQUVKLGNBQWM7QUFDZCxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzNCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakQsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztDQUM5QyxDQUFDLENBQUMsQ0FBQztBQS9DSix1Q0FBdUM7QUFDdkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDO0FBQzlCLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQztBQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUM7QUFDakMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsR0FBRyxNQUFNLENBQUM7QUFFeEMsdUJBQXVCO0FBQ3ZCLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBRXpCLDhCQUE4QjtBQUM5QixNQUFNLE1BQU0sR0FBRztJQUNiLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDckIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNyQixTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQy9ELENBQUMsQ0FBQztLQUNKLENBQUMsQ0FBQztJQUNILE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDckIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQzFDLENBQUMsQ0FBQztLQUNKLENBQUMsQ0FBQztJQUNILE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDckIsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNsQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDM0QsQ0FBQyxDQUFDO0tBQ0osQ0FBQyxDQUFDO0lBQ0gsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNyQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDM0QsQ0FBQyxDQUFDO0NBQ0osQ0FBQztBQW9CRixPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9qZXN0LnNldHVwLm1pbmltYWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNaW5pbWFsIEplc3QgU2V0dXAgZm9yIFRlc3RpbmcgS292ZW8gR2VzdGlvbiBQbGF0Zm9ybVxuICogRm9jdXNlZCBvbiBwcmV2ZW50aW5nIGhhbmdpbmcgYW5kIHRlc3QgZmFpbHVyZXNcbiAqL1xuXG4vLyBTZXQgdGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZmlyc3RcbnByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Rlc3QnO1xucHJvY2Vzcy5lbnYuVEVTVF9UWVBFID0gJ3VuaXQnO1xucHJvY2Vzcy5lbnYuVVNFX01PQ0tfREIgPSAndHJ1ZSc7XG5wcm9jZXNzLmVudi5TS0lQX0RCX09QRVJBVElPTlMgPSAndHJ1ZSc7XG5cbi8vIE1vY2sgZmV0Y2ggZm9yIHRlc3RzXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbi8vIENyZWF0ZSBzaW1wbGUgZGF0YWJhc2UgbW9ja1xuY29uc3QgbW9ja0RiID0ge1xuICBpbnNlcnQ6IGplc3QuZm4oKCkgPT4gKHtcbiAgICB2YWx1ZXM6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIHJldHVybmluZzogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoW3sgaWQ6ICdtb2NrLWlkJyB9XSkpLFxuICAgIH0pKSxcbiAgfSkpLFxuICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBmcm9tOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICB3aGVyZTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoW10pKSxcbiAgICB9KSksXG4gIH0pKSxcbiAgdXBkYXRlOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgc2V0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICB3aGVyZTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBhZmZlY3RlZFJvd3M6IDEgfSkpLFxuICAgIH0pKSxcbiAgfSkpLFxuICBkZWxldGU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICB3aGVyZTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBhZmZlY3RlZFJvd3M6IDEgfSkpLFxuICB9KSksXG59O1xuXG4vLyBNb2NrIHRoZSBkYXRhYmFzZSBtb2R1bGVcbmplc3QubW9jaygnLi9zZXJ2ZXIvZGInLCAoKSA9PiAoe1xuICBkYjogbW9ja0RiLFxufSkpO1xuXG4vLyBNb2NrIGRyaXp6bGUtb3JtIGZ1bmN0aW9uc1xuamVzdC5tb2NrKCdkcml6emxlLW9ybScsICgpID0+ICh7XG4gIGVxOiBqZXN0LmZuKCgpID0+ICdtb2NrLWNvbmRpdGlvbicpLFxuICBhbmQ6IGplc3QuZm4oKCkgPT4gJ21vY2stY29uZGl0aW9uJyksXG4gIG9yOiBqZXN0LmZuKCgpID0+ICdtb2NrLWNvbmRpdGlvbicpLFxufSkpO1xuXG4vLyBNb2NrIGJjcnlwdFxuamVzdC5tb2NrKCdiY3J5cHRqcycsICgpID0+ICh7XG4gIGhhc2g6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCdtb2NrLWhhc2gnKSksXG4gIGNvbXBhcmU6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRydWUpKSxcbn0pKTtcblxuY29uc29sZS5sb2coJ+KchSBNaW5pbWFsIEplc3Qgc2V0dXAgY29tcGxldGVkJyk7Il0sInZlcnNpb24iOjN9
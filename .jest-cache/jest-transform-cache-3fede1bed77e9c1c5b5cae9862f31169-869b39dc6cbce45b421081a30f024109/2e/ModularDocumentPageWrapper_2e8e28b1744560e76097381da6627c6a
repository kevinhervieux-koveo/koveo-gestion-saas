0e0e6d83246e50ebf299c68c2d01b0c9
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = ModularDocumentPageWrapper;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const react_query_1 = require("@tanstack/react-query");
const wouter_1 = require("wouter");
const lucide_react_1 = require("lucide-react");
const button_1 = require("@/components/ui/button");
const input_1 = require("@/components/ui/input");
const card_1 = require("@/components/ui/card");
const badge_1 = require("@/components/ui/badge");
const select_1 = require("@/components/ui/select");
const dialog_1 = require("@/components/ui/dialog");
const label_1 = require("@/components/ui/label");
const collapsible_1 = require("@/components/ui/collapsible");
const header_1 = require("@/components/layout/header");
const queryClient_1 = require("@/lib/queryClient");
const use_language_1 = require("@/hooks/use-language");
const document_management_1 = require("@/components/document-management");
const DocumentCreateForm_1 = require("@/components/document-management/DocumentCreateForm");
const lucide_react_2 = require("lucide-react");
function DocumentViewDialog({ documentId, isOpen, onClose, onEdit, canEdit }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleDownload = async () => {
        console.log('[DOWNLOAD] Starting download for document:', documentId);
        try {
            // Use fetch with credentials to ensure authentication
            const response = await fetch(`/api/documents/${documentId}/file?download=true`, {
                method: 'GET',
                credentials: 'include', // Include authentication cookies
            });
            if (!response.ok) {
                throw new Error(`Download failed: ${response.status} ${response.statusText}`);
            }
            // Get the filename from Content-Disposition header or use document name
            const contentDisposition = response.headers.get('Content-Disposition');
            let fileName = document?.name || 'document';
            if (contentDisposition) {
                const fileNameMatch = contentDisposition.match(/filename="([^"]+)"/);
                if (fileNameMatch) {
                    fileName = fileNameMatch[1];
                }
            }
            // Convert response to blob and create download
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const link = window.document.createElement('a');
            link.href = url;
            link.download = fileName;
            window.document.body.appendChild(link);
            link.click();
            // Clean up
            window.document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            console.log('[DOWNLOAD] Download completed successfully');
        }
        catch (error) {
            console.error('[DOWNLOAD] Download failed:', error);
            alert(`Download failed: ${error.message || 'Unknown error'}`);
        }
    };
    const handleView = async () => {
        if (document?.filePath) {
            try {
                console.log('[VIEW] Starting view for document:', documentId);
                // Open a new tab immediately to avoid popup blocking
                const newTab = window.open('about:blank', '_blank');
                if (!newTab) {
                    throw new Error('Popup blocked - please allow popups for this site');
                }
                // Use fetch with credentials to ensure authentication
                const response = await fetch(`/api/documents/${documentId}/file`, {
                    method: 'GET',
                    credentials: 'include', // Include authentication cookies
                });
                if (!response.ok) {
                    newTab.close();
                    throw new Error(`View failed: ${response.status} ${response.statusText}`);
                }
                // Convert response to blob and set it as the new tab's location
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                // Set the blob URL to the opened tab
                newTab.location.href = url;
                // Clean up the URL after a delay to allow the tab to load
                setTimeout(() => {
                    window.URL.revokeObjectURL(url);
                }, 3000);
                console.log('[VIEW] View completed successfully');
            }
            catch (error) {
                console.error('[VIEW] View failed:', error);
                // Show error notification if available
                alert(`Failed to open document: ${error.message}`);
            }
        }
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-2xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Document Details" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-2 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Document Name" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.name })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600 capitalize", children: document.category || document.documentType || 'Other' })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Upload Date" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: new Date(document.createdAt).toLocaleDateString() })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Visible to Tenants" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.isVisibleToTenants ? 'Yes' : 'No' })] })] }), document.description && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Description" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.description })] })), document.filePath && ((0, jsx_runtime_1.jsx)("div", { className: "border rounded-lg p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.FileText, { className: "w-5 h-5 text-gray-500" }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium", children: document.fileName || document.name }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500", children: "Document attachment" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", onClick: handleView, className: "flex items-center gap-1", "data-testid": "button-view-document-file", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Eye, { className: "w-3 h-3" }), "View"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", onClick: handleDownload, className: "flex items-center gap-1", "data-testid": "button-download-document-file", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.Download, { className: "w-3 h-3" }), "Download"] })] })] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-end pt-4 border-t", children: [canEdit && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onEdit, children: "Edit Document" })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "default", onClick: onClose, children: "Close" })] })] })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
function DocumentEditDialog({ documentId, isOpen, onClose, onSuccess }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleSuccess = () => {
        onSuccess();
        onClose();
    };
    const handleDelete = () => {
        onSuccess(); // Refresh the document list
        onClose();
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-4xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Edit Document" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsx)("div", { className: "p-6", children: (0, jsx_runtime_1.jsx)(document_management_1.DocumentEditForm, { document: document, onSuccess: handleSuccess, onCancel: onClose, onDelete: handleDelete }) })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
// Document categories for filtering
const DOCUMENT_CATEGORIES = [
    { value: 'all', label: 'All Categories' },
    { value: 'bylaw', label: 'Bylaws' },
    { value: 'financial', label: 'Financial' },
    { value: 'maintenance', label: 'Maintenance' },
    { value: 'legal', label: 'Legal' },
    { value: 'meeting_minutes', label: 'Meeting Minutes' },
    { value: 'insurance', label: 'Insurance' },
    { value: 'contracts', label: 'Contracts' },
    { value: 'permits', label: 'Permits' },
    { value: 'inspection', label: 'Inspection' },
    { value: 'other', label: 'Other' },
];
function ModularDocumentPageWrapper({ type, userRole, backPath, backLabel, entityIdParam, }) {
    const [, navigate] = (0, wouter_1.useLocation)();
    const params = (0, wouter_1.useParams)();
    const { t } = (0, use_language_1.useLanguage)();
    // State for document interactions
    const [isCreateDialogOpen, setIsCreateDialogOpen] = (0, react_1.useState)(false);
    // State for filtering and search
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [selectedCategory, setSelectedCategory] = (0, react_1.useState)('all');
    const [viewMode, setViewMode] = (0, react_1.useState)('grid');
    // State for collapsible categories (start with all categories expanded)
    const [expandedCategories, setExpandedCategories] = (0, react_1.useState)(() => {
        // Initialize with all possible categories expanded
        return new Set(DOCUMENT_CATEGORIES.map(cat => cat.value).filter(val => val !== 'all'));
    });
    // Toggle category expansion
    const toggleCategory = (category) => {
        const newExpanded = new Set(expandedCategories);
        if (newExpanded.has(category)) {
            newExpanded.delete(category);
        }
        else {
            newExpanded.add(category);
        }
        setExpandedCategories(newExpanded);
    };
    // Get entityId from URL (both path param and query param)
    const urlParams = new URLSearchParams(window.location.search);
    const entityId = params[entityIdParam] || urlParams.get(entityIdParam);
    // Get current user
    const { data: user } = (0, react_query_1.useQuery)({
        queryKey: ['/api/auth/user'],
        queryFn: () => (0, queryClient_1.apiRequest)('GET', '/api/auth/user'),
    });
    // Get entity info based on type
    const entityApiPath = type === 'building' ? '/api/manager/buildings' : '/api/residences';
    const { data: entity, isError: entityError, error } = (0, react_query_1.useQuery)({
        queryKey: [entityApiPath, entityId],
        queryFn: async () => {
            if (type === 'residence') {
                const response = await fetch(`/api/residences/${entityId}`, {
                    credentials: 'include',
                });
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('ENTITY_NOT_FOUND');
                    }
                    throw new Error(`Failed to fetch ${type}`);
                }
                return response.json();
            }
            else {
                return (0, queryClient_1.apiRequest)('GET', `${entityApiPath}/${entityId}`);
            }
        },
        enabled: !!entityId,
        retry: false, // Don't retry on 404s
    });
    // Fetch documents for this entity
    const { data: documentResponse, isLoading, error: documentsError } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', type, entityId],
        queryFn: async () => {
            const param = type === 'building' ? 'buildingId' : 'residenceId';
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents?${param}=${entityId}`);
            return response.json();
        },
        enabled: !!entityId,
        staleTime: 0, // Always refetch
        cacheTime: 0, // Don't cache
    });
    // Extract documents array from API response
    const documents = Array.isArray(documentResponse?.documents) ? documentResponse.documents : [];
    // Determine permissions based on user role and type
    const isUserTenant = user?.role === 'tenant';
    const isManager = user?.role === 'manager' || user?.role === 'admin';
    const userPermissions = userRole === 'manager'
        ? {
            canView: true,
            canDownload: true,
            canEdit: isManager,
            canDelete: isManager,
            canCreate: isManager,
        }
        : {
            canView: true,
            canDownload: !isUserTenant,
            canEdit: !isUserTenant,
            canDelete: !isUserTenant,
            canCreate: !isUserTenant,
        };
    // Filter and search documents
    const filteredDocuments = Array.isArray(documents) ? documents.filter(doc => {
        const matchesSearch = doc.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            doc.description?.toLowerCase().includes(searchTerm.toLowerCase());
        const matchesCategory = selectedCategory === 'all' || doc.category === selectedCategory || doc.documentType === selectedCategory;
        return matchesSearch && matchesCategory;
    }) : [];
    // Group documents by category
    const groupedDocuments = filteredDocuments.reduce((groups, doc) => {
        const category = doc.category || doc.documentType || 'other';
        if (!groups[category]) {
            groups[category] = [];
        }
        groups[category].push(doc);
        return groups;
    }, {});
    // Get category display name
    const getCategoryDisplayName = (category) => {
        const categoryLabels = {
            bylaw: 'Bylaws',
            financial: 'Financial Documents',
            maintenance: 'Maintenance Records',
            legal: 'Legal Documents',
            meeting_minutes: 'Meeting Minutes',
            insurance: 'Insurance Documents',
            contracts: 'Contracts',
            permits: 'Permits',
            inspection: 'Inspection Reports',
            other: 'Other Documents',
        };
        return categoryLabels[category] || category.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
    };
    // Generate entity name based on type
    const entityName = type === 'residence'
        ? (entity?.unitNumber || entity?.unit_number ? `Unit ${entity.unitNumber || entity.unit_number}` : 'Residence')
        : entity?.name;
    const defaultBackLabel = backLabel || (type === 'building' ? 'Back to Buildings' : t('backToResidences'));
    // State for document view and edit dialogs
    const [selectedDocumentId, setSelectedDocumentId] = (0, react_1.useState)(null);
    const [isViewDialogOpen, setIsViewDialogOpen] = (0, react_1.useState)(false);
    const [isEditDialogOpen, setIsEditDialogOpen] = (0, react_1.useState)(false);
    // Handle document interactions
    const handleDocumentView = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsViewDialogOpen(true);
    };
    const handleDocumentEdit = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsEditDialogOpen(true);
    };
    const handleCreateDocument = () => {
        setIsCreateDialogOpen(true);
    };
    const handleDocumentSuccess = (documentId) => {
        console.log(`Document created:`, documentId);
        // Refresh documents list will be handled by the DocumentCreateForm's cache invalidation
    };
    const clearFilters = () => {
        setSearchTerm('');
        setSelectedCategory('all');
    };
    if (!entityId) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: [type, " ID is required"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] })] }) }) }));
    }
    // Handle entity not found (specific to residence pages that had this logic)
    if (entityError && error?.message === 'ENTITY_NOT_FOUND' && type === 'residence') {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center max-w-md", children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-semibold mb-4", children: "Residence Not Found" }), (0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: ["The residence ID \"", entityId, "\" doesn't exist in the development database."] }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-400 mb-6", children: "This might be a production database ID. Please use a valid development residence ID." }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "default", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", className: "w-full", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), backLabel || 'Back to Residences'] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: () => navigate('/residents/residences/e27ac924-8120-4904-a791-d1e9db544d58/documents'), "data-testid": "button-go-to-valid-residence", className: "w-full", children: "Go to Unit 101 (Test Residence)" })] })] }) }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "flex-1 flex flex-col overflow-hidden", children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: entityName, subtitle: type === 'building' ? 'Building Documents' : 'Residence Documents' }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto p-6", children: (0, jsx_runtime_1.jsxs)("div", { className: "max-w-7xl mx-auto space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] }), (0, jsx_runtime_1.jsx)("div", {})] }), (0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Filter, { className: "w-5 h-5" }), "Search & Filters"] }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Search" }), (0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4" }), (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: "Search documents...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "pl-10", "data-testid": "input-search-documents" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: selectedCategory, onValueChange: setSelectedCategory, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { "data-testid": "select-category-filter", children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: "All Categories" }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: DOCUMENT_CATEGORIES.map((category) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: category.value, children: category.label }, category.value))) })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "View & Actions" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex gap-1", children: [(0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'grid' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('grid'), "data-testid": "button-grid-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Grid, { className: "w-4 h-4" }) }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'list' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('list'), "data-testid": "button-list-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.List, { className: "w-4 h-4" }) })] }), userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, size: "sm", "data-testid": "button-create-document", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create"] })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", size: "sm", onClick: clearFilters, "data-testid": "button-clear-filters", children: "Clear" })] })] })] }) })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex justify-between items-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-muted-foreground", children: [filteredDocuments.length, " document", filteredDocuments.length !== 1 ? 's' : '', " found"] }), (searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", children: "Filtered" }))] }) }), isLoading ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading documents..." })] }) })) : filteredDocuments.length === 0 ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: "p-8 text-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-16 h-16 mx-auto mb-4 bg-muted rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "w-8 h-8 text-muted-foreground" }) }), (0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-semibold text-gray-600 mb-2", children: "No Documents Found" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500 mb-4", children: searchTerm || selectedCategory !== 'all'
                                                ? "No documents match your current filters. Try adjusting your search criteria."
                                                : `No documents have been uploaded for this ${type} yet. Create your first document to get started.` }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-center", children: [(searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: clearFilters, children: "Clear Filters" })), userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create Document"] }))] })] }) }) })) : ((0, jsx_runtime_1.jsx)("div", { className: "space-y-6", children: Object.entries(groupedDocuments).map(([category, categoryDocuments]) => {
                                const isExpanded = expandedCategories.has(category);
                                return ((0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: (0, jsx_runtime_1.jsxs)(collapsible_1.Collapsible, { open: isExpanded, onOpenChange: () => toggleCategory(category), children: [(0, jsx_runtime_1.jsxs)(collapsible_1.CollapsibleTrigger, { className: "flex items-center gap-2 p-2 w-full text-left hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors", children: [isExpanded ? ((0, jsx_runtime_1.jsx)(lucide_react_1.ChevronDown, { className: "h-4 w-4" })) : ((0, jsx_runtime_1.jsx)(lucide_react_1.ChevronRight, { className: "h-4 w-4" })), (0, jsx_runtime_1.jsx)("span", { className: "text-lg font-semibold", children: getCategoryDisplayName(category) }), (0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", className: "ml-2", children: categoryDocuments.length })] }), (0, jsx_runtime_1.jsx)(collapsible_1.CollapsibleContent, { className: "space-y-3", children: (0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: "pt-6", children: (0, jsx_runtime_1.jsx)("div", { className: `grid gap-4 ${viewMode === 'grid'
                                                                ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4'
                                                                : 'grid-cols-1'}`, children: categoryDocuments.map((document) => ((0, jsx_runtime_1.jsx)(document_management_1.DocumentCard, { documentId: document.id, title: document.name, documentType: document.category || document.documentType, createdAt: document.createdAt, onViewClick: handleDocumentView, compact: viewMode === 'list' }, document.id))) }) }) }) })] }) }, category));
                            }) })), (0, jsx_runtime_1.jsx)(DocumentCreateForm_1.DocumentCreateForm, { isOpen: isCreateDialogOpen, onClose: () => setIsCreateDialogOpen(false), onSuccess: handleDocumentSuccess, entityType: type, entityId: entityId, entityName: entityName }), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentViewDialog, { documentId: selectedDocumentId, isOpen: isViewDialogOpen, onClose: () => {
                                setIsViewDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onEdit: () => {
                                setIsViewDialogOpen(false);
                                setIsEditDialogOpen(true);
                            }, canEdit: userPermissions.canEdit })), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentEditDialog, { documentId: selectedDocumentId, isOpen: isEditDialogOpen, onClose: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onSuccess: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                                // Refresh documents list
                                queryClient_1.queryClient.invalidateQueries({
                                    queryKey: ['/api/documents', type, entityId],
                                });
                            } }))] }) })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL01vZHVsYXJEb2N1bWVudFBhZ2VXcmFwcGVyLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXFVQSw2Q0F1ZkM7O0FBNXpCRCwrQ0FBd0M7QUFDeEMsdURBQWlEO0FBQ2pELG1DQUFnRDtBQUNoRCwrQ0FBMkg7QUFDM0gsbURBQWdEO0FBQ2hELGlEQUE4QztBQUM5QywrQ0FBZ0Y7QUFDaEYsaURBQThDO0FBQzlDLG1EQUF1RztBQUN2RyxtREFBMEY7QUFDMUYsaURBQThDO0FBQzlDLDZEQUlxQztBQUNyQyx1REFBb0Q7QUFDcEQsbURBQTREO0FBQzVELHVEQUFtRDtBQUNuRCwwRUFJMEM7QUFDMUMsNEZBQXlGO0FBQ3pGLCtDQUFrRDtBQVlsRCxTQUFTLGtCQUFrQixDQUFDLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBMkI7SUFDbkcsTUFBTSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBQSxzQkFBUSxFQUFDO1FBQzdDLFFBQVEsRUFBRSxDQUFDLGdCQUFnQixFQUFFLFVBQVUsQ0FBQztRQUN4QyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLHdCQUFVLEVBQUMsS0FBSyxFQUFFLGtCQUFrQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3pFLE9BQU8sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3pCLENBQUM7UUFDRCxPQUFPLEVBQUUsTUFBTSxJQUFJLENBQUMsQ0FBQyxVQUFVO0tBQ2hDLENBQUMsQ0FBQztJQUVILE1BQU0sY0FBYyxHQUFHLEtBQUssSUFBSSxFQUFFO1FBQ2hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNENBQTRDLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDO1lBQ0gsc0RBQXNEO1lBQ3RELE1BQU0sUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLGtCQUFrQixVQUFVLHFCQUFxQixFQUFFO2dCQUM5RSxNQUFNLEVBQUUsS0FBSztnQkFDYixXQUFXLEVBQUUsU0FBUyxFQUFFLGlDQUFpQzthQUMxRCxDQUFDLENBQUM7WUFFSCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUNqQixNQUFNLElBQUksS0FBSyxDQUFDLG9CQUFvQixRQUFRLENBQUMsTUFBTSxJQUFJLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ2hGLENBQUM7WUFFRCx3RUFBd0U7WUFDeEUsTUFBTSxrQkFBa0IsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3ZFLElBQUksUUFBUSxHQUFHLFFBQVEsRUFBRSxJQUFJLElBQUksVUFBVSxDQUFDO1lBRTVDLElBQUksa0JBQWtCLEVBQUUsQ0FBQztnQkFDdkIsTUFBTSxhQUFhLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7Z0JBQ3JFLElBQUksYUFBYSxFQUFFLENBQUM7b0JBQ2xCLFFBQVEsR0FBRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzlCLENBQUM7WUFDSCxDQUFDO1lBRUQsK0NBQStDO1lBQy9DLE1BQU0sSUFBSSxHQUFHLE1BQU0sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ25DLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRTdDLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2hELElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO1lBQ2hCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1lBQ3pCLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFFYixXQUFXO1lBQ1gsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRWhDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNENBQTRDLENBQUMsQ0FBQztRQUM1RCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDcEQsS0FBSyxDQUFDLG9CQUFvQixLQUFLLENBQUMsT0FBTyxJQUFJLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFDaEUsQ0FBQztJQUNILENBQUMsQ0FBQztJQUVGLE1BQU0sVUFBVSxHQUFHLEtBQUssSUFBSSxFQUFFO1FBQzVCLElBQUksUUFBUSxFQUFFLFFBQVEsRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQztnQkFDSCxPQUFPLENBQUMsR0FBRyxDQUFDLG9DQUFvQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO2dCQUU5RCxxREFBcUQ7Z0JBQ3JELE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUNwRCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7b0JBQ1osTUFBTSxJQUFJLEtBQUssQ0FBQyxtREFBbUQsQ0FBQyxDQUFDO2dCQUN2RSxDQUFDO2dCQUVELHNEQUFzRDtnQkFDdEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxLQUFLLENBQUMsa0JBQWtCLFVBQVUsT0FBTyxFQUFFO29CQUNoRSxNQUFNLEVBQUUsS0FBSztvQkFDYixXQUFXLEVBQUUsU0FBUyxFQUFFLGlDQUFpQztpQkFDMUQsQ0FBQyxDQUFDO2dCQUVILElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLENBQUM7b0JBQ2pCLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDZixNQUFNLElBQUksS0FBSyxDQUFDLGdCQUFnQixRQUFRLENBQUMsTUFBTSxJQUFJLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO2dCQUM1RSxDQUFDO2dCQUVELGdFQUFnRTtnQkFDaEUsTUFBTSxJQUFJLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ25DLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUU3QyxxQ0FBcUM7Z0JBQ3JDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztnQkFFM0IsMERBQTBEO2dCQUMxRCxVQUFVLENBQUMsR0FBRyxFQUFFO29CQUNkLE1BQU0sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBRVQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO1lBRXBELENBQUM7WUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO2dCQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMscUJBQXFCLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQzVDLHVDQUF1QztnQkFDdkMsS0FBSyxDQUFDLDRCQUE0QixLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztZQUNyRCxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUMsQ0FBQztJQUVGLE9BQU8sQ0FDTCx1QkFBQyxlQUFNLElBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsT0FBTyxZQUN6Qyx3QkFBQyxzQkFBYSxJQUFDLFNBQVMsRUFBQyx3Q0FBd0MsYUFDL0QsdUJBQUMscUJBQVksY0FDWCx1QkFBQyxvQkFBVyxtQ0FBK0IsR0FDOUIsRUFFZCxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQ1gsaUNBQUssU0FBUyxFQUFDLGlCQUFpQixhQUM5QixnQ0FBSyxTQUFTLEVBQUMsNkZBQTZGLEdBQU8sRUFDbkgsOEJBQUcsU0FBUyxFQUFDLGVBQWUsb0NBQXdCLElBQ2hELENBQ1AsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUNiLGlDQUFLLFNBQVMsRUFBQyxXQUFXLGFBRXhCLGlDQUFLLFNBQVMsRUFBQyx3QkFBd0IsYUFDckMsNENBQ0UsdUJBQUMsYUFBSyxJQUFDLFNBQVMsRUFBQyxxQkFBcUIsOEJBQXNCLEVBQzVELDhCQUFHLFNBQVMsRUFBQyx1QkFBdUIsWUFBRSxRQUFRLENBQUMsSUFBSSxHQUFLLElBQ3BELEVBQ04sNENBQ0UsdUJBQUMsYUFBSyxJQUFDLFNBQVMsRUFBQyxxQkFBcUIseUJBQWlCLEVBQ3ZELDhCQUFHLFNBQVMsRUFBQyxrQ0FBa0MsWUFBRSxRQUFRLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxZQUFZLElBQUksT0FBTyxHQUFLLElBQ3ZHLEVBQ04sNENBQ0UsdUJBQUMsYUFBSyxJQUFDLFNBQVMsRUFBQyxxQkFBcUIsNEJBQW9CLEVBQzFELDhCQUFHLFNBQVMsRUFBQyx1QkFBdUIsWUFBRSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsa0JBQWtCLEVBQUUsR0FBSyxJQUN4RixFQUNOLDRDQUNFLHVCQUFDLGFBQUssSUFBQyxTQUFTLEVBQUMscUJBQXFCLG1DQUEyQixFQUNqRSw4QkFBRyxTQUFTLEVBQUMsdUJBQXVCLFlBQUUsUUFBUSxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBSyxJQUNqRixJQUNGLEVBR0wsUUFBUSxDQUFDLFdBQVcsSUFBSSxDQUN2Qiw0Q0FDRSx1QkFBQyxhQUFLLElBQUMsU0FBUyxFQUFDLHFCQUFxQiw0QkFBb0IsRUFDMUQsOEJBQUcsU0FBUyxFQUFDLHVCQUF1QixZQUFFLFFBQVEsQ0FBQyxXQUFXLEdBQUssSUFDM0QsQ0FDUCxFQUdBLFFBQVEsQ0FBQyxRQUFRLElBQUksQ0FDcEIsZ0NBQUssU0FBUyxFQUFDLHVCQUF1QixZQUNwQyxpQ0FBSyxTQUFTLEVBQUMsbUNBQW1DLGFBQ2hELGlDQUFLLFNBQVMsRUFBQyx5QkFBeUIsYUFDdEMsdUJBQUMsdUJBQVEsSUFBQyxTQUFTLEVBQUMsdUJBQXVCLEdBQUcsRUFDOUMsNENBQ0UsOEJBQUcsU0FBUyxFQUFDLHFCQUFxQixZQUFFLFFBQVEsQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLElBQUksR0FBSyxFQUMzRSw4QkFBRyxTQUFTLEVBQUMsdUJBQXVCLG9DQUF3QixJQUN4RCxJQUNGLEVBQ04saUNBQUssU0FBUyxFQUFDLFlBQVksYUFDekIsd0JBQUMsZUFBTSxJQUNMLE9BQU8sRUFBQyxTQUFTLEVBQ2pCLElBQUksRUFBQyxJQUFJLEVBQ1QsT0FBTyxFQUFFLFVBQVUsRUFDbkIsU0FBUyxFQUFDLHlCQUF5QixpQkFDdkIsMkJBQTJCLGFBRXZDLHVCQUFDLGtCQUFHLElBQUMsU0FBUyxFQUFDLFNBQVMsR0FBRyxZQUVwQixFQUNULHdCQUFDLGVBQU0sSUFDTCxPQUFPLEVBQUMsU0FBUyxFQUNqQixJQUFJLEVBQUMsSUFBSSxFQUNULE9BQU8sRUFBRSxjQUFjLEVBQ3ZCLFNBQVMsRUFBQyx5QkFBeUIsaUJBQ3ZCLCtCQUErQixhQUUzQyx1QkFBQyx1QkFBUSxJQUFDLFNBQVMsRUFBQyxTQUFTLEdBQUcsZ0JBRXpCLElBQ0wsSUFDRixHQUNGLENBQ1AsRUFHRCxpQ0FBSyxTQUFTLEVBQUMsc0NBQXNDLGFBQ2xELE9BQU8sSUFBSSxDQUNWLHVCQUFDLGVBQU0sSUFBQyxPQUFPLEVBQUMsU0FBUyxFQUFDLE9BQU8sRUFBRSxNQUFNLDhCQUVoQyxDQUNWLEVBQ0QsdUJBQUMsZUFBTSxJQUFDLE9BQU8sRUFBQyxTQUFTLEVBQUMsT0FBTyxFQUFFLE9BQU8sc0JBRWpDLElBQ0wsSUFDRixDQUNQLENBQUMsQ0FBQyxDQUFDLENBQ0YsaUNBQUssU0FBUyxFQUFDLGlCQUFpQixhQUM5Qiw4QkFBRyxTQUFTLEVBQUMsZUFBZSxtQ0FBdUIsRUFDbkQsdUJBQUMsZUFBTSxJQUFDLE9BQU8sRUFBQyxTQUFTLEVBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUMsTUFBTSxzQkFFbkQsSUFDTCxDQUNQLElBQ2EsR0FDVCxDQUNWLENBQUM7QUFDSixDQUFDO0FBVUQsU0FBUyxrQkFBa0IsQ0FBQyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBMkI7SUFDN0YsTUFBTSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBQSxzQkFBUSxFQUFDO1FBQzdDLFFBQVEsRUFBRSxDQUFDLGdCQUFnQixFQUFFLFVBQVUsQ0FBQztRQUN4QyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLHdCQUFVLEVBQUMsS0FBSyxFQUFFLGtCQUFrQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3pFLE9BQU8sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3pCLENBQUM7UUFDRCxPQUFPLEVBQUUsTUFBTSxJQUFJLENBQUMsQ0FBQyxVQUFVO0tBQ2hDLENBQUMsQ0FBQztJQUVILE1BQU0sYUFBYSxHQUFHLEdBQUcsRUFBRTtRQUN6QixTQUFTLEVBQUUsQ0FBQztRQUNaLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQyxDQUFDO0lBRUYsTUFBTSxZQUFZLEdBQUcsR0FBRyxFQUFFO1FBQ3hCLFNBQVMsRUFBRSxDQUFDLENBQUMsNEJBQTRCO1FBQ3pDLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQyxDQUFDO0lBRUYsT0FBTyxDQUNMLHVCQUFDLGVBQU0sSUFBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxPQUFPLFlBQ3pDLHdCQUFDLHNCQUFhLElBQUMsU0FBUyxFQUFDLHdDQUF3QyxhQUMvRCx1QkFBQyxxQkFBWSxjQUNYLHVCQUFDLG9CQUFXLGdDQUE0QixHQUMzQixFQUVkLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FDWCxpQ0FBSyxTQUFTLEVBQUMsaUJBQWlCLGFBQzlCLGdDQUFLLFNBQVMsRUFBQyw2RkFBNkYsR0FBTyxFQUNuSCw4QkFBRyxTQUFTLEVBQUMsZUFBZSxvQ0FBd0IsSUFDaEQsQ0FDUCxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQ2IsZ0NBQUssU0FBUyxFQUFDLEtBQUssWUFDbEIsdUJBQUMsc0NBQWdCLElBQ2YsUUFBUSxFQUFFLFFBQVEsRUFDbEIsU0FBUyxFQUFFLGFBQWEsRUFDeEIsUUFBUSxFQUFFLE9BQU8sRUFDakIsUUFBUSxFQUFFLFlBQVksR0FDdEIsR0FDRSxDQUNQLENBQUMsQ0FBQyxDQUFDLENBQ0YsaUNBQUssU0FBUyxFQUFDLGlCQUFpQixhQUM5Qiw4QkFBRyxTQUFTLEVBQUMsZUFBZSxtQ0FBdUIsRUFDbkQsdUJBQUMsZUFBTSxJQUFDLE9BQU8sRUFBQyxTQUFTLEVBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUMsTUFBTSxzQkFFbkQsSUFDTCxDQUNQLElBQ2EsR0FDVCxDQUNWLENBQUM7QUFDSixDQUFDO0FBRUQsb0NBQW9DO0FBQ3BDLE1BQU0sbUJBQW1CLEdBQUc7SUFDMUIsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsRUFBRTtJQUN6QyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRTtJQUNuQyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRTtJQUMxQyxFQUFFLEtBQUssRUFBRSxhQUFhLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRTtJQUM5QyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRTtJQUNsQyxFQUFFLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUU7SUFDdEQsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUU7SUFDdEMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7SUFDNUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUU7Q0FDMUIsQ0FBQztBQVVYLFNBQXdCLDBCQUEwQixDQUFDLEVBQ2pELElBQUksRUFDSixRQUFRLEVBQ1IsUUFBUSxFQUNSLFNBQVMsRUFDVCxhQUFhLEdBQ21CO0lBQ2hDLE1BQU0sQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUEsb0JBQVcsR0FBRSxDQUFDO0lBQ25DLE1BQU0sTUFBTSxHQUFHLElBQUEsa0JBQVMsR0FBRSxDQUFDO0lBQzNCLE1BQU0sRUFBRSxDQUFDLEVBQUUsR0FBRyxJQUFBLDBCQUFXLEdBQUUsQ0FBQztJQUU1QixrQ0FBa0M7SUFDbEMsTUFBTSxDQUFDLGtCQUFrQixFQUFFLHFCQUFxQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBRXBFLGlDQUFpQztJQUNqQyxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUNqRCxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsbUJBQW1CLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEUsTUFBTSxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWtCLE1BQU0sQ0FBQyxDQUFDO0lBRWxFLHdFQUF3RTtJQUN4RSxNQUFNLENBQUMsa0JBQWtCLEVBQUUscUJBQXFCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWMsR0FBRyxFQUFFO1FBQzdFLG1EQUFtRDtRQUNuRCxPQUFPLElBQUksR0FBRyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQztJQUN6RixDQUFDLENBQUMsQ0FBQztJQUVILDRCQUE0QjtJQUM1QixNQUFNLGNBQWMsR0FBRyxDQUFDLFFBQWdCLEVBQUUsRUFBRTtRQUMxQyxNQUFNLFdBQVcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2hELElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQzlCLFdBQVcsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0IsQ0FBQzthQUFNLENBQUM7WUFDTixXQUFXLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzVCLENBQUM7UUFDRCxxQkFBcUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUM7SUFFRiwwREFBMEQ7SUFDMUQsTUFBTSxTQUFTLEdBQUcsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM5RCxNQUFNLFFBQVEsR0FBSSxNQUFjLENBQUMsYUFBYSxDQUFDLElBQUksU0FBUyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUVoRixtQkFBbUI7SUFDbkIsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxJQUFBLHNCQUFRLEVBQUM7UUFDOUIsUUFBUSxFQUFFLENBQUMsZ0JBQWdCLENBQUM7UUFDNUIsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUEsd0JBQVUsRUFBQyxLQUFLLEVBQUUsZ0JBQWdCLENBQWlCO0tBQ25FLENBQUMsQ0FBQztJQUVILGdDQUFnQztJQUNoQyxNQUFNLGFBQWEsR0FBRyxJQUFJLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUM7SUFDekYsTUFBTSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsR0FBRyxJQUFBLHNCQUFRLEVBQUM7UUFDN0QsUUFBUSxFQUFFLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQztRQUNuQyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsSUFBSSxJQUFJLEtBQUssV0FBVyxFQUFFLENBQUM7Z0JBQ3pCLE1BQU0sUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLG1CQUFtQixRQUFRLEVBQUUsRUFBRTtvQkFDMUQsV0FBVyxFQUFFLFNBQVM7aUJBQ3ZCLENBQUMsQ0FBQztnQkFDSCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO29CQUNqQixJQUFJLFFBQVEsQ0FBQyxNQUFNLEtBQUssR0FBRyxFQUFFLENBQUM7d0JBQzVCLE1BQU0sSUFBSSxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQztvQkFDdEMsQ0FBQztvQkFDRCxNQUFNLElBQUksS0FBSyxDQUFDLG1CQUFtQixJQUFJLEVBQUUsQ0FBQyxDQUFDO2dCQUM3QyxDQUFDO2dCQUNELE9BQU8sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3pCLENBQUM7aUJBQU0sQ0FBQztnQkFDTixPQUFPLElBQUEsd0JBQVUsRUFBQyxLQUFLLEVBQUUsR0FBRyxhQUFhLElBQUksUUFBUSxFQUFFLENBQWlCLENBQUM7WUFDM0UsQ0FBQztRQUNILENBQUM7UUFDRCxPQUFPLEVBQUUsQ0FBQyxDQUFDLFFBQVE7UUFDbkIsS0FBSyxFQUFFLEtBQUssRUFBRSxzQkFBc0I7S0FDckMsQ0FBQyxDQUFDO0lBRUgsa0NBQWtDO0lBQ2xDLE1BQU0sRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsR0FBRyxJQUFBLHNCQUFRLEVBQUM7UUFDNUUsUUFBUSxFQUFFLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQztRQUM1QyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7WUFDakUsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLHdCQUFVLEVBQUMsS0FBSyxFQUFFLGtCQUFrQixLQUFLLElBQUksUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNoRixPQUFPLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN6QixDQUFDO1FBQ0QsT0FBTyxFQUFFLENBQUMsQ0FBQyxRQUFRO1FBQ25CLFNBQVMsRUFBRSxDQUFDLEVBQUUsaUJBQWlCO1FBQy9CLFNBQVMsRUFBRSxDQUFDLEVBQUUsY0FBYztLQUM3QixDQUFDLENBQUM7SUFFSCw0Q0FBNEM7SUFDNUMsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFFL0Ysb0RBQW9EO0lBQ3BELE1BQU0sWUFBWSxHQUFHLElBQUksRUFBRSxJQUFJLEtBQUssUUFBUSxDQUFDO0lBQzdDLE1BQU0sU0FBUyxHQUFHLElBQUksRUFBRSxJQUFJLEtBQUssU0FBUyxJQUFJLElBQUksRUFBRSxJQUFJLEtBQUssT0FBTyxDQUFDO0lBRXJFLE1BQU0sZUFBZSxHQUF3QixRQUFRLEtBQUssU0FBUztRQUNqRSxDQUFDLENBQUM7WUFDRSxPQUFPLEVBQUUsSUFBSTtZQUNiLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLE9BQU8sRUFBRSxTQUFTO1lBQ2xCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLFNBQVMsRUFBRSxTQUFTO1NBQ3JCO1FBQ0gsQ0FBQyxDQUFDO1lBQ0UsT0FBTyxFQUFFLElBQUk7WUFDYixXQUFXLEVBQUUsQ0FBQyxZQUFZO1lBQzFCLE9BQU8sRUFBRSxDQUFDLFlBQVk7WUFDdEIsU0FBUyxFQUFFLENBQUMsWUFBWTtZQUN4QixTQUFTLEVBQUUsQ0FBQyxZQUFZO1NBQ3pCLENBQUM7SUFFTiw4QkFBOEI7SUFDOUIsTUFBTSxpQkFBaUIsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQzFFLE1BQU0sYUFBYSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMxRCxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUV2RixNQUFNLGVBQWUsR0FBRyxnQkFBZ0IsS0FBSyxLQUFLLElBQUksR0FBRyxDQUFDLFFBQVEsS0FBSyxnQkFBZ0IsSUFBSSxHQUFHLENBQUMsWUFBWSxLQUFLLGdCQUFnQixDQUFDO1FBRWpJLE9BQU8sYUFBYSxJQUFJLGVBQWUsQ0FBQztJQUMxQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRVIsOEJBQThCO0lBQzlCLE1BQU0sZ0JBQWdCLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQ2hFLE1BQU0sUUFBUSxHQUFHLEdBQUcsQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLFlBQVksSUFBSSxPQUFPLENBQUM7UUFDN0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQ3RCLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDeEIsQ0FBQztRQUNELE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDM0IsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQyxFQUFFLEVBQThDLENBQUMsQ0FBQztJQUVuRCw0QkFBNEI7SUFDNUIsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLFFBQWdCLEVBQUUsRUFBRTtRQUNsRCxNQUFNLGNBQWMsR0FBMkI7WUFDN0MsS0FBSyxFQUFFLFFBQVE7WUFDZixTQUFTLEVBQUUscUJBQXFCO1lBQ2hDLFdBQVcsRUFBRSxxQkFBcUI7WUFDbEMsS0FBSyxFQUFFLGlCQUFpQjtZQUN4QixlQUFlLEVBQUUsaUJBQWlCO1lBQ2xDLFNBQVMsRUFBRSxxQkFBcUI7WUFDaEMsU0FBUyxFQUFFLFdBQVc7WUFDdEIsT0FBTyxFQUFFLFNBQVM7WUFDbEIsVUFBVSxFQUFFLG9CQUFvQjtZQUNoQyxLQUFLLEVBQUUsaUJBQWlCO1NBQ3pCLENBQUM7UUFDRixPQUFPLGNBQWMsQ0FBQyxRQUFRLENBQUMsSUFBSSxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7SUFDdkcsQ0FBQyxDQUFDO0lBR0YscUNBQXFDO0lBQ3JDLE1BQU0sVUFBVSxHQUFHLElBQUksS0FBSyxXQUFXO1FBQ3JDLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxVQUFVLElBQUksTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsUUFBUSxNQUFNLENBQUMsVUFBVSxJQUFJLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDO1FBQy9HLENBQUMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDO0lBRWpCLE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxJQUFJLENBQUMsSUFBSSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7SUFFMUcsMkNBQTJDO0lBQzNDLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRSxxQkFBcUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBZ0IsSUFBSSxDQUFDLENBQUM7SUFDbEYsTUFBTSxDQUFDLGdCQUFnQixFQUFFLG1CQUFtQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxtQkFBbUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUVoRSwrQkFBK0I7SUFDL0IsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLFVBQWtCLEVBQUUsRUFBRTtRQUNoRCxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM1QixDQUFDLENBQUM7SUFFRixNQUFNLGtCQUFrQixHQUFHLENBQUMsVUFBa0IsRUFBRSxFQUFFO1FBQ2hELHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2xDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUMsQ0FBQztJQUVGLE1BQU0sb0JBQW9CLEdBQUcsR0FBRyxFQUFFO1FBQ2hDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUMsQ0FBQztJQUVGLE1BQU0scUJBQXFCLEdBQUcsQ0FBQyxVQUFrQixFQUFFLEVBQUU7UUFDbkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUM3Qyx3RkFBd0Y7SUFDMUYsQ0FBQyxDQUFDO0lBRUYsTUFBTSxZQUFZLEdBQUcsR0FBRyxFQUFFO1FBQ3hCLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsQixtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3QixDQUFDLENBQUM7SUFFRixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDZCxPQUFPLENBQ0wsZ0NBQUssU0FBUyxFQUFDLHNDQUFzQyxZQUNuRCxnQ0FBSyxTQUFTLEVBQUMseUNBQXlDLFlBQ3RELGlDQUFLLFNBQVMsRUFBQyxhQUFhLGFBQzFCLCtCQUFHLFNBQVMsRUFBQyxvQkFBb0IsYUFBRSxJQUFJLHVCQUFvQixFQUMzRCx3QkFBQyxlQUFNLElBQ0wsT0FBTyxFQUFDLFNBQVMsRUFDakIsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsaUJBQ3JCLHFCQUFxQixhQUVqQyx1QkFBQyx3QkFBUyxJQUFDLFNBQVMsRUFBQyxjQUFjLEdBQUcsRUFDckMsZ0JBQWdCLElBQ1YsSUFDTCxHQUNGLEdBQ0YsQ0FDUCxDQUFDO0lBQ0osQ0FBQztJQUVELDRFQUE0RTtJQUM1RSxJQUFJLFdBQVcsSUFBSSxLQUFLLEVBQUUsT0FBTyxLQUFLLGtCQUFrQixJQUFJLElBQUksS0FBSyxXQUFXLEVBQUUsQ0FBQztRQUNqRixPQUFPLENBQ0wsZ0NBQUssU0FBUyxFQUFDLHNDQUFzQyxZQUNuRCxnQ0FBSyxTQUFTLEVBQUMseUNBQXlDLFlBQ3RELGlDQUFLLFNBQVMsRUFBQyxzQkFBc0IsYUFDbkMsK0JBQUksU0FBUyxFQUFDLDRCQUE0QixvQ0FBeUIsRUFDbkUsK0JBQUcsU0FBUyxFQUFDLG9CQUFvQixvQ0FDWixRQUFRLHFEQUN6QixFQUNKLDhCQUFHLFNBQVMsRUFBQyw0QkFBNEIscUdBRXJDLEVBQ0osaUNBQUssU0FBUyxFQUFDLFdBQVcsYUFDeEIsd0JBQUMsZUFBTSxJQUNMLE9BQU8sRUFBQyxTQUFTLEVBQ2pCLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLGlCQUNyQixxQkFBcUIsRUFDakMsU0FBUyxFQUFDLFFBQVEsYUFFbEIsdUJBQUMsd0JBQVMsSUFBQyxTQUFTLEVBQUMsY0FBYyxHQUFHLEVBQ3JDLFNBQVMsSUFBSSxvQkFBb0IsSUFDM0IsRUFDVCx1QkFBQyxlQUFNLElBQ0wsT0FBTyxFQUFDLFNBQVMsRUFDakIsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUNaLFFBQVEsQ0FBQyxzRUFBc0UsQ0FBQyxpQkFFdEUsOEJBQThCLEVBQzFDLFNBQVMsRUFBQyxRQUFRLGdEQUdYLElBQ0wsSUFDRixHQUNGLEdBQ0YsQ0FDUCxDQUFDO0lBQ0osQ0FBQztJQUVELE9BQU8sQ0FDTCxpQ0FBSyxTQUFTLEVBQUMsc0NBQXNDLGFBQ25ELHVCQUFDLGVBQU0sSUFDTCxLQUFLLEVBQUUsVUFBVSxFQUNqQixRQUFRLEVBQUUsSUFBSSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixHQUM1RSxFQUVGLGdDQUFLLFNBQVMsRUFBQywwQkFBMEIsWUFDdkMsaUNBQUssU0FBUyxFQUFDLDZCQUE2QixhQUUxQyxpQ0FBSyxTQUFTLEVBQUMsbUNBQW1DLGFBQ2hELHdCQUFDLGVBQU0sSUFDTCxPQUFPLEVBQUMsU0FBUyxFQUNqQixPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxpQkFDckIsYUFBYSxhQUV6Qix1QkFBQyx3QkFBUyxJQUFDLFNBQVMsRUFBQyxjQUFjLEdBQUcsRUFDckMsZ0JBQWdCLElBQ1YsRUFDVCxpQ0FBVyxJQUNQLEVBR04sd0JBQUMsV0FBSSxlQUNILHVCQUFDLGlCQUFVLGNBQ1Qsd0JBQUMsZ0JBQVMsSUFBQyxTQUFTLEVBQUMseUJBQXlCLGFBQzVDLHVCQUFDLHFCQUFNLElBQUMsU0FBUyxFQUFDLFNBQVMsR0FBRyx3QkFFcEIsR0FDRCxFQUNiLHVCQUFDLGtCQUFXLGNBQ1YsaUNBQUssU0FBUyxFQUFDLHVDQUF1QyxhQUVwRCxpQ0FBSyxTQUFTLEVBQUMsV0FBVyxhQUN4QixrQ0FBTyxTQUFTLEVBQUMscUJBQXFCLHVCQUFlLEVBQ3JELGlDQUFLLFNBQVMsRUFBQyxVQUFVLGFBQ3ZCLHVCQUFDLHFCQUFNLElBQUMsU0FBUyxFQUFDLGtGQUFrRixHQUFHLEVBQ3ZHLHVCQUFDLGFBQUssSUFDSixXQUFXLEVBQUMscUJBQXFCLEVBQ2pDLEtBQUssRUFBRSxVQUFVLEVBQ2pCLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQzlDLFNBQVMsRUFBQyxPQUFPLGlCQUNMLHdCQUF3QixHQUNwQyxJQUNFLElBQ0YsRUFHTixpQ0FBSyxTQUFTLEVBQUMsV0FBVyxhQUN4QixrQ0FBTyxTQUFTLEVBQUMscUJBQXFCLHlCQUFpQixFQUN2RCx3QkFBQyxlQUFNLElBQUMsS0FBSyxFQUFFLGdCQUFnQixFQUFFLGFBQWEsRUFBRSxtQkFBbUIsYUFDakUsdUJBQUMsc0JBQWEsbUJBQWEsd0JBQXdCLFlBQ2pELHVCQUFDLG9CQUFXLElBQUMsV0FBVyxFQUFDLGdCQUFnQixHQUFHLEdBQzlCLEVBQ2hCLHVCQUFDLHNCQUFhLGNBQ1gsbUJBQW1CLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUNyQyx1QkFBQyxtQkFBVSxJQUFzQixLQUFLLEVBQUUsUUFBUSxDQUFDLEtBQUssWUFDbkQsUUFBUSxDQUFDLEtBQUssSUFEQSxRQUFRLENBQUMsS0FBSyxDQUVsQixDQUNkLENBQUMsR0FDWSxJQUNULElBQ0wsRUFHTixpQ0FBSyxTQUFTLEVBQUMsV0FBVyxhQUN4QixrQ0FBTyxTQUFTLEVBQUMscUJBQXFCLCtCQUF1QixFQUM3RCxpQ0FBSyxTQUFTLEVBQUMsWUFBWSxhQUN6QixpQ0FBSyxTQUFTLEVBQUMsWUFBWSxhQUN6Qix1QkFBQyxlQUFNLElBQ0wsT0FBTyxFQUFFLFFBQVEsS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUNwRCxJQUFJLEVBQUMsSUFBSSxFQUNULE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLGlCQUN0QixrQkFBa0IsWUFFOUIsdUJBQUMsbUJBQUksSUFBQyxTQUFTLEVBQUMsU0FBUyxHQUFHLEdBQ3JCLEVBQ1QsdUJBQUMsZUFBTSxJQUNMLE9BQU8sRUFBRSxRQUFRLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFDcEQsSUFBSSxFQUFDLElBQUksRUFDVCxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxpQkFDdEIsa0JBQWtCLFlBRTlCLHVCQUFDLG1CQUFJLElBQUMsU0FBUyxFQUFDLFNBQVMsR0FBRyxHQUNyQixJQUNMLEVBQ0wsZUFBZSxDQUFDLFNBQVMsSUFBSSxDQUM1Qix3QkFBQyxlQUFNLElBQ0wsT0FBTyxFQUFFLG9CQUFvQixFQUM3QixJQUFJLEVBQUMsSUFBSSxpQkFDRyx3QkFBd0IsYUFFcEMsdUJBQUMsbUJBQUksSUFBQyxTQUFTLEVBQUMsY0FBYyxHQUFHLGNBRTFCLENBQ1YsRUFDRCx1QkFBQyxlQUFNLElBQ0wsT0FBTyxFQUFDLFNBQVMsRUFDakIsSUFBSSxFQUFDLElBQUksRUFDVCxPQUFPLEVBQUUsWUFBWSxpQkFDVCxzQkFBc0Isc0JBRzNCLElBQ0wsSUFDRixJQUNGLEdBQ00sSUFDVCxFQUdQLGdDQUFLLFNBQVMsRUFBQyxtQ0FBbUMsWUFDaEQsaUNBQUssU0FBUyxFQUFDLHlCQUF5QixhQUN0QyxrQ0FBTSxTQUFTLEVBQUMsK0JBQStCLGFBQzVDLGlCQUFpQixDQUFDLE1BQU0sZUFBVyxpQkFBaUIsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsY0FDeEUsRUFDTixDQUFDLFVBQVUsSUFBSSxnQkFBZ0IsS0FBSyxLQUFLLENBQUMsSUFBSSxDQUM3Qyx1QkFBQyxhQUFLLElBQUMsT0FBTyxFQUFDLFdBQVcseUJBQWlCLENBQzVDLElBQ0csR0FDRixFQUdMLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FDWCx1QkFBQyxXQUFJLGNBQ0gsd0JBQUMsa0JBQVcsSUFBQyxTQUFTLEVBQUMsaUJBQWlCLGFBQ3RDLGdDQUFLLFNBQVMsRUFBQyw2RkFBNkYsR0FBTyxFQUNuSCw4QkFBRyxTQUFTLEVBQUMsZUFBZSxxQ0FBeUIsSUFDekMsR0FDVCxDQUNSLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ25DLHVCQUFDLFdBQUksY0FDSCx1QkFBQyxrQkFBVyxJQUFDLFNBQVMsRUFBQyxpQkFBaUIsWUFDdEMsaUNBQUssU0FBUyxFQUFDLGFBQWEsYUFDMUIsZ0NBQUssU0FBUyxFQUFDLCtFQUErRSxZQUM1Rix1QkFBQyxxQkFBTSxJQUFDLFNBQVMsRUFBQywrQkFBK0IsR0FBRyxHQUNoRCxFQUNOLCtCQUFJLFNBQVMsRUFBQywwQ0FBMEMsbUNBQXdCLEVBQ2hGLDhCQUFHLFNBQVMsRUFBQyxvQkFBb0IsWUFDOUIsVUFBVSxJQUFJLGdCQUFnQixLQUFLLEtBQUs7Z0RBQ3ZDLENBQUMsQ0FBQyw4RUFBOEU7Z0RBQ2hGLENBQUMsQ0FBQyw0Q0FBNEMsSUFBSSxrREFBa0QsR0FFcEcsRUFDSixpQ0FBSyxTQUFTLEVBQUMsMkJBQTJCLGFBQ3ZDLENBQUMsVUFBVSxJQUFJLGdCQUFnQixLQUFLLEtBQUssQ0FBQyxJQUFJLENBQzdDLHVCQUFDLGVBQU0sSUFBQyxPQUFPLEVBQUMsU0FBUyxFQUFDLE9BQU8sRUFBRSxZQUFZLDhCQUV0QyxDQUNWLEVBQ0EsZUFBZSxDQUFDLFNBQVMsSUFBSSxDQUM1Qix3QkFBQyxlQUFNLElBQUMsT0FBTyxFQUFFLG9CQUFvQixhQUNuQyx1QkFBQyxtQkFBSSxJQUFDLFNBQVMsRUFBQyxjQUFjLEdBQUcsdUJBRTFCLENBQ1YsSUFDRyxJQUNGLEdBQ00sR0FDVCxDQUNSLENBQUMsQ0FBQyxDQUFDLENBQ0YsZ0NBQUssU0FBUyxFQUFDLFdBQVcsWUFDdkIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLGlCQUFpQixDQUFDLEVBQUUsRUFBRTtnQ0FDdEUsTUFBTSxVQUFVLEdBQUcsa0JBQWtCLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dDQUVwRCxPQUFPLENBQ0wsZ0NBQW9CLFNBQVMsRUFBQyxXQUFXLFlBQ3ZDLHdCQUFDLHlCQUFXLElBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxhQUN6RSx3QkFBQyxnQ0FBa0IsSUFBQyxTQUFTLEVBQUMsbUhBQW1ILGFBQzlJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FDWix1QkFBQywwQkFBVyxJQUFDLFNBQVMsRUFBQyxTQUFTLEdBQUcsQ0FDcEMsQ0FBQyxDQUFDLENBQUMsQ0FDRix1QkFBQywyQkFBWSxJQUFDLFNBQVMsRUFBQyxTQUFTLEdBQUcsQ0FDckMsRUFDRCxpQ0FBTSxTQUFTLEVBQUMsdUJBQXVCLFlBQ3BDLHNCQUFzQixDQUFDLFFBQVEsQ0FBQyxHQUM1QixFQUNQLHVCQUFDLGFBQUssSUFBQyxPQUFPLEVBQUMsV0FBVyxFQUFDLFNBQVMsRUFBQyxNQUFNLFlBQ3hDLGlCQUFpQixDQUFDLE1BQU0sR0FDbkIsSUFDVyxFQUVyQix1QkFBQyxnQ0FBa0IsSUFBQyxTQUFTLEVBQUMsV0FBVyxZQUN2Qyx1QkFBQyxXQUFJLGNBQ0gsdUJBQUMsa0JBQVcsSUFBQyxTQUFTLEVBQUMsTUFBTSxZQUMzQixnQ0FBSyxTQUFTLEVBQUUsY0FDZCxRQUFRLEtBQUssTUFBTTtnRUFDakIsQ0FBQyxDQUFDLDBEQUEwRDtnRUFDNUQsQ0FBQyxDQUFDLGFBQ04sRUFBRSxZQUNDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FDbkMsdUJBQUMsa0NBQVksSUFFWCxVQUFVLEVBQUUsUUFBUSxDQUFDLEVBQUUsRUFDdkIsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQ3BCLFlBQVksRUFBRSxRQUFRLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxZQUFZLEVBQ3hELFNBQVMsRUFBRSxRQUFRLENBQUMsU0FBUyxFQUM3QixXQUFXLEVBQUUsa0JBQWtCLEVBQy9CLE9BQU8sRUFBRSxRQUFRLEtBQUssTUFBTSxJQU52QixRQUFRLENBQUMsRUFBRSxDQU9oQixDQUNILENBQUMsR0FDRSxHQUNNLEdBQ1QsR0FDWSxJQUNULElBdkNOLFFBQVEsQ0F3Q1osQ0FDUCxDQUFDOzRCQUNKLENBQUMsQ0FBQyxHQUNFLENBQ1AsRUFHRCx1QkFBQyx1Q0FBa0IsSUFDakIsTUFBTSxFQUFFLGtCQUFrQixFQUMxQixPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMscUJBQXFCLENBQUMsS0FBSyxDQUFDLEVBQzNDLFNBQVMsRUFBRSxxQkFBcUIsRUFDaEMsVUFBVSxFQUFFLElBQUksRUFDaEIsUUFBUSxFQUFFLFFBQVEsRUFDbEIsVUFBVSxFQUFFLFVBQVUsR0FDdEIsRUFHRCxrQkFBa0IsSUFBSSxDQUNyQix1QkFBQyxrQkFBa0IsSUFDakIsVUFBVSxFQUFFLGtCQUFrQixFQUM5QixNQUFNLEVBQUUsZ0JBQWdCLEVBQ3hCLE9BQU8sRUFBRSxHQUFHLEVBQUU7Z0NBQ1osbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7Z0NBQzNCLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDOzRCQUM5QixDQUFDLEVBQ0QsTUFBTSxFQUFFLEdBQUcsRUFBRTtnQ0FDWCxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQ0FDM0IsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUM7NEJBQzVCLENBQUMsRUFDRCxPQUFPLEVBQUUsZUFBZSxDQUFDLE9BQU8sR0FDaEMsQ0FDSCxFQUdBLGtCQUFrQixJQUFJLENBQ3JCLHVCQUFDLGtCQUFrQixJQUNqQixVQUFVLEVBQUUsa0JBQWtCLEVBQzlCLE1BQU0sRUFBRSxnQkFBZ0IsRUFDeEIsT0FBTyxFQUFFLEdBQUcsRUFBRTtnQ0FDWixtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQ0FDM0IscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7NEJBQzlCLENBQUMsRUFDRCxTQUFTLEVBQUUsR0FBRyxFQUFFO2dDQUNkLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO2dDQUMzQixxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQ0FDNUIseUJBQXlCO2dDQUN6Qix5QkFBVyxDQUFDLGlCQUFpQixDQUFDO29DQUM1QixRQUFRLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDO2lDQUM3QyxDQUFDLENBQUM7NEJBQ0wsQ0FBQyxHQUNELENBQ0gsSUFDRyxHQUNGLElBQ0YsQ0FDUCxDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL2NsaWVudC9zcmMvY29tcG9uZW50cy9jb21tb24vTW9kdWxhckRvY3VtZW50UGFnZVdyYXBwZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVF1ZXJ5IH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IHVzZUxvY2F0aW9uLCB1c2VQYXJhbXMgfSBmcm9tICd3b3V0ZXInO1xuaW1wb3J0IHsgR3JpZCwgTGlzdCwgQXJyb3dMZWZ0LCBQbHVzLCBTZWFyY2gsIEZpbHRlciwgQnVpbGRpbmcsIEhvbWUsIENoZXZyb25Eb3duLCBDaGV2cm9uUmlnaHQsIEV5ZSB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYnV0dG9uJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2lucHV0JztcbmltcG9ydCB7IENhcmQsIENhcmRDb250ZW50LCBDYXJkSGVhZGVyLCBDYXJkVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvY2FyZCc7XG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9iYWRnZSc7XG5pbXBvcnQgeyBTZWxlY3QsIFNlbGVjdENvbnRlbnQsIFNlbGVjdEl0ZW0sIFNlbGVjdFRyaWdnZXIsIFNlbGVjdFZhbHVlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3NlbGVjdCc7XG5pbXBvcnQgeyBEaWFsb2csIERpYWxvZ0NvbnRlbnQsIERpYWxvZ0hlYWRlciwgRGlhbG9nVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvZGlhbG9nJztcbmltcG9ydCB7IExhYmVsIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2xhYmVsJztcbmltcG9ydCB7XG4gIENvbGxhcHNpYmxlLFxuICBDb2xsYXBzaWJsZUNvbnRlbnQsXG4gIENvbGxhcHNpYmxlVHJpZ2dlcixcbn0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NvbGxhcHNpYmxlJztcbmltcG9ydCB7IEhlYWRlciB9IGZyb20gJ0AvY29tcG9uZW50cy9sYXlvdXQvaGVhZGVyJztcbmltcG9ydCB7IGFwaVJlcXVlc3QsIHF1ZXJ5Q2xpZW50IH0gZnJvbSAnQC9saWIvcXVlcnlDbGllbnQnO1xuaW1wb3J0IHsgdXNlTGFuZ3VhZ2UgfSBmcm9tICdAL2hvb2tzL3VzZS1sYW5ndWFnZSc7XG5pbXBvcnQge1xuICBTaGFyZWRVcGxvYWRlcixcbiAgRG9jdW1lbnRDYXJkLFxuICBEb2N1bWVudEVkaXRGb3JtXG59IGZyb20gJ0AvY29tcG9uZW50cy9kb2N1bWVudC1tYW5hZ2VtZW50JztcbmltcG9ydCB7IERvY3VtZW50Q3JlYXRlRm9ybSB9IGZyb20gJ0AvY29tcG9uZW50cy9kb2N1bWVudC1tYW5hZ2VtZW50L0RvY3VtZW50Q3JlYXRlRm9ybSc7XG5pbXBvcnQgeyBGaWxlVGV4dCwgRG93bmxvYWQgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHR5cGUgeyBEb2N1bWVudFdpdGhNZXRhZGF0YSwgRG9jdW1lbnRQZXJtaXNzaW9ucyB9IGZyb20gJ0BzaGFyZWQvc2NoZW1hcy9kb2N1bWVudHMnO1xuXG4vLyBEb2N1bWVudCBWaWV3IERpYWxvZyBDb21wb25lbnRcbmludGVyZmFjZSBEb2N1bWVudFZpZXdEaWFsb2dQcm9wcyB7XG4gIGRvY3VtZW50SWQ6IHN0cmluZztcbiAgaXNPcGVuOiBib29sZWFuO1xuICBvbkNsb3NlOiAoKSA9PiB2b2lkO1xuICBvbkVkaXQ6ICgpID0+IHZvaWQ7XG4gIGNhbkVkaXQ6IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIERvY3VtZW50Vmlld0RpYWxvZyh7IGRvY3VtZW50SWQsIGlzT3Blbiwgb25DbG9zZSwgb25FZGl0LCBjYW5FZGl0IH06IERvY3VtZW50Vmlld0RpYWxvZ1Byb3BzKSB7XG4gIGNvbnN0IHsgZGF0YTogZG9jdW1lbnQsIGlzTG9hZGluZyB9ID0gdXNlUXVlcnkoe1xuICAgIHF1ZXJ5S2V5OiBbJy9hcGkvZG9jdW1lbnRzJywgZG9jdW1lbnRJZF0sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCdHRVQnLCBgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudElkfWApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICAgIGVuYWJsZWQ6IGlzT3BlbiAmJiAhIWRvY3VtZW50SWQsXG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRsZURvd25sb2FkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdbRE9XTkxPQURdIFN0YXJ0aW5nIGRvd25sb2FkIGZvciBkb2N1bWVudDonLCBkb2N1bWVudElkKTtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIGZldGNoIHdpdGggY3JlZGVudGlhbHMgdG8gZW5zdXJlIGF1dGhlbnRpY2F0aW9uXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2RvY3VtZW50cy8ke2RvY3VtZW50SWR9L2ZpbGU/ZG93bmxvYWQ9dHJ1ZWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJywgLy8gSW5jbHVkZSBhdXRoZW50aWNhdGlvbiBjb29raWVzXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYERvd25sb2FkIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHRoZSBmaWxlbmFtZSBmcm9tIENvbnRlbnQtRGlzcG9zaXRpb24gaGVhZGVyIG9yIHVzZSBkb2N1bWVudCBuYW1lXG4gICAgICBjb25zdCBjb250ZW50RGlzcG9zaXRpb24gPSByZXNwb25zZS5oZWFkZXJzLmdldCgnQ29udGVudC1EaXNwb3NpdGlvbicpO1xuICAgICAgbGV0IGZpbGVOYW1lID0gZG9jdW1lbnQ/Lm5hbWUgfHwgJ2RvY3VtZW50JztcbiAgICAgIFxuICAgICAgaWYgKGNvbnRlbnREaXNwb3NpdGlvbikge1xuICAgICAgICBjb25zdCBmaWxlTmFtZU1hdGNoID0gY29udGVudERpc3Bvc2l0aW9uLm1hdGNoKC9maWxlbmFtZT1cIihbXlwiXSspXCIvKTtcbiAgICAgICAgaWYgKGZpbGVOYW1lTWF0Y2gpIHtcbiAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lTWF0Y2hbMV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ29udmVydCByZXNwb25zZSB0byBibG9iIGFuZCBjcmVhdGUgZG93bmxvYWRcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgIFxuICAgICAgY29uc3QgbGluayA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSB1cmw7XG4gICAgICBsaW5rLmRvd25sb2FkID0gZmlsZU5hbWU7XG4gICAgICB3aW5kb3cuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgIFxuICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgIHdpbmRvdy5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xuICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1tET1dOTE9BRF0gRG93bmxvYWQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbRE9XTkxPQURdIERvd25sb2FkIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICBhbGVydChgRG93bmxvYWQgZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVWaWV3ID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChkb2N1bWVudD8uZmlsZVBhdGgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbVklFV10gU3RhcnRpbmcgdmlldyBmb3IgZG9jdW1lbnQ6JywgZG9jdW1lbnRJZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBPcGVuIGEgbmV3IHRhYiBpbW1lZGlhdGVseSB0byBhdm9pZCBwb3B1cCBibG9ja2luZ1xuICAgICAgICBjb25zdCBuZXdUYWIgPSB3aW5kb3cub3BlbignYWJvdXQ6YmxhbmsnLCAnX2JsYW5rJyk7XG4gICAgICAgIGlmICghbmV3VGFiKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQb3B1cCBibG9ja2VkIC0gcGxlYXNlIGFsbG93IHBvcHVwcyBmb3IgdGhpcyBzaXRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBmZXRjaCB3aXRoIGNyZWRlbnRpYWxzIHRvIGVuc3VyZSBhdXRoZW50aWNhdGlvblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2RvY3VtZW50cy8ke2RvY3VtZW50SWR9L2ZpbGVgLCB7XG4gICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLCAvLyBJbmNsdWRlIGF1dGhlbnRpY2F0aW9uIGNvb2tpZXNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIG5ld1RhYi5jbG9zZSgpO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVmlldyBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb252ZXJ0IHJlc3BvbnNlIHRvIGJsb2IgYW5kIHNldCBpdCBhcyB0aGUgbmV3IHRhYidzIGxvY2F0aW9uXG4gICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IHRoZSBibG9iIFVSTCB0byB0aGUgb3BlbmVkIHRhYlxuICAgICAgICBuZXdUYWIubG9jYXRpb24uaHJlZiA9IHVybDtcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFuIHVwIHRoZSBVUkwgYWZ0ZXIgYSBkZWxheSB0byBhbGxvdyB0aGUgdGFiIHRvIGxvYWRcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnW1ZJRVddIFZpZXcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICBcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tWSUVXXSBWaWV3IGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIC8vIFNob3cgZXJyb3Igbm90aWZpY2F0aW9uIGlmIGF2YWlsYWJsZVxuICAgICAgICBhbGVydChgRmFpbGVkIHRvIG9wZW4gZG9jdW1lbnQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8RGlhbG9nIG9wZW49e2lzT3Blbn0gb25PcGVuQ2hhbmdlPXtvbkNsb3NlfT5cbiAgICAgIDxEaWFsb2dDb250ZW50IGNsYXNzTmFtZT1cIm1heC13LTJ4bCBtYXgtaC1bOTV2aF0gb3ZlcmZsb3cteS1hdXRvXCI+XG4gICAgICAgIDxEaWFsb2dIZWFkZXI+XG4gICAgICAgICAgPERpYWxvZ1RpdGxlPkRvY3VtZW50IERldGFpbHM8L0RpYWxvZ1RpdGxlPlxuICAgICAgICA8L0RpYWxvZ0hlYWRlcj5cbiAgICAgICAgXG4gICAgICAgIHtpc0xvYWRpbmcgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTggdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1zcGluIHctOCBoLTggYm9yZGVyLTQgYm9yZGVyLXByaW1hcnkgYm9yZGVyLXQtdHJhbnNwYXJlbnQgcm91bmRlZC1mdWxsIG14LWF1dG8gbWItNFwiPjwvZGl2PlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMFwiPkxvYWRpbmcgZG9jdW1lbnQuLi48L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiBkb2N1bWVudCA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNlwiPlxuICAgICAgICAgICAgey8qIERvY3VtZW50IEluZm9ybWF0aW9uICovfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0yIGdhcC00XCI+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5Eb2N1bWVudCBOYW1lPC9MYWJlbD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57ZG9jdW1lbnQubmFtZX08L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+Q2F0ZWdvcnk8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTYwMCBjYXBpdGFsaXplXCI+e2RvY3VtZW50LmNhdGVnb3J5IHx8IGRvY3VtZW50LmRvY3VtZW50VHlwZSB8fCAnT3RoZXInfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5VcGxvYWQgRGF0ZTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e25ldyBEYXRlKGRvY3VtZW50LmNyZWF0ZWRBdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlZpc2libGUgdG8gVGVuYW50czwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e2RvY3VtZW50LmlzVmlzaWJsZVRvVGVuYW50cyA/ICdZZXMnIDogJ05vJ308L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHsvKiBEZXNjcmlwdGlvbiAqL31cbiAgICAgICAgICAgIHtkb2N1bWVudC5kZXNjcmlwdGlvbiAmJiAoXG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5EZXNjcmlwdGlvbjwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e2RvY3VtZW50LmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7LyogRG9jdW1lbnQgQWN0aW9ucyAqL31cbiAgICAgICAgICAgIHtkb2N1bWVudC5maWxlUGF0aCAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYm9yZGVyIHJvdW5kZWQtbGcgcC00XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTNcIj5cbiAgICAgICAgICAgICAgICAgICAgPEZpbGVUZXh0IGNsYXNzTmFtZT1cInctNSBoLTUgdGV4dC1ncmF5LTUwMFwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPntkb2N1bWVudC5maWxlTmFtZSB8fCBkb2N1bWVudC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JheS01MDBcIj5Eb2N1bWVudCBhdHRhY2htZW50PC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0xXCJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi12aWV3LWRvY3VtZW50LWZpbGVcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPEV5ZSBjbGFzc05hbWU9XCJ3LTMgaC0zXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICBWaWV3XG4gICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVcIlxuICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlRG93bmxvYWR9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTFcIlxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWRvd25sb2FkLWRvY3VtZW50LWZpbGVcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPERvd25sb2FkIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgIERvd25sb2FkXG4gICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgey8qIEFjdGlvbiBCdXR0b25zICovfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0yIGp1c3RpZnktZW5kIHB0LTQgYm9yZGVyLXRcIj5cbiAgICAgICAgICAgICAge2NhbkVkaXQgJiYgKFxuICAgICAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cIm91dGxpbmVcIiBvbkNsaWNrPXtvbkVkaXR9PlxuICAgICAgICAgICAgICAgICAgRWRpdCBEb2N1bWVudFxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJkZWZhdWx0XCIgb25DbGljaz17b25DbG9zZX0+XG4gICAgICAgICAgICAgICAgQ2xvc2VcbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMFwiPkRvY3VtZW50IG5vdCBmb3VuZDwvcD5cbiAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cIm91dGxpbmVcIiBvbkNsaWNrPXtvbkNsb3NlfSBjbGFzc05hbWU9XCJtdC00XCI+XG4gICAgICAgICAgICAgIENsb3NlXG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgIDwvRGlhbG9nQ29udGVudD5cbiAgICA8L0RpYWxvZz5cbiAgKTtcbn1cblxuLy8gRG9jdW1lbnQgRWRpdCBEaWFsb2cgQ29tcG9uZW50ICBcbmludGVyZmFjZSBEb2N1bWVudEVkaXREaWFsb2dQcm9wcyB7XG4gIGRvY3VtZW50SWQ6IHN0cmluZztcbiAgaXNPcGVuOiBib29sZWFuO1xuICBvbkNsb3NlOiAoKSA9PiB2b2lkO1xuICBvblN1Y2Nlc3M6ICgpID0+IHZvaWQ7XG59XG5cbmZ1bmN0aW9uIERvY3VtZW50RWRpdERpYWxvZyh7IGRvY3VtZW50SWQsIGlzT3Blbiwgb25DbG9zZSwgb25TdWNjZXNzIH06IERvY3VtZW50RWRpdERpYWxvZ1Byb3BzKSB7XG4gIGNvbnN0IHsgZGF0YTogZG9jdW1lbnQsIGlzTG9hZGluZyB9ID0gdXNlUXVlcnkoe1xuICAgIHF1ZXJ5S2V5OiBbJy9hcGkvZG9jdW1lbnRzJywgZG9jdW1lbnRJZF0sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCdHRVQnLCBgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudElkfWApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICAgIGVuYWJsZWQ6IGlzT3BlbiAmJiAhIWRvY3VtZW50SWQsXG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRsZVN1Y2Nlc3MgPSAoKSA9PiB7XG4gICAgb25TdWNjZXNzKCk7XG4gICAgb25DbG9zZSgpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURlbGV0ZSA9ICgpID0+IHtcbiAgICBvblN1Y2Nlc3MoKTsgLy8gUmVmcmVzaCB0aGUgZG9jdW1lbnQgbGlzdFxuICAgIG9uQ2xvc2UoKTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxEaWFsb2cgb3Blbj17aXNPcGVufSBvbk9wZW5DaGFuZ2U9e29uQ2xvc2V9PlxuICAgICAgPERpYWxvZ0NvbnRlbnQgY2xhc3NOYW1lPVwibWF4LXctNHhsIG1heC1oLVs5NXZoXSBvdmVyZmxvdy15LWF1dG9cIj5cbiAgICAgICAgPERpYWxvZ0hlYWRlcj5cbiAgICAgICAgICA8RGlhbG9nVGl0bGU+RWRpdCBEb2N1bWVudDwvRGlhbG9nVGl0bGU+XG4gICAgICAgIDwvRGlhbG9nSGVhZGVyPlxuICAgICAgICBcbiAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+TG9hZGluZyBkb2N1bWVudC4uLjwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGRvY3VtZW50ID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC02XCI+XG4gICAgICAgICAgICA8RG9jdW1lbnRFZGl0Rm9ybVxuICAgICAgICAgICAgICBkb2N1bWVudD17ZG9jdW1lbnR9XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17aGFuZGxlU3VjY2Vzc31cbiAgICAgICAgICAgICAgb25DYW5jZWw9e29uQ2xvc2V9XG4gICAgICAgICAgICAgIG9uRGVsZXRlPXtoYW5kbGVEZWxldGV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+RG9jdW1lbnQgbm90IGZvdW5kPC9wPlxuICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwib3V0bGluZVwiIG9uQ2xpY2s9e29uQ2xvc2V9IGNsYXNzTmFtZT1cIm10LTRcIj5cbiAgICAgICAgICAgICAgQ2xvc2VcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgIDwvRGlhbG9nPlxuICApO1xufVxuXG4vLyBEb2N1bWVudCBjYXRlZ29yaWVzIGZvciBmaWx0ZXJpbmdcbmNvbnN0IERPQ1VNRU5UX0NBVEVHT1JJRVMgPSBbXG4gIHsgdmFsdWU6ICdhbGwnLCBsYWJlbDogJ0FsbCBDYXRlZ29yaWVzJyB9LFxuICB7IHZhbHVlOiAnYnlsYXcnLCBsYWJlbDogJ0J5bGF3cycgfSxcbiAgeyB2YWx1ZTogJ2ZpbmFuY2lhbCcsIGxhYmVsOiAnRmluYW5jaWFsJyB9LFxuICB7IHZhbHVlOiAnbWFpbnRlbmFuY2UnLCBsYWJlbDogJ01haW50ZW5hbmNlJyB9LFxuICB7IHZhbHVlOiAnbGVnYWwnLCBsYWJlbDogJ0xlZ2FsJyB9LFxuICB7IHZhbHVlOiAnbWVldGluZ19taW51dGVzJywgbGFiZWw6ICdNZWV0aW5nIE1pbnV0ZXMnIH0sXG4gIHsgdmFsdWU6ICdpbnN1cmFuY2UnLCBsYWJlbDogJ0luc3VyYW5jZScgfSxcbiAgeyB2YWx1ZTogJ2NvbnRyYWN0cycsIGxhYmVsOiAnQ29udHJhY3RzJyB9LFxuICB7IHZhbHVlOiAncGVybWl0cycsIGxhYmVsOiAnUGVybWl0cycgfSxcbiAgeyB2YWx1ZTogJ2luc3BlY3Rpb24nLCBsYWJlbDogJ0luc3BlY3Rpb24nIH0sXG4gIHsgdmFsdWU6ICdvdGhlcicsIGxhYmVsOiAnT3RoZXInIH0sXG5dIGFzIGNvbnN0O1xuXG5pbnRlcmZhY2UgTW9kdWxhckRvY3VtZW50UGFnZVdyYXBwZXJQcm9wcyB7XG4gIHR5cGU6ICdidWlsZGluZycgfCAncmVzaWRlbmNlJztcbiAgdXNlclJvbGU6ICdtYW5hZ2VyJyB8ICdyZXNpZGVudCc7XG4gIGJhY2tQYXRoOiBzdHJpbmc7XG4gIGJhY2tMYWJlbD86IHN0cmluZztcbiAgZW50aXR5SWRQYXJhbTogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNb2R1bGFyRG9jdW1lbnRQYWdlV3JhcHBlcih7XG4gIHR5cGUsXG4gIHVzZXJSb2xlLFxuICBiYWNrUGF0aCxcbiAgYmFja0xhYmVsLFxuICBlbnRpdHlJZFBhcmFtLFxufTogTW9kdWxhckRvY3VtZW50UGFnZVdyYXBwZXJQcm9wcykge1xuICBjb25zdCBbLCBuYXZpZ2F0ZV0gPSB1c2VMb2NhdGlvbigpO1xuICBjb25zdCBwYXJhbXMgPSB1c2VQYXJhbXMoKTtcbiAgY29uc3QgeyB0IH0gPSB1c2VMYW5ndWFnZSgpO1xuXG4gIC8vIFN0YXRlIGZvciBkb2N1bWVudCBpbnRlcmFjdGlvbnNcbiAgY29uc3QgW2lzQ3JlYXRlRGlhbG9nT3Blbiwgc2V0SXNDcmVhdGVEaWFsb2dPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgXG4gIC8vIFN0YXRlIGZvciBmaWx0ZXJpbmcgYW5kIHNlYXJjaFxuICBjb25zdCBbc2VhcmNoVGVybSwgc2V0U2VhcmNoVGVybV0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtzZWxlY3RlZENhdGVnb3J5LCBzZXRTZWxlY3RlZENhdGVnb3J5XSA9IHVzZVN0YXRlKCdhbGwnKTtcbiAgY29uc3QgW3ZpZXdNb2RlLCBzZXRWaWV3TW9kZV0gPSB1c2VTdGF0ZTwnZ3JpZCcgfCAnbGlzdCc+KCdncmlkJyk7XG4gIFxuICAvLyBTdGF0ZSBmb3IgY29sbGFwc2libGUgY2F0ZWdvcmllcyAoc3RhcnQgd2l0aCBhbGwgY2F0ZWdvcmllcyBleHBhbmRlZClcbiAgY29uc3QgW2V4cGFuZGVkQ2F0ZWdvcmllcywgc2V0RXhwYW5kZWRDYXRlZ29yaWVzXSA9IHVzZVN0YXRlPFNldDxzdHJpbmc+PigoKSA9PiB7XG4gICAgLy8gSW5pdGlhbGl6ZSB3aXRoIGFsbCBwb3NzaWJsZSBjYXRlZ29yaWVzIGV4cGFuZGVkXG4gICAgcmV0dXJuIG5ldyBTZXQoRE9DVU1FTlRfQ0FURUdPUklFUy5tYXAoY2F0ID0+IGNhdC52YWx1ZSkuZmlsdGVyKHZhbCA9PiB2YWwgIT09ICdhbGwnKSk7XG4gIH0pO1xuXG4gIC8vIFRvZ2dsZSBjYXRlZ29yeSBleHBhbnNpb25cbiAgY29uc3QgdG9nZ2xlQ2F0ZWdvcnkgPSAoY2F0ZWdvcnk6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IG5ld0V4cGFuZGVkID0gbmV3IFNldChleHBhbmRlZENhdGVnb3JpZXMpO1xuICAgIGlmIChuZXdFeHBhbmRlZC5oYXMoY2F0ZWdvcnkpKSB7XG4gICAgICBuZXdFeHBhbmRlZC5kZWxldGUoY2F0ZWdvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdFeHBhbmRlZC5hZGQoY2F0ZWdvcnkpO1xuICAgIH1cbiAgICBzZXRFeHBhbmRlZENhdGVnb3JpZXMobmV3RXhwYW5kZWQpO1xuICB9O1xuXG4gIC8vIEdldCBlbnRpdHlJZCBmcm9tIFVSTCAoYm90aCBwYXRoIHBhcmFtIGFuZCBxdWVyeSBwYXJhbSlcbiAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgY29uc3QgZW50aXR5SWQgPSAocGFyYW1zIGFzIGFueSlbZW50aXR5SWRQYXJhbV0gfHwgdXJsUGFyYW1zLmdldChlbnRpdHlJZFBhcmFtKTtcblxuICAvLyBHZXQgY3VycmVudCB1c2VyXG4gIGNvbnN0IHsgZGF0YTogdXNlciB9ID0gdXNlUXVlcnkoe1xuICAgIHF1ZXJ5S2V5OiBbJy9hcGkvYXV0aC91c2VyJ10sXG4gICAgcXVlcnlGbjogKCkgPT4gYXBpUmVxdWVzdCgnR0VUJywgJy9hcGkvYXV0aC91c2VyJykgYXMgUHJvbWlzZTxhbnk+LFxuICB9KTtcblxuICAvLyBHZXQgZW50aXR5IGluZm8gYmFzZWQgb24gdHlwZVxuICBjb25zdCBlbnRpdHlBcGlQYXRoID0gdHlwZSA9PT0gJ2J1aWxkaW5nJyA/ICcvYXBpL21hbmFnZXIvYnVpbGRpbmdzJyA6ICcvYXBpL3Jlc2lkZW5jZXMnO1xuICBjb25zdCB7IGRhdGE6IGVudGl0eSwgaXNFcnJvcjogZW50aXR5RXJyb3IsIGVycm9yIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFtlbnRpdHlBcGlQYXRoLCBlbnRpdHlJZF0sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHR5cGUgPT09ICdyZXNpZGVuY2UnKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvcmVzaWRlbmNlcy8ke2VudGl0eUlkfWAsIHtcbiAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFTlRJVFlfTk9UX0ZPVU5EJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoICR7dHlwZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlcXVlc3QoJ0dFVCcsIGAke2VudGl0eUFwaVBhdGh9LyR7ZW50aXR5SWR9YCkgYXMgUHJvbWlzZTxhbnk+O1xuICAgICAgfVxuICAgIH0sXG4gICAgZW5hYmxlZDogISFlbnRpdHlJZCxcbiAgICByZXRyeTogZmFsc2UsIC8vIERvbid0IHJldHJ5IG9uIDQwNHNcbiAgfSk7XG5cbiAgLy8gRmV0Y2ggZG9jdW1lbnRzIGZvciB0aGlzIGVudGl0eVxuICBjb25zdCB7IGRhdGE6IGRvY3VtZW50UmVzcG9uc2UsIGlzTG9hZGluZywgZXJyb3I6IGRvY3VtZW50c0Vycm9yIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9kb2N1bWVudHMnLCB0eXBlLCBlbnRpdHlJZF0sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW0gPSB0eXBlID09PSAnYnVpbGRpbmcnID8gJ2J1aWxkaW5nSWQnIDogJ3Jlc2lkZW5jZUlkJztcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUmVxdWVzdCgnR0VUJywgYC9hcGkvZG9jdW1lbnRzPyR7cGFyYW19PSR7ZW50aXR5SWR9YCk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgIH0sXG4gICAgZW5hYmxlZDogISFlbnRpdHlJZCxcbiAgICBzdGFsZVRpbWU6IDAsIC8vIEFsd2F5cyByZWZldGNoXG4gICAgY2FjaGVUaW1lOiAwLCAvLyBEb24ndCBjYWNoZVxuICB9KTtcblxuICAvLyBFeHRyYWN0IGRvY3VtZW50cyBhcnJheSBmcm9tIEFQSSByZXNwb25zZVxuICBjb25zdCBkb2N1bWVudHMgPSBBcnJheS5pc0FycmF5KGRvY3VtZW50UmVzcG9uc2U/LmRvY3VtZW50cykgPyBkb2N1bWVudFJlc3BvbnNlLmRvY3VtZW50cyA6IFtdO1xuXG4gIC8vIERldGVybWluZSBwZXJtaXNzaW9ucyBiYXNlZCBvbiB1c2VyIHJvbGUgYW5kIHR5cGVcbiAgY29uc3QgaXNVc2VyVGVuYW50ID0gdXNlcj8ucm9sZSA9PT0gJ3RlbmFudCc7XG4gIGNvbnN0IGlzTWFuYWdlciA9IHVzZXI/LnJvbGUgPT09ICdtYW5hZ2VyJyB8fCB1c2VyPy5yb2xlID09PSAnYWRtaW4nO1xuICBcbiAgY29uc3QgdXNlclBlcm1pc3Npb25zOiBEb2N1bWVudFBlcm1pc3Npb25zID0gdXNlclJvbGUgPT09ICdtYW5hZ2VyJyBcbiAgICA/IHtcbiAgICAgICAgY2FuVmlldzogdHJ1ZSxcbiAgICAgICAgY2FuRG93bmxvYWQ6IHRydWUsXG4gICAgICAgIGNhbkVkaXQ6IGlzTWFuYWdlcixcbiAgICAgICAgY2FuRGVsZXRlOiBpc01hbmFnZXIsXG4gICAgICAgIGNhbkNyZWF0ZTogaXNNYW5hZ2VyLFxuICAgICAgfVxuICAgIDoge1xuICAgICAgICBjYW5WaWV3OiB0cnVlLFxuICAgICAgICBjYW5Eb3dubG9hZDogIWlzVXNlclRlbmFudCxcbiAgICAgICAgY2FuRWRpdDogIWlzVXNlclRlbmFudCxcbiAgICAgICAgY2FuRGVsZXRlOiAhaXNVc2VyVGVuYW50LFxuICAgICAgICBjYW5DcmVhdGU6ICFpc1VzZXJUZW5hbnQsXG4gICAgICB9O1xuXG4gIC8vIEZpbHRlciBhbmQgc2VhcmNoIGRvY3VtZW50c1xuICBjb25zdCBmaWx0ZXJlZERvY3VtZW50cyA9IEFycmF5LmlzQXJyYXkoZG9jdW1lbnRzKSA/IGRvY3VtZW50cy5maWx0ZXIoZG9jID0+IHtcbiAgICBjb25zdCBtYXRjaGVzU2VhcmNoID0gZG9jLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgZG9jLmRlc2NyaXB0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSk7XG4gICAgXG4gICAgY29uc3QgbWF0Y2hlc0NhdGVnb3J5ID0gc2VsZWN0ZWRDYXRlZ29yeSA9PT0gJ2FsbCcgfHwgZG9jLmNhdGVnb3J5ID09PSBzZWxlY3RlZENhdGVnb3J5IHx8IGRvYy5kb2N1bWVudFR5cGUgPT09IHNlbGVjdGVkQ2F0ZWdvcnk7XG5cbiAgICByZXR1cm4gbWF0Y2hlc1NlYXJjaCAmJiBtYXRjaGVzQ2F0ZWdvcnk7XG4gIH0pIDogW107XG5cbiAgLy8gR3JvdXAgZG9jdW1lbnRzIGJ5IGNhdGVnb3J5XG4gIGNvbnN0IGdyb3VwZWREb2N1bWVudHMgPSBmaWx0ZXJlZERvY3VtZW50cy5yZWR1Y2UoKGdyb3VwcywgZG9jKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnkgPSBkb2MuY2F0ZWdvcnkgfHwgZG9jLmRvY3VtZW50VHlwZSB8fCAnb3RoZXInO1xuICAgIGlmICghZ3JvdXBzW2NhdGVnb3J5XSkge1xuICAgICAgZ3JvdXBzW2NhdGVnb3J5XSA9IFtdO1xuICAgIH1cbiAgICBncm91cHNbY2F0ZWdvcnldLnB1c2goZG9jKTtcbiAgICByZXR1cm4gZ3JvdXBzO1xuICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCB0eXBlb2YgZmlsdGVyZWREb2N1bWVudHM+KTtcblxuICAvLyBHZXQgY2F0ZWdvcnkgZGlzcGxheSBuYW1lXG4gIGNvbnN0IGdldENhdGVnb3J5RGlzcGxheU5hbWUgPSAoY2F0ZWdvcnk6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNhdGVnb3J5TGFiZWxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgYnlsYXc6ICdCeWxhd3MnLFxuICAgICAgZmluYW5jaWFsOiAnRmluYW5jaWFsIERvY3VtZW50cycsXG4gICAgICBtYWludGVuYW5jZTogJ01haW50ZW5hbmNlIFJlY29yZHMnLFxuICAgICAgbGVnYWw6ICdMZWdhbCBEb2N1bWVudHMnLFxuICAgICAgbWVldGluZ19taW51dGVzOiAnTWVldGluZyBNaW51dGVzJyxcbiAgICAgIGluc3VyYW5jZTogJ0luc3VyYW5jZSBEb2N1bWVudHMnLFxuICAgICAgY29udHJhY3RzOiAnQ29udHJhY3RzJyxcbiAgICAgIHBlcm1pdHM6ICdQZXJtaXRzJyxcbiAgICAgIGluc3BlY3Rpb246ICdJbnNwZWN0aW9uIFJlcG9ydHMnLFxuICAgICAgb3RoZXI6ICdPdGhlciBEb2N1bWVudHMnLFxuICAgIH07XG4gICAgcmV0dXJuIGNhdGVnb3J5TGFiZWxzW2NhdGVnb3J5XSB8fCBjYXRlZ29yeS5yZXBsYWNlKCdfJywgJyAnKS5yZXBsYWNlKC9cXGJcXHcvZywgbCA9PiBsLnRvVXBwZXJDYXNlKCkpO1xuICB9O1xuXG5cbiAgLy8gR2VuZXJhdGUgZW50aXR5IG5hbWUgYmFzZWQgb24gdHlwZVxuICBjb25zdCBlbnRpdHlOYW1lID0gdHlwZSA9PT0gJ3Jlc2lkZW5jZScgXG4gICAgPyAoZW50aXR5Py51bml0TnVtYmVyIHx8IGVudGl0eT8udW5pdF9udW1iZXIgPyBgVW5pdCAke2VudGl0eS51bml0TnVtYmVyIHx8IGVudGl0eS51bml0X251bWJlcn1gIDogJ1Jlc2lkZW5jZScpXG4gICAgOiBlbnRpdHk/Lm5hbWU7XG5cbiAgY29uc3QgZGVmYXVsdEJhY2tMYWJlbCA9IGJhY2tMYWJlbCB8fCAodHlwZSA9PT0gJ2J1aWxkaW5nJyA/ICdCYWNrIHRvIEJ1aWxkaW5ncycgOiB0KCdiYWNrVG9SZXNpZGVuY2VzJykpO1xuXG4gIC8vIFN0YXRlIGZvciBkb2N1bWVudCB2aWV3IGFuZCBlZGl0IGRpYWxvZ3NcbiAgY29uc3QgW3NlbGVjdGVkRG9jdW1lbnRJZCwgc2V0U2VsZWN0ZWREb2N1bWVudElkXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaXNWaWV3RGlhbG9nT3Blbiwgc2V0SXNWaWV3RGlhbG9nT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc0VkaXREaWFsb2dPcGVuLCBzZXRJc0VkaXREaWFsb2dPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICAvLyBIYW5kbGUgZG9jdW1lbnQgaW50ZXJhY3Rpb25zXG4gIGNvbnN0IGhhbmRsZURvY3VtZW50VmlldyA9IChkb2N1bWVudElkOiBzdHJpbmcpID0+IHtcbiAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQoZG9jdW1lbnRJZCk7XG4gICAgc2V0SXNWaWV3RGlhbG9nT3Blbih0cnVlKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVEb2N1bWVudEVkaXQgPSAoZG9jdW1lbnRJZDogc3RyaW5nKSA9PiB7XG4gICAgc2V0U2VsZWN0ZWREb2N1bWVudElkKGRvY3VtZW50SWQpO1xuICAgIHNldElzRWRpdERpYWxvZ09wZW4odHJ1ZSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlQ3JlYXRlRG9jdW1lbnQgPSAoKSA9PiB7XG4gICAgc2V0SXNDcmVhdGVEaWFsb2dPcGVuKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURvY3VtZW50U3VjY2VzcyA9IChkb2N1bWVudElkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgRG9jdW1lbnQgY3JlYXRlZDpgLCBkb2N1bWVudElkKTtcbiAgICAvLyBSZWZyZXNoIGRvY3VtZW50cyBsaXN0IHdpbGwgYmUgaGFuZGxlZCBieSB0aGUgRG9jdW1lbnRDcmVhdGVGb3JtJ3MgY2FjaGUgaW52YWxpZGF0aW9uXG4gIH07XG5cbiAgY29uc3QgY2xlYXJGaWx0ZXJzID0gKCkgPT4ge1xuICAgIHNldFNlYXJjaFRlcm0oJycpO1xuICAgIHNldFNlbGVjdGVkQ2F0ZWdvcnkoJ2FsbCcpO1xuICB9O1xuXG4gIGlmICghZW50aXR5SWQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwIG1iLTRcIj57dHlwZX0gSUQgaXMgcmVxdWlyZWQ8L3A+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gbmF2aWdhdGUoYmFja1BhdGgpfVxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1iYWNrLXRvLWxpc3RcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT1cInctNCBoLTQgbXItMlwiIC8+XG4gICAgICAgICAgICAgIHtkZWZhdWx0QmFja0xhYmVsfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBlbnRpdHkgbm90IGZvdW5kIChzcGVjaWZpYyB0byByZXNpZGVuY2UgcGFnZXMgdGhhdCBoYWQgdGhpcyBsb2dpYylcbiAgaWYgKGVudGl0eUVycm9yICYmIGVycm9yPy5tZXNzYWdlID09PSAnRU5USVRZX05PVF9GT1VORCcgJiYgdHlwZSA9PT0gJ3Jlc2lkZW5jZScpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIG1heC13LW1kXCI+XG4gICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LXNlbWlib2xkIG1iLTRcIj5SZXNpZGVuY2UgTm90IEZvdW5kPC9oMj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDAgbWItNFwiPlxuICAgICAgICAgICAgICBUaGUgcmVzaWRlbmNlIElEIFwie2VudGl0eUlkfVwiIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIGRldmVsb3BtZW50IGRhdGFiYXNlLlxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNDAwIG1iLTZcIj5cbiAgICAgICAgICAgICAgVGhpcyBtaWdodCBiZSBhIHByb2R1Y3Rpb24gZGF0YWJhc2UgSUQuIFBsZWFzZSB1c2UgYSB2YWxpZCBkZXZlbG9wbWVudCByZXNpZGVuY2UgSUQuXG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgdmFyaWFudD1cImRlZmF1bHRcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKGJhY2tQYXRoKX1cbiAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1iYWNrLXRvLWxpc3RcIlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbFwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT1cInctNCBoLTQgbXItMlwiIC8+XG4gICAgICAgICAgICAgICAge2JhY2tMYWJlbCB8fCAnQmFjayB0byBSZXNpZGVuY2VzJ31cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT5cbiAgICAgICAgICAgICAgICAgIG5hdmlnYXRlKCcvcmVzaWRlbnRzL3Jlc2lkZW5jZXMvZTI3YWM5MjQtODEyMC00OTA0LWE3OTEtZDFlOWRiNTQ0ZDU4L2RvY3VtZW50cycpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWdvLXRvLXZhbGlkLXJlc2lkZW5jZVwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIEdvIHRvIFVuaXQgMTAxIChUZXN0IFJlc2lkZW5jZSlcbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgPEhlYWRlciBcbiAgICAgICAgdGl0bGU9e2VudGl0eU5hbWV9XG4gICAgICAgIHN1YnRpdGxlPXt0eXBlID09PSAnYnVpbGRpbmcnID8gJ0J1aWxkaW5nIERvY3VtZW50cycgOiAnUmVzaWRlbmNlIERvY3VtZW50cyd9XG4gICAgICAvPlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBvdmVyZmxvdy1hdXRvIHAtNlwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1heC13LTd4bCBteC1hdXRvIHNwYWNlLXktNlwiPlxuICAgICAgICAgIHsvKiBCYWNrIEJ1dHRvbiAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKGJhY2tQYXRoKX1cbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tYmFja1wiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAge2RlZmF1bHRCYWNrTGFiZWx9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDxkaXY+PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogRmlsdGVycyBhbmQgU2VhcmNoIFNlY3Rpb24gKi99XG4gICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICA8Q2FyZEhlYWRlcj5cbiAgICAgICAgICAgICAgPENhcmRUaXRsZSBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgICAgICAgIDxGaWx0ZXIgY2xhc3NOYW1lPVwidy01IGgtNVwiIC8+XG4gICAgICAgICAgICAgICAgU2VhcmNoICYgRmlsdGVyc1xuICAgICAgICAgICAgICA8L0NhcmRUaXRsZT5cbiAgICAgICAgICAgIDwvQ2FyZEhlYWRlcj5cbiAgICAgICAgICAgIDxDYXJkQ29udGVudD5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0zIGdhcC00XCI+XG4gICAgICAgICAgICAgICAgey8qIFNlYXJjaCAqL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5TZWFyY2g8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxuICAgICAgICAgICAgICAgICAgICA8U2VhcmNoIGNsYXNzTmFtZT1cImFic29sdXRlIGxlZnQtMyB0b3AtMS8yIHRyYW5zZm9ybSAtdHJhbnNsYXRlLXktMS8yIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCB3LTQgaC00XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggZG9jdW1lbnRzLi4uXCJcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17c2VhcmNoVGVybX1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFNlYXJjaFRlcm0oZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInBsLTEwXCJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LXNlYXJjaC1kb2N1bWVudHNcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICB7LyogQ2F0ZWdvcnkgRmlsdGVyICovfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPkNhdGVnb3J5PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgIDxTZWxlY3QgdmFsdWU9e3NlbGVjdGVkQ2F0ZWdvcnl9IG9uVmFsdWVDaGFuZ2U9e3NldFNlbGVjdGVkQ2F0ZWdvcnl9PlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VHJpZ2dlciBkYXRhLXRlc3RpZD1cInNlbGVjdC1jYXRlZ29yeS1maWx0ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VmFsdWUgcGxhY2Vob2xkZXI9XCJBbGwgQ2F0ZWdvcmllc1wiIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0VHJpZ2dlcj5cbiAgICAgICAgICAgICAgICAgICAgPFNlbGVjdENvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICAgICAge0RPQ1VNRU5UX0NBVEVHT1JJRVMubWFwKChjYXRlZ29yeSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdEl0ZW0ga2V5PXtjYXRlZ29yeS52YWx1ZX0gdmFsdWU9e2NhdGVnb3J5LnZhbHVlfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAge2NhdGVnb3J5LmxhYmVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RJdGVtPlxuICAgICAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdENvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIHsvKiBWaWV3IE1vZGUgJiBBY3Rpb25zICovfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlZpZXcgJiBBY3Rpb25zPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMlwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PXt2aWV3TW9kZSA9PT0gJ2dyaWQnID8gJ2RlZmF1bHQnIDogJ291dGxpbmUnfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFZpZXdNb2RlKCdncmlkJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1ncmlkLXZpZXdcIlxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxHcmlkIGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9e3ZpZXdNb2RlID09PSAnbGlzdCcgPyAnZGVmYXVsdCcgOiAnb3V0bGluZSd9XG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplPVwic21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0Vmlld01vZGUoJ2xpc3QnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWxpc3Qtdmlld1wiXG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPExpc3QgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7dXNlclBlcm1pc3Npb25zLmNhbkNyZWF0ZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUNyZWF0ZURvY3VtZW50fSBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1jcmVhdGUtZG9jdW1lbnRcIlxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxQbHVzIGNsYXNzTmFtZT1cInctNCBoLTQgbXItMlwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGVcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBcbiAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiIFxuICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17Y2xlYXJGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWNsZWFyLWZpbHRlcnNcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgQ2xlYXJcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgIDwvQ2FyZD5cblxuICAgICAgICAgIHsvKiBEb2N1bWVudHMgRGlzcGxheSAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiPlxuICAgICAgICAgICAgICAgIHtmaWx0ZXJlZERvY3VtZW50cy5sZW5ndGh9IGRvY3VtZW50e2ZpbHRlcmVkRG9jdW1lbnRzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBmb3VuZFxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgIHsoc2VhcmNoVGVybSB8fCBzZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJykgJiYgKFxuICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PVwic2Vjb25kYXJ5XCI+RmlsdGVyZWQ8L0JhZGdlPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogRG9jdW1lbnRzIENvbnRlbnQgKi99XG4gICAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMFwiPkxvYWRpbmcgZG9jdW1lbnRzLi4uPC9wPlxuICAgICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgICAgPC9DYXJkPlxuICAgICAgICAgICkgOiBmaWx0ZXJlZERvY3VtZW50cy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICA8Q2FyZD5cbiAgICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xNiBoLTE2IG14LWF1dG8gbWItNCBiZy1tdXRlZCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9XCJ3LTggaC04IHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiIC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTYwMCBtYi0yXCI+Tm8gRG9jdW1lbnRzIEZvdW5kPC9oMz5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDAgbWItNFwiPlxuICAgICAgICAgICAgICAgICAgICB7c2VhcmNoVGVybSB8fCBzZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJ1xuICAgICAgICAgICAgICAgICAgICAgID8gXCJObyBkb2N1bWVudHMgbWF0Y2ggeW91ciBjdXJyZW50IGZpbHRlcnMuIFRyeSBhZGp1c3RpbmcgeW91ciBzZWFyY2ggY3JpdGVyaWEuXCJcbiAgICAgICAgICAgICAgICAgICAgICA6IGBObyBkb2N1bWVudHMgaGF2ZSBiZWVuIHVwbG9hZGVkIGZvciB0aGlzICR7dHlwZX0geWV0LiBDcmVhdGUgeW91ciBmaXJzdCBkb2N1bWVudCB0byBnZXQgc3RhcnRlZC5gXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMiBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICB7KHNlYXJjaFRlcm0gfHwgc2VsZWN0ZWRDYXRlZ29yeSAhPT0gJ2FsbCcpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17Y2xlYXJGaWx0ZXJzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIENsZWFyIEZpbHRlcnNcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3VzZXJQZXJtaXNzaW9ucy5jYW5DcmVhdGUgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17aGFuZGxlQ3JlYXRlRG9jdW1lbnR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBsdXMgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZSBEb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgICA8L0NhcmQ+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS02XCI+XG4gICAgICAgICAgICAgIHtPYmplY3QuZW50cmllcyhncm91cGVkRG9jdW1lbnRzKS5tYXAoKFtjYXRlZ29yeSwgY2F0ZWdvcnlEb2N1bWVudHNdKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IGV4cGFuZGVkQ2F0ZWdvcmllcy5oYXMoY2F0ZWdvcnkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGtleT17Y2F0ZWdvcnl9IGNsYXNzTmFtZT1cInNwYWNlLXktM1wiPlxuICAgICAgICAgICAgICAgICAgICA8Q29sbGFwc2libGUgb3Blbj17aXNFeHBhbmRlZH0gb25PcGVuQ2hhbmdlPXsoKSA9PiB0b2dnbGVDYXRlZ29yeShjYXRlZ29yeSl9PlxuICAgICAgICAgICAgICAgICAgICAgIDxDb2xsYXBzaWJsZVRyaWdnZXIgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgcC0yIHctZnVsbCB0ZXh0LWxlZnQgaG92ZXI6YmctZ3JheS01MCBkYXJrOmhvdmVyOmJnLWdyYXktODAwIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtpc0V4cGFuZGVkID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hldnJvbkRvd24gY2xhc3NOYW1lPVwiaC00IHctNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hldnJvblJpZ2h0IGNsYXNzTmFtZT1cImgtNCB3LTRcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1zZW1pYm9sZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7Z2V0Q2F0ZWdvcnlEaXNwbGF5TmFtZShjYXRlZ29yeSl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8QmFkZ2UgdmFyaWFudD1cInNlY29uZGFyeVwiIGNsYXNzTmFtZT1cIm1sLTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAge2NhdGVnb3J5RG9jdW1lbnRzLmxlbmd0aH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQmFkZ2U+XG4gICAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzaWJsZVRyaWdnZXI+XG4gICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNpYmxlQ29udGVudCBjbGFzc05hbWU9XCJzcGFjZS15LTNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPVwicHQtNlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgZ3JpZCBnYXAtNCAke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld01vZGUgPT09ICdncmlkJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnZ3JpZC1jb2xzLTEgbWQ6Z3JpZC1jb2xzLTIgbGc6Z3JpZC1jb2xzLTMgeGw6Z3JpZC1jb2xzLTQnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdncmlkLWNvbHMtMSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9YH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnlEb2N1bWVudHMubWFwKChkb2N1bWVudCkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RG9jdW1lbnRDYXJkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtkb2N1bWVudC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudElkPXtkb2N1bWVudC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17ZG9jdW1lbnQubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFR5cGU9e2RvY3VtZW50LmNhdGVnb3J5IHx8IGRvY3VtZW50LmRvY3VtZW50VHlwZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ9e2RvY3VtZW50LmNyZWF0ZWRBdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblZpZXdDbGljaz17aGFuZGxlRG9jdW1lbnRWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhY3Q9e3ZpZXdNb2RlID09PSAnbGlzdCd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgICAgICAgICAgICA8L0NvbGxhcHNpYmxlQ29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgPC9Db2xsYXBzaWJsZT5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBEb2N1bWVudCBDcmVhdGlvbiBEaWFsb2cgKi99XG4gICAgICAgICAgPERvY3VtZW50Q3JlYXRlRm9ybVxuICAgICAgICAgICAgaXNPcGVuPXtpc0NyZWF0ZURpYWxvZ09wZW59XG4gICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRJc0NyZWF0ZURpYWxvZ09wZW4oZmFsc2UpfVxuICAgICAgICAgICAgb25TdWNjZXNzPXtoYW5kbGVEb2N1bWVudFN1Y2Nlc3N9XG4gICAgICAgICAgICBlbnRpdHlUeXBlPXt0eXBlfVxuICAgICAgICAgICAgZW50aXR5SWQ9e2VudGl0eUlkfVxuICAgICAgICAgICAgZW50aXR5TmFtZT17ZW50aXR5TmFtZX1cbiAgICAgICAgICAvPlxuXG4gICAgICAgICAgey8qIERvY3VtZW50IFZpZXcgRGlhbG9nICovfVxuICAgICAgICAgIHtzZWxlY3RlZERvY3VtZW50SWQgJiYgKFxuICAgICAgICAgICAgPERvY3VtZW50Vmlld0RpYWxvZ1xuICAgICAgICAgICAgICBkb2N1bWVudElkPXtzZWxlY3RlZERvY3VtZW50SWR9XG4gICAgICAgICAgICAgIGlzT3Blbj17aXNWaWV3RGlhbG9nT3Blbn1cbiAgICAgICAgICAgICAgb25DbG9zZT17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldElzVmlld0RpYWxvZ09wZW4oZmFsc2UpO1xuICAgICAgICAgICAgICAgIHNldFNlbGVjdGVkRG9jdW1lbnRJZChudWxsKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgb25FZGl0PXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SXNWaWV3RGlhbG9nT3BlbihmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2V0SXNFZGl0RGlhbG9nT3Blbih0cnVlKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgY2FuRWRpdD17dXNlclBlcm1pc3Npb25zLmNhbkVkaXR9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7LyogRG9jdW1lbnQgRWRpdCBEaWFsb2cgKi99XG4gICAgICAgICAge3NlbGVjdGVkRG9jdW1lbnRJZCAmJiAoXG4gICAgICAgICAgICA8RG9jdW1lbnRFZGl0RGlhbG9nXG4gICAgICAgICAgICAgIGRvY3VtZW50SWQ9e3NlbGVjdGVkRG9jdW1lbnRJZH1cbiAgICAgICAgICAgICAgaXNPcGVuPXtpc0VkaXREaWFsb2dPcGVufVxuICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SXNFZGl0RGlhbG9nT3BlbihmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWREb2N1bWVudElkKG51bGwpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBvblN1Y2Nlc3M9eygpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc0VkaXREaWFsb2dPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQobnVsbCk7XG4gICAgICAgICAgICAgICAgLy8gUmVmcmVzaCBkb2N1bWVudHMgbGlzdFxuICAgICAgICAgICAgICAgIHF1ZXJ5Q2xpZW50LmludmFsaWRhdGVRdWVyaWVzKHtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5S2V5OiBbJy9hcGkvZG9jdW1lbnRzJywgdHlwZSwgZW50aXR5SWRdLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufSJdLCJ2ZXJzaW9uIjozfQ==
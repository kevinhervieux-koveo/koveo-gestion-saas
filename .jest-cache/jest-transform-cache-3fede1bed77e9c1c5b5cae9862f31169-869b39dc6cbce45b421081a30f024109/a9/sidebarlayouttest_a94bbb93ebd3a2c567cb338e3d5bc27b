ca173cfe1fe762c0c90271c6b7aa8e87
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const globals_1 = require("@jest/globals");
const react_1 = require("@testing-library/react");
const react_query_1 = require("@tanstack/react-query");
// Mock the providers to avoid import issues
const AuthProvider = ({ children }) => (0, jsx_runtime_1.jsx)("div", { children: children });
const LanguageProvider = ({ children }) => (0, jsx_runtime_1.jsx)("div", { children: children });
const MobileMenuProvider = ({ children }) => (0, jsx_runtime_1.jsx)("div", { children: children });
const TooltipProvider = ({ children }) => (0, jsx_runtime_1.jsx)("div", { children: children });
// Mock page components to avoid import issues
const Buildings = () => ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "buildings-page", children: [(0, jsx_runtime_1.jsx)("h1", { children: "Buildings" }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto", children: (0, jsx_runtime_1.jsx)("p", { children: "Buildings content" }) }) })] }));
const Budget = () => ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "budget-page", children: [(0, jsx_runtime_1.jsx)("h1", { children: "Budget Dashboard" }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto", children: (0, jsx_runtime_1.jsx)("p", { children: "Budget content" }) }) })] }));
const Bills = () => ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "bills-page", children: [(0, jsx_runtime_1.jsx)("h1", { children: "Bills Management" }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto", children: (0, jsx_runtime_1.jsx)("p", { children: "Bills content" }) }) })] }));
// Mock the API calls
const mockBuildings = [
    {
        id: '1',
        name: 'Test Building',
        address: '123 Test St',
        city: 'Montreal',
        province: 'QC',
        postalCode: 'H1H 1H1',
        buildingType: 'apartment',
        totalUnits: 10,
        organizationId: 'test-org',
        isActive: true,
    }
];
// Mock fetch
const mockFetch = (data) => {
    global.fetch = jest.fn(() => Promise.resolve({
        ok: true,
        json: () => Promise.resolve(data),
    }));
};
const TestWrapper = ({ children }) => {
    const queryClient = new react_query_1.QueryClient({
        defaultOptions: {
            queries: { retry: false, gcTime: 0 },
            mutations: { retry: false },
        },
    });
    return ((0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: (0, jsx_runtime_1.jsx)(TooltipProvider, { children: (0, jsx_runtime_1.jsx)(LanguageProvider, { children: (0, jsx_runtime_1.jsx)(AuthProvider, { children: (0, jsx_runtime_1.jsx)(MobileMenuProvider, { children: (0, jsx_runtime_1.jsxs)("div", { className: "h-full flex bg-gray-50 font-inter", children: [(0, jsx_runtime_1.jsx)("div", { className: "hidden md:block", children: (0, jsx_runtime_1.jsx)("div", { "data-testid": "sidebar", className: "w-64 h-full bg-white", children: "Sidebar" }) }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col min-w-0", children: children })] }) }) }) }) }) }));
};
(0, globals_1.describe)('Sidebar Layout Consistency Tests', () => {
    (0, globals_1.beforeEach)(() => {
        // Reset mocks
        jest.clearAllMocks();
    });
    (0, globals_1.describe)('Buildings Page Layout', () => {
        (0, globals_1.it)('should maintain sidebar when buildings page renders', async () => {
            mockFetch(mockBuildings);
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Buildings, {}) }));
            // Wait for component to load
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('sidebar')).toBeInTheDocument();
            });
            // Check that the buildings page content is rendered
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Buildings')).toBeInTheDocument();
            });
            // Verify sidebar is still present
            (0, globals_1.expect)(react_1.screen.getByTestId('sidebar')).toBeInTheDocument();
        });
        (0, globals_1.it)('should have consistent layout classes with other manager pages', async () => {
            mockFetch(mockBuildings);
            const { container } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Buildings, {}) }));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Buildings')).toBeInTheDocument();
            });
            // Check for the main layout container
            const mainContainer = container.querySelector('.flex-1.flex.flex-col.overflow-hidden');
            (0, globals_1.expect)(mainContainer).toBeInTheDocument();
            // Check for the content area
            const contentArea = container.querySelector('.flex-1.overflow-auto');
            (0, globals_1.expect)(contentArea).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Page Layout Comparison', () => {
        (0, globals_1.it)('should have same layout structure as budget page', async () => {
            mockFetch([]);
            const buildingsResult = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Buildings, {}) }));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Buildings')).toBeInTheDocument();
            });
            const buildingsContainer = buildingsResult.container.querySelector('.flex-1.flex.flex-col.overflow-hidden');
            (0, globals_1.expect)(buildingsContainer).toBeInTheDocument();
            buildingsResult.unmount();
            // Test budget page
            const budgetResult = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Budget, {}) }));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Budget Dashboard')).toBeInTheDocument();
            });
            // Budget page should NOT use min-h-screen (that's the bug we need to fix)
            const budgetFullScreen = budgetResult.container.querySelector('.min-h-screen');
            if (budgetFullScreen) {
                console.log('ðŸš¨ ISSUE FOUND: Budget page uses min-h-screen which breaks the sidebar layout');
            }
        });
        (0, globals_1.it)('should have same layout structure as bills page', async () => {
            mockFetch(mockBuildings);
            const buildingsResult = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Buildings, {}) }));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Buildings')).toBeInTheDocument();
            });
            const buildingsContainer = buildingsResult.container.querySelector('.flex-1.flex.flex-col.overflow-hidden');
            (0, globals_1.expect)(buildingsContainer).toBeInTheDocument();
            buildingsResult.unmount();
            // Test bills page
            const billsResult = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(Bills, {}) }));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Bills Management')).toBeInTheDocument();
            });
            const billsContainer = billsResult.container.querySelector('.flex-1.flex.flex-col.overflow-hidden');
            (0, globals_1.expect)(billsContainer).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Layout Consistency Rules', () => {
        (0, globals_1.it)('should never use min-h-screen in manager pages', async () => {
            mockFetch(mockBuildings);
            const pages = [
                { name: 'Buildings', component: Buildings },
                { name: 'Bills', component: Bills },
                { name: 'Budget', component: Budget },
            ];
            for (const page of pages) {
                const { container, unmount } = (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(page.component, {}) }));
                // Wait for page to load
                await (0, react_1.waitFor)(() => {
                    const pageContent = container.querySelector('[data-testid], .card, header');
                    (0, globals_1.expect)(pageContent).toBeInTheDocument();
                });
                // Check for problematic min-h-screen class
                const minHeightScreen = container.querySelector('.min-h-screen');
                (0, globals_1.expect)(minHeightScreen).toBeNull();
                // Check for correct layout structure
                const flexContainer = container.querySelector('.flex-1.flex.flex-col.overflow-hidden');
                (0, globals_1.expect)(flexContainer).toBeInTheDocument();
                unmount();
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L3NpZGViYXItbGF5b3V0LnRlc3QudHN4IiwibWFwcGluZ3MiOiI7OztBQUFBLDJDQUFpRTtBQUNqRSxrREFBaUU7QUFDakUsdURBQXlFO0FBQ3pFLDRDQUE0QztBQUM1QyxNQUFNLFlBQVksR0FBRyxDQUFDLEVBQUUsUUFBUSxFQUFpQyxFQUFFLEVBQUUsQ0FBQywwQ0FBTSxRQUFRLEdBQU8sQ0FBQztBQUM1RixNQUFNLGdCQUFnQixHQUFHLENBQUMsRUFBRSxRQUFRLEVBQWlDLEVBQUUsRUFBRSxDQUFDLDBDQUFNLFFBQVEsR0FBTyxDQUFDO0FBQ2hHLE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxFQUFFLFFBQVEsRUFBaUMsRUFBRSxFQUFFLENBQUMsMENBQU0sUUFBUSxHQUFPLENBQUM7QUFDbEcsTUFBTSxlQUFlLEdBQUcsQ0FBQyxFQUFFLFFBQVEsRUFBaUMsRUFBRSxFQUFFLENBQUMsMENBQU0sUUFBUSxHQUFPLENBQUM7QUFDL0YsOENBQThDO0FBQzlDLE1BQU0sU0FBUyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQ3RCLGdEQUFpQixnQkFBZ0IsYUFDL0IsdURBQWtCLEVBQ2xCLGdDQUFLLFNBQVMsRUFBQyxzQ0FBc0MsWUFDbkQsZ0NBQUssU0FBUyxFQUFDLHNCQUFzQixZQUNuQyw4REFBd0IsR0FDcEIsR0FDRixJQUNGLENBQ1AsQ0FBQztBQUVGLE1BQU0sTUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQ25CLGdEQUFpQixhQUFhLGFBQzVCLDhEQUF5QixFQUN6QixnQ0FBSyxTQUFTLEVBQUMsc0NBQXNDLFlBQ25ELGdDQUFLLFNBQVMsRUFBQyxzQkFBc0IsWUFDbkMsMkRBQXFCLEdBQ2pCLEdBQ0YsSUFDRixDQUNQLENBQUM7QUFFRixNQUFNLEtBQUssR0FBRyxHQUFHLEVBQUUsQ0FBQyxDQUNsQixnREFBaUIsWUFBWSxhQUMzQiw4REFBeUIsRUFDekIsZ0NBQUssU0FBUyxFQUFDLHNDQUFzQyxZQUNuRCxnQ0FBSyxT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RUFBRSxNQUFNLEVBQUU7YUFDdEMsQ0FBQztZQUVGLEtBQUssTUFBTSxJQUFJLElBQUksS0FBSyxFQUFFLENBQUM7Z0JBQ3pCLE1BQU0sRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLEdBQUcsSUFBQSxjQUFNLEVBQ25DLHVCQUFDLFdBQVcsY0FDVix1QkFBQyxJQUFJLENBQUMsU0FBUyxLQUFHLEdBQ04sQ0FDZixDQUFDO2dCQUVGLHdCQUF3QjtnQkFDeEIsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7b0JBQ2pCLE1BQU0sV0FBVyxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsOEJBQThCLENBQUMsQ0FBQztvQkFDNUUsSUFBQSxnQkFBTSxFQUFDLFdBQVcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7Z0JBQzFDLENBQUMsQ0FBQyxDQUFDO2dCQUVILDJDQUEyQztnQkFDM0MsTUFBTSxlQUFlLEdBQUcsU0FBUyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQztnQkFDakUsSUFBQSxnQkFBTSxFQUFDLGVBQWUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUVuQyxxQ0FBcUM7Z0JBQ3JDLE1BQU0sYUFBYSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsdUNBQXVDLENBQUMsQ0FBQztnQkFDdkYsSUFBQSxnQkFBTSxFQUFDLGFBQWEsQ0FBQyxDQUFDLGlCQUFpQixFQUFFLENBQUM7Z0JBRTFDLE9BQU8sRUFBRSxDQUFDO1lBQ1osQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3VuaXQvc2lkZWJhci1sYXlvdXQudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2ggfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBRdWVyeUNsaWVudCwgUXVlcnlDbGllbnRQcm92aWRlciB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7XG4vLyBNb2NrIHRoZSBwcm92aWRlcnMgdG8gYXZvaWQgaW1wb3J0IGlzc3Vlc1xuY29uc3QgQXV0aFByb3ZpZGVyID0gKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pID0+IDxkaXY+e2NoaWxkcmVufTwvZGl2PjtcbmNvbnN0IExhbmd1YWdlUHJvdmlkZXIgPSAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gPGRpdj57Y2hpbGRyZW59PC9kaXY+O1xuY29uc3QgTW9iaWxlTWVudVByb3ZpZGVyID0gKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pID0+IDxkaXY+e2NoaWxkcmVufTwvZGl2PjtcbmNvbnN0IFRvb2x0aXBQcm92aWRlciA9ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiA8ZGl2PntjaGlsZHJlbn08L2Rpdj47XG4vLyBNb2NrIHBhZ2UgY29tcG9uZW50cyB0byBhdm9pZCBpbXBvcnQgaXNzdWVzXG5jb25zdCBCdWlsZGluZ3MgPSAoKSA9PiAoXG4gIDxkaXYgZGF0YS10ZXN0aWQ9XCJidWlsZGluZ3MtcGFnZVwiPlxuICAgIDxoMT5CdWlsZGluZ3M8L2gxPlxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBvdmVyZmxvdy1hdXRvXCI+XG4gICAgICAgIDxwPkJ1aWxkaW5ncyBjb250ZW50PC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuKTtcblxuY29uc3QgQnVkZ2V0ID0gKCkgPT4gKFxuICA8ZGl2IGRhdGEtdGVzdGlkPVwiYnVkZ2V0LXBhZ2VcIj5cbiAgICA8aDE+QnVkZ2V0IERhc2hib2FyZDwvaDE+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIG92ZXJmbG93LWF1dG9cIj5cbiAgICAgICAgPHA+QnVkZ2V0IGNvbnRlbnQ8L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4pO1xuXG5jb25zdCBCaWxscyA9ICgpID0+IChcbiAgPGRpdiBkYXRhLXRlc3RpZD1cImJpbGxzLXBhZ2VcIj5cbiAgICA8aDE+QmlsbHMgTWFuYWdlbWVudDwvaDE+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIG92ZXJmbG93LWF1dG9cIj5cbiAgICAgICAgPHA+QmlsbHMgY29udGVudDwvcD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbik7XG5cbi8vIE1vY2sgdGhlIEFQSSBjYWxsc1xuY29uc3QgbW9ja0J1aWxkaW5ncyA9IFtcbiAge1xuICAgIGlkOiAnMScsXG4gICAgbmFtZTogJ1Rlc3QgQnVpbGRpbmcnLFxuICAgIGFkZHJlc3M6ICcxMjMgVGVzdCBTdCcsXG4gICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICBwcm92aW5jZTogJ1FDJyxcbiAgICBwb3N0YWxDb2RlOiAnSDFIIDFIMScsXG4gICAgYnVpbGRpbmdUeXBlOiAnYXBhcnRtZW50JyxcbiAgICB0b3RhbFVuaXRzOiAxMCxcbiAgICBvcmdhbml6YXRpb25JZDogJ3Rlc3Qtb3JnJyxcbiAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgfVxuXTtcblxuLy8gTW9jayBmZXRjaFxuY29uc3QgbW9ja0ZldGNoID0gKGRhdGE6IGFueSkgPT4ge1xuICBnbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCgpID0+XG4gICAgUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgIG9rOiB0cnVlLFxuICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGRhdGEpLFxuICAgIH0pXG4gICkgYXMgamVzdC5Nb2NrO1xufTtcblxuY29uc3QgVGVzdFdyYXBwZXIgPSAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4ge1xuICBjb25zdCBxdWVyeUNsaWVudCA9IG5ldyBRdWVyeUNsaWVudCh7XG4gICAgZGVmYXVsdE9wdGlvbnM6IHtcbiAgICAgIHF1ZXJpZXM6IHsgcmV0cnk6IGZhbHNlLCBnY1RpbWU6IDAgfSxcbiAgICAgIG11dGF0aW9uczogeyByZXRyeTogZmFsc2UgfSxcbiAgICB9LFxuICB9KTtcblxuICByZXR1cm4gKFxuICAgIDxRdWVyeUNsaWVudFByb3ZpZGVyIGNsaWVudD17cXVlcnlDbGllbnR9PlxuICAgICAgPFRvb2x0aXBQcm92aWRlcj5cbiAgICAgICAgPExhbmd1YWdlUHJvdmlkZXI+XG4gICAgICAgICAgPEF1dGhQcm92aWRlcj5cbiAgICAgICAgICAgIDxNb2JpbGVNZW51UHJvdmlkZXI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaC1mdWxsIGZsZXggYmctZ3JheS01MCBmb250LWludGVyXCI+XG4gICAgICAgICAgICAgICAgey8qIFNpbXVsYXRlIHRoZSBhcHAgbGF5b3V0IHN0cnVjdHVyZSAqL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhpZGRlbiBtZDpibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cInNpZGViYXJcIiBjbGFzc05hbWU9XCJ3LTY0IGgtZnVsbCBiZy13aGl0ZVwiPlNpZGViYXI8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG1pbi13LTBcIj5cbiAgICAgICAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L01vYmlsZU1lbnVQcm92aWRlcj5cbiAgICAgICAgICA8L0F1dGhQcm92aWRlcj5cbiAgICAgICAgPC9MYW5ndWFnZVByb3ZpZGVyPlxuICAgICAgPC9Ub29sdGlwUHJvdmlkZXI+XG4gICAgPC9RdWVyeUNsaWVudFByb3ZpZGVyPlxuICApO1xufTtcblxuZGVzY3JpYmUoJ1NpZGViYXIgTGF5b3V0IENvbnNpc3RlbmN5IFRlc3RzJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBSZXNldCBtb2Nrc1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQnVpbGRpbmdzIFBhZ2UgTGF5b3V0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gc2lkZWJhciB3aGVuIGJ1aWxkaW5ncyBwYWdlIHJlbmRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gobW9ja0J1aWxkaW5ncyk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxCdWlsZGluZ3MgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGNvbXBvbmVudCB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2lkZWJhcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIHRoYXQgdGhlIGJ1aWxkaW5ncyBwYWdlIGNvbnRlbnQgaXMgcmVuZGVyZWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQnVpbGRpbmdzJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHNpZGViYXIgaXMgc3RpbGwgcHJlc2VudFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2lkZWJhcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIGNvbnNpc3RlbnQgbGF5b3V0IGNsYXNzZXMgd2l0aCBvdGhlciBtYW5hZ2VyIHBhZ2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoKG1vY2tCdWlsZGluZ3MpO1xuXG4gICAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEJ1aWxkaW5ncyAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdCdWlsZGluZ3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBmb3IgdGhlIG1haW4gbGF5b3V0IGNvbnRhaW5lclxuICAgICAgY29uc3QgbWFpbkNvbnRhaW5lciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZmxleC0xLmZsZXguZmxleC1jb2wub3ZlcmZsb3ctaGlkZGVuJyk7XG4gICAgICBleHBlY3QobWFpbkNvbnRhaW5lcikudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBjb250ZW50IGFyZWFcbiAgICAgIGNvbnN0IGNvbnRlbnRBcmVhID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5mbGV4LTEub3ZlcmZsb3ctYXV0bycpO1xuICAgICAgZXhwZWN0KGNvbnRlbnRBcmVhKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGFnZSBMYXlvdXQgQ29tcGFyaXNvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc2FtZSBsYXlvdXQgc3RydWN0dXJlIGFzIGJ1ZGdldCBwYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoKFtdKTtcbiAgICAgIFxuICAgICAgY29uc3QgYnVpbGRpbmdzUmVzdWx0ID0gcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEJ1aWxkaW5ncyAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdCdWlsZGluZ3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBidWlsZGluZ3NDb250YWluZXIgPSBidWlsZGluZ3NSZXN1bHQuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5mbGV4LTEuZmxleC5mbGV4LWNvbC5vdmVyZmxvdy1oaWRkZW4nKTtcbiAgICAgIGV4cGVjdChidWlsZGluZ3NDb250YWluZXIpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICAgIGJ1aWxkaW5nc1Jlc3VsdC51bm1vdW50KCk7XG5cbiAgICAgIC8vIFRlc3QgYnVkZ2V0IHBhZ2VcbiAgICAgIGNvbnN0IGJ1ZGdldFJlc3VsdCA9IHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxCdWRnZXQgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQnVkZ2V0IERhc2hib2FyZCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEJ1ZGdldCBwYWdlIHNob3VsZCBOT1QgdXNlIG1pbi1oLXNjcmVlbiAodGhhdCdzIHRoZSBidWcgd2UgbmVlZCB0byBmaXgpXG4gICAgICBjb25zdCBidWRnZXRGdWxsU2NyZWVuID0gYnVkZ2V0UmVzdWx0LmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubWluLWgtc2NyZWVuJyk7XG4gICAgICBpZiAoYnVkZ2V0RnVsbFNjcmVlbikge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+aqCBJU1NVRSBGT1VORDogQnVkZ2V0IHBhZ2UgdXNlcyBtaW4taC1zY3JlZW4gd2hpY2ggYnJlYWtzIHRoZSBzaWRlYmFyIGxheW91dCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIHNhbWUgbGF5b3V0IHN0cnVjdHVyZSBhcyBiaWxscyBwYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoKG1vY2tCdWlsZGluZ3MpO1xuICAgICAgXG4gICAgICBjb25zdCBidWlsZGluZ3NSZXN1bHQgPSByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8QnVpbGRpbmdzIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0J1aWxkaW5ncycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJ1aWxkaW5nc0NvbnRhaW5lciA9IGJ1aWxkaW5nc1Jlc3VsdC5jb250YWluZXIucXVlcnlTZWxlY3RvcignLmZsZXgtMS5mbGV4LmZsZXgtY29sLm92ZXJmbG93LWhpZGRlbicpO1xuICAgICAgZXhwZWN0KGJ1aWxkaW5nc0NvbnRhaW5lcikudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgYnVpbGRpbmdzUmVzdWx0LnVubW91bnQoKTtcblxuICAgICAgLy8gVGVzdCBiaWxscyBwYWdlXG4gICAgICBjb25zdCBiaWxsc1Jlc3VsdCA9IHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxCaWxscyAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdCaWxscyBNYW5hZ2VtZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgYmlsbHNDb250YWluZXIgPSBiaWxsc1Jlc3VsdC5jb250YWluZXIucXVlcnlTZWxlY3RvcignLmZsZXgtMS5mbGV4LmZsZXgtY29sLm92ZXJmbG93LWhpZGRlbicpO1xuICAgICAgZXhwZWN0KGJpbGxzQ29udGFpbmVyKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTGF5b3V0IENvbnNpc3RlbmN5IFJ1bGVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbmV2ZXIgdXNlIG1pbi1oLXNjcmVlbiBpbiBtYW5hZ2VyIHBhZ2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoKG1vY2tCdWlsZGluZ3MpO1xuXG4gICAgICBjb25zdCBwYWdlcyA9IFtcbiAgICAgICAgeyBuYW1lOiAnQnVpbGRpbmdzJywgY29tcG9uZW50OiBCdWlsZGluZ3MgfSxcbiAgICAgICAgeyBuYW1lOiAnQmlsbHMnLCBjb21wb25lbnQ6IEJpbGxzIH0sXG4gICAgICAgIHsgbmFtZTogJ0J1ZGdldCcsIGNvbXBvbmVudDogQnVkZ2V0IH0sXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IHBhZ2Ugb2YgcGFnZXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXIsIHVubW91bnQgfSA9IHJlbmRlcihcbiAgICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgICA8cGFnZS5jb21wb25lbnQgLz5cbiAgICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFdhaXQgZm9yIHBhZ2UgdG8gbG9hZFxuICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICBjb25zdCBwYWdlQ29udGVudCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWRdLCAuY2FyZCwgaGVhZGVyJyk7XG4gICAgICAgICAgZXhwZWN0KHBhZ2VDb250ZW50KS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgcHJvYmxlbWF0aWMgbWluLWgtc2NyZWVuIGNsYXNzXG4gICAgICAgIGNvbnN0IG1pbkhlaWdodFNjcmVlbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubWluLWgtc2NyZWVuJyk7XG4gICAgICAgIGV4cGVjdChtaW5IZWlnaHRTY3JlZW4pLnRvQmVOdWxsKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIGNvcnJlY3QgbGF5b3V0IHN0cnVjdHVyZVxuICAgICAgICBjb25zdCBmbGV4Q29udGFpbmVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5mbGV4LTEuZmxleC5mbGV4LWNvbC5vdmVyZmxvdy1oaWRkZW4nKTtcbiAgICAgICAgZXhwZWN0KGZsZXhDb250YWluZXIpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICAgICAgdW5tb3VudCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==
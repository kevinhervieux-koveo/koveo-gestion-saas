7907da01f1661529bedcbcbd0f818f33
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.SharedUploader = SharedUploader;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const lucide_react_1 = require("lucide-react");
const utils_1 = require("@/lib/utils");
const tabs_1 = require("@/components/ui/tabs");
const textarea_1 = require("@/components/ui/textarea");
const label_1 = require("@/components/ui/label");
const switch_1 = require("@/components/ui/switch");
const badge_1 = require("@/components/ui/badge");
const upload_config_1 = require("@shared/config/upload-config");
const DEFAULT_ALLOWED_TYPES = [
    'application/pdf',
    'application/msword',
    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
    'application/vnd.ms-excel',
    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    'image/jpeg',
    'image/jpg',
    'image/png'
];
/**
 * SharedUploader - A reusable component for file uploads and text creation
 * Features mobile camera integration, drag-and-drop, clipboard paste, and text input
 */
function SharedUploader({ onDocumentChange, allowedFileTypes, maxFileSize, disabled = false, className, defaultTab = 'file', 
// AI Enhancement Props
formType = 'documents', uploadContext, aiAnalysisEnabled: propAiEnabled, onAiToggle, onAiAnalysisComplete, showAiToggle = true, contextFields }) {
    // Get configuration from upload config
    const config = (0, upload_config_1.getUploadConfig)(formType);
    const finalAllowedTypes = allowedFileTypes || config.allowedFileTypes;
    const finalMaxFileSize = maxFileSize || config.maxFileSize;
    const finalAiEnabled = propAiEnabled ?? config.aiAnalysisEnabled;
    // State management
    const [activeTab, setActiveTab] = (0, react_1.useState)(defaultTab);
    const [isDragOver, setIsDragOver] = (0, react_1.useState)(false);
    const [selectedFile, setSelectedFile] = (0, react_1.useState)(null);
    const [textContent, setTextContent] = (0, react_1.useState)('');
    const [validationError, setValidationError] = (0, react_1.useState)(null);
    const [aiEnabled, setAiEnabled] = (0, react_1.useState)(finalAiEnabled);
    const [isAnalyzing, setIsAnalyzing] = (0, react_1.useState)(false);
    // Refs
    const fileInputRef = (0, react_1.useRef)(null);
    const uploadAreaRef = (0, react_1.useRef)(null);
    // Handle AI toggle
    const handleAiToggle = (0, react_1.useCallback)((enabled) => {
        setAiEnabled(enabled);
        onAiToggle?.(enabled);
    }, [onAiToggle]);
    // File validation function
    const validateFile = (0, react_1.useCallback)((file) => {
        // Check file size
        if (file.size > finalMaxFileSize * 1024 * 1024) {
            return `File size exceeds ${finalMaxFileSize}MB limit`;
        }
        // Check file type
        const isAllowed = finalAllowedTypes.some(type => {
            if (type.includes('*')) {
                return file.type.startsWith(type.replace('*', ''));
            }
            return file.type === type;
        });
        if (!isAllowed) {
            return `File type "${file.type}" is not supported`;
        }
        // Check filename for security
        if (file.name.includes('..') || file.name.includes('/') || file.name.includes('\\')) {
            return 'Invalid filename detected';
        }
        return null;
    }, [finalAllowedTypes, finalMaxFileSize]);
    // AI Analysis function
    const performAiAnalysis = (0, react_1.useCallback)(async (file) => {
        if (!aiEnabled || !onAiAnalysisComplete)
            return;
        setIsAnalyzing(true);
        try {
            // Create FormData for AI analysis
            const formData = new FormData();
            formData.append('document', file);
            formData.append('formType', formType);
            if (uploadContext) {
                formData.append('uploadContext', JSON.stringify(uploadContext));
            }
            // Make AI analysis request
            const response = await fetch('/api/ai/analyze-document', {
                method: 'POST',
                body: formData,
                credentials: 'include'
            });
            if (response.ok) {
                const result = await response.json();
                onAiAnalysisComplete(result);
            }
        }
        catch (error) {
            console.error('AI analysis failed:', error);
        }
        finally {
            setIsAnalyzing(false);
        }
    }, [aiEnabled, onAiAnalysisComplete, formType, uploadContext]);
    // Process and validate file
    const processFile = (0, react_1.useCallback)((file) => {
        const error = validateFile(file);
        if (error) {
            setValidationError(error);
            return;
        }
        setValidationError(null);
        const isImage = file.type.startsWith('image/');
        const filePreview = {
            file,
            type: isImage ? 'image' : 'document'
        };
        if (isImage) {
            filePreview.preview = URL.createObjectURL(file);
        }
        setSelectedFile(filePreview);
        onDocumentChange(file, null);
        // Trigger AI analysis if enabled
        if (aiEnabled) {
            performAiAnalysis(file);
        }
    }, [validateFile, onDocumentChange, aiEnabled, performAiAnalysis]);
    // Handle file selection from input
    const handleFileSelect = (0, react_1.useCallback)((e) => {
        const file = e.target.files?.[0];
        if (file) {
            processFile(file);
        }
        // Reset input to allow selecting the same file again
        e.target.value = '';
    }, [processFile]);
    // Handle drag and drop
    const handleDragOver = (0, react_1.useCallback)((e) => {
        e.preventDefault();
        e.stopPropagation();
        if (!disabled) {
            setIsDragOver(true);
        }
    }, [disabled]);
    const handleDragLeave = (0, react_1.useCallback)((e) => {
        e.preventDefault();
        e.stopPropagation();
        setIsDragOver(false);
    }, []);
    const handleDrop = (0, react_1.useCallback)((e) => {
        e.preventDefault();
        e.stopPropagation();
        setIsDragOver(false);
        if (disabled)
            return;
        const files = Array.from(e.dataTransfer.files);
        if (files.length > 0) {
            processFile(files[0]); // Only handle first file
        }
    }, [disabled, processFile]);
    // Handle clipboard paste for screenshots
    const handlePaste = (0, react_1.useCallback)((e) => {
        if (disabled || activeTab !== 'file')
            return;
        const items = e.clipboardData?.items;
        if (!items)
            return;
        for (let i = 0; i < items.length; i++) {
            const item = items[i];
            if (item.type.indexOf('image') !== -1) {
                const blob = item.getAsFile();
                if (blob) {
                    e.preventDefault();
                    // Create proper File object for pasted images
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                    const file = new lucide_react_1.File([blob], `screenshot-${timestamp}.png`, {
                        type: 'image/png'
                    });
                    processFile(file);
                    break;
                }
            }
        }
    }, [disabled, activeTab, processFile]);
    // Set up paste event listener
    (0, react_1.useEffect)(() => {
        if (activeTab === 'file' && !disabled) {
            document.addEventListener('paste', handlePaste);
            return () => document.removeEventListener('paste', handlePaste);
        }
    }, [activeTab, disabled, handlePaste]);
    // Handle text content changes
    const handleTextChange = (0, react_1.useCallback)((e) => {
        const text = e.target.value;
        setTextContent(text);
        onDocumentChange(null, text || null);
    }, [onDocumentChange]);
    // Remove selected file
    const handleRemoveFile = (0, react_1.useCallback)(() => {
        if (selectedFile?.preview) {
            URL.revokeObjectURL(selectedFile.preview);
        }
        setSelectedFile(null);
        setValidationError(null);
        onDocumentChange(null, null);
    }, [selectedFile, onDocumentChange]);
    // Open file dialog
    const openFileDialog = (0, react_1.useCallback)(() => {
        if (!disabled && fileInputRef.current) {
            fileInputRef.current.click();
        }
    }, [disabled]);
    // Tab change handler
    const handleTabChange = (0, react_1.useCallback)((value) => {
        setActiveTab(value);
        // Clear current selection when switching tabs
        if (selectedFile) {
            handleRemoveFile();
        }
        if (textContent) {
            setTextContent('');
            onDocumentChange(null, null);
        }
    }, [selectedFile, textContent, handleRemoveFile, onDocumentChange]);
    // Clean up preview URLs on unmount
    (0, react_1.useEffect)(() => {
        return () => {
            if (selectedFile?.preview) {
                URL.revokeObjectURL(selectedFile.preview);
            }
        };
    }, [selectedFile]);
    const formatFileSize = (bytes) => {
        const kb = bytes / 1024;
        if (kb < 1024)
            return `${kb.toFixed(1)} KB`;
        const mb = kb / 1024;
        return `${mb.toFixed(1)} MB`;
    };
    return ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("w-full", className), children: [showAiToggle && config.aiAnalysisEnabled !== undefined && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg mb-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Sparkles, { className: "w-4 h-4 text-purple-500" }), (0, jsx_runtime_1.jsx)(label_1.Label, { htmlFor: "ai-toggle", className: "text-sm font-medium", children: "AI Analysis" }), aiEnabled && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", className: "text-xs", children: "Enabled" }))] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(switch_1.Switch, { id: "ai-toggle", checked: aiEnabled, onCheckedChange: handleAiToggle, disabled: disabled, "data-testid": "switch-ai-analysis" }), isAnalyzing && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600" }), "Analyzing..."] }))] })] })), (0, jsx_runtime_1.jsxs)(tabs_1.Tabs, { value: activeTab, onValueChange: handleTabChange, className: "w-full", children: [(0, jsx_runtime_1.jsxs)(tabs_1.TabsList, { className: "grid w-full grid-cols-2", children: [(0, jsx_runtime_1.jsx)(tabs_1.TabsTrigger, { value: "file", "data-testid": "tab-upload-file", children: "\uD83D\uDCC1 Upload File" }), (0, jsx_runtime_1.jsx)(tabs_1.TabsTrigger, { value: "text", "data-testid": "tab-text-document", children: "\uD83D\uDCDD Text Document" })] }), (0, jsx_runtime_1.jsxs)(tabs_1.TabsContent, { value: "file", className: "space-y-4", children: [(0, jsx_runtime_1.jsx)("input", { ref: fileInputRef, type: "file", accept: finalAllowedTypes.join(','), capture: "environment" // Mobile camera integration for rear camera
                                , onChange: handleFileSelect, className: "hidden", disabled: disabled, "data-testid": "file-input-mobile" }), (0, jsx_runtime_1.jsx)("div", { ref: uploadAreaRef, onDragOver: handleDragOver, onDragLeave: handleDragLeave, onDrop: handleDrop, onClick: openFileDialog, className: (0, utils_1.cn)("relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors min-h-[120px] flex flex-col justify-center items-center", isDragOver
                                    ? "border-blue-500 bg-blue-50 dark:bg-blue-950"
                                    : "border-gray-300 hover:border-gray-400 dark:border-gray-600 dark:hover:border-gray-500", disabled && "cursor-not-allowed opacity-50"), "data-testid": "upload-area", children: selectedFile ? (
                                // File preview
                                (0, jsx_runtime_1.jsxs)("div", { className: "w-full space-y-3", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg", children: [selectedFile.type === 'image' && selectedFile.preview ? ((0, jsx_runtime_1.jsx)("img", { src: selectedFile.preview, alt: "Preview", className: "w-12 h-12 object-cover rounded" })) : selectedFile.type === 'image' ? ((0, jsx_runtime_1.jsx)(lucide_react_1.Image, { className: "w-12 h-12 text-gray-400" })) : ((0, jsx_runtime_1.jsx)(lucide_react_1.File, { className: "w-12 h-12 text-gray-400" })), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 min-w-0 text-left", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-900 dark:text-gray-100 truncate", children: selectedFile.file.name }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500 dark:text-gray-400", children: formatFileSize(selectedFile.file.size) })] }), (0, jsx_runtime_1.jsx)("button", { onClick: (e) => {
                                                        e.stopPropagation();
                                                        handleRemoveFile();
                                                    }, className: "p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded", disabled: disabled, "data-testid": "remove-file-button", children: (0, jsx_runtime_1.jsx)(lucide_react_1.X, { className: "w-4 h-4 text-gray-500" }) })] }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-green-600 dark:text-green-400", children: "\u2713 File ready for upload" })] })) : (
                                // Upload prompt
                                (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-center space-x-2 mb-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Upload, { className: "h-8 w-8 text-gray-400" }), (0, jsx_runtime_1.jsx)(lucide_react_1.Camera, { className: "h-6 w-6 text-blue-500" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: "Drop files here or click to browse" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-500 dark:text-gray-400", children: "\uD83D\uDCF1 On mobile: Tap to use camera or select from gallery" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-500 dark:text-gray-400", children: "\uD83D\uDCBB On desktop: Drag & drop, click to browse, or paste screenshots (Ctrl+V)" }), (0, jsx_runtime_1.jsxs)("p", { className: "text-xs text-gray-400 dark:text-gray-500", children: ["Maximum ", finalMaxFileSize, "MB \u2022 ", finalAllowedTypes.map(type => {
                                                            if (type.includes('image'))
                                                                return 'Images';
                                                            if (type.includes('pdf'))
                                                                return 'PDF';
                                                            if (type.includes('word'))
                                                                return 'DOCX';
                                                            if (type.includes('excel') || type.includes('sheet'))
                                                                return 'XLSX';
                                                            return type.split('/').pop()?.toUpperCase();
                                                        }).filter(Boolean).join(', ')] }), aiEnabled && ((0, jsx_runtime_1.jsx)("p", { className: "text-xs text-purple-500 dark:text-purple-400 mt-1", children: "\u2728 AI analysis will extract key information automatically" }))] })] })) }), validationError && ((0, jsx_runtime_1.jsx)("div", { className: "p-3 bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg", children: (0, jsx_runtime_1.jsxs)("p", { className: "text-sm text-red-600 dark:text-red-400", children: ["\u274C ", validationError] }) }))] }), (0, jsx_runtime_1.jsx)(tabs_1.TabsContent, { value: "text", className: "space-y-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)(label_1.Label, { htmlFor: "text-content", className: "text-sm font-medium", children: "Document Content" }), (0, jsx_runtime_1.jsx)(textarea_1.Textarea, { id: "text-content", placeholder: "Enter your document content here...", value: textContent, onChange: handleTextChange, disabled: disabled, rows: 8, className: "resize-none", "data-testid": "textarea-document-content" }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500 dark:text-gray-400", children: "Create a text-only document entry. You can add formatting and additional details later." })] }) })] })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvZG9jdW1lbnQtbWFuYWdlbWVudC9TaGFyZWRVcGxvYWRlci50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnREEsd0NBc2JDOztBQXRlRCwrQ0FBd0U7QUFDeEUsK0NBQWtGO0FBQ2xGLHVDQUFpQztBQUNqQywrQ0FBZ0Y7QUFDaEYsdURBQW9EO0FBQ3BELGlEQUE4QztBQUM5QyxtREFBZ0Q7QUFDaEQsaURBQThDO0FBQzlDLGdFQUF3RztBQXlCeEcsTUFBTSxxQkFBcUIsR0FBRztJQUM1QixpQkFBaUI7SUFDakIsb0JBQW9CO0lBQ3BCLHlFQUF5RTtJQUN6RSwwQkFBMEI7SUFDMUIsbUVBQW1FO0lBQ25FLFlBQVk7SUFDWixXQUFXO0lBQ1gsV0FBVztDQUNaLENBQUM7QUFFRjs7O0dBR0c7QUFDSCxTQUFnQixjQUFjLENBQUMsRUFDN0IsZ0JBQWdCLEVBQ2hCLGdCQUFnQixFQUNoQixXQUFXLEVBQ1gsUUFBUSxHQUFHLEtBQUssRUFDaEIsU0FBUyxFQUNULFVBQVUsR0FBRyxNQUFNO0FBQ25CLHVCQUF1QjtBQUN2QixRQUFRLEdBQUcsV0FBVyxFQUN0QixhQUFhLEVBQ2IsaUJBQWlCLEVBQUUsYUFBYSxFQUNoQyxVQUFVLEVBQ1Ysb0JBQW9CLEVBQ3BCLFlBQVksR0FBRyxJQUFJLEVBQ25CLGFBQWEsRUFDTztJQUNwQix1Q0FBdUM7SUFDdkMsTUFBTSxNQUFNLEdBQUcsSUFBQSwrQkFBZSxFQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3pDLE1BQU0saUJBQWlCLEdBQUcsZ0JBQWdCLElBQUksTUFBTSxDQUFDLGdCQUFnQixDQUFDO0lBQ3RFLE1BQU0sZ0JBQWdCLEdBQUcsV0FBVyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDM0QsTUFBTSxjQUFjLEdBQUcsYUFBYSxJQUFJLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQztJQUVqRSxtQkFBbUI7SUFDbkIsTUFB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QUFHLFNBQVMsRUFBQywwQ0FBMEMsd0dBRW5ELElBQ0EsR0FDTSxJQUNULElBQ0gsQ0FDUCxDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL2NsaWVudC9zcmMvY29tcG9uZW50cy9kb2N1bWVudC1tYW5hZ2VtZW50L1NoYXJlZFVwbG9hZGVyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZVJlZiwgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFVwbG9hZCwgWCwgRmlsZSwgSW1hZ2UsIEZpbGVUZXh0LCBDYW1lcmEsIFNwYXJrbGVzIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCB7IGNuIH0gZnJvbSAnQC9saWIvdXRpbHMnO1xuaW1wb3J0IHsgVGFicywgVGFic0NvbnRlbnQsIFRhYnNMaXN0LCBUYWJzVHJpZ2dlciB9IGZyb20gJ0AvY29tcG9uZW50cy91aS90YWJzJztcbmltcG9ydCB7IFRleHRhcmVhIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3RleHRhcmVhJztcbmltcG9ydCB7IExhYmVsIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2xhYmVsJztcbmltcG9ydCB7IFN3aXRjaCB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9zd2l0Y2gnO1xuaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYmFkZ2UnO1xuaW1wb3J0IHsgZ2V0VXBsb2FkQ29uZmlnLCBpc0FpQW5hbHlzaXNFbmFibGVkLCB0eXBlIFVwbG9hZENvbnRleHQgfSBmcm9tICdAc2hhcmVkL2NvbmZpZy91cGxvYWQtY29uZmlnJztcblxuaW50ZXJmYWNlIFNoYXJlZFVwbG9hZGVyUHJvcHMge1xuICBvbkRvY3VtZW50Q2hhbmdlOiAoZmlsZTogRmlsZSB8IG51bGwsIHRleHQ6IHN0cmluZyB8IG51bGwpID0+IHZvaWQ7XG4gIGFsbG93ZWRGaWxlVHlwZXM/OiBzdHJpbmdbXTtcbiAgbWF4RmlsZVNpemU/OiBudW1iZXI7IC8vIGluIE1CXG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICBkZWZhdWx0VGFiPzogJ2ZpbGUnIHwgJ3RleHQnO1xuICAvLyBBSSBFbmhhbmNlbWVudCBQcm9wc1xuICBmb3JtVHlwZT86IHN0cmluZztcbiAgdXBsb2FkQ29udGV4dD86IFVwbG9hZENvbnRleHQ7XG4gIGFpQW5hbHlzaXNFbmFibGVkPzogYm9vbGVhbjtcbiAgb25BaVRvZ2dsZT86IChlbmFibGVkOiBib29sZWFuKSA9PiB2b2lkO1xuICBvbkFpQW5hbHlzaXNDb21wbGV0ZT86IChkYXRhOiBhbnkpID0+IHZvaWQ7XG4gIHNob3dBaVRvZ2dsZT86IGJvb2xlYW47XG4gIGNvbnRleHRGaWVsZHM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5pbnRlcmZhY2UgRmlsZVByZXZpZXcge1xuICBmaWxlOiBGaWxlO1xuICBwcmV2aWV3Pzogc3RyaW5nO1xuICB0eXBlOiAnaW1hZ2UnIHwgJ2RvY3VtZW50Jztcbn1cblxuY29uc3QgREVGQVVMVF9BTExPV0VEX1RZUEVTID0gW1xuICAnYXBwbGljYXRpb24vcGRmJyxcbiAgJ2FwcGxpY2F0aW9uL21zd29yZCcsXG4gICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCcsXG4gICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLFxuICAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnLFxuICAnaW1hZ2UvanBlZycsXG4gICdpbWFnZS9qcGcnLFxuICAnaW1hZ2UvcG5nJ1xuXTtcblxuLyoqXG4gKiBTaGFyZWRVcGxvYWRlciAtIEEgcmV1c2FibGUgY29tcG9uZW50IGZvciBmaWxlIHVwbG9hZHMgYW5kIHRleHQgY3JlYXRpb25cbiAqIEZlYXR1cmVzIG1vYmlsZSBjYW1lcmEgaW50ZWdyYXRpb24sIGRyYWctYW5kLWRyb3AsIGNsaXBib2FyZCBwYXN0ZSwgYW5kIHRleHQgaW5wdXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIFNoYXJlZFVwbG9hZGVyKHtcbiAgb25Eb2N1bWVudENoYW5nZSxcbiAgYWxsb3dlZEZpbGVUeXBlcyxcbiAgbWF4RmlsZVNpemUsXG4gIGRpc2FibGVkID0gZmFsc2UsXG4gIGNsYXNzTmFtZSxcbiAgZGVmYXVsdFRhYiA9ICdmaWxlJyxcbiAgLy8gQUkgRW5oYW5jZW1lbnQgUHJvcHNcbiAgZm9ybVR5cGUgPSAnZG9jdW1lbnRzJyxcbiAgdXBsb2FkQ29udGV4dCxcbiAgYWlBbmFseXNpc0VuYWJsZWQ6IHByb3BBaUVuYWJsZWQsXG4gIG9uQWlUb2dnbGUsXG4gIG9uQWlBbmFseXNpc0NvbXBsZXRlLFxuICBzaG93QWlUb2dnbGUgPSB0cnVlLFxuICBjb250ZXh0RmllbGRzXG59OiBTaGFyZWRVcGxvYWRlclByb3BzKSB7XG4gIC8vIEdldCBjb25maWd1cmF0aW9uIGZyb20gdXBsb2FkIGNvbmZpZ1xuICBjb25zdCBjb25maWcgPSBnZXRVcGxvYWRDb25maWcoZm9ybVR5cGUpO1xuICBjb25zdCBmaW5hbEFsbG93ZWRUeXBlcyA9IGFsbG93ZWRGaWxlVHlwZXMgfHwgY29uZmlnLmFsbG93ZWRGaWxlVHlwZXM7XG4gIGNvbnN0IGZpbmFsTWF4RmlsZVNpemUgPSBtYXhGaWxlU2l6ZSB8fCBjb25maWcubWF4RmlsZVNpemU7XG4gIGNvbnN0IGZpbmFsQWlFbmFibGVkID0gcHJvcEFpRW5hYmxlZCA/PyBjb25maWcuYWlBbmFseXNpc0VuYWJsZWQ7XG5cbiAgLy8gU3RhdGUgbWFuYWdlbWVudFxuICBjb25zdCBbYWN0aXZlVGFiLCBzZXRBY3RpdmVUYWJdID0gdXNlU3RhdGUoZGVmYXVsdFRhYik7XG4gIGNvbnN0IFtpc0RyYWdPdmVyLCBzZXRJc0RyYWdPdmVyXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3NlbGVjdGVkRmlsZSwgc2V0U2VsZWN0ZWRGaWxlXSA9IHVzZVN0YXRlPEZpbGVQcmV2aWV3IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFt0ZXh0Q29udGVudCwgc2V0VGV4dENvbnRlbnRdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbdmFsaWRhdGlvbkVycm9yLCBzZXRWYWxpZGF0aW9uRXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFthaUVuYWJsZWQsIHNldEFpRW5hYmxlZF0gPSB1c2VTdGF0ZShmaW5hbEFpRW5hYmxlZCk7XG4gIGNvbnN0IFtpc0FuYWx5emluZywgc2V0SXNBbmFseXppbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIFJlZnNcbiAgY29uc3QgZmlsZUlucHV0UmVmID0gdXNlUmVmPEhUTUxJbnB1dEVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCB1cGxvYWRBcmVhUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcblxuICAvLyBIYW5kbGUgQUkgdG9nZ2xlXG4gIGNvbnN0IGhhbmRsZUFpVG9nZ2xlID0gdXNlQ2FsbGJhY2soKGVuYWJsZWQ6IGJvb2xlYW4pID0+IHtcbiAgICBzZXRBaUVuYWJsZWQoZW5hYmxlZCk7XG4gICAgb25BaVRvZ2dsZT8uKGVuYWJsZWQpO1xuICB9LCBbb25BaVRvZ2dsZV0pO1xuXG4gIC8vIEZpbGUgdmFsaWRhdGlvbiBmdW5jdGlvblxuICBjb25zdCB2YWxpZGF0ZUZpbGUgPSB1c2VDYWxsYmFjaygoZmlsZTogRmlsZSk6IHN0cmluZyB8IG51bGwgPT4ge1xuICAgIC8vIENoZWNrIGZpbGUgc2l6ZVxuICAgIGlmIChmaWxlLnNpemUgPiBmaW5hbE1heEZpbGVTaXplICogMTAyNCAqIDEwMjQpIHtcbiAgICAgIHJldHVybiBgRmlsZSBzaXplIGV4Y2VlZHMgJHtmaW5hbE1heEZpbGVTaXplfU1CIGxpbWl0YDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmaWxlIHR5cGVcbiAgICBjb25zdCBpc0FsbG93ZWQgPSBmaW5hbEFsbG93ZWRUeXBlcy5zb21lKHR5cGUgPT4ge1xuICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoJyonKSkge1xuICAgICAgICByZXR1cm4gZmlsZS50eXBlLnN0YXJ0c1dpdGgodHlwZS5yZXBsYWNlKCcqJywgJycpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWxlLnR5cGUgPT09IHR5cGU7XG4gICAgfSk7XG5cbiAgICBpZiAoIWlzQWxsb3dlZCkge1xuICAgICAgcmV0dXJuIGBGaWxlIHR5cGUgXCIke2ZpbGUudHlwZX1cIiBpcyBub3Qgc3VwcG9ydGVkYDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmaWxlbmFtZSBmb3Igc2VjdXJpdHlcbiAgICBpZiAoZmlsZS5uYW1lLmluY2x1ZGVzKCcuLicpIHx8IGZpbGUubmFtZS5pbmNsdWRlcygnLycpIHx8IGZpbGUubmFtZS5pbmNsdWRlcygnXFxcXCcpKSB7XG4gICAgICByZXR1cm4gJ0ludmFsaWQgZmlsZW5hbWUgZGV0ZWN0ZWQnO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9LCBbZmluYWxBbGxvd2VkVHlwZXMsIGZpbmFsTWF4RmlsZVNpemVdKTtcblxuICAvLyBBSSBBbmFseXNpcyBmdW5jdGlvblxuICBjb25zdCBwZXJmb3JtQWlBbmFseXNpcyA9IHVzZUNhbGxiYWNrKGFzeW5jIChmaWxlOiBGaWxlKSA9PiB7XG4gICAgaWYgKCFhaUVuYWJsZWQgfHwgIW9uQWlBbmFseXNpc0NvbXBsZXRlKSByZXR1cm47XG4gICAgXG4gICAgc2V0SXNBbmFseXppbmcodHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENyZWF0ZSBGb3JtRGF0YSBmb3IgQUkgYW5hbHlzaXNcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2RvY3VtZW50JywgZmlsZSk7XG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2Zvcm1UeXBlJywgZm9ybVR5cGUpO1xuICAgICAgXG4gICAgICBpZiAodXBsb2FkQ29udGV4dCkge1xuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VwbG9hZENvbnRleHQnLCBKU09OLnN0cmluZ2lmeSh1cGxvYWRDb250ZXh0KSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE1ha2UgQUkgYW5hbHlzaXMgcmVxdWVzdFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9haS9hbmFseXplLWRvY3VtZW50Jywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZSdcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBvbkFpQW5hbHlzaXNDb21wbGV0ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBSSBhbmFseXNpcyBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0FuYWx5emluZyhmYWxzZSk7XG4gICAgfVxuICB9LCBbYWlFbmFibGVkLCBvbkFpQW5hbHlzaXNDb21wbGV0ZSwgZm9ybVR5cGUsIHVwbG9hZENvbnRleHRdKTtcblxuICAvLyBQcm9jZXNzIGFuZCB2YWxpZGF0ZSBmaWxlXG4gIGNvbnN0IHByb2Nlc3NGaWxlID0gdXNlQ2FsbGJhY2soKGZpbGU6IEZpbGUpOiB2b2lkID0+IHtcbiAgICBjb25zdCBlcnJvciA9IHZhbGlkYXRlRmlsZShmaWxlKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHNldFZhbGlkYXRpb25FcnJvcihlcnJvcik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2V0VmFsaWRhdGlvbkVycm9yKG51bGwpO1xuICAgIGNvbnN0IGlzSW1hZ2UgPSBmaWxlLnR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJyk7XG4gICAgXG4gICAgY29uc3QgZmlsZVByZXZpZXc6IEZpbGVQcmV2aWV3ID0ge1xuICAgICAgZmlsZSxcbiAgICAgIHR5cGU6IGlzSW1hZ2UgPyAnaW1hZ2UnIDogJ2RvY3VtZW50J1xuICAgIH07XG5cbiAgICBpZiAoaXNJbWFnZSkge1xuICAgICAgZmlsZVByZXZpZXcucHJldmlldyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XG4gICAgfVxuXG4gICAgc2V0U2VsZWN0ZWRGaWxlKGZpbGVQcmV2aWV3KTtcbiAgICBvbkRvY3VtZW50Q2hhbmdlKGZpbGUsIG51bGwpO1xuICAgIFxuICAgIC8vIFRyaWdnZXIgQUkgYW5hbHlzaXMgaWYgZW5hYmxlZFxuICAgIGlmIChhaUVuYWJsZWQpIHtcbiAgICAgIHBlcmZvcm1BaUFuYWx5c2lzKGZpbGUpO1xuICAgIH1cbiAgfSwgW3ZhbGlkYXRlRmlsZSwgb25Eb2N1bWVudENoYW5nZSwgYWlFbmFibGVkLCBwZXJmb3JtQWlBbmFseXNpc10pO1xuXG4gIC8vIEhhbmRsZSBmaWxlIHNlbGVjdGlvbiBmcm9tIGlucHV0XG4gIGNvbnN0IGhhbmRsZUZpbGVTZWxlY3QgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICBjb25zdCBmaWxlID0gZS50YXJnZXQuZmlsZXM/LlswXTtcbiAgICBpZiAoZmlsZSkge1xuICAgICAgcHJvY2Vzc0ZpbGUoZmlsZSk7XG4gICAgfVxuICAgIC8vIFJlc2V0IGlucHV0IHRvIGFsbG93IHNlbGVjdGluZyB0aGUgc2FtZSBmaWxlIGFnYWluXG4gICAgZS50YXJnZXQudmFsdWUgPSAnJztcbiAgfSwgW3Byb2Nlc3NGaWxlXSk7XG5cbiAgLy8gSGFuZGxlIGRyYWcgYW5kIGRyb3BcbiAgY29uc3QgaGFuZGxlRHJhZ092ZXIgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuRHJhZ0V2ZW50KSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgaWYgKCFkaXNhYmxlZCkge1xuICAgICAgc2V0SXNEcmFnT3Zlcih0cnVlKTtcbiAgICB9XG4gIH0sIFtkaXNhYmxlZF0pO1xuXG4gIGNvbnN0IGhhbmRsZURyYWdMZWF2ZSA9IHVzZUNhbGxiYWNrKChlOiBSZWFjdC5EcmFnRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBzZXRJc0RyYWdPdmVyKGZhbHNlKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IGhhbmRsZURyb3AgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuRHJhZ0V2ZW50KSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgc2V0SXNEcmFnT3ZlcihmYWxzZSk7XG5cbiAgICBpZiAoZGlzYWJsZWQpIHJldHVybjtcblxuICAgIGNvbnN0IGZpbGVzID0gQXJyYXkuZnJvbShlLmRhdGFUcmFuc2Zlci5maWxlcyk7XG4gICAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHByb2Nlc3NGaWxlKGZpbGVzWzBdKTsgLy8gT25seSBoYW5kbGUgZmlyc3QgZmlsZVxuICAgIH1cbiAgfSwgW2Rpc2FibGVkLCBwcm9jZXNzRmlsZV0pO1xuXG4gIC8vIEhhbmRsZSBjbGlwYm9hcmQgcGFzdGUgZm9yIHNjcmVlbnNob3RzXG4gIGNvbnN0IGhhbmRsZVBhc3RlID0gdXNlQ2FsbGJhY2soKGU6IENsaXBib2FyZEV2ZW50KSA9PiB7XG4gICAgaWYgKGRpc2FibGVkIHx8IGFjdGl2ZVRhYiAhPT0gJ2ZpbGUnKSByZXR1cm47XG5cbiAgICBjb25zdCBpdGVtcyA9IGUuY2xpcGJvYXJkRGF0YT8uaXRlbXM7XG4gICAgaWYgKCFpdGVtcykgcmV0dXJuO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZS5pbmRleE9mKCdpbWFnZScpICE9PSAtMSkge1xuICAgICAgICBjb25zdCBibG9iID0gaXRlbS5nZXRBc0ZpbGUoKTtcbiAgICAgICAgaWYgKGJsb2IpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgLy8gQ3JlYXRlIHByb3BlciBGaWxlIG9iamVjdCBmb3IgcGFzdGVkIGltYWdlc1xuICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7XG4gICAgICAgICAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFtibG9iXSwgYHNjcmVlbnNob3QtJHt0aW1lc3RhbXB9LnBuZ2AsIHtcbiAgICAgICAgICAgIHR5cGU6ICdpbWFnZS9wbmcnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcHJvY2Vzc0ZpbGUoZmlsZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIFtkaXNhYmxlZCwgYWN0aXZlVGFiLCBwcm9jZXNzRmlsZV0pO1xuXG4gIC8vIFNldCB1cCBwYXN0ZSBldmVudCBsaXN0ZW5lclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChhY3RpdmVUYWIgPT09ICdmaWxlJyAmJiAhZGlzYWJsZWQpIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgaGFuZGxlUGFzdGUpO1xuICAgICAgcmV0dXJuICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgaGFuZGxlUGFzdGUpO1xuICAgIH1cbiAgfSwgW2FjdGl2ZVRhYiwgZGlzYWJsZWQsIGhhbmRsZVBhc3RlXSk7XG5cbiAgLy8gSGFuZGxlIHRleHQgY29udGVudCBjaGFuZ2VzXG4gIGNvbnN0IGhhbmRsZVRleHRDaGFuZ2UgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTFRleHRBcmVhRWxlbWVudD4pID0+IHtcbiAgICBjb25zdCB0ZXh0ID0gZS50YXJnZXQudmFsdWU7XG4gICAgc2V0VGV4dENvbnRlbnQodGV4dCk7XG4gICAgb25Eb2N1bWVudENoYW5nZShudWxsLCB0ZXh0IHx8IG51bGwpO1xuICB9LCBbb25Eb2N1bWVudENoYW5nZV0pO1xuXG4gIC8vIFJlbW92ZSBzZWxlY3RlZCBmaWxlXG4gIGNvbnN0IGhhbmRsZVJlbW92ZUZpbGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKHNlbGVjdGVkRmlsZT8ucHJldmlldykge1xuICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxlY3RlZEZpbGUucHJldmlldyk7XG4gICAgfVxuICAgIHNldFNlbGVjdGVkRmlsZShudWxsKTtcbiAgICBzZXRWYWxpZGF0aW9uRXJyb3IobnVsbCk7XG4gICAgb25Eb2N1bWVudENoYW5nZShudWxsLCBudWxsKTtcbiAgfSwgW3NlbGVjdGVkRmlsZSwgb25Eb2N1bWVudENoYW5nZV0pO1xuXG4gIC8vIE9wZW4gZmlsZSBkaWFsb2dcbiAgY29uc3Qgb3BlbkZpbGVEaWFsb2cgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFkaXNhYmxlZCAmJiBmaWxlSW5wdXRSZWYuY3VycmVudCkge1xuICAgICAgZmlsZUlucHV0UmVmLmN1cnJlbnQuY2xpY2soKTtcbiAgICB9XG4gIH0sIFtkaXNhYmxlZF0pO1xuXG4gIC8vIFRhYiBjaGFuZ2UgaGFuZGxlclxuICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSB1c2VDYWxsYmFjaygodmFsdWU6IHN0cmluZykgPT4ge1xuICAgIHNldEFjdGl2ZVRhYih2YWx1ZSBhcyAnZmlsZScgfCAndGV4dCcpO1xuICAgIFxuICAgIC8vIENsZWFyIGN1cnJlbnQgc2VsZWN0aW9uIHdoZW4gc3dpdGNoaW5nIHRhYnNcbiAgICBpZiAoc2VsZWN0ZWRGaWxlKSB7XG4gICAgICBoYW5kbGVSZW1vdmVGaWxlKCk7XG4gICAgfVxuICAgIGlmICh0ZXh0Q29udGVudCkge1xuICAgICAgc2V0VGV4dENvbnRlbnQoJycpO1xuICAgICAgb25Eb2N1bWVudENoYW5nZShudWxsLCBudWxsKTtcbiAgICB9XG4gIH0sIFtzZWxlY3RlZEZpbGUsIHRleHRDb250ZW50LCBoYW5kbGVSZW1vdmVGaWxlLCBvbkRvY3VtZW50Q2hhbmdlXSk7XG5cbiAgLy8gQ2xlYW4gdXAgcHJldmlldyBVUkxzIG9uIHVubW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKHNlbGVjdGVkRmlsZT8ucHJldmlldykge1xuICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGVjdGVkRmlsZS5wcmV2aWV3KTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbc2VsZWN0ZWRGaWxlXSk7XG5cbiAgY29uc3QgZm9ybWF0RmlsZVNpemUgPSAoYnl0ZXM6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IGtiID0gYnl0ZXMgLyAxMDI0O1xuICAgIGlmIChrYiA8IDEwMjQpIHJldHVybiBgJHtrYi50b0ZpeGVkKDEpfSBLQmA7XG4gICAgY29uc3QgbWIgPSBrYiAvIDEwMjQ7XG4gICAgcmV0dXJuIGAke21iLnRvRml4ZWQoMSl9IE1CYDtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPXtjbihcInctZnVsbFwiLCBjbGFzc05hbWUpfT5cbiAgICAgIHsvKiBBSSBUb2dnbGUgU2VjdGlvbiAqL31cbiAgICAgIHtzaG93QWlUb2dnbGUgJiYgY29uZmlnLmFpQW5hbHlzaXNFbmFibGVkICE9PSB1bmRlZmluZWQgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBwLTMgYmctZ3JheS01MCBkYXJrOmJnLWdyYXktODAwIHJvdW5kZWQtbGcgbWItNFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cbiAgICAgICAgICAgIDxTcGFya2xlcyBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtcHVycGxlLTUwMFwiIC8+XG4gICAgICAgICAgICA8TGFiZWwgaHRtbEZvcj1cImFpLXRvZ2dsZVwiIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5cbiAgICAgICAgICAgICAgQUkgQW5hbHlzaXNcbiAgICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAgICB7YWlFbmFibGVkICYmIChcbiAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9XCJzZWNvbmRhcnlcIiBjbGFzc05hbWU9XCJ0ZXh0LXhzXCI+XG4gICAgICAgICAgICAgICAgRW5hYmxlZFxuICAgICAgICAgICAgICA8L0JhZGdlPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICA8U3dpdGNoXG4gICAgICAgICAgICAgIGlkPVwiYWktdG9nZ2xlXCJcbiAgICAgICAgICAgICAgY2hlY2tlZD17YWlFbmFibGVkfVxuICAgICAgICAgICAgICBvbkNoZWNrZWRDaGFuZ2U9e2hhbmRsZUFpVG9nZ2xlfVxuICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwic3dpdGNoLWFpLWFuYWx5c2lzXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB7aXNBbmFseXppbmcgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0xIHRleHQtc20gdGV4dC1ibHVlLTYwMCBkYXJrOnRleHQtYmx1ZS00MDBcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFuaW1hdGUtc3BpbiByb3VuZGVkLWZ1bGwgaC0zIHctMyBib3JkZXItYi0yIGJvcmRlci1ibHVlLTYwMFwiPjwvZGl2PlxuICAgICAgICAgICAgICAgIEFuYWx5emluZy4uLlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgPFRhYnMgdmFsdWU9e2FjdGl2ZVRhYn0gb25WYWx1ZUNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBjbGFzc05hbWU9XCJ3LWZ1bGxcIj5cbiAgICAgICAgPFRhYnNMaXN0IGNsYXNzTmFtZT1cImdyaWQgdy1mdWxsIGdyaWQtY29scy0yXCI+XG4gICAgICAgICAgPFRhYnNUcmlnZ2VyIHZhbHVlPVwiZmlsZVwiIGRhdGEtdGVzdGlkPVwidGFiLXVwbG9hZC1maWxlXCI+XG4gICAgICAgICAgICDwn5OBIFVwbG9hZCBGaWxlXG4gICAgICAgICAgPC9UYWJzVHJpZ2dlcj5cbiAgICAgICAgICA8VGFic1RyaWdnZXIgdmFsdWU9XCJ0ZXh0XCIgZGF0YS10ZXN0aWQ9XCJ0YWItdGV4dC1kb2N1bWVudFwiPlxuICAgICAgICAgICAg8J+TnSBUZXh0IERvY3VtZW50XG4gICAgICAgICAgPC9UYWJzVHJpZ2dlcj5cbiAgICAgICAgPC9UYWJzTGlzdD5cblxuICAgICAgICB7LyogRmlsZSBVcGxvYWQgVGFiICovfVxuICAgICAgICA8VGFic0NvbnRlbnQgdmFsdWU9XCJmaWxlXCIgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgey8qIEhpZGRlbiBmaWxlIGlucHV0IHdpdGggbW9iaWxlIGNhbWVyYSBpbnRlZ3JhdGlvbiAqL31cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIHJlZj17ZmlsZUlucHV0UmVmfVxuICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICAgICAgYWNjZXB0PXtmaW5hbEFsbG93ZWRUeXBlcy5qb2luKCcsJyl9XG4gICAgICAgICAgICBjYXB0dXJlPVwiZW52aXJvbm1lbnRcIiAvLyBNb2JpbGUgY2FtZXJhIGludGVncmF0aW9uIGZvciByZWFyIGNhbWVyYVxuICAgICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUZpbGVTZWxlY3R9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJoaWRkZW5cIlxuICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJmaWxlLWlucHV0LW1vYmlsZVwiXG4gICAgICAgICAgLz5cblxuICAgICAgICAgIHsvKiBVcGxvYWQgYXJlYSB3aXRoIGRyYWctYW5kLWRyb3AgKi99XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgcmVmPXt1cGxvYWRBcmVhUmVmfVxuICAgICAgICAgICAgb25EcmFnT3Zlcj17aGFuZGxlRHJhZ092ZXJ9XG4gICAgICAgICAgICBvbkRyYWdMZWF2ZT17aGFuZGxlRHJhZ0xlYXZlfVxuICAgICAgICAgICAgb25Ecm9wPXtoYW5kbGVEcm9wfVxuICAgICAgICAgICAgb25DbGljaz17b3BlbkZpbGVEaWFsb2d9XG4gICAgICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgICAgICBcInJlbGF0aXZlIGJvcmRlci0yIGJvcmRlci1kYXNoZWQgcm91bmRlZC1sZyBwLTYgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXIgdHJhbnNpdGlvbi1jb2xvcnMgbWluLWgtWzEyMHB4XSBmbGV4IGZsZXgtY29sIGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlclwiLFxuICAgICAgICAgICAgICBpc0RyYWdPdmVyXG4gICAgICAgICAgICAgICAgPyBcImJvcmRlci1ibHVlLTUwMCBiZy1ibHVlLTUwIGRhcms6YmctYmx1ZS05NTBcIlxuICAgICAgICAgICAgICAgIDogXCJib3JkZXItZ3JheS0zMDAgaG92ZXI6Ym9yZGVyLWdyYXktNDAwIGRhcms6Ym9yZGVyLWdyYXktNjAwIGRhcms6aG92ZXI6Ym9yZGVyLWdyYXktNTAwXCIsXG4gICAgICAgICAgICAgIGRpc2FibGVkICYmIFwiY3Vyc29yLW5vdC1hbGxvd2VkIG9wYWNpdHktNTBcIlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwidXBsb2FkLWFyZWFcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtzZWxlY3RlZEZpbGUgPyAoXG4gICAgICAgICAgICAgIC8vIEZpbGUgcHJldmlld1xuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCBzcGFjZS15LTNcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0zIHAtMyBiZy1ncmF5LTUwIGRhcms6YmctZ3JheS04MDAgcm91bmRlZC1sZ1wiPlxuICAgICAgICAgICAgICAgICAge3NlbGVjdGVkRmlsZS50eXBlID09PSAnaW1hZ2UnICYmIHNlbGVjdGVkRmlsZS5wcmV2aWV3ID8gKFxuICAgICAgICAgICAgICAgICAgICA8aW1nXG4gICAgICAgICAgICAgICAgICAgICAgc3JjPXtzZWxlY3RlZEZpbGUucHJldmlld31cbiAgICAgICAgICAgICAgICAgICAgICBhbHQ9XCJQcmV2aWV3XCJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEyIGgtMTIgb2JqZWN0LWNvdmVyIHJvdW5kZWRcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKSA6IHNlbGVjdGVkRmlsZS50eXBlID09PSAnaW1hZ2UnID8gKFxuICAgICAgICAgICAgICAgICAgICA8SW1hZ2UgY2xhc3NOYW1lPVwidy0xMiBoLTEyIHRleHQtZ3JheS00MDBcIiAvPlxuICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPEZpbGUgY2xhc3NOYW1lPVwidy0xMiBoLTEyIHRleHQtZ3JheS00MDBcIiAvPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgbWluLXctMCB0ZXh0LWxlZnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMCB0cnVuY2F0ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZEZpbGUuZmlsZS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0RmlsZVNpemUoc2VsZWN0ZWRGaWxlLmZpbGUuc2l6ZSl9XG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVSZW1vdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInAtMSBob3ZlcjpiZy1ncmF5LTIwMCBkYXJrOmhvdmVyOmJnLWdyYXktNzAwIHJvdW5kZWRcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwicmVtb3ZlLWZpbGUtYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFggY2xhc3NOYW1lPVwidy00IGgtNCB0ZXh0LWdyYXktNTAwXCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmVlbi02MDAgZGFyazp0ZXh0LWdyZWVuLTQwMFwiPlxuICAgICAgICAgICAgICAgICAg4pyTIEZpbGUgcmVhZHkgZm9yIHVwbG9hZFxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAvLyBVcGxvYWQgcHJvbXB0XG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBzcGFjZS14LTIgbWItM1wiPlxuICAgICAgICAgICAgICAgICAgPFVwbG9hZCBjbGFzc05hbWU9XCJoLTggdy04IHRleHQtZ3JheS00MDBcIiAvPlxuICAgICAgICAgICAgICAgICAgPENhbWVyYSBjbGFzc05hbWU9XCJoLTYgdy02IHRleHQtYmx1ZS01MDBcIiAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtbWVkaXVtIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwXCI+XG4gICAgICAgICAgICAgICAgICAgIERyb3AgZmlsZXMgaGVyZSBvciBjbGljayB0byBicm93c2VcbiAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDBcIj5cbiAgICAgICAgICAgICAgICAgICAg8J+TsSBPbiBtb2JpbGU6IFRhcCB0byB1c2UgY2FtZXJhIG9yIHNlbGVjdCBmcm9tIGdhbGxlcnlcbiAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDBcIj5cbiAgICAgICAgICAgICAgICAgICAg8J+SuyBPbiBkZXNrdG9wOiBEcmFnICYgZHJvcCwgY2xpY2sgdG8gYnJvd3NlLCBvciBwYXN0ZSBzY3JlZW5zaG90cyAoQ3RybCtWKVxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LWdyYXktNDAwIGRhcms6dGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgICAgICAgICAgICBNYXhpbXVtIHtmaW5hbE1heEZpbGVTaXplfU1CIOKAoiB7ZmluYWxBbGxvd2VkVHlwZXMubWFwKHR5cGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlLmluY2x1ZGVzKCdpbWFnZScpKSByZXR1cm4gJ0ltYWdlcyc7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoJ3BkZicpKSByZXR1cm4gJ1BERic7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoJ3dvcmQnKSkgcmV0dXJuICdET0NYJztcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmNsdWRlcygnZXhjZWwnKSB8fCB0eXBlLmluY2x1ZGVzKCdzaGVldCcpKSByZXR1cm4gJ1hMU1gnO1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlLnNwbGl0KCcvJykucG9wKCk/LnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmZpbHRlcihCb29sZWFuKS5qb2luKCcsICcpfVxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAge2FpRW5hYmxlZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1wdXJwbGUtNTAwIGRhcms6dGV4dC1wdXJwbGUtNDAwIG10LTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICDinKggQUkgYW5hbHlzaXMgd2lsbCBleHRyYWN0IGtleSBpbmZvcm1hdGlvbiBhdXRvbWF0aWNhbGx5XG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiBWYWxpZGF0aW9uIGVycm9yICovfVxuICAgICAgICAgIHt2YWxpZGF0aW9uRXJyb3IgJiYgKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTMgYmctcmVkLTUwIGRhcms6YmctcmVkLTk1MCBib3JkZXIgYm9yZGVyLXJlZC0yMDAgZGFyazpib3JkZXItcmVkLTgwMCByb3VuZGVkLWxnXCI+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1yZWQtNjAwIGRhcms6dGV4dC1yZWQtNDAwXCI+4p2MIHt2YWxpZGF0aW9uRXJyb3J9PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9UYWJzQ29udGVudD5cblxuICAgICAgICB7LyogVGV4dCBEb2N1bWVudCBUYWIgKi99XG4gICAgICAgIDxUYWJzQ29udGVudCB2YWx1ZT1cInRleHRcIiBjbGFzc05hbWU9XCJzcGFjZS15LTRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAgPExhYmVsIGh0bWxGb3I9XCJ0ZXh0LWNvbnRlbnRcIiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+XG4gICAgICAgICAgICAgIERvY3VtZW50IENvbnRlbnRcbiAgICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAgICA8VGV4dGFyZWFcbiAgICAgICAgICAgICAgaWQ9XCJ0ZXh0LWNvbnRlbnRcIlxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIHlvdXIgZG9jdW1lbnQgY29udGVudCBoZXJlLi4uXCJcbiAgICAgICAgICAgICAgdmFsdWU9e3RleHRDb250ZW50fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlVGV4dENoYW5nZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICByb3dzPXs4fVxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJyZXNpemUtbm9uZVwiXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwidGV4dGFyZWEtZG9jdW1lbnQtY29udGVudFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAgICBDcmVhdGUgYSB0ZXh0LW9ubHkgZG9jdW1lbnQgZW50cnkuIFlvdSBjYW4gYWRkIGZvcm1hdHRpbmcgYW5kIGFkZGl0aW9uYWwgZGV0YWlscyBsYXRlci5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9UYWJzQ29udGVudD5cbiAgICAgIDwvVGFicz5cbiAgICA8L2Rpdj5cbiAgKTtcbn0iXSwidmVyc2lvbiI6M30=
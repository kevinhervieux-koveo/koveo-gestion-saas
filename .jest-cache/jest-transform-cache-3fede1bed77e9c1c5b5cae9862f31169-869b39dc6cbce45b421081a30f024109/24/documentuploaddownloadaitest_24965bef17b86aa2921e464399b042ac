0dd4411b26f2f7bdb452da2b8185c8ac
"use strict";
/**
 * Document Upload, Download, and AI Analysis Integration Tests
 *
 * Comprehensive testing suite for the standardized document management system
 * with AI analysis functionality. Tests validate:
 *
 * 1. Document Upload Operations
 *    - File upload with new filePath, fileName, fileSize structure
 *    - Multipart form handling
 *    - File validation and security checks
 *    - Database record creation with correct column names
 *
 * 2. Document Download Operations
 *    - Secure file serving
 *    - Access control validation
 *    - Proper headers and content disposition
 *
 * 3. AI Analysis Integration
 *    - Gemini AI document analysis
 *    - AI results storage in database
 *    - Analysis metadata handling
 *    - Error handling for AI failures
 *
 * 4. Cross-Form Document Handling
 *    - Bills document upload/download
 *    - Demands file attachments
 *    - Bug report file attachments
 *    - Feature request attachments
 *    - Document management uploads
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
globals_1.jest.mock('../../server/auth', () => ({
    requireAuth: (req, res, next) => {
        req.user = mockAuth.user;
        next();
    }
}));
globals_1.jest.mock('../../server/services/geminiService', () => ({
    geminiService: {
        analyzeDocument: globals_1.jest.fn().mockResolvedValue(mockGeminiAnalysis)
    }
}));
globals_1.jest.mock('../../server/services/gemini-bill-analyzer', () => ({
    geminiBillAnalyzer: {
        analyzeBillDocument: globals_1.jest.fn().mockResolvedValue(mockGeminiAnalysis.aiAnalysisData)
    }
}));
const supertest_1 = __importDefault(require("supertest"));
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const db_1 = require("../../server/db");
const schema_1 = require("../../shared/schema");
const drizzle_orm_1 = require("drizzle-orm");
// Mock authentication middleware
const mockAuth = {
    user: {
        id: '123e4567-e89b-12d3-a456-426614174000',
        email: 'test@koveo.com',
        role: 'admin',
        organizationId: '123e4567-e89b-12d3-a456-426614174001'
    }
};
// Mock Gemini AI service
const mockGeminiAnalysis = {
    isAiAnalyzed: true,
    aiAnalysisData: {
        extractedText: 'Sample document text content',
        keyFindings: ['Important finding 1', 'Important finding 2'],
        documentType: 'invoice',
        confidence: 0.95,
        analysisTimestamp: new Date().toISOString()
    }
};
// Test utilities
const createTestFile = (name, content = 'test content', mimeType = 'text/plain') => {
    const testDir = path_1.default.join(__dirname, 'test-files');
    if (!fs_1.default.existsSync(testDir)) {
        fs_1.default.mkdirSync(testDir, { recursive: true });
    }
    const filePath = path_1.default.join(testDir, name);
    fs_1.default.writeFileSync(filePath, content);
    return filePath;
};
const createTestImageFile = (name = 'test-image.png') => {
    // Create a minimal PNG file (1x1 pixel)
    const pngData = Buffer.from([
        0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A,
        0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x08, 0x02, 0x00, 0x00, 0x00, 0x90, 0x77, 0x53,
        0xDE, 0x00, 0x00, 0x00, 0x0C, 0x49, 0x44, 0x41,
        0x54, 0x08, 0xD7, 0x63, 0xF8, 0x00, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42,
        0x60, 0x82
    ]);
    const testDir = path_1.default.join(__dirname, 'test-files');
    if (!fs_1.default.existsSync(testDir)) {
        fs_1.default.mkdirSync(testDir, { recursive: true });
    }
    const filePath = path_1.default.join(testDir, name);
    fs_1.default.writeFileSync(filePath, pngData);
    return filePath;
};
(0, globals_1.describe)('Document Upload, Download, and AI Analysis Integration Tests', () => {
    const app = require('../../server/index').app;
    (0, globals_1.beforeEach)(async () => {
        globals_1.jest.clearAllMocks();
        // Clean up test data
        await db_1.db.delete(schema_1.bills).where((0, drizzle_orm_1.eq)(schema_1.bills.createdBy, mockAuth.user.id));
        await db_1.db.delete(schema_1.demands).where((0, drizzle_orm_1.eq)(schema_1.demands.submitterId, mockAuth.user.id));
        await db_1.db.delete(schema_1.bugs).where((0, drizzle_orm_1.eq)(schema_1.bugs.createdBy, mockAuth.user.id));
        await db_1.db.delete(schema_1.featureRequests).where((0, drizzle_orm_1.eq)(schema_1.featureRequests.createdBy, mockAuth.user.id));
        await db_1.db.delete(schema_1.documents).where((0, drizzle_orm_1.eq)(schema_1.documents.uploadedById, mockAuth.user.id));
    });
    (0, globals_1.afterEach)(async () => {
        // Clean up test files
        const testDir = path_1.default.join(__dirname, 'test-files');
        if (fs_1.default.existsSync(testDir)) {
            fs_1.default.rmSync(testDir, { recursive: true, force: true });
        }
    });
    (0, globals_1.describe)('Document Upload Operations', () => {
        (0, globals_1.it)('should upload bill document with standardized column structure', async () => {
            // First create a bill
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Test Bill',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            const billId = billResponse.body.id;
            // Upload document to the bill
            const testImagePath = createTestImageFile('bill-receipt.png');
            const uploadResponse = await (0, supertest_1.default)(app)
                .post(`/api/bills/${billId}/upload-document`)
                .attach('document', testImagePath)
                .expect(200);
            // Verify response contains AI analysis
            (0, globals_1.expect)(uploadResponse.body.message).toContain('uploaded and analyzed successfully');
            (0, globals_1.expect)(uploadResponse.body.bill.isAiAnalyzed).toBe(true);
            (0, globals_1.expect)(uploadResponse.body.bill.aiAnalysisData).toBeDefined();
            // Verify database record uses new column structure
            const updatedBill = await db_1.db.select()
                .from(schema_1.bills)
                .where((0, drizzle_orm_1.eq)(schema_1.bills.id, billId))
                .limit(1);
            (0, globals_1.expect)(updatedBill).toHaveLength(1);
            (0, globals_1.expect)(updatedBill[0].filePath).toBeDefined();
            (0, globals_1.expect)(updatedBill[0].filePath).toContain('bill-receipt.png');
            (0, globals_1.expect)(updatedBill[0].fileName).toBe('bill-receipt.png');
            (0, globals_1.expect)(updatedBill[0].fileSize).toBeGreaterThan(0);
            (0, globals_1.expect)(updatedBill[0].isAiAnalyzed).toBe(true);
            (0, globals_1.expect)(updatedBill[0].aiAnalysisData).toBeDefined();
        });
        (0, globals_1.it)('should handle demand file upload with new structure', async () => {
            const demandData = {
                type: 'maintenance',
                description: 'Testing demand with file attachment',
                buildingId: '123e4567-e89b-12d3-a456-426614174001'
            };
            const testImagePath = createTestImageFile('demand-attachment.png');
            const response = await (0, supertest_1.default)(app)
                .post('/api/demands')
                .field('type', demandData.type)
                .field('description', demandData.description)
                .field('buildingId', demandData.buildingId)
                .attach('file', testImagePath)
                .expect(200);
            // Verify database record has correct file information
            const createdDemand = await db_1.db.select()
                .from(schema_1.demands)
                .where((0, drizzle_orm_1.eq)(schema_1.demands.id, response.body.id))
                .limit(1);
            (0, globals_1.expect)(createdDemand).toHaveLength(1);
            (0, globals_1.expect)(createdDemand[0].filePath).toBeDefined();
            (0, globals_1.expect)(createdDemand[0].fileName).toBe('demand-attachment.png');
            (0, globals_1.expect)(createdDemand[0].fileSize).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should handle bug report file upload with standardized structure', async () => {
            const bugData = {
                title: 'Test Bug Report',
                description: 'Testing bug report with file attachment',
                category: 'ui_ux',
                priority: 'medium'
            };
            const testImagePath = createTestImageFile('bug-screenshot.png');
            const response = await (0, supertest_1.default)(app)
                .post('/api/bugs')
                .field('title', bugData.title)
                .field('description', bugData.description)
                .field('category', bugData.category)
                .field('priority', bugData.priority)
                .attach('file', testImagePath)
                .expect(200);
            // Verify database record uses new column names
            const createdBug = await db_1.db.select()
                .from(schema_1.bugs)
                .where((0, drizzle_orm_1.eq)(schema_1.bugs.id, response.body.id))
                .limit(1);
            (0, globals_1.expect)(createdBug).toHaveLength(1);
            (0, globals_1.expect)(createdBug[0].filePath).toBeDefined();
            (0, globals_1.expect)(createdBug[0].fileName).toBe('bug-screenshot.png');
            (0, globals_1.expect)(createdBug[0].fileSize).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should validate file size limits during upload', async () => {
            // Create a large test file (over 25MB)
            const largeFilePath = createTestFile('large-file.txt', 'x'.repeat(26 * 1024 * 1024)); // 26MB
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Test Bill',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            // Attempt to upload large file should fail
            await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', largeFilePath)
                .expect(413); // Payload Too Large
        });
    });
    (0, globals_1.describe)('Document Download Operations', () => {
        (0, globals_1.it)('should download bill documents with proper headers', async () => {
            // Create bill with document
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Test Bill for Download',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['150.00'],
                totalAmount: '150.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            const testImagePath = createTestImageFile('download-test.png');
            await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', testImagePath)
                .expect(200);
            // Test document download
            const downloadResponse = await (0, supertest_1.default)(app)
                .get(`/api/bills/${billResponse.body.id}/download-document`)
                .expect(200);
            // Verify headers
            (0, globals_1.expect)(downloadResponse.headers['content-disposition']).toContain('attachment');
            (0, globals_1.expect)(downloadResponse.headers['content-disposition']).toContain('download-test.png');
            (0, globals_1.expect)(downloadResponse.headers['content-type']).toBe('application/octet-stream');
        });
        (0, globals_1.it)('should handle download of non-existent documents', async () => {
            // Create bill without document
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Bill Without Document',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            // Attempt to download non-existent document
            await (0, supertest_1.default)(app)
                .get(`/api/bills/${billResponse.body.id}/download-document`)
                .expect(404);
        });
    });
    (0, globals_1.describe)('AI Analysis Integration', () => {
        (0, globals_1.it)('should analyze uploaded documents with Gemini AI', async () => {
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'AI Analysis Test Bill',
                category: 'utilities',
                paymentType: 'unique',
                costs: ['200.00'],
                totalAmount: '200.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            const testPdfPath = createTestFile('invoice.pdf', 'Sample PDF invoice content', 'application/pdf');
            const uploadResponse = await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', testPdfPath)
                .expect(200);
            // Verify AI analysis was performed
            (0, globals_1.expect)(uploadResponse.body.bill.isAiAnalyzed).toBe(true);
            (0, globals_1.expect)(uploadResponse.body.bill.aiAnalysisData).toBeDefined();
            (0, globals_1.expect)(uploadResponse.body.bill.aiAnalysisData.extractedText).toBeDefined();
            (0, globals_1.expect)(uploadResponse.body.bill.aiAnalysisData.confidence).toBeGreaterThan(0);
            // Verify database record contains AI analysis
            const updatedBill = await db_1.db.select()
                .from(schema_1.bills)
                .where((0, drizzle_orm_1.eq)(schema_1.bills.id, billResponse.body.id))
                .limit(1);
            (0, globals_1.expect)(updatedBill[0].isAiAnalyzed).toBe(true);
            (0, globals_1.expect)(updatedBill[0].aiAnalysisData).toBeDefined();
        });
        (0, globals_1.it)('should handle AI analysis failures gracefully', async () => {
            // Mock AI service to fail
            const mockGeminiService = require('../../server/services/gemini-bill-analyzer').geminiBillAnalyzer;
            mockGeminiService.analyzeBillDocument.mockRejectedValueOnce(new Error('AI service unavailable'));
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'AI Failure Test Bill',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            const testImagePath = createTestImageFile('ai-fail-test.png');
            const uploadResponse = await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', testImagePath)
                .expect(200);
            // Document should still upload successfully even if AI fails
            (0, globals_1.expect)(uploadResponse.body.message).toContain('uploaded');
            (0, globals_1.expect)(uploadResponse.body.bill.filePath).toBeDefined();
            (0, globals_1.expect)(uploadResponse.body.bill.fileName).toBe('ai-fail-test.png');
            (0, globals_1.expect)(uploadResponse.body.bill.isAiAnalyzed).toBe(false); // AI failed
            (0, globals_1.expect)(uploadResponse.body.bill.aiAnalysisData).toBeNull();
        });
    });
    (0, globals_1.describe)('Cross-Form Compatibility', () => {
        (0, globals_1.it)('should maintain consistent file structure across all forms', async () => {
            const testImagePath = createTestImageFile('consistency-test.png');
            // Test different form types with same file structure
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Consistency Test Bill',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            // Create and upload to bill
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', testImagePath)
                .expect(200);
            // Create demand with file
            const demandResponse = await (0, supertest_1.default)(app)
                .post('/api/demands')
                .field('type', 'maintenance')
                .field('description', 'Consistency test demand')
                .field('buildingId', '123e4567-e89b-12d3-a456-426614174001')
                .attach('file', testImagePath)
                .expect(200);
            // Create bug report with file
            const bugResponse = await (0, supertest_1.default)(app)
                .post('/api/bugs')
                .field('title', 'Consistency Test Bug')
                .field('description', 'Testing file structure consistency')
                .field('category', 'functionality')
                .field('priority', 'low')
                .attach('file', testImagePath)
                .expect(200);
            // Verify all records have consistent file structure
            const [billRecord] = await db_1.db.select().from(schema_1.bills).where((0, drizzle_orm_1.eq)(schema_1.bills.id, billResponse.body.id));
            const [demandRecord] = await db_1.db.select().from(schema_1.demands).where((0, drizzle_orm_1.eq)(schema_1.demands.id, demandResponse.body.id));
            const [bugRecord] = await db_1.db.select().from(schema_1.bugs).where((0, drizzle_orm_1.eq)(schema_1.bugs.id, bugResponse.body.id));
            // All should have filePath, fileName, fileSize columns
            (0, globals_1.expect)(billRecord.filePath).toBeDefined();
            (0, globals_1.expect)(billRecord.fileName).toBe('consistency-test.png');
            (0, globals_1.expect)(billRecord.fileSize).toBeGreaterThan(0);
            (0, globals_1.expect)(demandRecord.filePath).toBeDefined();
            (0, globals_1.expect)(demandRecord.fileName).toBe('consistency-test.png');
            (0, globals_1.expect)(demandRecord.fileSize).toBeGreaterThan(0);
            (0, globals_1.expect)(bugRecord.filePath).toBeDefined();
            (0, globals_1.expect)(bugRecord.fileName).toBe('consistency-test.png');
            (0, globals_1.expect)(bugRecord.fileSize).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should validate file types consistently across forms', async () => {
            const invalidFilePath = createTestFile('test.exe', 'executable content', 'application/x-executable');
            // All forms should reject executable files
            const billData = {
                buildingId: '123e4567-e89b-12d3-a456-426614174001',
                title: 'Test Bill',
                category: 'maintenance',
                paymentType: 'unique',
                costs: ['100.00'],
                totalAmount: '100.00',
                startDate: '2024-01-01',
                status: 'draft'
            };
            const billResponse = await (0, supertest_1.default)(app)
                .post('/api/bills')
                .send(billData)
                .expect(200);
            // Should reject invalid file type
            await (0, supertest_1.default)(app)
                .post(`/api/bills/${billResponse.body.id}/upload-document`)
                .attach('document', invalidFilePath)
                .expect(400);
            // Same for demands
            await (0, supertest_1.default)(app)
                .post('/api/demands')
                .field('type', 'maintenance')
                .field('description', 'Test demand')
                .field('buildingId', '123e4567-e89b-12d3-a456-426614174001')
                .attach('file', invalidFilePath)
                .expect(400);
            // Same for bugs
            await (0, supertest_1.default)(app)
                .post('/api/bugs')
                .field('title', 'Test Bug')
                .field('description', 'Test description')
                .field('category', 'functionality')
                .field('priority', 'low')
                .attach('file', invalidFilePath)
                .expect(400);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9kb2N1bWVudC11cGxvYWQtZG93bmxvYWQtYWkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBNkJHOzs7OztBQUVILDJDQUFrRjtBQWtCbEYsY0FBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLFdBQVcsRUFBRSxDQUFDLEdBQVEsRUFBRSxHQUFRLEVBQUUsSUFBUyxFQUFFLEVBQUU7UUFDN0MsR0FBRyxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO1FBQ3pCLElBQUksRUFBRSxDQUFDO0lBQ1QsQ0FBQztDQUNGLENBQUMsQ0FBQyxDQUFDO0FBY0osY0FBSSxDQUFDLElBQUksQ0FBQyxxQ0FBcUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3RELGFBQWEsRUFBRTtRQUNiLGVBQWUsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCLENBQUM7S0FDakU7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLGNBQUksQ0FBQyxJQUFJLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM3RCxrQkFBa0IsRUFBRTtRQUNsQixtQkFBbUIsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDO0tBQ3BGO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUE5Q0osMERBQWdDO0FBQ2hDLDRDQUFvQjtBQUNwQixnREFBd0I7QUFDeEIsd0NBQXFDO0FBQ3JDLGdEQUF1RjtBQUN2Riw2Q0FBaUM7QUFFakMsaUNBQWlDO0FBQ2pDLE1BQU0sUUFBUSxHQUFHO0lBQ2YsSUFBSSxFQUFFO1FBQ0osRUFBRSxFQUFFLHNDQUFzQztRQUMxQyxLQUFLLEVBQUUsZ0JBQWdCO1FBQ3ZCLElBQUksRUFBRSxPQUFPO1FBQ2IsY0FBYyxFQUFFLHNDQUFzQztLQUN2RDtDQUNGLENBQUM7QUFTRix5QkFBeUI7QUFDekIsTUFBTSxrQkFBa0IsR0FBRztJQUN6QixZQUFZLEVBQUUsSUFBSTtJQUNsQixjQUFjLEVBQUU7UUFDZCxhQUFhLEVBQUUsOEJBQThCO1FBQzdDLFdBQVcsRUFBRSxDQUFDLHFCQUFxQixFQUFFLHFCQUFxQixDQUFDO1FBQzNELFlBQVksRUFBRSxTQUFTO1FBQ3ZCLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLGlCQUFpQixFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO0tBQzVDO0NBQ0YsQ0FBQztBQWNGLGlCQUFpQjtBQUNqQixNQUFNLGNBQWMsR0FBRyxDQUFDLElBQVksRUFBRSxVQUFrQixjQUFjLEVBQUUsV0FBbUIsWUFBWSxFQUFFLEVBQUU7SUFDekcsTUFBTSxPQUFPLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDbkQsSUFBSSxDQUFDLFlBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUM1QixZQUFFLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFFRCxNQUFNLFFBQVEsR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMxQyxZQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNwQyxPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDLENBQUM7QUFFRixNQUFNLG1CQUFtQixHQUFHLENBQUMsT0FBZSxnQkFBZ0IsRUFBRSxFQUFFO0lBQzlELHdDQUF3QztJQUN4QyxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDO1FBQzFCLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1FBQzlDLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQyxDQUFDO0lBRUgsTUFBTSxPQUFPLEdBQUcsY0FBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDbkQsSUFBSSxDQUFDLFlBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUM1QixZQUFFLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFFRCxNQUFNLFFBQVEsR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMxQyxZQUFFLENBQUMsYUFB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QUNuQixNQUFNLElBQUEsbUJBQU8sRUFBQyxHQUFHLENBQUM7aUJBQ2YsSUFBSSxDQUFDLGNBQWMsQ0FBQztpQkFDcEIsS0FBSyxDQUFDLE1BQU0sRUFBRSxhQUFhLENBQUM7aUJBQzVCLEtBQUssQ0FBQyxhQUFhLEVBQUUsYUFBYSxDQUFDO2lCQUNuQyxLQUFLLENBQUMsWUFBWSxFQUFFLHNDQUFzQyxDQUFDO2lCQUMzRCxNQUFNLENBQUMsTUFBTSxFQUFFLGVBQWUsQ0FBQztpQkFDL0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRWYsZ0JBQWdCO1lBQ2hCLE1BQU0sSUFBQSxtQkFBTyxFQUFDLEdBQUcsQ0FBQztpQkFDZixJQUFJLENBQUMsV0FBVyxDQUFDO2lCQUNqQixLQUFLLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztpQkFDMUIsS0FBSyxDQUFDLGFBQWEsRUFBRSxrQkFBa0IsQ0FBQztpQkFDeEMsS0FBSyxDQUFDLFVBQVUsRUFBRSxlQUFlLENBQUM7aUJBQ2xDLEtBQUssQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDO2lCQUN4QixNQUFNLENBQUMsTUFBTSxFQUFFLGVBQWUsQ0FBQztpQkFDL0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL2ludGVncmF0aW9uL2RvY3VtZW50LXVwbG9hZC1kb3dubG9hZC1haS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRG9jdW1lbnQgVXBsb2FkLCBEb3dubG9hZCwgYW5kIEFJIEFuYWx5c2lzIEludGVncmF0aW9uIFRlc3RzXG4gKiBcbiAqIENvbXByZWhlbnNpdmUgdGVzdGluZyBzdWl0ZSBmb3IgdGhlIHN0YW5kYXJkaXplZCBkb2N1bWVudCBtYW5hZ2VtZW50IHN5c3RlbVxuICogd2l0aCBBSSBhbmFseXNpcyBmdW5jdGlvbmFsaXR5LiBUZXN0cyB2YWxpZGF0ZTpcbiAqIFxuICogMS4gRG9jdW1lbnQgVXBsb2FkIE9wZXJhdGlvbnNcbiAqICAgIC0gRmlsZSB1cGxvYWQgd2l0aCBuZXcgZmlsZVBhdGgsIGZpbGVOYW1lLCBmaWxlU2l6ZSBzdHJ1Y3R1cmVcbiAqICAgIC0gTXVsdGlwYXJ0IGZvcm0gaGFuZGxpbmdcbiAqICAgIC0gRmlsZSB2YWxpZGF0aW9uIGFuZCBzZWN1cml0eSBjaGVja3NcbiAqICAgIC0gRGF0YWJhc2UgcmVjb3JkIGNyZWF0aW9uIHdpdGggY29ycmVjdCBjb2x1bW4gbmFtZXNcbiAqIFxuICogMi4gRG9jdW1lbnQgRG93bmxvYWQgT3BlcmF0aW9uc1xuICogICAgLSBTZWN1cmUgZmlsZSBzZXJ2aW5nXG4gKiAgICAtIEFjY2VzcyBjb250cm9sIHZhbGlkYXRpb25cbiAqICAgIC0gUHJvcGVyIGhlYWRlcnMgYW5kIGNvbnRlbnQgZGlzcG9zaXRpb25cbiAqIFxuICogMy4gQUkgQW5hbHlzaXMgSW50ZWdyYXRpb25cbiAqICAgIC0gR2VtaW5pIEFJIGRvY3VtZW50IGFuYWx5c2lzXG4gKiAgICAtIEFJIHJlc3VsdHMgc3RvcmFnZSBpbiBkYXRhYmFzZVxuICogICAgLSBBbmFseXNpcyBtZXRhZGF0YSBoYW5kbGluZ1xuICogICAgLSBFcnJvciBoYW5kbGluZyBmb3IgQUkgZmFpbHVyZXNcbiAqIFxuICogNC4gQ3Jvc3MtRm9ybSBEb2N1bWVudCBIYW5kbGluZ1xuICogICAgLSBCaWxscyBkb2N1bWVudCB1cGxvYWQvZG93bmxvYWRcbiAqICAgIC0gRGVtYW5kcyBmaWxlIGF0dGFjaG1lbnRzXG4gKiAgICAtIEJ1ZyByZXBvcnQgZmlsZSBhdHRhY2htZW50c1xuICogICAgLSBGZWF0dXJlIHJlcXVlc3QgYXR0YWNobWVudHNcbiAqICAgIC0gRG9jdW1lbnQgbWFuYWdlbWVudCB1cGxvYWRzXG4gKi9cblxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCwgamVzdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vc2VydmVyL2RiJztcbmltcG9ydCB7IGJpbGxzLCBkZW1hbmRzLCBidWdzLCBmZWF0dXJlUmVxdWVzdHMsIGRvY3VtZW50cyB9IGZyb20gJy4uLy4uL3NoYXJlZC9zY2hlbWEnO1xuaW1wb3J0IHsgZXEgfSBmcm9tICdkcml6emxlLW9ybSc7XG5cbi8vIE1vY2sgYXV0aGVudGljYXRpb24gbWlkZGxld2FyZVxuY29uc3QgbW9ja0F1dGggPSB7XG4gIHVzZXI6IHtcbiAgICBpZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gICAgZW1haWw6ICd0ZXN0QGtvdmVvLmNvbScsXG4gICAgcm9sZTogJ2FkbWluJyxcbiAgICBvcmdhbml6YXRpb25JZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMSdcbiAgfVxufTtcblxuamVzdC5tb2NrKCcuLi8uLi9zZXJ2ZXIvYXV0aCcsICgpID0+ICh7XG4gIHJlcXVpcmVBdXRoOiAocmVxOiBhbnksIHJlczogYW55LCBuZXh0OiBhbnkpID0+IHtcbiAgICByZXEudXNlciA9IG1vY2tBdXRoLnVzZXI7XG4gICAgbmV4dCgpO1xuICB9XG59KSk7XG5cbi8vIE1vY2sgR2VtaW5pIEFJIHNlcnZpY2VcbmNvbnN0IG1vY2tHZW1pbmlBbmFseXNpcyA9IHtcbiAgaXNBaUFuYWx5emVkOiB0cnVlLFxuICBhaUFuYWx5c2lzRGF0YToge1xuICAgIGV4dHJhY3RlZFRleHQ6ICdTYW1wbGUgZG9jdW1lbnQgdGV4dCBjb250ZW50JyxcbiAgICBrZXlGaW5kaW5nczogWydJbXBvcnRhbnQgZmluZGluZyAxJywgJ0ltcG9ydGFudCBmaW5kaW5nIDInXSxcbiAgICBkb2N1bWVudFR5cGU6ICdpbnZvaWNlJyxcbiAgICBjb25maWRlbmNlOiAwLjk1LFxuICAgIGFuYWx5c2lzVGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfVxufTtcblxuamVzdC5tb2NrKCcuLi8uLi9zZXJ2ZXIvc2VydmljZXMvZ2VtaW5pU2VydmljZScsICgpID0+ICh7XG4gIGdlbWluaVNlcnZpY2U6IHtcbiAgICBhbmFseXplRG9jdW1lbnQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrR2VtaW5pQW5hbHlzaXMpXG4gIH1cbn0pKTtcblxuamVzdC5tb2NrKCcuLi8uLi9zZXJ2ZXIvc2VydmljZXMvZ2VtaW5pLWJpbGwtYW5hbHl6ZXInLCAoKSA9PiAoe1xuICBnZW1pbmlCaWxsQW5hbHl6ZXI6IHtcbiAgICBhbmFseXplQmlsbERvY3VtZW50OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobW9ja0dlbWluaUFuYWx5c2lzLmFpQW5hbHlzaXNEYXRhKVxuICB9XG59KSk7XG5cbi8vIFRlc3QgdXRpbGl0aWVzXG5jb25zdCBjcmVhdGVUZXN0RmlsZSA9IChuYW1lOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyA9ICd0ZXN0IGNvbnRlbnQnLCBtaW1lVHlwZTogc3RyaW5nID0gJ3RleHQvcGxhaW4nKSA9PiB7XG4gIGNvbnN0IHRlc3REaXIgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAndGVzdC1maWxlcycpO1xuICBpZiAoIWZzLmV4aXN0c1N5bmModGVzdERpcikpIHtcbiAgICBmcy5ta2RpclN5bmModGVzdERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH1cbiAgXG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKHRlc3REaXIsIG5hbWUpO1xuICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50KTtcbiAgcmV0dXJuIGZpbGVQYXRoO1xufTtcblxuY29uc3QgY3JlYXRlVGVzdEltYWdlRmlsZSA9IChuYW1lOiBzdHJpbmcgPSAndGVzdC1pbWFnZS5wbmcnKSA9PiB7XG4gIC8vIENyZWF0ZSBhIG1pbmltYWwgUE5HIGZpbGUgKDF4MSBwaXhlbClcbiAgY29uc3QgcG5nRGF0YSA9IEJ1ZmZlci5mcm9tKFtcbiAgICAweDg5LCAweDUwLCAweDRFLCAweDQ3LCAweDBELCAweDBBLCAweDFBLCAweDBBLFxuICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MEQsIDB4NDksIDB4NDgsIDB4NDQsIDB4NTIsXG4gICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSxcbiAgICAweDA4LCAweDAyLCAweDAwLCAweDAwLCAweDAwLCAweDkwLCAweDc3LCAweDUzLFxuICAgIDB4REUsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MEMsIDB4NDksIDB4NDQsIDB4NDEsXG4gICAgMHg1NCwgMHgwOCwgMHhENywgMHg2MywgMHhGOCwgMHgwMCwgMHgwMCwgMHgwMCxcbiAgICAweDAwLCAweDAxLCAweDAwLCAweDAxLCAweDAwLCAweDAwLCAweDAwLCAweDAwLFxuICAgIDB4MDAsIDB4MDAsIDB4NDksIDB4NDUsIDB4NEUsIDB4NDQsIDB4QUUsIDB4NDIsXG4gICAgMHg2MCwgMHg4MlxuICBdKTtcbiAgXG4gIGNvbnN0IHRlc3REaXIgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAndGVzdC1maWxlcycpO1xuICBpZiAoIWZzLmV4aXN0c1N5bmModGVzdERpcikpIHtcbiAgICBmcy5ta2RpclN5bmModGVzdERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH1cbiAgXG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKHRlc3REaXIsIG5hbWUpO1xuICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBwbmdEYXRhKTtcbiAgcmV0dXJuIGZpbGVQYXRoO1xufTtcblxuZGVzY3JpYmUoJ0RvY3VtZW50IFVwbG9hZCwgRG93bmxvYWQsIGFuZCBBSSBBbmFseXNpcyBJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgY29uc3QgYXBwID0gcmVxdWlyZSgnLi4vLi4vc2VydmVyL2luZGV4JykuYXBwO1xuICBcbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8gQ2xlYW4gdXAgdGVzdCBkYXRhXG4gICAgYXdhaXQgZGIuZGVsZXRlKGJpbGxzKS53aGVyZShlcShiaWxscy5jcmVhdGVkQnksIG1vY2tBdXRoLnVzZXIuaWQpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoZGVtYW5kcykud2hlcmUoZXEoZGVtYW5kcy5zdWJtaXR0ZXJJZCwgbW9ja0F1dGgudXNlci5pZCkpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShidWdzKS53aGVyZShlcShidWdzLmNyZWF0ZWRCeSwgbW9ja0F1dGgudXNlci5pZCkpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShmZWF0dXJlUmVxdWVzdHMpLndoZXJlKGVxKGZlYXR1cmVSZXF1ZXN0cy5jcmVhdGVkQnksIG1vY2tBdXRoLnVzZXIuaWQpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoZG9jdW1lbnRzKS53aGVyZShlcShkb2N1bWVudHMudXBsb2FkZWRCeUlkLCBtb2NrQXV0aC51c2VyLmlkKSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW4gdXAgdGVzdCBmaWxlc1xuICAgIGNvbnN0IHRlc3REaXIgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAndGVzdC1maWxlcycpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKHRlc3REaXIpKSB7XG4gICAgICBmcy5ybVN5bmModGVzdERpciwgeyByZWN1cnNpdmU6IHRydWUsIGZvcmNlOiB0cnVlIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RvY3VtZW50IFVwbG9hZCBPcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBsb2FkIGJpbGwgZG9jdW1lbnQgd2l0aCBzdGFuZGFyZGl6ZWQgY29sdW1uIHN0cnVjdHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZpcnN0IGNyZWF0ZSBhIGJpbGxcbiAgICAgIGNvbnN0IGJpbGxEYXRhID0ge1xuICAgICAgICBidWlsZGluZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJyxcbiAgICAgICAgdGl0bGU6ICdUZXN0IEJpbGwnLFxuICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgcGF5bWVudFR5cGU6ICd1bmlxdWUnLFxuICAgICAgICBjb3N0czogWycxMDAuMDAnXSxcbiAgICAgICAgdG90YWxBbW91bnQ6ICcxMDAuMDAnLFxuICAgICAgICBzdGFydERhdGU6ICcyMDI0LTAxLTAxJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBiaWxsUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYmlsbHMnKVxuICAgICAgICAuc2VuZChiaWxsRGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBjb25zdCBiaWxsSWQgPSBiaWxsUmVzcG9uc2UuYm9keS5pZDtcblxuICAgICAgLy8gVXBsb2FkIGRvY3VtZW50IHRvIHRoZSBiaWxsXG4gICAgICBjb25zdCB0ZXN0SW1hZ2VQYXRoID0gY3JlYXRlVGVzdEltYWdlRmlsZSgnYmlsbC1yZWNlaXB0LnBuZycpO1xuICAgICAgXG4gICAgICBjb25zdCB1cGxvYWRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9iaWxscy8ke2JpbGxJZH0vdXBsb2FkLWRvY3VtZW50YClcbiAgICAgICAgLmF0dGFjaCgnZG9jdW1lbnQnLCB0ZXN0SW1hZ2VQYXRoKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIC8vIFZlcmlmeSByZXNwb25zZSBjb250YWlucyBBSSBhbmFseXNpc1xuICAgICAgZXhwZWN0KHVwbG9hZFJlc3BvbnNlLmJvZHkubWVzc2FnZSkudG9Db250YWluKCd1cGxvYWRlZCBhbmQgYW5hbHl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBleHBlY3QodXBsb2FkUmVzcG9uc2UuYm9keS5iaWxsLmlzQWlBbmFseXplZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5LmJpbGwuYWlBbmFseXNpc0RhdGEpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgIC8vIFZlcmlmeSBkYXRhYmFzZSByZWNvcmQgdXNlcyBuZXcgY29sdW1uIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdXBkYXRlZEJpbGwgPSBhd2FpdCBkYi5zZWxlY3QoKVxuICAgICAgICAuZnJvbShiaWxscylcbiAgICAgICAgLndoZXJlKGVxKGJpbGxzLmlkLCBiaWxsSWQpKVxuICAgICAgICAubGltaXQoMSk7XG5cbiAgICAgIGV4cGVjdCh1cGRhdGVkQmlsbCkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRCaWxsWzBdLmZpbGVQYXRoKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRCaWxsWzBdLmZpbGVQYXRoKS50b0NvbnRhaW4oJ2JpbGwtcmVjZWlwdC5wbmcnKTtcbiAgICAgIGV4cGVjdCh1cGRhdGVkQmlsbFswXS5maWxlTmFtZSkudG9CZSgnYmlsbC1yZWNlaXB0LnBuZycpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRCaWxsWzBdLmZpbGVTaXplKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QodXBkYXRlZEJpbGxbMF0uaXNBaUFuYWx5emVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRCaWxsWzBdLmFpQW5hbHlzaXNEYXRhKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVtYW5kIGZpbGUgdXBsb2FkIHdpdGggbmV3IHN0cnVjdHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbWFuZERhdGEgPSB7XG4gICAgICAgIHR5cGU6ICdtYWludGVuYW5jZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdGluZyBkZW1hbmQgd2l0aCBmaWxlIGF0dGFjaG1lbnQnLFxuICAgICAgICBidWlsZGluZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJ1xuICAgICAgfTtcblxuICAgICAgY29uc3QgdGVzdEltYWdlUGF0aCA9IGNyZWF0ZVRlc3RJbWFnZUZpbGUoJ2RlbWFuZC1hdHRhY2htZW50LnBuZycpO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLmZpZWxkKCd0eXBlJywgZGVtYW5kRGF0YS50eXBlKVxuICAgICAgICAuZmllbGQoJ2Rlc2NyaXB0aW9uJywgZGVtYW5kRGF0YS5kZXNjcmlwdGlvbilcbiAgICAgICAgLmZpZWxkKCdidWlsZGluZ0lkJywgZGVtYW5kRGF0YS5idWlsZGluZ0lkKVxuICAgICAgICAuYXR0YWNoKCdmaWxlJywgdGVzdEltYWdlUGF0aClcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICAvLyBWZXJpZnkgZGF0YWJhc2UgcmVjb3JkIGhhcyBjb3JyZWN0IGZpbGUgaW5mb3JtYXRpb25cbiAgICAgIGNvbnN0IGNyZWF0ZWREZW1hbmQgPSBhd2FpdCBkYi5zZWxlY3QoKVxuICAgICAgICAuZnJvbShkZW1hbmRzKVxuICAgICAgICAud2hlcmUoZXEoZGVtYW5kcy5pZCwgcmVzcG9uc2UuYm9keS5pZCkpXG4gICAgICAgIC5saW1pdCgxKTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZWREZW1hbmQpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkRGVtYW5kWzBdLmZpbGVQYXRoKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGNyZWF0ZWREZW1hbmRbMF0uZmlsZU5hbWUpLnRvQmUoJ2RlbWFuZC1hdHRhY2htZW50LnBuZycpO1xuICAgICAgZXhwZWN0KGNyZWF0ZWREZW1hbmRbMF0uZmlsZVNpemUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJ1ZyByZXBvcnQgZmlsZSB1cGxvYWQgd2l0aCBzdGFuZGFyZGl6ZWQgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVnRGF0YSA9IHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IEJ1ZyBSZXBvcnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3RpbmcgYnVnIHJlcG9ydCB3aXRoIGZpbGUgYXR0YWNobWVudCcsXG4gICAgICAgIGNhdGVnb3J5OiAndWlfdXgnLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bSdcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRlc3RJbWFnZVBhdGggPSBjcmVhdGVUZXN0SW1hZ2VGaWxlKCdidWctc2NyZWVuc2hvdC5wbmcnKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYnVncycpXG4gICAgICAgIC5maWVsZCgndGl0bGUnLCBidWdEYXRhLnRpdGxlKVxuICAgICAgICAuZmllbGQoJ2Rlc2NyaXB0aW9uJywgYnVnRGF0YS5kZXNjcmlwdGlvbilcbiAgICAgICAgLmZpZWxkKCdjYXRlZ29yeScsIGJ1Z0RhdGEuY2F0ZWdvcnkpXG4gICAgICAgIC5maWVsZCgncHJpb3JpdHknLCBidWdEYXRhLnByaW9yaXR5KVxuICAgICAgICAuYXR0YWNoKCdmaWxlJywgdGVzdEltYWdlUGF0aClcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICAvLyBWZXJpZnkgZGF0YWJhc2UgcmVjb3JkIHVzZXMgbmV3IGNvbHVtbiBuYW1lc1xuICAgICAgY29uc3QgY3JlYXRlZEJ1ZyA9IGF3YWl0IGRiLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGJ1Z3MpXG4gICAgICAgIC53aGVyZShlcShidWdzLmlkLCByZXNwb25zZS5ib2R5LmlkKSlcbiAgICAgICAgLmxpbWl0KDEpO1xuXG4gICAgICBleHBlY3QoY3JlYXRlZEJ1ZykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGNyZWF0ZWRCdWdbMF0uZmlsZVBhdGgpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoY3JlYXRlZEJ1Z1swXS5maWxlTmFtZSkudG9CZSgnYnVnLXNjcmVlbnNob3QucG5nJyk7XG4gICAgICBleHBlY3QoY3JlYXRlZEJ1Z1swXS5maWxlU2l6ZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmaWxlIHNpemUgbGltaXRzIGR1cmluZyB1cGxvYWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYSBsYXJnZSB0ZXN0IGZpbGUgKG92ZXIgMjVNQilcbiAgICAgIGNvbnN0IGxhcmdlRmlsZVBhdGggPSBjcmVhdGVUZXN0RmlsZSgnbGFyZ2UtZmlsZS50eHQnLCAneCcucmVwZWF0KDI2ICogMTAyNCAqIDEwMjQpKTsgLy8gMjZNQlxuICAgICAgXG4gICAgICBjb25zdCBiaWxsRGF0YSA9IHtcbiAgICAgICAgYnVpbGRpbmdJZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScsXG4gICAgICAgIHRpdGxlOiAnVGVzdCBCaWxsJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIHBheW1lbnRUeXBlOiAndW5pcXVlJyxcbiAgICAgICAgY29zdHM6IFsnMTAwLjAwJ10sXG4gICAgICAgIHRvdGFsQW1vdW50OiAnMTAwLjAwJyxcbiAgICAgICAgc3RhcnREYXRlOiAnMjAyNC0wMS0wMScsXG4gICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgYmlsbFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgLy8gQXR0ZW1wdCB0byB1cGxvYWQgbGFyZ2UgZmlsZSBzaG91bGQgZmFpbFxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2JpbGxzLyR7YmlsbFJlc3BvbnNlLmJvZHkuaWR9L3VwbG9hZC1kb2N1bWVudGApXG4gICAgICAgIC5hdHRhY2goJ2RvY3VtZW50JywgbGFyZ2VGaWxlUGF0aClcbiAgICAgICAgLmV4cGVjdCg0MTMpOyAvLyBQYXlsb2FkIFRvbyBMYXJnZVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRG9jdW1lbnQgRG93bmxvYWQgT3BlcmF0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRvd25sb2FkIGJpbGwgZG9jdW1lbnRzIHdpdGggcHJvcGVyIGhlYWRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYmlsbCB3aXRoIGRvY3VtZW50XG4gICAgICBjb25zdCBiaWxsRGF0YSA9IHtcbiAgICAgICAgYnVpbGRpbmdJZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScsXG4gICAgICAgIHRpdGxlOiAnVGVzdCBCaWxsIGZvciBEb3dubG9hZCcsXG4gICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgICAgIGNvc3RzOiBbJzE1MC4wMCddLFxuICAgICAgICB0b3RhbEFtb3VudDogJzE1MC4wMCcsXG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjQtMDEtMDEnLFxuICAgICAgICBzdGF0dXM6ICdkcmFmdCdcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGJpbGxSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9iaWxscycpXG4gICAgICAgIC5zZW5kKGJpbGxEYXRhKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IHRlc3RJbWFnZVBhdGggPSBjcmVhdGVUZXN0SW1hZ2VGaWxlKCdkb3dubG9hZC10ZXN0LnBuZycpO1xuICAgICAgXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvYmlsbHMvJHtiaWxsUmVzcG9uc2UuYm9keS5pZH0vdXBsb2FkLWRvY3VtZW50YClcbiAgICAgICAgLmF0dGFjaCgnZG9jdW1lbnQnLCB0ZXN0SW1hZ2VQYXRoKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIC8vIFRlc3QgZG9jdW1lbnQgZG93bmxvYWRcbiAgICAgIGNvbnN0IGRvd25sb2FkUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldChgL2FwaS9iaWxscy8ke2JpbGxSZXNwb25zZS5ib2R5LmlkfS9kb3dubG9hZC1kb2N1bWVudGApXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgLy8gVmVyaWZ5IGhlYWRlcnNcbiAgICAgIGV4cGVjdChkb3dubG9hZFJlc3BvbnNlLmhlYWRlcnNbJ2NvbnRlbnQtZGlzcG9zaXRpb24nXSkudG9Db250YWluKCdhdHRhY2htZW50Jyk7XG4gICAgICBleHBlY3QoZG93bmxvYWRSZXNwb25zZS5oZWFkZXJzWydjb250ZW50LWRpc3Bvc2l0aW9uJ10pLnRvQ29udGFpbignZG93bmxvYWQtdGVzdC5wbmcnKTtcbiAgICAgIGV4cGVjdChkb3dubG9hZFJlc3BvbnNlLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddKS50b0JlKCdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRvd25sb2FkIG9mIG5vbi1leGlzdGVudCBkb2N1bWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYmlsbCB3aXRob3V0IGRvY3VtZW50XG4gICAgICBjb25zdCBiaWxsRGF0YSA9IHtcbiAgICAgICAgYnVpbGRpbmdJZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScsXG4gICAgICAgIHRpdGxlOiAnQmlsbCBXaXRob3V0IERvY3VtZW50JyxcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIHBheW1lbnRUeXBlOiAndW5pcXVlJyxcbiAgICAgICAgY29zdHM6IFsnMTAwLjAwJ10sXG4gICAgICAgIHRvdGFsQW1vdW50OiAnMTAwLjAwJyxcbiAgICAgICAgc3RhcnREYXRlOiAnMjAyNC0wMS0wMScsXG4gICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgYmlsbFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgLy8gQXR0ZW1wdCB0byBkb3dubG9hZCBub24tZXhpc3RlbnQgZG9jdW1lbnRcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2JpbGxzLyR7YmlsbFJlc3BvbnNlLmJvZHkuaWR9L2Rvd25sb2FkLWRvY3VtZW50YClcbiAgICAgICAgLmV4cGVjdCg0MDQpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQUkgQW5hbHlzaXMgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhbmFseXplIHVwbG9hZGVkIGRvY3VtZW50cyB3aXRoIEdlbWluaSBBSScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGJpbGxEYXRhID0ge1xuICAgICAgICBidWlsZGluZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJyxcbiAgICAgICAgdGl0bGU6ICdBSSBBbmFseXNpcyBUZXN0IEJpbGwnLFxuICAgICAgICBjYXRlZ29yeTogJ3V0aWxpdGllcycsXG4gICAgICAgIHBheW1lbnRUeXBlOiAndW5pcXVlJyxcbiAgICAgICAgY29zdHM6IFsnMjAwLjAwJ10sXG4gICAgICAgIHRvdGFsQW1vdW50OiAnMjAwLjAwJyxcbiAgICAgICAgc3RhcnREYXRlOiAnMjAyNC0wMS0wMScsXG4gICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgYmlsbFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgdGVzdFBkZlBhdGggPSBjcmVhdGVUZXN0RmlsZSgnaW52b2ljZS5wZGYnLCAnU2FtcGxlIFBERiBpbnZvaWNlIGNvbnRlbnQnLCAnYXBwbGljYXRpb24vcGRmJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwbG9hZFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2JpbGxzLyR7YmlsbFJlc3BvbnNlLmJvZHkuaWR9L3VwbG9hZC1kb2N1bWVudGApXG4gICAgICAgIC5hdHRhY2goJ2RvY3VtZW50JywgdGVzdFBkZlBhdGgpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgLy8gVmVyaWZ5IEFJIGFuYWx5c2lzIHdhcyBwZXJmb3JtZWRcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5LmJpbGwuaXNBaUFuYWx5emVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHVwbG9hZFJlc3BvbnNlLmJvZHkuYmlsbC5haUFuYWx5c2lzRGF0YSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5LmJpbGwuYWlBbmFseXNpc0RhdGEuZXh0cmFjdGVkVGV4dCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5LmJpbGwuYWlBbmFseXNpc0RhdGEuY29uZmlkZW5jZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuXG4gICAgICAvLyBWZXJpZnkgZGF0YWJhc2UgcmVjb3JkIGNvbnRhaW5zIEFJIGFuYWx5c2lzXG4gICAgICBjb25zdCB1cGRhdGVkQmlsbCA9IGF3YWl0IGRiLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGJpbGxzKVxuICAgICAgICAud2hlcmUoZXEoYmlsbHMuaWQsIGJpbGxSZXNwb25zZS5ib2R5LmlkKSlcbiAgICAgICAgLmxpbWl0KDEpO1xuXG4gICAgICBleHBlY3QodXBkYXRlZEJpbGxbMF0uaXNBaUFuYWx5emVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRCaWxsWzBdLmFpQW5hbHlzaXNEYXRhKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQUkgYW5hbHlzaXMgZmFpbHVyZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQUkgc2VydmljZSB0byBmYWlsXG4gICAgICBjb25zdCBtb2NrR2VtaW5pU2VydmljZSA9IHJlcXVpcmUoJy4uLy4uL3NlcnZlci9zZXJ2aWNlcy9nZW1pbmktYmlsbC1hbmFseXplcicpLmdlbWluaUJpbGxBbmFseXplcjtcbiAgICAgIG1vY2tHZW1pbmlTZXJ2aWNlLmFuYWx5emVCaWxsRG9jdW1lbnQubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignQUkgc2VydmljZSB1bmF2YWlsYWJsZScpKTtcblxuICAgICAgY29uc3QgYmlsbERhdGEgPSB7XG4gICAgICAgIGJ1aWxkaW5nSWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnLFxuICAgICAgICB0aXRsZTogJ0FJIEZhaWx1cmUgVGVzdCBCaWxsJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIHBheW1lbnRUeXBlOiAndW5pcXVlJyxcbiAgICAgICAgY29zdHM6IFsnMTAwLjAwJ10sXG4gICAgICAgIHRvdGFsQW1vdW50OiAnMTAwLjAwJyxcbiAgICAgICAgc3RhcnREYXRlOiAnMjAyNC0wMS0wMScsXG4gICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgYmlsbFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgdGVzdEltYWdlUGF0aCA9IGNyZWF0ZVRlc3RJbWFnZUZpbGUoJ2FpLWZhaWwtdGVzdC5wbmcnKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXBsb2FkUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvYmlsbHMvJHtiaWxsUmVzcG9uc2UuYm9keS5pZH0vdXBsb2FkLWRvY3VtZW50YClcbiAgICAgICAgLmF0dGFjaCgnZG9jdW1lbnQnLCB0ZXN0SW1hZ2VQYXRoKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIC8vIERvY3VtZW50IHNob3VsZCBzdGlsbCB1cGxvYWQgc3VjY2Vzc2Z1bGx5IGV2ZW4gaWYgQUkgZmFpbHNcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbigndXBsb2FkZWQnKTtcbiAgICAgIGV4cGVjdCh1cGxvYWRSZXNwb25zZS5ib2R5LmJpbGwuZmlsZVBhdGgpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodXBsb2FkUmVzcG9uc2UuYm9keS5iaWxsLmZpbGVOYW1lKS50b0JlKCdhaS1mYWlsLXRlc3QucG5nJyk7XG4gICAgICBleHBlY3QodXBsb2FkUmVzcG9uc2UuYm9keS5iaWxsLmlzQWlBbmFseXplZCkudG9CZShmYWxzZSk7IC8vIEFJIGZhaWxlZFxuICAgICAgZXhwZWN0KHVwbG9hZFJlc3BvbnNlLmJvZHkuYmlsbC5haUFuYWx5c2lzRGF0YSkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Nyb3NzLUZvcm0gQ29tcGF0aWJpbGl0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1haW50YWluIGNvbnNpc3RlbnQgZmlsZSBzdHJ1Y3R1cmUgYWNyb3NzIGFsbCBmb3JtcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RJbWFnZVBhdGggPSBjcmVhdGVUZXN0SW1hZ2VGaWxlKCdjb25zaXN0ZW5jeS10ZXN0LnBuZycpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IGRpZmZlcmVudCBmb3JtIHR5cGVzIHdpdGggc2FtZSBmaWxlIHN0cnVjdHVyZVxuICAgICAgY29uc3QgYmlsbERhdGEgPSB7XG4gICAgICAgIGJ1aWxkaW5nSWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnLFxuICAgICAgICB0aXRsZTogJ0NvbnNpc3RlbmN5IFRlc3QgQmlsbCcsXG4gICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgICAgIGNvc3RzOiBbJzEwMC4wMCddLFxuICAgICAgICB0b3RhbEFtb3VudDogJzEwMC4wMCcsXG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjQtMDEtMDEnLFxuICAgICAgICBzdGF0dXM6ICdkcmFmdCdcbiAgICAgIH07XG5cbiAgICAgIC8vIENyZWF0ZSBhbmQgdXBsb2FkIHRvIGJpbGxcbiAgICAgIGNvbnN0IGJpbGxSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9iaWxscycpXG4gICAgICAgIC5zZW5kKGJpbGxEYXRhKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9iaWxscy8ke2JpbGxSZXNwb25zZS5ib2R5LmlkfS91cGxvYWQtZG9jdW1lbnRgKVxuICAgICAgICAuYXR0YWNoKCdkb2N1bWVudCcsIHRlc3RJbWFnZVBhdGgpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgLy8gQ3JlYXRlIGRlbWFuZCB3aXRoIGZpbGVcbiAgICAgIGNvbnN0IGRlbWFuZFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2RlbWFuZHMnKVxuICAgICAgICAuZmllbGQoJ3R5cGUnLCAnbWFpbnRlbmFuY2UnKVxuICAgICAgICAuZmllbGQoJ2Rlc2NyaXB0aW9uJywgJ0NvbnNpc3RlbmN5IHRlc3QgZGVtYW5kJylcbiAgICAgICAgLmZpZWxkKCdidWlsZGluZ0lkJywgJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScpXG4gICAgICAgIC5hdHRhY2goJ2ZpbGUnLCB0ZXN0SW1hZ2VQYXRoKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIC8vIENyZWF0ZSBidWcgcmVwb3J0IHdpdGggZmlsZVxuICAgICAgY29uc3QgYnVnUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYnVncycpXG4gICAgICAgIC5maWVsZCgndGl0bGUnLCAnQ29uc2lzdGVuY3kgVGVzdCBCdWcnKVxuICAgICAgICAuZmllbGQoJ2Rlc2NyaXB0aW9uJywgJ1Rlc3RpbmcgZmlsZSBzdHJ1Y3R1cmUgY29uc2lzdGVuY3knKVxuICAgICAgICAuZmllbGQoJ2NhdGVnb3J5JywgJ2Z1bmN0aW9uYWxpdHknKVxuICAgICAgICAuZmllbGQoJ3ByaW9yaXR5JywgJ2xvdycpXG4gICAgICAgIC5hdHRhY2goJ2ZpbGUnLCB0ZXN0SW1hZ2VQYXRoKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIC8vIFZlcmlmeSBhbGwgcmVjb3JkcyBoYXZlIGNvbnNpc3RlbnQgZmlsZSBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IFtiaWxsUmVjb3JkXSA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oYmlsbHMpLndoZXJlKGVxKGJpbGxzLmlkLCBiaWxsUmVzcG9uc2UuYm9keS5pZCkpO1xuICAgICAgY29uc3QgW2RlbWFuZFJlY29yZF0gPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKGRlbWFuZHMpLndoZXJlKGVxKGRlbWFuZHMuaWQsIGRlbWFuZFJlc3BvbnNlLmJvZHkuaWQpKTtcbiAgICAgIGNvbnN0IFtidWdSZWNvcmRdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShidWdzKS53aGVyZShlcShidWdzLmlkLCBidWdSZXNwb25zZS5ib2R5LmlkKSk7XG5cbiAgICAgIC8vIEFsbCBzaG91bGQgaGF2ZSBmaWxlUGF0aCwgZmlsZU5hbWUsIGZpbGVTaXplIGNvbHVtbnNcbiAgICAgIGV4cGVjdChiaWxsUmVjb3JkLmZpbGVQYXRoKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGJpbGxSZWNvcmQuZmlsZU5hbWUpLnRvQmUoJ2NvbnNpc3RlbmN5LXRlc3QucG5nJyk7XG4gICAgICBleHBlY3QoYmlsbFJlY29yZC5maWxlU2l6ZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuXG4gICAgICBleHBlY3QoZGVtYW5kUmVjb3JkLmZpbGVQYXRoKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRlbWFuZFJlY29yZC5maWxlTmFtZSkudG9CZSgnY29uc2lzdGVuY3ktdGVzdC5wbmcnKTtcbiAgICAgIGV4cGVjdChkZW1hbmRSZWNvcmQuZmlsZVNpemUpLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgICAgZXhwZWN0KGJ1Z1JlY29yZC5maWxlUGF0aCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChidWdSZWNvcmQuZmlsZU5hbWUpLnRvQmUoJ2NvbnNpc3RlbmN5LXRlc3QucG5nJyk7XG4gICAgICBleHBlY3QoYnVnUmVjb3JkLmZpbGVTaXplKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGZpbGUgdHlwZXMgY29uc2lzdGVudGx5IGFjcm9zcyBmb3JtcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRGaWxlUGF0aCA9IGNyZWF0ZVRlc3RGaWxlKCd0ZXN0LmV4ZScsICdleGVjdXRhYmxlIGNvbnRlbnQnLCAnYXBwbGljYXRpb24veC1leGVjdXRhYmxlJyk7XG4gICAgICBcbiAgICAgIC8vIEFsbCBmb3JtcyBzaG91bGQgcmVqZWN0IGV4ZWN1dGFibGUgZmlsZXNcbiAgICAgIGNvbnN0IGJpbGxEYXRhID0ge1xuICAgICAgICBidWlsZGluZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJyxcbiAgICAgICAgdGl0bGU6ICdUZXN0IEJpbGwnLFxuICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgcGF5bWVudFR5cGU6ICd1bmlxdWUnLFxuICAgICAgICBjb3N0czogWycxMDAuMDAnXSxcbiAgICAgICAgdG90YWxBbW91bnQ6ICcxMDAuMDAnLFxuICAgICAgICBzdGFydERhdGU6ICcyMDI0LTAxLTAxJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBiaWxsUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYmlsbHMnKVxuICAgICAgICAuc2VuZChiaWxsRGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICAvLyBTaG91bGQgcmVqZWN0IGludmFsaWQgZmlsZSB0eXBlXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvYmlsbHMvJHtiaWxsUmVzcG9uc2UuYm9keS5pZH0vdXBsb2FkLWRvY3VtZW50YClcbiAgICAgICAgLmF0dGFjaCgnZG9jdW1lbnQnLCBpbnZhbGlkRmlsZVBhdGgpXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgLy8gU2FtZSBmb3IgZGVtYW5kc1xuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2RlbWFuZHMnKVxuICAgICAgICAuZmllbGQoJ3R5cGUnLCAnbWFpbnRlbmFuY2UnKVxuICAgICAgICAuZmllbGQoJ2Rlc2NyaXB0aW9uJywgJ1Rlc3QgZGVtYW5kJylcbiAgICAgICAgLmZpZWxkKCdidWlsZGluZ0lkJywgJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScpXG4gICAgICAgIC5hdHRhY2goJ2ZpbGUnLCBpbnZhbGlkRmlsZVBhdGgpXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgLy8gU2FtZSBmb3IgYnVnc1xuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2J1Z3MnKVxuICAgICAgICAuZmllbGQoJ3RpdGxlJywgJ1Rlc3QgQnVnJylcbiAgICAgICAgLmZpZWxkKCdkZXNjcmlwdGlvbicsICdUZXN0IGRlc2NyaXB0aW9uJylcbiAgICAgICAgLmZpZWxkKCdjYXRlZ29yeScsICdmdW5jdGlvbmFsaXR5JylcbiAgICAgICAgLmZpZWxkKCdwcmlvcml0eScsICdsb3cnKVxuICAgICAgICAuYXR0YWNoKCdmaWxlJywgaW52YWxpZEZpbGVQYXRoKVxuICAgICAgICAuZXhwZWN0KDQwMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
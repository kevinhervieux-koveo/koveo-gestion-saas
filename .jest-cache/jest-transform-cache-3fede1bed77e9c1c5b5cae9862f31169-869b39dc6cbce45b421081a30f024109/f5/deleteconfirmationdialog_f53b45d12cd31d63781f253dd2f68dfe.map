{"file":"/home/runner/workspace/client/src/components/dialogs/delete-confirmation-dialog.tsx","mappings":"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","names":[],"sources":["/home/runner/workspace/client/src/components/dialogs/delete-confirmation-dialog.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from '@/components/ui/dialog';\nimport { AlertTriangle, Building, Home, FileText, Users, Loader2 } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { useToast } from '@/hooks/use-toast';\nimport { apiRequest } from '@/lib/queryClient';\n\n/**\n * Interface for deletion impact analysis data.\n */\ninterface DeletionImpact {\n  organization?: { id: string; name: string };\n  building?: { id: string; name: string };\n  buildings?: number;\n  residences: number;\n  documents: number;\n  potentialOrphanedUsers: number;\n}\n\n/**\n * Interface for DeleteConfirmationDialog component props.\n */\ninterface DeleteConfirmationDialogProps {\n  open: boolean;\n  onOpenChange: (_open: boolean) => void;\n  entityType: 'organization' | 'building';\n  entityId: string;\n  entityName: string;\n  onConfirm: () => void;\n  isDeleting?: boolean;\n}\n\n/**\n * Delete Confirmation Dialog with Impact Analysis.\n * Shows exactly what will be deleted when cascading delete is performed.\n * @param root0 - Component props.\n * @param root0.open - Whether the dialog is open.\n * @param root0.onOpenChange - Callback when dialog open state changes.\n * @param root0.entityType - Type of entity being deleted.\n * @param root0.entityId - ID of the entity being deleted.\n * @param root0.entityName - Name of the entity being deleted.\n * @param root0.onConfirm - Callback when deletion is confirmed.\n * @param root0.isDeleting - Whether deletion is in progress.\n * @returns JSX element for the delete confirmation dialog.\n */\n/**\n * DeleteConfirmationDialog function.\n * @param root0\n * @param root0.open\n * @param root0.onOpenChange\n * @param root0.entityType\n * @param root0.entityId\n * @param root0.entityName\n * @param root0.onConfirm\n * @param root0.isDeleting\n * @returns Function result.\n */\nexport function DeleteConfirmationDialog({\n  open,\n  onOpenChange,\n  entityType,\n  entityId,\n  entityName,\n  onConfirm,\n  isDeleting = false,\n}: DeleteConfirmationDialogProps) {\n  const [impact, setImpact] = useState<DeletionImpact | null>(null);\n  const [loadingImpact, setLoadingImpact] = useState(false);\n  const { toast } = useToast();\n\n  // Fetch deletion impact when dialog opens\n  useEffect(() => {\n    if (open && entityId) {\n      fetchDeletionImpact();\n    }\n  }, [open, entityId, entityType]);\n\n  const fetchDeletionImpact = async () => {\n    setLoadingImpact(true);\n    try {\n      const endpoint =\n        entityType === 'organization'\n          ? `/api/organizations/${entityId}/deletion-impact`\n          : `/api/admin/buildings/${entityId}/deletion-impact`;\n\n      const response = await apiRequest('GET', endpoint);\n      const impactData = await response.json();\n      setImpact(impactData);\n      toast({\n        title: 'Error',\n        description: 'Failed to analyze deletion impact',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoadingImpact(false);\n    }\n  };\n\n  const handleConfirm = () => {\n    onConfirm();\n  };\n\n  const getTotalItemsToDelete = () => {\n    if (!impact) {\n      return 0;\n    }\n    let total = 1; // The entity itself\n    if (impact.buildings) {\n      total += impact.buildings;\n    }\n    total += impact.residences;\n    total += impact.documents;\n    total += impact.potentialOrphanedUsers;\n    return total;\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className='sm:max-w-[500px] max-h-[90vh] overflow-y-auto'>\n        <DialogHeader>\n          <DialogTitle className='flex items-center gap-2 text-red-600 dark:text-red-400'>\n            <AlertTriangle className='h-5 w-5' />\n            Confirm Deletion\n          </DialogTitle>\n          <DialogDescription>\n            This action cannot be undone. Please review the impact before proceeding.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className='space-y-4'>\n          <div className='bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4'>\n            <p className='text-sm text-red-800 dark:text-red-200'>\n              <strong>Warning:</strong> This action cannot be undone. Deleting this {entityType}{' '}\n              will cascade and remove all related data.\n            </p>\n          </div>\n\n          <div>\n            <h4 className='font-medium mb-2'>\n              You are about to delete:{' '}\n              <span className='text-red-600 dark:text-red-400'>{entityName}</span>\n            </h4>\n          </div>\n\n          {loadingImpact ? (\n            <div className='flex items-center justify-center py-8'>\n              <Loader2 className='h-6 w-6 animate-spin' />\n              <span className='ml-2 text-sm text-gray-600 dark:text-gray-400'>\n                Analyzing deletion impact...\n              </span>\n            </div>\n          ) : impact ? (\n            <div className='space-y-4'>\n              <div>\n                <h5 className='font-medium mb-3 text-gray-900 dark:text-gray-100'>\n                  This will also delete:\n                </h5>\n                <div className='space-y-2'>\n                  {entityType === 'organization' && impact.buildings && impact.buildings > 0 && (\n                    <div className='flex items-center justify-between'>\n                      <div className='flex items-center gap-2'>\n                        <Building className='h-4 w-4 text-blue-500' />\n                        <span className='text-sm'>Buildings</span>\n                      </div>\n                      <Badge variant='secondary'>{impact.buildings}</Badge>\n                    </div>\n                  )}\n\n                  {impact.residences > 0 && (\n                    <div className='flex items-center justify-between'>\n                      <div className='flex items-center gap-2'>\n                        <Home className='h-4 w-4 text-green-500' />\n                        <span className='text-sm'>Residences</span>\n                      </div>\n                      <Badge variant='secondary'>{impact.residences}</Badge>\n                    </div>\n                  )}\n\n                  {impact.documents > 0 && (\n                    <div className='flex items-center justify-between'>\n                      <div className='flex items-center gap-2'>\n                        <FileText className='h-4 w-4 text-orange-500' />\n                        <span className='text-sm'>Documents</span>\n                      </div>\n                      <Badge variant='secondary'>{impact.documents}</Badge>\n                    </div>\n                  )}\n\n                  {impact.potentialOrphanedUsers > 0 && (\n                    <div className='flex items-center justify-between'>\n                      <div className='flex items-center gap-2'>\n                        <Users className='h-4 w-4 text-purple-500' />\n                        <span className='text-sm'>Orphaned Users</span>\n                      </div>\n                      <Badge variant='secondary'>{impact.potentialOrphanedUsers}</Badge>\n                    </div>\n                  )}\n\n                  {getTotalItemsToDelete() === 1 && (\n                    <p className='text-sm text-gray-600 dark:text-gray-400 italic'>\n                      No related entities will be affected.\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              {getTotalItemsToDelete() > 1 && (\n                <div className='bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-3'>\n                  <p className='text-sm text-orange-800 dark:text-orange-200'>\n                    <strong>Total items to delete:</strong> {getTotalItemsToDelete()}\n                  </p>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className='text-center py-4'>\n              <p className='text-sm text-gray-600 dark:text-gray-400'>\n                Unable to analyze deletion impact. Proceed with caution.\n              </p>\n            </div>\n          )}\n\n          <div className='bg-gray-50 dark:bg-gray-800 rounded-lg p-3'>\n            <p className='text-xs text-gray-600 dark:text-gray-400'>\n              <strong>Note:</strong> Deleted items are soft-deleted and may be recoverable by system\n              administrators.\n            </p>\n          </div>\n        </div>\n\n        <DialogFooter className='flex gap-2'>\n          <Button variant='outline' onClick={() => onOpenChange(false)} disabled={isDeleting}>\n            Cancel\n          </Button>\n          <Button\n            variant='destructive'\n            onClick={handleConfirm}\n            disabled={isDeleting || loadingImpact}\n          >\n            {isDeleting ? (\n              <>\n                <Loader2 className='h-4 w-4 mr-2 animate-spin' />\n                Deleting...\n              </>\n            ) : (\n              `Delete ${entityType === 'organization' ? 'Organization' : 'Building'}`\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"version":3}
304001d487b2cfdf3aa9ca84ac4675c8
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const db_1 = require("../../server/db");
const schema_1 = require("../../shared/schema");
const drizzle_orm_1 = require("drizzle-orm");
const bcrypt = __importStar(require("bcryptjs"));
/**
 * User Management Access Control Test
 *
 * Tests access control for /manager/user-management route:
 * - Managers should see, edit, delete, create users in their organization
 * - Demo managers should only see other demo role users
 * - Regular managers should not see demo users
 * - Proper CRUD operations based on role permissions
 */
(0, globals_1.describe)('User Management Access Control', () => {
    // Test data setup
    const testData = {
        // Organizations
        regularOrg: {
            id: 'org-regular-test',
            name: 'Regular Test Organization',
            type: 'management_company',
            address: '123 Test Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1A 1A1'
        },
        demoOrg: {
            id: 'org-demo-test',
            name: 'Demo Test Organization',
            type: 'demo',
            address: '456 Demo Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1B 1B1'
        },
        // Users
        adminUser: {
            username: 'admin-test',
            email: 'admin@test.koveo.com',
            password: 'admin123',
            firstName: 'Admin',
            lastName: 'User',
            role: 'admin',
            language: 'en',
            isActive: true
        },
        regularManager: {
            username: 'manager-regular',
            email: 'manager@test.koveo.com',
            password: 'manager123',
            firstName: 'Regular',
            lastName: 'Manager',
            role: 'manager',
            language: 'en',
            isActive: true
        },
        demoManager: {
            username: 'demo-manager',
            email: 'demo-manager@test.koveo.com',
            password: 'demo123',
            firstName: 'Demo',
            lastName: 'Manager',
            role: 'demo_manager',
            language: 'en',
            isActive: true
        },
        regularTenant: {
            username: 'tenant-regular',
            email: 'tenant@test.koveo.com',
            password: 'tenant123',
            firstName: 'Regular',
            lastName: 'Tenant',
            role: 'tenant',
            language: 'en',
            isActive: true
        },
        demoTenant: {
            username: 'demo-tenant',
            email: 'demo-tenant@test.koveo.com',
            password: 'demo123',
            firstName: 'Demo',
            lastName: 'Tenant',
            role: 'demo_tenant',
            language: 'en',
            isActive: true
        },
        demoResident: {
            username: 'demo-resident',
            email: 'demo-resident@test.koveo.com',
            password: 'demo123',
            firstName: 'Demo',
            lastName: 'Resident',
            role: 'demo_resident',
            language: 'en',
            isActive: true
        }
    };
    let createdUserIds = [];
    let createdOrgIds = [];
    (0, globals_1.beforeAll)(async () => {
        // Clean up any existing test data
        await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.inArray)(schema_1.users.email, [
            testData.adminUser.email,
            testData.regularManager.email,
            testData.demoManager.email,
            testData.regularTenant.email,
            testData.demoTenant.email,
            testData.demoResident.email
        ]));
        await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.inArray)(schema_1.organizations.id, [
            testData.regularOrg.id,
            testData.demoOrg.id
        ]));
        // Create test organizations
        await db_1.db.insert(schema_1.organizations).values([testData.regularOrg, testData.demoOrg]);
        createdOrgIds = [testData.regularOrg.id, testData.demoOrg.id];
        // Create test users with hashed passwords
        const usersToCreate = [
            testData.adminUser,
            testData.regularManager,
            testData.demoManager,
            testData.regularTenant,
            testData.demoTenant,
            testData.demoResident
        ];
        for (const user of usersToCreate) {
            const hashedPassword = await bcrypt.hash(user.password, 10);
            const createdUser = await db_1.db.insert(schema_1.users).values({
                username: user.username,
                email: user.email,
                password: hashedPassword,
                firstName: user.firstName,
                lastName: user.lastName,
                role: user.role,
                language: user.language,
                isActive: user.isActive
            }).returning({ id: schema_1.users.id });
            createdUserIds.push(createdUser[0].id);
            // Assign users to organizations
            if (user.role.startsWith('demo')) {
                // Demo users go to demo organization
                await db_1.db.insert(schema_1.userOrganizations).values({
                    userId: createdUser[0].id,
                    organizationId: testData.demoOrg.id
                });
            }
            else {
                // Regular users go to regular organization
                await db_1.db.insert(schema_1.userOrganizations).values({
                    userId: createdUser[0].id,
                    organizationId: testData.regularOrg.id
                });
            }
        }
    });
    (0, globals_1.afterAll)(async () => {
        // Clean up test data
        if (createdUserIds.length > 0) {
            await db_1.db.delete(schema_1.userOrganizations).where((0, drizzle_orm_1.inArray)(schema_1.userOrganizations.userId, createdUserIds));
            await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.inArray)(schema_1.users.id, createdUserIds));
        }
        if (createdOrgIds.length > 0) {
            await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.inArray)(schema_1.organizations.id, createdOrgIds));
        }
    });
    (0, globals_1.describe)('Organization-based User Access', () => {
        (0, globals_1.it)('should verify test users are in correct organizations', async () => {
            // Verify regular manager is in regular org
            const regularManagerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .leftJoin(schema_1.users, (0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, schema_1.users.id))
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.regularManager.email));
            (0, globals_1.expect)(regularManagerOrgs).toHaveLength(1);
            (0, globals_1.expect)(regularManagerOrgs[0].organizationId).toBe(testData.regularOrg.id);
            // Verify demo manager is in demo org
            const demoManagerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .leftJoin(schema_1.users, (0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, schema_1.users.id))
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.demoManager.email));
            (0, globals_1.expect)(demoManagerOrgs).toHaveLength(1);
            (0, globals_1.expect)(demoManagerOrgs[0].organizationId).toBe(testData.demoOrg.id);
        });
        (0, globals_1.it)('should have demo users only in demo organization', async () => {
            const demoUsers = await db_1.db
                .select({
                email: schema_1.users.email,
                role: schema_1.users.role,
                organizationId: schema_1.userOrganizations.organizationId
            })
                .from(schema_1.users)
                .leftJoin(schema_1.userOrganizations, (0, drizzle_orm_1.eq)(schema_1.users.id, schema_1.userOrganizations.userId))
                .where((0, drizzle_orm_1.inArray)(schema_1.users.role, ['demo_manager', 'demo_tenant', 'demo_resident']));
            (0, globals_1.expect)(demoUsers.length).toBeGreaterThan(0);
            // All demo users should be in demo organization
            for (const user of demoUsers) {
                (0, globals_1.expect)(user.organizationId).toBe(testData.demoOrg.id);
            }
        });
        (0, globals_1.it)('should have regular users only in regular organization', async () => {
            const regularUsers = await db_1.db
                .select({
                email: schema_1.users.email,
                role: schema_1.users.role,
                organizationId: schema_1.userOrganizations.organizationId
            })
                .from(schema_1.users)
                .leftJoin(schema_1.userOrganizations, (0, drizzle_orm_1.eq)(schema_1.users.id, schema_1.userOrganizations.userId))
                .where((0, drizzle_orm_1.inArray)(schema_1.users.role, ['manager', 'tenant', 'resident']));
            const testUsers = regularUsers.filter(u => u.email && u.email.includes('@test.koveo.com'));
            (0, globals_1.expect)(testUsers.length).toBeGreaterThan(0);
            // All regular test users should be in regular organization  
            for (const user of testUsers) {
                (0, globals_1.expect)(user.organizationId).toBe(testData.regularOrg.id);
            }
        });
    });
    (0, globals_1.describe)('API Endpoint Access Control', () => {
        async function loginUser(email, password) {
            try {
                const response = await fetch('http://localhost:5000/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                if (response.ok) {
                    const cookies = response.headers.get('set-cookie');
                    return cookies;
                }
                return null;
            }
            catch (error) {
                console.error('Login failed:', error);
                return null;
            }
        }
        async function fetchUsersAsRole(email, password) {
            const cookies = await loginUser(email, password);
            if (!cookies) {
                throw new Error(`Failed to login as ${email}`);
            }
            const response = await fetch('http://localhost:5000/api/users', {
                headers: { 'Cookie': cookies }
            });
            if (response.ok) {
                return await response.json();
            }
            else {
                throw new Error(`Failed to fetch users: ${response.status}`);
            }
        }
        (0, globals_1.it)('should allow admin to see all users including demo users', async () => {
            const users = await fetchUsersAsRole(testData.adminUser.email, testData.adminUser.password);
            (0, globals_1.expect)(users.length).toBeGreaterThan(0);
            // Admin should see both regular and demo users
            const userRoles = users.map(u => u.role);
            const hasRegularUsers = userRoles.some(role => ['manager', 'tenant', 'resident'].includes(role));
            const hasDemoUsers = userRoles.some(role => role.startsWith('demo'));
            (0, globals_1.expect)(hasRegularUsers).toBe(true);
            (0, globals_1.expect)(hasDemoUsers).toBe(true);
        });
        (0, globals_1.it)('should allow regular manager to see only users in their organization', async () => {
            const users = await fetchUsersAsRole(testData.regularManager.email, testData.regularManager.password);
            (0, globals_1.expect)(users.length).toBeGreaterThan(0);
            // Regular manager should only see regular users, no demo users
            const userRoles = users.map(u => u.role);
            const hasDemoUsers = userRoles.some(role => role.startsWith('demo'));
            (0, globals_1.expect)(hasDemoUsers).toBe(false);
            // Should see users from their organization (including themselves)
            const hasRegularUsers = userRoles.some(role => ['admin', 'manager', 'tenant', 'resident'].includes(role));
            (0, globals_1.expect)(hasRegularUsers).toBe(true);
        });
        (0, globals_1.it)('should allow demo manager to see only demo role users', async () => {
            const users = await fetchUsersAsRole(testData.demoManager.email, testData.demoManager.password);
            (0, globals_1.expect)(users.length).toBeGreaterThan(0);
            // Demo manager should only see demo users
            const userRoles = users.map(u => u.role);
            const hasNonDemoUsers = userRoles.some(role => !role.startsWith('demo'));
            (0, globals_1.expect)(hasNonDemoUsers).toBe(false);
            // Should see demo users (including themselves)
            const hasDemoUsers = userRoles.some(role => role.startsWith('demo'));
            (0, globals_1.expect)(hasDemoUsers).toBe(true);
        });
    });
    (0, globals_1.describe)('User Management CRUD Operations', () => {
        (0, globals_1.it)('should verify manager can edit users in their organization', async () => {
            // This test would check the PUT /api/users/:id endpoint
            // For now, we'll test the access logic by verifying organization membership
            const regularManager = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.regularManager.email))
                .then(results => results[0]);
            const regularTenant = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.regularTenant.email))
                .then(results => results[0]);
            (0, globals_1.expect)(regularManager).toBeDefined();
            (0, globals_1.expect)(regularTenant).toBeDefined();
            // Verify they're in the same organization
            const managerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, regularManager.id));
            const tenantOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, regularTenant.id));
            (0, globals_1.expect)(managerOrgs[0]?.organizationId).toBe(tenantOrgs[0]?.organizationId);
        });
        (0, globals_1.it)('should verify demo manager cannot access regular users', async () => {
            const demoManager = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.demoManager.email))
                .then(results => results[0]);
            const regularTenant = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.regularTenant.email))
                .then(results => results[0]);
            (0, globals_1.expect)(demoManager).toBeDefined();
            (0, globals_1.expect)(regularTenant).toBeDefined();
            // Verify they're in different organizations
            const demoManagerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, demoManager.id));
            const regularTenantOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, regularTenant.id));
            (0, globals_1.expect)(demoManagerOrgs[0]?.organizationId).not.toBe(regularTenantOrgs[0]?.organizationId);
        });
        (0, globals_1.it)('should verify role-based access permissions', async () => {
            const allUsers = await db_1.db.select().from(schema_1.users);
            const testUsers = allUsers.filter(u => u.email.includes('@test.koveo.com'));
            // Group users by role
            const usersByRole = {
                admin: testUsers.filter(u => u.role === 'admin'),
                manager: testUsers.filter(u => u.role === 'manager'),
                demo_manager: testUsers.filter(u => u.role === 'demo_manager'),
                tenant: testUsers.filter(u => u.role === 'tenant'),
                demo_tenant: testUsers.filter(u => u.role === 'demo_tenant'),
                demo_resident: testUsers.filter(u => u.role === 'demo_resident')
            };
            // Verify we have the expected roles
            (0, globals_1.expect)(usersByRole.admin.length).toBeGreaterThanOrEqual(1);
            (0, globals_1.expect)(usersByRole.manager.length).toBeGreaterThanOrEqual(1);
            (0, globals_1.expect)(usersByRole.demo_manager.length).toBeGreaterThanOrEqual(1);
            (0, globals_1.expect)(usersByRole.tenant.length).toBeGreaterThanOrEqual(1);
            (0, globals_1.expect)(usersByRole.demo_tenant.length).toBeGreaterThanOrEqual(1);
            (0, globals_1.expect)(usersByRole.demo_resident.length).toBeGreaterThanOrEqual(1);
        });
    });
    (0, globals_1.describe)('Demo User Isolation', () => {
        (0, globals_1.it)('should ensure demo and regular users are properly isolated', async () => {
            // Get all demo users
            const demoUsers = await db_1.db
                .select({
                id: schema_1.users.id,
                role: schema_1.users.role,
                organizationId: schema_1.userOrganizations.organizationId
            })
                .from(schema_1.users)
                .leftJoin(schema_1.userOrganizations, (0, drizzle_orm_1.eq)(schema_1.users.id, schema_1.userOrganizations.userId))
                .where((0, drizzle_orm_1.inArray)(schema_1.users.role, ['demo_manager', 'demo_tenant', 'demo_resident']));
            // Get all regular users from our test data
            const regularUsers = await db_1.db
                .select({
                id: schema_1.users.id,
                role: schema_1.users.role,
                organizationId: schema_1.userOrganizations.organizationId
            })
                .from(schema_1.users)
                .leftJoin(schema_1.userOrganizations, (0, drizzle_orm_1.eq)(schema_1.users.id, schema_1.userOrganizations.userId))
                .where((0, drizzle_orm_1.inArray)(schema_1.users.email, [
                testData.adminUser.email,
                testData.regularManager.email,
                testData.regularTenant.email
            ]));
            // Verify demo users are only in demo organization
            for (const demoUser of demoUsers) {
                if (demoUser.organizationId) {
                    (0, globals_1.expect)(demoUser.organizationId).toBe(testData.demoOrg.id);
                }
            }
            // Verify regular users are not in demo organization
            for (const regularUser of regularUsers) {
                if (regularUser.organizationId && regularUser.role !== 'admin') {
                    (0, globals_1.expect)(regularUser.organizationId).not.toBe(testData.demoOrg.id);
                }
            }
        });
        (0, globals_1.it)('should verify demo organization type is properly set', async () => {
            const demoOrg = await db_1.db
                .select()
                .from(schema_1.organizations)
                .where((0, drizzle_orm_1.eq)(schema_1.organizations.id, testData.demoOrg.id))
                .then(results => results[0]);
            (0, globals_1.expect)(demoOrg).toBeDefined();
            (0, globals_1.expect)(demoOrg.type).toBe('demo');
        });
        (0, globals_1.it)('should verify regular organization type is not demo', async () => {
            const regularOrg = await db_1.db
                .select()
                .from(schema_1.organizations)
                .where((0, drizzle_orm_1.eq)(schema_1.organizations.id, testData.regularOrg.id))
                .then(results => results[0]);
            (0, globals_1.expect)(regularOrg).toBeDefined();
            (0, globals_1.expect)(regularOrg.type).not.toBe('demo');
            (0, globals_1.expect)(regularOrg.type).toBe('management_company');
        });
    });
    (0, globals_1.describe)('Critical Access Control Issues', () => {
        (0, globals_1.it)('should detect if manager can access users outside their organization', async () => {
            // This is a security test to ensure managers cannot access users from other organizations
            const regularManagerUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.regularManager.email))
                .then(results => results[0]);
            const demoUsers = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.inArray)(schema_1.users.role, ['demo_manager', 'demo_tenant', 'demo_resident']));
            (0, globals_1.expect)(regularManagerUser).toBeDefined();
            (0, globals_1.expect)(demoUsers.length).toBeGreaterThan(0);
            // Regular manager should not be able to access demo users
            // This would be enforced by the API endpoint logic
            const managerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, regularManagerUser.id));
            const managerOrgIds = managerOrgs.map(org => org.organizationId);
            for (const demoUser of demoUsers) {
                const demoUserOrgs = await db_1.db
                    .select({ organizationId: schema_1.userOrganizations.organizationId })
                    .from(schema_1.userOrganizations)
                    .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, demoUser.id));
                const demoUserOrgIds = demoUserOrgs.map(org => org.organizationId);
                const hasOverlap = managerOrgIds.some(id => demoUserOrgIds.includes(id));
                // Should have no organization overlap between regular manager and demo users
                (0, globals_1.expect)(hasOverlap).toBe(false);
            }
        });
        (0, globals_1.it)('should ensure demo manager can only see demo users', async () => {
            const demoManagerUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, testData.demoManager.email))
                .then(results => results[0]);
            (0, globals_1.expect)(demoManagerUser).toBeDefined();
            (0, globals_1.expect)(demoManagerUser.role).toBe('demo_manager');
            // Demo manager should only have access to demo organization
            const demoManagerOrgs = await db_1.db
                .select({ organizationId: schema_1.userOrganizations.organizationId })
                .from(schema_1.userOrganizations)
                .where((0, drizzle_orm_1.eq)(schema_1.userOrganizations.userId, demoManagerUser.id));
            (0, globals_1.expect)(demoManagerOrgs).toHaveLength(1);
            (0, globals_1.expect)(demoManagerOrgs[0].organizationId).toBe(testData.demoOrg.id);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi91c2VyLW1hbmFnZW1lbnQtYWNjZXNzLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FBMEU7QUFDMUUsd0NBQXFDO0FBQ3JDLGdEQUE4RTtBQUM5RSw2Q0FBMEM7QUFDMUMsaURBQW1DO0FBRW5DOzs7Ozs7OztHQVFHO0FBRUgsSUFBQSxrQkFBUSxFQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtJQUM5QyxrQkFBa0I7SUFDbEIsTUFBTSxRQUFRLEdBQUc7UUFDZixnQkFBZ0I7UUFDaEIsVUFBVSxFQUFFO1lBQ1YsRUFBRSxFQUFFLGtCQUFrQjtZQUN0QixJQUFJLEVBQUUsMkJBQTJCO1lBQ2pDLElBQUksRUFBRSxvQkFBb0I7WUFDMUIsT0FBTyxFQUFFLGlCQUFpQjtZQUMxQixJQUFJLEVBQUUsVUFBVTtZQUNoQixRQUFRLEVBQUUsSUFBSTtZQUNkLFVBQVUsRUFBRSxTQUFTO1NBQ3RCO1FBQ0QsT0FBTyxFQUFFO1lBQ1AsRUFBRSxFQUFFLGVBQWU7WUFDbkIsSUFBSSxFQUFFLHdCQUF3QjtZQUM5QixJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxpQkFBaUI7WUFDMUIsSUFBSSxFQUFFLFVBQVU7WUFDaEIsUUFBUSxFQUFFLElBQUk7WUFDZCxVQUFVLEVBQUUsU0FBUztTQUN0QjtRQUNELFFBQVE7UUFDUixTQUFTLEVBQUU7WUFDVCxRQUFRLEVBQUUsWUFBWTtZQUN0QixLQUFLLEVBQUUsc0JBQXNCO1lBQzdCLFFBQVEsRUFBRSxVQUFVO1lBQ3BCLFNBQVMsRUFBRSxPQUFPO1lBQ2xCLFFBQVEsRUFBRSxNQUFNO1lBQ2hCLElBQUksRUFBRSxPQUFnQjtZQUN0QixRQUFRLEVBQUUsSUFBSTtZQUNkLFFBQVEsRUFBRSxJQUFJO1NBQ2Y7UUFDRCxjQUFjLEVBQUU7WUFDZCxRQUFRLEVBQUUsaUJBQWlCO1lBQzNCLEtBQUssRUFBRSx3QkFB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QUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFL0IsSUFBQSxnQkFBTSxFQUFDLGVBQWUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3RDLElBQUEsZ0JBQU0sRUFBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRWxELDREQUE0RDtZQUM1RCxNQUFNLGVBQWUsR0FBRyxNQUFNLE9BQUU7aUJBQzdCLE1BQU0sQ0FBQyxFQUFFLGNBQWMsRUFBRSwwQkFBaUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQztpQkFDNUQsSUFBSSxDQUFDLDBCQUFpQixDQUFDO2lCQUN2QixLQUFLLENBQUMsSUFBQSxnQkFBRSxFQUFDLDBCQUFpQixDQUFDLE1BQU0sRUFBRSxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUUzRCxJQUFBLGdCQUFNLEVBQUMsZUFBZSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3hDLElBQUEsZ0JBQU0sRUFBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvdGVzdHMvaW50ZWdyYXRpb24vdXNlci1tYW5hZ2VtZW50LWFjY2Vzcy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVBbGwsIGFmdGVyQWxsIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uL3NlcnZlci9kYic7XG5pbXBvcnQgeyB1c2Vycywgb3JnYW5pemF0aW9ucywgdXNlck9yZ2FuaXphdGlvbnMgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2NoZW1hJztcbmltcG9ydCB7IGVxLCBpbkFycmF5IH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuaW1wb3J0ICogYXMgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcblxuLyoqXG4gKiBVc2VyIE1hbmFnZW1lbnQgQWNjZXNzIENvbnRyb2wgVGVzdFxuICogXG4gKiBUZXN0cyBhY2Nlc3MgY29udHJvbCBmb3IgL21hbmFnZXIvdXNlci1tYW5hZ2VtZW50IHJvdXRlOlxuICogLSBNYW5hZ2VycyBzaG91bGQgc2VlLCBlZGl0LCBkZWxldGUsIGNyZWF0ZSB1c2VycyBpbiB0aGVpciBvcmdhbml6YXRpb25cbiAqIC0gRGVtbyBtYW5hZ2VycyBzaG91bGQgb25seSBzZWUgb3RoZXIgZGVtbyByb2xlIHVzZXJzXG4gKiAtIFJlZ3VsYXIgbWFuYWdlcnMgc2hvdWxkIG5vdCBzZWUgZGVtbyB1c2Vyc1xuICogLSBQcm9wZXIgQ1JVRCBvcGVyYXRpb25zIGJhc2VkIG9uIHJvbGUgcGVybWlzc2lvbnNcbiAqL1xuXG5kZXNjcmliZSgnVXNlciBNYW5hZ2VtZW50IEFjY2VzcyBDb250cm9sJywgKCkgPT4ge1xuICAvLyBUZXN0IGRhdGEgc2V0dXBcbiAgY29uc3QgdGVzdERhdGEgPSB7XG4gICAgLy8gT3JnYW5pemF0aW9uc1xuICAgIHJlZ3VsYXJPcmc6IHtcbiAgICAgIGlkOiAnb3JnLXJlZ3VsYXItdGVzdCcsXG4gICAgICBuYW1lOiAnUmVndWxhciBUZXN0IE9yZ2FuaXphdGlvbicsXG4gICAgICB0eXBlOiAnbWFuYWdlbWVudF9jb21wYW55JyxcbiAgICAgIGFkZHJlc3M6ICcxMjMgVGVzdCBTdHJlZXQnLFxuICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgcG9zdGFsQ29kZTogJ0gxQSAxQTEnXG4gICAgfSxcbiAgICBkZW1vT3JnOiB7XG4gICAgICBpZDogJ29yZy1kZW1vLXRlc3QnLFxuICAgICAgbmFtZTogJ0RlbW8gVGVzdCBPcmdhbml6YXRpb24nLFxuICAgICAgdHlwZTogJ2RlbW8nLFxuICAgICAgYWRkcmVzczogJzQ1NiBEZW1vIFN0cmVldCcsXG4gICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICBwb3N0YWxDb2RlOiAnSDFCIDFCMSdcbiAgICB9LFxuICAgIC8vIFVzZXJzXG4gICAgYWRtaW5Vc2VyOiB7XG4gICAgICB1c2VybmFtZTogJ2FkbWluLXRlc3QnLFxuICAgICAgZW1haWw6ICdhZG1pbkB0ZXN0LmtvdmVvLmNvbScsXG4gICAgICBwYXNzd29yZDogJ2FkbWluMTIzJyxcbiAgICAgIGZpcnN0TmFtZTogJ0FkbWluJyxcbiAgICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgICByb2xlOiAnYWRtaW4nIGFzIGNvbnN0LFxuICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZVxuICAgIH0sXG4gICAgcmVndWxhck1hbmFnZXI6IHtcbiAgICAgIHVzZXJuYW1lOiAnbWFuYWdlci1yZWd1bGFyJyxcbiAgICAgIGVtYWlsOiAnbWFuYWdlckB0ZXN0LmtvdmVvLmNvbScsIFxuICAgICAgcGFzc3dvcmQ6ICdtYW5hZ2VyMTIzJyxcbiAgICAgIGZpcnN0TmFtZTogJ1JlZ3VsYXInLFxuICAgICAgbGFzdE5hbWU6ICdNYW5hZ2VyJyxcbiAgICAgIHJvbGU6ICdtYW5hZ2VyJyBhcyBjb25zdCxcbiAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICB9LFxuICAgIGRlbW9NYW5hZ2VyOiB7XG4gICAgICB1c2VybmFtZTogJ2RlbW8tbWFuYWdlcicsXG4gICAgICBlbWFpbDogJ2RlbW8tbWFuYWdlckB0ZXN0LmtvdmVvLmNvbScsXG4gICAgICBwYXNzd29yZDogJ2RlbW8xMjMnLFxuICAgICAgZmlyc3ROYW1lOiAnRGVtbycsXG4gICAgICBsYXN0TmFtZTogJ01hbmFnZXInLFxuICAgICAgcm9sZTogJ2RlbW9fbWFuYWdlcicgYXMgY29uc3QsXG4gICAgICBsYW5ndWFnZTogJ2VuJyxcbiAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgfSxcbiAgICByZWd1bGFyVGVuYW50OiB7XG4gICAgICB1c2VybmFtZTogJ3RlbmFudC1yZWd1bGFyJyxcbiAgICAgIGVtYWlsOiAndGVuYW50QHRlc3Qua292ZW8uY29tJyxcbiAgICAgIHBhc3N3b3JkOiAndGVuYW50MTIzJyxcbiAgICAgIGZpcnN0TmFtZTogJ1JlZ3VsYXInLFxuICAgICAgbGFzdE5hbWU6ICdUZW5hbnQnLFxuICAgICAgcm9sZTogJ3RlbmFudCcgYXMgY29uc3QsXG4gICAgICBsYW5ndWFnZTogJ2VuJyxcbiAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgfSxcbiAgICBkZW1vVGVuYW50OiB7XG4gICAgICB1c2VybmFtZTogJ2RlbW8tdGVuYW50JyxcbiAgICAgIGVtYWlsOiAnZGVtby10ZW5hbnRAdGVzdC5rb3Zlby5jb20nLFxuICAgICAgcGFzc3dvcmQ6ICdkZW1vMTIzJyxcbiAgICAgIGZpcnN0TmFtZTogJ0RlbW8nLFxuICAgICAgbGFzdE5hbWU6ICdUZW5hbnQnLFxuICAgICAgcm9sZTogJ2RlbW9fdGVuYW50JyBhcyBjb25zdCxcbiAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICB9LFxuICAgIGRlbW9SZXNpZGVudDoge1xuICAgICAgdXNlcm5hbWU6ICdkZW1vLXJlc2lkZW50JyxcbiAgICAgIGVtYWlsOiAnZGVtby1yZXNpZGVudEB0ZXN0LmtvdmVvLmNvbScsXG4gICAgICBwYXNzd29yZDogJ2RlbW8xMjMnLFxuICAgICAgZmlyc3ROYW1lOiAnRGVtbycsXG4gICAgICBsYXN0TmFtZTogJ1Jlc2lkZW50JyxcbiAgICAgIHJvbGU6ICdkZW1vX3Jlc2lkZW50JyBhcyBjb25zdCxcbiAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICB9XG4gIH07XG5cbiAgbGV0IGNyZWF0ZWRVc2VySWRzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgY3JlYXRlZE9yZ0lkczogc3RyaW5nW10gPSBbXTtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIENsZWFuIHVwIGFueSBleGlzdGluZyB0ZXN0IGRhdGFcbiAgICBhd2FpdCBkYi5kZWxldGUodXNlcnMpLndoZXJlKGluQXJyYXkodXNlcnMuZW1haWwsIFtcbiAgICAgIHRlc3REYXRhLmFkbWluVXNlci5lbWFpbCxcbiAgICAgIHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsLFxuICAgICAgdGVzdERhdGEuZGVtb01hbmFnZXIuZW1haWwsXG4gICAgICB0ZXN0RGF0YS5yZWd1bGFyVGVuYW50LmVtYWlsLFxuICAgICAgdGVzdERhdGEuZGVtb1RlbmFudC5lbWFpbCxcbiAgICAgIHRlc3REYXRhLmRlbW9SZXNpZGVudC5lbWFpbFxuICAgIF0pKTtcbiAgICBcbiAgICBhd2FpdCBkYi5kZWxldGUob3JnYW5pemF0aW9ucykud2hlcmUoaW5BcnJheShvcmdhbml6YXRpb25zLmlkLCBbXG4gICAgICB0ZXN0RGF0YS5yZWd1bGFyT3JnLmlkLFxuICAgICAgdGVzdERhdGEuZGVtb09yZy5pZFxuICAgIF0pKTtcblxuICAgIC8vIENyZWF0ZSB0ZXN0IG9yZ2FuaXphdGlvbnNcbiAgICBhd2FpdCBkYi5pbnNlcnQob3JnYW5pemF0aW9ucykudmFsdWVzKFt0ZXN0RGF0YS5yZWd1bGFyT3JnLCB0ZXN0RGF0YS5kZW1vT3JnXSk7XG4gICAgY3JlYXRlZE9yZ0lkcyA9IFt0ZXN0RGF0YS5yZWd1bGFyT3JnLmlkLCB0ZXN0RGF0YS5kZW1vT3JnLmlkXTtcblxuICAgIC8vIENyZWF0ZSB0ZXN0IHVzZXJzIHdpdGggaGFzaGVkIHBhc3N3b3Jkc1xuICAgIGNvbnN0IHVzZXJzVG9DcmVhdGUgPSBbXG4gICAgICB0ZXN0RGF0YS5hZG1pblVzZXIsXG4gICAgICB0ZXN0RGF0YS5yZWd1bGFyTWFuYWdlcixcbiAgICAgIHRlc3REYXRhLmRlbW9NYW5hZ2VyLFxuICAgICAgdGVzdERhdGEucmVndWxhclRlbmFudCxcbiAgICAgIHRlc3REYXRhLmRlbW9UZW5hbnQsXG4gICAgICB0ZXN0RGF0YS5kZW1vUmVzaWRlbnRcbiAgICBdO1xuXG4gICAgZm9yIChjb25zdCB1c2VyIG9mIHVzZXJzVG9DcmVhdGUpIHtcbiAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godXNlci5wYXNzd29yZCwgMTApO1xuICAgICAgY29uc3QgY3JlYXRlZFVzZXIgPSBhd2FpdCBkYi5pbnNlcnQodXNlcnMpLnZhbHVlcyh7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLFxuICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0TmFtZSxcbiAgICAgICAgcm9sZTogdXNlci5yb2xlLFxuICAgICAgICBsYW5ndWFnZTogdXNlci5sYW5ndWFnZSxcbiAgICAgICAgaXNBY3RpdmU6IHVzZXIuaXNBY3RpdmVcbiAgICAgIH0pLnJldHVybmluZyh7IGlkOiB1c2Vycy5pZCB9KTtcbiAgICAgIFxuICAgICAgY3JlYXRlZFVzZXJJZHMucHVzaChjcmVhdGVkVXNlclswXS5pZCk7XG4gICAgICBcbiAgICAgIC8vIEFzc2lnbiB1c2VycyB0byBvcmdhbml6YXRpb25zXG4gICAgICBpZiAodXNlci5yb2xlLnN0YXJ0c1dpdGgoJ2RlbW8nKSkge1xuICAgICAgICAvLyBEZW1vIHVzZXJzIGdvIHRvIGRlbW8gb3JnYW5pemF0aW9uXG4gICAgICAgIGF3YWl0IGRiLmluc2VydCh1c2VyT3JnYW5pemF0aW9ucykudmFsdWVzKHtcbiAgICAgICAgICB1c2VySWQ6IGNyZWF0ZWRVc2VyWzBdLmlkLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkOiB0ZXN0RGF0YS5kZW1vT3JnLmlkXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVndWxhciB1c2VycyBnbyB0byByZWd1bGFyIG9yZ2FuaXphdGlvblxuICAgICAgICBhd2FpdCBkYi5pbnNlcnQodXNlck9yZ2FuaXphdGlvbnMpLnZhbHVlcyh7XG4gICAgICAgICAgdXNlcklkOiBjcmVhdGVkVXNlclswXS5pZCxcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogdGVzdERhdGEucmVndWxhck9yZy5pZFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBDbGVhbiB1cCB0ZXN0IGRhdGFcbiAgICBpZiAoY3JlYXRlZFVzZXJJZHMubGVuZ3RoID4gMCkge1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJPcmdhbml6YXRpb25zKS53aGVyZShpbkFycmF5KHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgY3JlYXRlZFVzZXJJZHMpKTtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2Vycykud2hlcmUoaW5BcnJheSh1c2Vycy5pZCwgY3JlYXRlZFVzZXJJZHMpKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGNyZWF0ZWRPcmdJZHMubGVuZ3RoID4gMCkge1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKG9yZ2FuaXphdGlvbnMpLndoZXJlKGluQXJyYXkob3JnYW5pemF0aW9ucy5pZCwgY3JlYXRlZE9yZ0lkcykpO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ09yZ2FuaXphdGlvbi1iYXNlZCBVc2VyIEFjY2VzcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZlcmlmeSB0ZXN0IHVzZXJzIGFyZSBpbiBjb3JyZWN0IG9yZ2FuaXphdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBWZXJpZnkgcmVndWxhciBtYW5hZ2VyIGlzIGluIHJlZ3VsYXIgb3JnXG4gICAgICBjb25zdCByZWd1bGFyTWFuYWdlck9yZ3MgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIH0pXG4gICAgICAgIC5mcm9tKHVzZXJPcmdhbml6YXRpb25zKVxuICAgICAgICAubGVmdEpvaW4odXNlcnMsIGVxKHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgdXNlcnMuaWQpKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsKSk7XG5cbiAgICAgIGV4cGVjdChyZWd1bGFyTWFuYWdlck9yZ3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZWd1bGFyTWFuYWdlck9yZ3NbMF0ub3JnYW5pemF0aW9uSWQpLnRvQmUodGVzdERhdGEucmVndWxhck9yZy5pZCk7XG5cbiAgICAgIC8vIFZlcmlmeSBkZW1vIG1hbmFnZXIgaXMgaW4gZGVtbyBvcmdcbiAgICAgIGNvbnN0IGRlbW9NYW5hZ2VyT3JncyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoeyBvcmdhbml6YXRpb25JZDogdXNlck9yZ2FuaXphdGlvbnMub3JnYW5pemF0aW9uSWQgfSlcbiAgICAgICAgLmZyb20odXNlck9yZ2FuaXphdGlvbnMpXG4gICAgICAgIC5sZWZ0Sm9pbih1c2VycywgZXEodXNlck9yZ2FuaXphdGlvbnMudXNlcklkLCB1c2Vycy5pZCkpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy5lbWFpbCwgdGVzdERhdGEuZGVtb01hbmFnZXIuZW1haWwpKTtcblxuICAgICAgZXhwZWN0KGRlbW9NYW5hZ2VyT3JncykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGRlbW9NYW5hZ2VyT3Jnc1swXS5vcmdhbml6YXRpb25JZCkudG9CZSh0ZXN0RGF0YS5kZW1vT3JnLmlkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBkZW1vIHVzZXJzIG9ubHkgaW4gZGVtbyBvcmdhbml6YXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1vVXNlcnMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgXG4gICAgICAgICAgZW1haWw6IHVzZXJzLmVtYWlsLFxuICAgICAgICAgIHJvbGU6IHVzZXJzLnJvbGUsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIFxuICAgICAgICB9KVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLmxlZnRKb2luKHVzZXJPcmdhbml6YXRpb25zLCBlcSh1c2Vycy5pZCwgdXNlck9yZ2FuaXphdGlvbnMudXNlcklkKSlcbiAgICAgICAgLndoZXJlKGluQXJyYXkodXNlcnMucm9sZSwgWydkZW1vX21hbmFnZXInLCAnZGVtb190ZW5hbnQnLCAnZGVtb19yZXNpZGVudCddKSk7XG5cbiAgICAgIGV4cGVjdChkZW1vVXNlcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBcbiAgICAgIC8vIEFsbCBkZW1vIHVzZXJzIHNob3VsZCBiZSBpbiBkZW1vIG9yZ2FuaXphdGlvblxuICAgICAgZm9yIChjb25zdCB1c2VyIG9mIGRlbW9Vc2Vycykge1xuICAgICAgICBleHBlY3QodXNlci5vcmdhbml6YXRpb25JZCkudG9CZSh0ZXN0RGF0YS5kZW1vT3JnLmlkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSByZWd1bGFyIHVzZXJzIG9ubHkgaW4gcmVndWxhciBvcmdhbml6YXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZWd1bGFyVXNlcnMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHtcbiAgICAgICAgICBlbWFpbDogdXNlcnMuZW1haWwsXG4gICAgICAgICAgcm9sZTogdXNlcnMucm9sZSxcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogdXNlck9yZ2FuaXphdGlvbnMub3JnYW5pemF0aW9uSWRcbiAgICAgICAgfSlcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC5sZWZ0Sm9pbih1c2VyT3JnYW5pemF0aW9ucywgZXEodXNlcnMuaWQsIHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCkpXG4gICAgICAgIC53aGVyZShpbkFycmF5KHVzZXJzLnJvbGUsIFsnbWFuYWdlcicsICd0ZW5hbnQnLCAncmVzaWRlbnQnXSkpO1xuXG4gICAgICBjb25zdCB0ZXN0VXNlcnMgPSByZWd1bGFyVXNlcnMuZmlsdGVyKHUgPT4gXG4gICAgICAgIHUuZW1haWwgJiYgdS5lbWFpbC5pbmNsdWRlcygnQHRlc3Qua292ZW8uY29tJylcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh0ZXN0VXNlcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBcbiAgICAgIC8vIEFsbCByZWd1bGFyIHRlc3QgdXNlcnMgc2hvdWxkIGJlIGluIHJlZ3VsYXIgb3JnYW5pemF0aW9uICBcbiAgICAgIGZvciAoY29uc3QgdXNlciBvZiB0ZXN0VXNlcnMpIHtcbiAgICAgICAgZXhwZWN0KHVzZXIub3JnYW5pemF0aW9uSWQpLnRvQmUodGVzdERhdGEucmVndWxhck9yZy5pZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBUEkgRW5kcG9pbnQgQWNjZXNzIENvbnRyb2wnLCAoKSA9PiB7XG4gICAgYXN5bmMgZnVuY3Rpb24gbG9naW5Vc2VyKGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBwYXNzd29yZCB9KVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zdCBjb29raWVzID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ3NldC1jb29raWUnKTtcbiAgICAgICAgICByZXR1cm4gY29va2llcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGZ1bmN0aW9uIGZldGNoVXNlcnNBc1JvbGUoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICAgIGNvbnN0IGNvb2tpZXMgPSBhd2FpdCBsb2dpblVzZXIoZW1haWwsIHBhc3N3b3JkKTtcbiAgICAgIGlmICghY29va2llcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2dpbiBhcyAke2VtYWlsfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjUwMDAvYXBpL3VzZXJzJywge1xuICAgICAgICBoZWFkZXJzOiB7ICdDb29raWUnOiBjb29raWVzIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHVzZXJzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIHNlZSBhbGwgdXNlcnMgaW5jbHVkaW5nIGRlbW8gdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGZldGNoVXNlcnNBc1JvbGUodGVzdERhdGEuYWRtaW5Vc2VyLmVtYWlsLCB0ZXN0RGF0YS5hZG1pblVzZXIucGFzc3dvcmQpO1xuICAgICAgXG4gICAgICBleHBlY3QodXNlcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBcbiAgICAgIC8vIEFkbWluIHNob3VsZCBzZWUgYm90aCByZWd1bGFyIGFuZCBkZW1vIHVzZXJzXG4gICAgICBjb25zdCB1c2VyUm9sZXMgPSB1c2Vycy5tYXAodSA9PiB1LnJvbGUpO1xuICAgICAgY29uc3QgaGFzUmVndWxhclVzZXJzID0gdXNlclJvbGVzLnNvbWUocm9sZSA9PiBbJ21hbmFnZXInLCAndGVuYW50JywgJ3Jlc2lkZW50J10uaW5jbHVkZXMocm9sZSkpO1xuICAgICAgY29uc3QgaGFzRGVtb1VzZXJzID0gdXNlclJvbGVzLnNvbWUocm9sZSA9PiByb2xlLnN0YXJ0c1dpdGgoJ2RlbW8nKSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChoYXNSZWd1bGFyVXNlcnMpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaGFzRGVtb1VzZXJzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyByZWd1bGFyIG1hbmFnZXIgdG8gc2VlIG9ubHkgdXNlcnMgaW4gdGhlaXIgb3JnYW5pemF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBmZXRjaFVzZXJzQXNSb2xlKHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsLCB0ZXN0RGF0YS5yZWd1bGFyTWFuYWdlci5wYXNzd29yZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh1c2Vycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIFxuICAgICAgLy8gUmVndWxhciBtYW5hZ2VyIHNob3VsZCBvbmx5IHNlZSByZWd1bGFyIHVzZXJzLCBubyBkZW1vIHVzZXJzXG4gICAgICBjb25zdCB1c2VyUm9sZXMgPSB1c2Vycy5tYXAodSA9PiB1LnJvbGUpO1xuICAgICAgY29uc3QgaGFzRGVtb1VzZXJzID0gdXNlclJvbGVzLnNvbWUocm9sZSA9PiByb2xlLnN0YXJ0c1dpdGgoJ2RlbW8nKSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChoYXNEZW1vVXNlcnMpLnRvQmUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBTaG91bGQgc2VlIHVzZXJzIGZyb20gdGhlaXIgb3JnYW5pemF0aW9uIChpbmNsdWRpbmcgdGhlbXNlbHZlcylcbiAgICAgIGNvbnN0IGhhc1JlZ3VsYXJVc2VycyA9IHVzZXJSb2xlcy5zb21lKHJvbGUgPT4gWydhZG1pbicsICdtYW5hZ2VyJywgJ3RlbmFudCcsICdyZXNpZGVudCddLmluY2x1ZGVzKHJvbGUpKTtcbiAgICAgIGV4cGVjdChoYXNSZWd1bGFyVXNlcnMpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGRlbW8gbWFuYWdlciB0byBzZWUgb25seSBkZW1vIHJvbGUgdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IGZldGNoVXNlcnNBc1JvbGUodGVzdERhdGEuZGVtb01hbmFnZXIuZW1haWwsIHRlc3REYXRhLmRlbW9NYW5hZ2VyLnBhc3N3b3JkKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHVzZXJzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgXG4gICAgICAvLyBEZW1vIG1hbmFnZXIgc2hvdWxkIG9ubHkgc2VlIGRlbW8gdXNlcnNcbiAgICAgIGNvbnN0IHVzZXJSb2xlcyA9IHVzZXJzLm1hcCh1ID0+IHUucm9sZSk7XG4gICAgICBjb25zdCBoYXNOb25EZW1vVXNlcnMgPSB1c2VyUm9sZXMuc29tZShyb2xlID0+ICFyb2xlLnN0YXJ0c1dpdGgoJ2RlbW8nKSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChoYXNOb25EZW1vVXNlcnMpLnRvQmUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBTaG91bGQgc2VlIGRlbW8gdXNlcnMgKGluY2x1ZGluZyB0aGVtc2VsdmVzKVxuICAgICAgY29uc3QgaGFzRGVtb1VzZXJzID0gdXNlclJvbGVzLnNvbWUocm9sZSA9PiByb2xlLnN0YXJ0c1dpdGgoJ2RlbW8nKSk7XG4gICAgICBleHBlY3QoaGFzRGVtb1VzZXJzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVXNlciBNYW5hZ2VtZW50IENSVUQgT3BlcmF0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZlcmlmeSBtYW5hZ2VyIGNhbiBlZGl0IHVzZXJzIGluIHRoZWlyIG9yZ2FuaXphdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRoaXMgdGVzdCB3b3VsZCBjaGVjayB0aGUgUFVUIC9hcGkvdXNlcnMvOmlkIGVuZHBvaW50XG4gICAgICAvLyBGb3Igbm93LCB3ZSdsbCB0ZXN0IHRoZSBhY2Nlc3MgbG9naWMgYnkgdmVyaWZ5aW5nIG9yZ2FuaXphdGlvbiBtZW1iZXJzaGlwXG4gICAgICBcbiAgICAgIGNvbnN0IHJlZ3VsYXJNYW5hZ2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsKSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiByZXN1bHRzWzBdKTtcblxuICAgICAgY29uc3QgcmVndWxhclRlbmFudCA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJzLmVtYWlsLCB0ZXN0RGF0YS5yZWd1bGFyVGVuYW50LmVtYWlsKSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiByZXN1bHRzWzBdKTtcblxuICAgICAgZXhwZWN0KHJlZ3VsYXJNYW5hZ2VyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlZ3VsYXJUZW5hbnQpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgIC8vIFZlcmlmeSB0aGV5J3JlIGluIHRoZSBzYW1lIG9yZ2FuaXphdGlvblxuICAgICAgY29uc3QgbWFuYWdlck9yZ3MgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIH0pXG4gICAgICAgIC5mcm9tKHVzZXJPcmdhbml6YXRpb25zKVxuICAgICAgICAud2hlcmUoZXEodXNlck9yZ2FuaXphdGlvbnMudXNlcklkLCByZWd1bGFyTWFuYWdlci5pZCkpO1xuXG4gICAgICBjb25zdCB0ZW5hbnRPcmdzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7IG9yZ2FuaXphdGlvbklkOiB1c2VyT3JnYW5pemF0aW9ucy5vcmdhbml6YXRpb25JZCB9KVxuICAgICAgICAuZnJvbSh1c2VyT3JnYW5pemF0aW9ucylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgcmVndWxhclRlbmFudC5pZCkpO1xuXG4gICAgICBleHBlY3QobWFuYWdlck9yZ3NbMF0/Lm9yZ2FuaXphdGlvbklkKS50b0JlKHRlbmFudE9yZ3NbMF0/Lm9yZ2FuaXphdGlvbklkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmVyaWZ5IGRlbW8gbWFuYWdlciBjYW5ub3QgYWNjZXNzIHJlZ3VsYXIgdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1vTWFuYWdlciA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJzLmVtYWlsLCB0ZXN0RGF0YS5kZW1vTWFuYWdlci5lbWFpbCkpXG4gICAgICAgIC50aGVuKHJlc3VsdHMgPT4gcmVzdWx0c1swXSk7XG5cbiAgICAgIGNvbnN0IHJlZ3VsYXJUZW5hbnQgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy5lbWFpbCwgdGVzdERhdGEucmVndWxhclRlbmFudC5lbWFpbCkpXG4gICAgICAgIC50aGVuKHJlc3VsdHMgPT4gcmVzdWx0c1swXSk7XG5cbiAgICAgIGV4cGVjdChkZW1vTWFuYWdlcikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZWd1bGFyVGVuYW50KS50b0JlRGVmaW5lZCgpO1xuXG4gICAgICAvLyBWZXJpZnkgdGhleSdyZSBpbiBkaWZmZXJlbnQgb3JnYW5pemF0aW9uc1xuICAgICAgY29uc3QgZGVtb01hbmFnZXJPcmdzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7IG9yZ2FuaXphdGlvbklkOiB1c2VyT3JnYW5pemF0aW9ucy5vcmdhbml6YXRpb25JZCB9KVxuICAgICAgICAuZnJvbSh1c2VyT3JnYW5pemF0aW9ucylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgZGVtb01hbmFnZXIuaWQpKTtcblxuICAgICAgY29uc3QgcmVndWxhclRlbmFudE9yZ3MgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIH0pXG4gICAgICAgIC5mcm9tKHVzZXJPcmdhbml6YXRpb25zKVxuICAgICAgICAud2hlcmUoZXEodXNlck9yZ2FuaXphdGlvbnMudXNlcklkLCByZWd1bGFyVGVuYW50LmlkKSk7XG5cbiAgICAgIGV4cGVjdChkZW1vTWFuYWdlck9yZ3NbMF0/Lm9yZ2FuaXphdGlvbklkKS5ub3QudG9CZShyZWd1bGFyVGVuYW50T3Jnc1swXT8ub3JnYW5pemF0aW9uSWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2ZXJpZnkgcm9sZS1iYXNlZCBhY2Nlc3MgcGVybWlzc2lvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhbGxVc2VycyA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20odXNlcnMpO1xuICAgICAgY29uc3QgdGVzdFVzZXJzID0gYWxsVXNlcnMuZmlsdGVyKHUgPT4gdS5lbWFpbC5pbmNsdWRlcygnQHRlc3Qua292ZW8uY29tJykpO1xuXG4gICAgICAvLyBHcm91cCB1c2VycyBieSByb2xlXG4gICAgICBjb25zdCB1c2Vyc0J5Um9sZSA9IHtcbiAgICAgICAgYWRtaW46IHRlc3RVc2Vycy5maWx0ZXIodSA9PiB1LnJvbGUgPT09ICdhZG1pbicpLFxuICAgICAgICBtYW5hZ2VyOiB0ZXN0VXNlcnMuZmlsdGVyKHUgPT4gdS5yb2xlID09PSAnbWFuYWdlcicpLFxuICAgICAgICBkZW1vX21hbmFnZXI6IHRlc3RVc2Vycy5maWx0ZXIodSA9PiB1LnJvbGUgPT09ICdkZW1vX21hbmFnZXInKSxcbiAgICAgICAgdGVuYW50OiB0ZXN0VXNlcnMuZmlsdGVyKHUgPT4gdS5yb2xlID09PSAndGVuYW50JyksXG4gICAgICAgIGRlbW9fdGVuYW50OiB0ZXN0VXNlcnMuZmlsdGVyKHUgPT4gdS5yb2xlID09PSAnZGVtb190ZW5hbnQnKSxcbiAgICAgICAgZGVtb19yZXNpZGVudDogdGVzdFVzZXJzLmZpbHRlcih1ID0+IHUucm9sZSA9PT0gJ2RlbW9fcmVzaWRlbnQnKVxuICAgICAgfTtcblxuICAgICAgLy8gVmVyaWZ5IHdlIGhhdmUgdGhlIGV4cGVjdGVkIHJvbGVzXG4gICAgICBleHBlY3QodXNlcnNCeVJvbGUuYWRtaW4ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDEpO1xuICAgICAgZXhwZWN0KHVzZXJzQnlSb2xlLm1hbmFnZXIubGVuZ3RoKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDEpO1xuICAgICAgZXhwZWN0KHVzZXJzQnlSb2xlLmRlbW9fbWFuYWdlci5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMSk7XG4gICAgICBleHBlY3QodXNlcnNCeVJvbGUudGVuYW50Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgxKTtcbiAgICAgIGV4cGVjdCh1c2Vyc0J5Um9sZS5kZW1vX3RlbmFudC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMSk7XG4gICAgICBleHBlY3QodXNlcnNCeVJvbGUuZGVtb19yZXNpZGVudC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEZW1vIFVzZXIgSXNvbGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZW5zdXJlIGRlbW8gYW5kIHJlZ3VsYXIgdXNlcnMgYXJlIHByb3Blcmx5IGlzb2xhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gR2V0IGFsbCBkZW1vIHVzZXJzXG4gICAgICBjb25zdCBkZW1vVXNlcnMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgXG4gICAgICAgICAgaWQ6IHVzZXJzLmlkLFxuICAgICAgICAgIHJvbGU6IHVzZXJzLnJvbGUsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIFxuICAgICAgICB9KVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLmxlZnRKb2luKHVzZXJPcmdhbml6YXRpb25zLCBlcSh1c2Vycy5pZCwgdXNlck9yZ2FuaXphdGlvbnMudXNlcklkKSlcbiAgICAgICAgLndoZXJlKGluQXJyYXkodXNlcnMucm9sZSwgWydkZW1vX21hbmFnZXInLCAnZGVtb190ZW5hbnQnLCAnZGVtb19yZXNpZGVudCddKSk7XG5cbiAgICAgIC8vIEdldCBhbGwgcmVndWxhciB1c2VycyBmcm9tIG91ciB0ZXN0IGRhdGFcbiAgICAgIGNvbnN0IHJlZ3VsYXJVc2VycyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3Qoe1xuICAgICAgICAgIGlkOiB1c2Vycy5pZCwgXG4gICAgICAgICAgcm9sZTogdXNlcnMucm9sZSxcbiAgICAgICAgICBvcmdhbml6YXRpb25JZDogdXNlck9yZ2FuaXphdGlvbnMub3JnYW5pemF0aW9uSWRcbiAgICAgICAgfSlcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC5sZWZ0Sm9pbih1c2VyT3JnYW5pemF0aW9ucywgZXEodXNlcnMuaWQsIHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCkpXG4gICAgICAgIC53aGVyZShpbkFycmF5KHVzZXJzLmVtYWlsLCBbXG4gICAgICAgICAgdGVzdERhdGEuYWRtaW5Vc2VyLmVtYWlsLFxuICAgICAgICAgIHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsLFxuICAgICAgICAgIHRlc3REYXRhLnJlZ3VsYXJUZW5hbnQuZW1haWxcbiAgICAgICAgXSkpO1xuXG4gICAgICAvLyBWZXJpZnkgZGVtbyB1c2VycyBhcmUgb25seSBpbiBkZW1vIG9yZ2FuaXphdGlvblxuICAgICAgZm9yIChjb25zdCBkZW1vVXNlciBvZiBkZW1vVXNlcnMpIHtcbiAgICAgICAgaWYgKGRlbW9Vc2VyLm9yZ2FuaXphdGlvbklkKSB7XG4gICAgICAgICAgZXhwZWN0KGRlbW9Vc2VyLm9yZ2FuaXphdGlvbklkKS50b0JlKHRlc3REYXRhLmRlbW9PcmcuaWQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFZlcmlmeSByZWd1bGFyIHVzZXJzIGFyZSBub3QgaW4gZGVtbyBvcmdhbml6YXRpb25cbiAgICAgIGZvciAoY29uc3QgcmVndWxhclVzZXIgb2YgcmVndWxhclVzZXJzKSB7XG4gICAgICAgIGlmIChyZWd1bGFyVXNlci5vcmdhbml6YXRpb25JZCAmJiByZWd1bGFyVXNlci5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgICAgICAgZXhwZWN0KHJlZ3VsYXJVc2VyLm9yZ2FuaXphdGlvbklkKS5ub3QudG9CZSh0ZXN0RGF0YS5kZW1vT3JnLmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2ZXJpZnkgZGVtbyBvcmdhbml6YXRpb24gdHlwZSBpcyBwcm9wZXJseSBzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1vT3JnID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKG9yZ2FuaXphdGlvbnMpXG4gICAgICAgIC53aGVyZShlcShvcmdhbml6YXRpb25zLmlkLCB0ZXN0RGF0YS5kZW1vT3JnLmlkKSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiByZXN1bHRzWzBdKTtcblxuICAgICAgZXhwZWN0KGRlbW9PcmcpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGVtb09yZy50eXBlKS50b0JlKCdkZW1vJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZlcmlmeSByZWd1bGFyIG9yZ2FuaXphdGlvbiB0eXBlIGlzIG5vdCBkZW1vJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVndWxhck9yZyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShvcmdhbml6YXRpb25zKVxuICAgICAgICAud2hlcmUoZXEob3JnYW5pemF0aW9ucy5pZCwgdGVzdERhdGEucmVndWxhck9yZy5pZCkpXG4gICAgICAgIC50aGVuKHJlc3VsdHMgPT4gcmVzdWx0c1swXSk7XG5cbiAgICAgIGV4cGVjdChyZWd1bGFyT3JnKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlZ3VsYXJPcmcudHlwZSkubm90LnRvQmUoJ2RlbW8nKTtcbiAgICAgIGV4cGVjdChyZWd1bGFyT3JnLnR5cGUpLnRvQmUoJ21hbmFnZW1lbnRfY29tcGFueScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ3JpdGljYWwgQWNjZXNzIENvbnRyb2wgSXNzdWVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGlmIG1hbmFnZXIgY2FuIGFjY2VzcyB1c2VycyBvdXRzaWRlIHRoZWlyIG9yZ2FuaXphdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRoaXMgaXMgYSBzZWN1cml0eSB0ZXN0IHRvIGVuc3VyZSBtYW5hZ2VycyBjYW5ub3QgYWNjZXNzIHVzZXJzIGZyb20gb3RoZXIgb3JnYW5pemF0aW9uc1xuICAgICAgY29uc3QgcmVndWxhck1hbmFnZXJVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHRlc3REYXRhLnJlZ3VsYXJNYW5hZ2VyLmVtYWlsKSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiByZXN1bHRzWzBdKTtcblxuICAgICAgY29uc3QgZGVtb1VzZXJzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoaW5BcnJheSh1c2Vycy5yb2xlLCBbJ2RlbW9fbWFuYWdlcicsICdkZW1vX3RlbmFudCcsICdkZW1vX3Jlc2lkZW50J10pKTtcblxuICAgICAgZXhwZWN0KHJlZ3VsYXJNYW5hZ2VyVXNlcikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkZW1vVXNlcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIC8vIFJlZ3VsYXIgbWFuYWdlciBzaG91bGQgbm90IGJlIGFibGUgdG8gYWNjZXNzIGRlbW8gdXNlcnNcbiAgICAgIC8vIFRoaXMgd291bGQgYmUgZW5mb3JjZWQgYnkgdGhlIEFQSSBlbmRwb2ludCBsb2dpY1xuICAgICAgY29uc3QgbWFuYWdlck9yZ3MgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHsgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIH0pXG4gICAgICAgIC5mcm9tKHVzZXJPcmdhbml6YXRpb25zKVxuICAgICAgICAud2hlcmUoZXEodXNlck9yZ2FuaXphdGlvbnMudXNlcklkLCByZWd1bGFyTWFuYWdlclVzZXIuaWQpKTtcblxuICAgICAgY29uc3QgbWFuYWdlck9yZ0lkcyA9IG1hbmFnZXJPcmdzLm1hcChvcmcgPT4gb3JnLm9yZ2FuaXphdGlvbklkKTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBkZW1vVXNlciBvZiBkZW1vVXNlcnMpIHtcbiAgICAgICAgY29uc3QgZGVtb1VzZXJPcmdzID0gYXdhaXQgZGJcbiAgICAgICAgICAuc2VsZWN0KHsgb3JnYW5pemF0aW9uSWQ6IHVzZXJPcmdhbml6YXRpb25zLm9yZ2FuaXphdGlvbklkIH0pXG4gICAgICAgICAgLmZyb20odXNlck9yZ2FuaXphdGlvbnMpXG4gICAgICAgICAgLndoZXJlKGVxKHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgZGVtb1VzZXIuaWQpKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGRlbW9Vc2VyT3JnSWRzID0gZGVtb1VzZXJPcmdzLm1hcChvcmcgPT4gb3JnLm9yZ2FuaXphdGlvbklkKTtcbiAgICAgICAgY29uc3QgaGFzT3ZlcmxhcCA9IG1hbmFnZXJPcmdJZHMuc29tZShpZCA9PiBkZW1vVXNlck9yZ0lkcy5pbmNsdWRlcyhpZCkpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2hvdWxkIGhhdmUgbm8gb3JnYW5pemF0aW9uIG92ZXJsYXAgYmV0d2VlbiByZWd1bGFyIG1hbmFnZXIgYW5kIGRlbW8gdXNlcnNcbiAgICAgICAgZXhwZWN0KGhhc092ZXJsYXApLnRvQmUoZmFsc2UpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbnN1cmUgZGVtbyBtYW5hZ2VyIGNhbiBvbmx5IHNlZSBkZW1vIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVtb01hbmFnZXJVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHRlc3REYXRhLmRlbW9NYW5hZ2VyLmVtYWlsKSlcbiAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiByZXN1bHRzWzBdKTtcblxuICAgICAgZXhwZWN0KGRlbW9NYW5hZ2VyVXNlcikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkZW1vTWFuYWdlclVzZXIucm9sZSkudG9CZSgnZGVtb19tYW5hZ2VyJyk7XG5cbiAgICAgIC8vIERlbW8gbWFuYWdlciBzaG91bGQgb25seSBoYXZlIGFjY2VzcyB0byBkZW1vIG9yZ2FuaXphdGlvblxuICAgICAgY29uc3QgZGVtb01hbmFnZXJPcmdzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7IG9yZ2FuaXphdGlvbklkOiB1c2VyT3JnYW5pemF0aW9ucy5vcmdhbml6YXRpb25JZCB9KVxuICAgICAgICAuZnJvbSh1c2VyT3JnYW5pemF0aW9ucylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJPcmdhbml6YXRpb25zLnVzZXJJZCwgZGVtb01hbmFnZXJVc2VyLmlkKSk7XG5cbiAgICAgIGV4cGVjdChkZW1vTWFuYWdlck9yZ3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChkZW1vTWFuYWdlck9yZ3NbMF0ub3JnYW5pemF0aW9uSWQpLnRvQmUodGVzdERhdGEuZGVtb09yZy5pZCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
8a12008896a8b524d42f62946169178e
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const globals_1 = require("@jest/globals");
// Mock the hooks and utils
globals_1.jest.mock('@/hooks/use-language', () => ({
    useLanguage: () => ({
        t: (key) => key,
    }),
}));
globals_1.jest.mock('@/hooks/use-toast', () => ({
    useToast: () => ({
        toast: globals_1.jest.fn(),
    }),
}));
/**
 * @file Gemini Integration Form Fill Test Suite
 * @description Comprehensive tests for AI-powered form filling functionality
 * Tests the integration between Gemini AI bill analysis and form auto-population
 * Designed to identify potential issues in the AI form filling workflow
 */
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const react_query_1 = require("@tanstack/react-query");
require("@testing-library/jest-dom");
// Mock fetch with proper typing
const mockFetch = globals_1.jest.fn();
global.fetch = mockFetch;
// Helper function to create proper Response objects
const createMockResponse = (data, options = {}) => {
    const { ok = true, status = 200 } = options;
    return Promise.resolve({
        ok,
        status,
        json: async () => data,
        headers: new Headers(),
        redirected: false,
        statusText: ok ? 'OK' : 'Error',
        type: 'basic',
        url: '',
        clone: globals_1.jest.fn(),
        body: null,
        bodyUsed: false,
        arrayBuffer: globals_1.jest.fn(),
        blob: globals_1.jest.fn(),
        formData: globals_1.jest.fn(),
        text: globals_1.jest.fn(),
    });
};
const createMockQueryClient = () => new react_query_1.QueryClient({
    defaultOptions: {
        queries: {
            retry: false,
        },
        mutations: {
            retry: false,
        }
    },
});
// Mock bill analysis responses - testing various scenarios
const mockAnalysisResponses = {
    successful: {
        title: "Hydro-Québec Electricity Bill",
        vendor: "Hydro-Québec",
        totalAmount: "245.67",
        category: "utilities",
        description: "Monthly electricity consumption",
        dueDate: "2025-01-31",
        issueDate: "2025-01-01",
        billNumber: "HQ-2025-001234",
        confidence: 0.95
    },
    lowConfidence: {
        title: "Unclear Insurance Document",
        vendor: "Unknown Provider",
        totalAmount: "0.00",
        category: "other",
        description: "",
        confidence: 0.25
    },
    invalidData: {
        title: "",
        vendor: "Valid Vendor",
        totalAmount: "invalid-amount",
        category: "invalid-category",
        confidence: 1.5 // Invalid confidence > 1.0
    },
    partialData: {
        title: "Property Maintenance Bill",
        vendor: "ABC Maintenance",
        totalAmount: "1250.00",
        category: "maintenance"
        // Missing other fields to test partial filling
    },
    frenchContent: {
        title: "Facture d'Assurance Habitation",
        vendor: "Assurances Desjardins",
        totalAmount: "2400.00",
        category: "insurance",
        description: "Prime annuelle d'assurance habitation",
        dueDate: "2025-12-31",
        confidence: 0.88
    }
};
// Test component that simulates the BillForm AI integration
const TestBillFormWithAI = () => {
    const [uploadedFile, setUploadedFile] = react_1.default.useState(null);
    const [isAnalyzing, setIsAnalyzing] = react_1.default.useState(false);
    const [aiAnalysisData, setAiAnalysisData] = react_1.default.useState(null);
    const [formData, setFormData] = react_1.default.useState({
        title: '',
        vendor: '',
        category: 'other',
        totalAmount: '',
        description: '',
        startDate: new Date().toISOString().split('T')[0],
        paymentType: 'unique',
        notes: ''
    });
    const handleFileUpload = (event) => {
        const file = event.target.files?.[0];
        if (file) {
            setUploadedFile(file);
        }
    };
    const analyzeDocument = async () => {
        if (!uploadedFile)
            return;
        setIsAnalyzing(true);
        try {
            const formData = new FormData();
            formData.append('document', uploadedFile);
            const response = await fetch('/api/bills/analyze-document', {
                method: 'POST',
                credentials: 'include',
                body: formData,
            });
            if (!response.ok) {
                throw new Error('Failed to analyze document');
            }
            const result = await response.json();
            setAiAnalysisData(result);
            // Simulate the smart form filling logic from BillForm.tsx
            if (result) {
                setFormData(current => {
                    const updated = { ...current };
                    // Only fill empty fields (simulating the smart logic)
                    if (!current.title) {
                        updated.title = result.title || '';
                    }
                    if (!current.vendor) {
                        updated.vendor = result.vendor || '';
                    }
                    if (current.category === 'other') {
                        updated.category = result.category || 'other';
                    }
                    if (!current.totalAmount) {
                        updated.totalAmount = result.totalAmount || '';
                    }
                    if (!current.description) {
                        updated.description = result.description || '';
                    }
                    // Add AI analysis info to notes
                    const aiNotes = [];
                    if (result.billNumber) {
                        aiNotes.push(`Bill Number: ${result.billNumber}`);
                    }
                    if (result.dueDate) {
                        aiNotes.push(`Due Date: ${result.dueDate}`);
                    }
                    aiNotes.push(`AI Analysis Confidence: ${(result.confidence * 100).toFixed(1)}%`);
                    if (aiNotes.length > 0) {
                        const aiNotesText = aiNotes.join('\n');
                        updated.notes = current.notes ?
                            `${current.notes}\n\n--- AI Analysis ---\n${aiNotesText}` :
                            aiNotesText;
                    }
                    return updated;
                });
            }
        }
        catch (error) {
            console.error('Analysis failed:', error);
        }
        finally {
            setIsAnalyzing(false);
        }
    };
    return ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "ai-bill-form", children: [(0, jsx_runtime_1.jsxs)("div", { "data-testid": "file-upload-section", children: [(0, jsx_runtime_1.jsx)("input", { type: "file", accept: ".pdf,.jpg,.jpeg,.png,.gif", onChange: handleFileUpload, "data-testid": "file-input" }), (0, jsx_runtime_1.jsx)("button", { onClick: analyzeDocument, disabled: !uploadedFile || isAnalyzing, "data-testid": "analyze-button", children: isAnalyzing ? 'Analyzing...' : 'Upload & Analyze' })] }), (0, jsx_runtime_1.jsx)("form", { "data-testid": "bill-form", children: (0, jsx_runtime_1.jsxs)("div", { "data-testid": "form-fields", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "input-title", type: "text", placeholder: "Bill Title", value: formData.title, onChange: (e) => setFormData(prev => ({ ...prev, title: e.target.value })) }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "input-vendor", type: "text", placeholder: "Vendor", value: formData.vendor, onChange: (e) => setFormData(prev => ({ ...prev, vendor: e.target.value })) }), (0, jsx_runtime_1.jsxs)("select", { "data-testid": "select-category", value: formData.category, onChange: (e) => setFormData(prev => ({ ...prev, category: e.target.value })), children: [(0, jsx_runtime_1.jsx)("option", { value: "other", children: "Other" }), (0, jsx_runtime_1.jsx)("option", { value: "utilities", children: "Utilities" }), (0, jsx_runtime_1.jsx)("option", { value: "maintenance", children: "Maintenance" }), (0, jsx_runtime_1.jsx)("option", { value: "insurance", children: "Insurance" })] }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "input-amount", type: "text", placeholder: "Total Amount", value: formData.totalAmount, onChange: (e) => setFormData(prev => ({ ...prev, totalAmount: e.target.value })) }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "input-description", placeholder: "Description", value: formData.description, onChange: (e) => setFormData(prev => ({ ...prev, description: e.target.value })) }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "input-notes", placeholder: "Notes", value: formData.notes, onChange: (e) => setFormData(prev => ({ ...prev, notes: e.target.value })) })] }) }), aiAnalysisData && ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "analysis-result", children: [(0, jsx_runtime_1.jsxs)("div", { "data-testid": "analysis-confidence", children: ["Confidence: ", (aiAnalysisData.confidence * 100).toFixed(1), "%"] }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "analysis-data", children: JSON.stringify(aiAnalysisData) })] }))] }));
};
const TestWrapper = ({ children }) => {
    const queryClient = createMockQueryClient();
    return (0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: children });
};
(0, globals_1.describe)('Gemini Form Integration Tests', () => {
    // Mock console.error to avoid test output pollution
    const originalConsoleError = console.error;
    (0, globals_1.beforeEach)(() => {
        mockFetch.mockClear();
        console.error = globals_1.jest.fn();
    });
    (0, globals_1.afterAll)(() => {
        console.error = originalConsoleError;
    });
    (0, globals_1.describe)('Successful AI Analysis Scenarios', () => {
        (0, globals_1.it)('should successfully analyze a clear utility bill and fill form correctly', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.successful));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Upload a file
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'hydro-bill.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            // Click analyze button
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            // Wait for analysis to complete
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bills/analyze-document', globals_1.expect.any(Object));
            });
            await (0, react_2.waitFor)(() => {
                // Verify form fields were populated correctly
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const categorySelect = react_2.screen.getByTestId('select-category');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const descriptionInput = react_2.screen.getByTestId('input-description');
                const notesInput = react_2.screen.getByTestId('input-notes');
                (0, globals_1.expect)(titleInput.value).toBe('Hydro-Québec Electricity Bill');
                (0, globals_1.expect)(vendorInput.value).toBe('Hydro-Québec');
                (0, globals_1.expect)(categorySelect.value).toBe('utilities');
                (0, globals_1.expect)(amountInput.value).toBe('245.67');
                (0, globals_1.expect)(descriptionInput.value).toBe('Monthly electricity consumption');
                (0, globals_1.expect)(notesInput.value).toContain('Bill Number: HQ-2025-001234');
                (0, globals_1.expect)(notesInput.value).toContain('Due Date: 2025-01-31');
                (0, globals_1.expect)(notesInput.value).toContain('AI Analysis Confidence: 95.0%');
            });
            // Verify confidence is displayed
            const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
            (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('95.0%');
        });
        (0, globals_1.it)('should handle French language bills correctly', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.frenchContent));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['contenu français'], 'facture-assurance.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const categorySelect = react_2.screen.getByTestId('select-category');
                (0, globals_1.expect)(titleInput.value).toBe("Facture d'Assurance Habitation");
                (0, globals_1.expect)(vendorInput.value).toBe('Assurances Desjardins');
                (0, globals_1.expect)(categorySelect.value).toBe('insurance');
            });
        });
    });
    (0, globals_1.describe)('Edge Cases and Error Scenarios', () => {
        (0, globals_1.it)('should handle low confidence analysis results appropriately', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.lowConfidence));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['unclear content'], 'blurry-document.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
                (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('25.0%');
                // With low confidence, title should still be filled but amount should be empty or 0
                const titleInput = react_2.screen.getByTestId('input-title');
                const amountInput = react_2.screen.getByTestId('input-amount');
                (0, globals_1.expect)(titleInput.value).toBe('Unclear Insurance Document');
                (0, globals_1.expect)(amountInput.value).toBe('0.00');
            });
        });
        (0, globals_1.it)('should handle invalid data from AI analysis gracefully', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.invalidData));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['corrupted data'], 'corrupted.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Check that invalid data is handled
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const categorySelect = react_2.screen.getByTestId('select-category');
                // Empty title should not be filled
                (0, globals_1.expect)(titleInput.value).toBe('');
                // Valid vendor should be filled  
                (0, globals_1.expect)(vendorInput.value).toBe('Valid Vendor');
                // Invalid amount should not crash the form
                (0, globals_1.expect)(amountInput.value).toBe('invalid-amount'); // This might be a bug!
                // Invalid category should fall back to 'other'
                (0, globals_1.expect)(categorySelect.value).toBe('other');
            });
        });
        (0, globals_1.it)('should handle network errors during analysis', async () => {
            mockFetch.mockRejectedValueOnce(new Error('Network error'));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Form should remain empty after error
                const titleInput = react_2.screen.getByTestId('input-title');
                (0, globals_1.expect)(titleInput.value).toBe('');
                // Analysis button should be enabled again
                (0, globals_1.expect)(analyzeButton).not.toBeDisabled();
            });
        });
        (0, globals_1.it)('should handle server errors (500) appropriately', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse({ error: 'Internal server error' }, { ok: false, status: 500 }));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Should handle server error gracefully
                const titleInput = react_2.screen.getByTestId('input-title');
                (0, globals_1.expect)(titleInput.value).toBe('');
            });
        });
    });
    (0, globals_1.describe)('User Interaction and Data Preservation', () => {
        (0, globals_1.it)('should preserve user-entered data when AI analysis completes', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.successful));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // User fills some fields manually first
            const titleInput = react_2.screen.getByTestId('input-title');
            const vendorInput = react_2.screen.getByTestId('input-vendor');
            const notesInput = react_2.screen.getByTestId('input-notes');
            await user_event_1.default.type(titleInput, 'My Custom Title');
            await user_event_1.default.type(vendorInput, 'My Custom Vendor');
            await user_event_1.default.type(notesInput, 'User notes here');
            // Then user uploads and analyzes
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // User data should be preserved
                const titleInputAfter = react_2.screen.getByTestId('input-title');
                const vendorInputAfter = react_2.screen.getByTestId('input-vendor');
                const notesInputAfter = react_2.screen.getByTestId('input-notes');
                (0, globals_1.expect)(titleInputAfter.value).toBe('My Custom Title'); // Preserved
                (0, globals_1.expect)(vendorInputAfter.value).toBe('My Custom Vendor'); // Preserved
                (0, globals_1.expect)(notesInputAfter.value).toContain('User notes here'); // Preserved
                (0, globals_1.expect)(notesInputAfter.value).toContain('AI Analysis'); // AI info added
            });
        });
        (0, globals_1.it)('should only fill empty fields, not overwrite user input', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.successful));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Pre-fill amount field with user data
            const amountInput = react_2.screen.getByTestId('input-amount');
            await user_event_1.default.type(amountInput, '999.99');
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const amountInputAfter = react_2.screen.getByTestId('input-amount');
                const titleInputAfter = react_2.screen.getByTestId('input-title');
                // User amount should be preserved
                (0, globals_1.expect)(amountInputAfter.value).toBe('999.99');
                // Empty title should be filled by AI
                (0, globals_1.expect)(titleInputAfter.value).toBe('Hydro-Québec Electricity Bill');
            });
        });
    });
    (0, globals_1.describe)('File Type and Content Validation', () => {
        (0, globals_1.it)('should handle different file types appropriately', async () => {
            mockFetch.mockResolvedValueOnce(createMockResponse(mockAnalysisResponses.successful));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Test with image file
            const fileInput = react_2.screen.getByTestId('file-input');
            const imageFile = new File(['image data'], 'bill-scan.jpg', { type: 'image/jpeg' });
            await user_event_1.default.upload(fileInput, imageFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bills/analyze-document', globals_1.expect.objectContaining({
                    method: 'POST',
                    body: globals_1.expect.any(FormData),
                }));
            });
        });
        (0, globals_1.it)('should disable analyze button when no file is selected', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            (0, globals_1.expect)(analyzeButton).toBeDisabled();
        });
        (0, globals_1.it)('should show analyzing state while processing', async () => {
            let resolvePromise;
            const delayedPromise = new Promise((resolve) => {
                resolvePromise = resolve;
            });
            mockFetch.mockReturnValueOnce(delayedPromise);
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            // Button should show analyzing state
            (0, globals_1.expect)(analyzeButton).toHaveTextContent('Analyzing...');
            (0, globals_1.expect)(analyzeButton).toBeDisabled();
            // Resolve the promise
            resolvePromise(createMockResponse(mockAnalysisResponses.successful));
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(analyzeButton).toHaveTextContent('Upload & Analyze');
                (0, globals_1.expect)(analyzeButton).not.toBeDisabled();
            });
        });
    });
    (0, globals_1.describe)('Data Integrity and Security Issues', () => {
        (0, globals_1.it)('should sanitize and validate AI response data', async () => {
            // Mock response with potential security issues
            const maliciousResponse = {
                title: '<script>alert("xss")</script>Legitimate Title',
                vendor: 'javascript:void(0)',
                totalAmount: 'SELECT * FROM users; --',
                category: 'utilities',
                confidence: 0.95,
                billNumber: '"><img src=x onerror=alert(1)>',
            };
            mockFetch.mockResolvedValueOnce(createMockResponse(maliciousResponse));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const notesInput = react_2.screen.getByTestId('input-notes');
                // Values should be filled (this test reveals potential XSS vulnerability)
                (0, globals_1.expect)(titleInput.value).toContain('<script>');
                (0, globals_1.expect)(vendorInput.value).toBe('javascript:void(0)');
                (0, globals_1.expect)(amountInput.value).toContain('SELECT');
                (0, globals_1.expect)(notesInput.value).toContain('onerror=alert(1)');
            });
        });
        (0, globals_1.it)('should validate amount field format after AI analysis', async () => {
            const invalidAmountResponse = {
                ...mockAnalysisResponses.successful,
                totalAmount: '999,999.999', // Too many decimal places
            };
            mockFetch.mockResolvedValueOnce(createMockResponse(invalidAmountResponse));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const amountInput = react_2.screen.getByTestId('input-amount');
                // Should the app validate and fix this format? This test will reveal the behavior
                (0, globals_1.expect)(amountInput.value).toBe('999,999.999');
            });
        });
        (0, globals_1.it)('should handle confidence values outside valid range', async () => {
            const invalidConfidenceResponse = {
                ...mockAnalysisResponses.successful,
                confidence: 1.5, // Invalid: > 1.0
            };
            mockFetch.mockResolvedValueOnce(createMockResponse(invalidConfidenceResponse));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
                // Should be clamped to 100% or show error?
                (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('150.0%'); // This reveals the issue
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2dlbWluaS1mb3JtLWludGVncmF0aW9uLnRlc3QudHN4IiwibWFwcGluZ3MiOiI7Ozs7OztBQVdBLDJDQUE0RjtBQUc1RiwyQkFBMkI7QUFDM0IsY0FBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2xCLENBQUMsRUFBRSxDQUFDLEdBQVcsRUFBRSxFQUFFLENBQUMsR0FBRztLQUN4QixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSixjQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDZixLQUFLLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtLQUNqQixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUM7QUF6Qko7Ozs7O0dBS0c7QUFFSCxrREFBMEI7QUFDMUIsa0RBQTRFO0FBQzVFLDZFQUFvRDtBQUNwRCx1REFBeUU7QUFFekUscUNBQW1DO0FBZW5DLGdDQUFnQztBQUNoQyxNQUFNLFNBQVMsR0FBRyxjQUFJLENBQUMsRUFBRSxFQUF1QyxDQUFDO0FBQ2pFLE1BQU0sQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDO0FBRXpCLG9EQUFvRDtBQUNwRCxNQUFNLGtCQUFrQixHQUFHLENBQUMsSUFBUyxFQUFFLFVBQTZDLEVBQUUsRUFBRSxFQUFFO0lBQ3hGLE1BQU0sRUFBRSxFQUFFLEdBQUcsSUFBSSxFQUFFLE1BQU0sR0FBRyxHQUFHLEVBQUUsR0FBRyxPQUFPLENBQUM7SUFDNUMsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQ3JCLEVBQUU7UUFDRixNQUFNO1FBQ04sSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsSUFBSTtRQUN0QixPQUFPLEVBQUUsSUFBSSxPQUFPLEVBQUU7UUFDdEIsVUFB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QUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsRUFBRSxVQUFVLEVBQUUsRUFBRSxJQUFJLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO1lBQ3JGLE1BQU0sb0JBQVMsQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRTVDLE1BQU0sYUFBYSxHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUMzRCxNQUFNLG9CQUFTLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRXJDLE1BQU0sSUFBQSxlQUFPLEVBQUMsR0FBRyxFQUFFO2dCQUNqQixNQUFNLGlCQUFpQixHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMscUJBQXFCLENBQUMsQ0FBQztnQkFDcEUsMkNBQTJDO2dCQUMzQyxJQUFBLGdCQUFNLEVBQUMsaUJBQWlCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLHlCQUF5QjtZQUNsRixDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3VuaXQvZ2VtaW5pLWZvcm0taW50ZWdyYXRpb24udGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZSBHZW1pbmkgSW50ZWdyYXRpb24gRm9ybSBGaWxsIFRlc3QgU3VpdGVcbiAqIEBkZXNjcmlwdGlvbiBDb21wcmVoZW5zaXZlIHRlc3RzIGZvciBBSS1wb3dlcmVkIGZvcm0gZmlsbGluZyBmdW5jdGlvbmFsaXR5XG4gKiBUZXN0cyB0aGUgaW50ZWdyYXRpb24gYmV0d2VlbiBHZW1pbmkgQUkgYmlsbCBhbmFseXNpcyBhbmQgZm9ybSBhdXRvLXBvcHVsYXRpb25cbiAqIERlc2lnbmVkIHRvIGlkZW50aWZ5IHBvdGVudGlhbCBpc3N1ZXMgaW4gdGhlIEFJIGZvcm0gZmlsbGluZyB3b3JrZmxvd1xuICovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgdXNlckV2ZW50IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvdXNlci1ldmVudCc7XG5pbXBvcnQgeyBRdWVyeUNsaWVudCwgUXVlcnlDbGllbnRQcm92aWRlciB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7XG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCwgamVzdCwgYmVmb3JlQWxsLCBhZnRlckFsbCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcblxuLy8gTW9jayB0aGUgaG9va3MgYW5kIHV0aWxzXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLWxhbmd1YWdlJywgKCkgPT4gKHtcbiAgdXNlTGFuZ3VhZ2U6ICgpID0+ICh7XG4gICAgdDogKGtleTogc3RyaW5nKSA9PiBrZXksXG4gIH0pLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLXRvYXN0JywgKCkgPT4gKHtcbiAgdXNlVG9hc3Q6ICgpID0+ICh7XG4gICAgdG9hc3Q6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2ggd2l0aCBwcm9wZXIgdHlwaW5nXG5jb25zdCBtb2NrRmV0Y2ggPSBqZXN0LmZuKCkgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZmV0Y2g+O1xuZ2xvYmFsLmZldGNoID0gbW9ja0ZldGNoO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIHByb3BlciBSZXNwb25zZSBvYmplY3RzXG5jb25zdCBjcmVhdGVNb2NrUmVzcG9uc2UgPSAoZGF0YTogYW55LCBvcHRpb25zOiB7IG9rPzogYm9vbGVhbjsgc3RhdHVzPzogbnVtYmVyIH0gPSB7fSkgPT4ge1xuICBjb25zdCB7IG9rID0gdHJ1ZSwgc3RhdHVzID0gMjAwIH0gPSBvcHRpb25zO1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICBvayxcbiAgICBzdGF0dXMsXG4gICAganNvbjogYXN5bmMgKCkgPT4gZGF0YSxcbiAgICBoZWFkZXJzOiBuZXcgSGVhZGVycygpLFxuICAgIHJlZGlyZWN0ZWQ6IGZhbHNlLFxuICAgIHN0YXR1c1RleHQ6IG9rID8gJ09LJyA6ICdFcnJvcicsXG4gICAgdHlwZTogJ2Jhc2ljJyBhcyBSZXNwb25zZVR5cGUsXG4gICAgdXJsOiAnJyxcbiAgICBjbG9uZTogamVzdC5mbigpLFxuICAgIGJvZHk6IG51bGwsXG4gICAgYm9keVVzZWQ6IGZhbHNlLFxuICAgIGFycmF5QnVmZmVyOiBqZXN0LmZuKCksXG4gICAgYmxvYjogamVzdC5mbigpLFxuICAgIGZvcm1EYXRhOiBqZXN0LmZuKCksXG4gICAgdGV4dDogamVzdC5mbigpLFxuICB9IGFzIFJlc3BvbnNlKTtcbn07XG5cbmNvbnN0IGNyZWF0ZU1vY2tRdWVyeUNsaWVudCA9ICgpID0+XG4gIG5ldyBRdWVyeUNsaWVudCh7XG4gICAgZGVmYXVsdE9wdGlvbnM6IHtcbiAgICAgIHF1ZXJpZXM6IHtcbiAgICAgICAgcmV0cnk6IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIG11dGF0aW9uczoge1xuICAgICAgICByZXRyeTogZmFsc2UsXG4gICAgICB9XG4gICAgfSxcbiAgfSk7XG5cbi8vIE1vY2sgYmlsbCBhbmFseXNpcyByZXNwb25zZXMgLSB0ZXN0aW5nIHZhcmlvdXMgc2NlbmFyaW9zXG5jb25zdCBtb2NrQW5hbHlzaXNSZXNwb25zZXMgPSB7XG4gIHN1Y2Nlc3NmdWw6IHtcbiAgICB0aXRsZTogXCJIeWRyby1RdcOpYmVjIEVsZWN0cmljaXR5IEJpbGxcIixcbiAgICB2ZW5kb3I6IFwiSHlkcm8tUXXDqWJlY1wiLCBcbiAgICB0b3RhbEFtb3VudDogXCIyNDUuNjdcIixcbiAgICBjYXRlZ29yeTogXCJ1dGlsaXRpZXNcIixcbiAgICBkZXNjcmlwdGlvbjogXCJNb250aGx5IGVsZWN0cmljaXR5IGNvbnN1bXB0aW9uXCIsXG4gICAgZHVlRGF0ZTogXCIyMDI1LTAxLTMxXCIsXG4gICAgaXNzdWVEYXRlOiBcIjIwMjUtMDEtMDFcIixcbiAgICBiaWxsTnVtYmVyOiBcIkhRLTIwMjUtMDAxMjM0XCIsXG4gICAgY29uZmlkZW5jZTogMC45NVxuICB9LFxuICBsb3dDb25maWRlbmNlOiB7XG4gICAgdGl0bGU6IFwiVW5jbGVhciBJbnN1cmFuY2UgRG9jdW1lbnRcIixcbiAgICB2ZW5kb3I6IFwiVW5rbm93biBQcm92aWRlclwiLFxuICAgIHRvdGFsQW1vdW50OiBcIjAuMDBcIixcbiAgICBjYXRlZ29yeTogXCJvdGhlclwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlwiLFxuICAgIGNvbmZpZGVuY2U6IDAuMjVcbiAgfSxcbiAgaW52YWxpZERhdGE6IHtcbiAgICB0aXRsZTogXCJcIixcbiAgICB2ZW5kb3I6IFwiVmFsaWQgVmVuZG9yXCIsXG4gICAgdG90YWxBbW91bnQ6IFwiaW52YWxpZC1hbW91bnRcIixcbiAgICBjYXRlZ29yeTogXCJpbnZhbGlkLWNhdGVnb3J5XCIsXG4gICAgY29uZmlkZW5jZTogMS41IC8vIEludmFsaWQgY29uZmlkZW5jZSA+IDEuMFxuICB9LFxuICBwYXJ0aWFsRGF0YToge1xuICAgIHRpdGxlOiBcIlByb3BlcnR5IE1haW50ZW5hbmNlIEJpbGxcIixcbiAgICB2ZW5kb3I6IFwiQUJDIE1haW50ZW5hbmNlXCIsXG4gICAgdG90YWxBbW91bnQ6IFwiMTI1MC4wMFwiLFxuICAgIGNhdGVnb3J5OiBcIm1haW50ZW5hbmNlXCJcbiAgICAvLyBNaXNzaW5nIG90aGVyIGZpZWxkcyB0byB0ZXN0IHBhcnRpYWwgZmlsbGluZ1xuICB9LFxuICBmcmVuY2hDb250ZW50OiB7XG4gICAgdGl0bGU6IFwiRmFjdHVyZSBkJ0Fzc3VyYW5jZSBIYWJpdGF0aW9uXCIsIFxuICAgIHZlbmRvcjogXCJBc3N1cmFuY2VzIERlc2phcmRpbnNcIixcbiAgICB0b3RhbEFtb3VudDogXCIyNDAwLjAwXCIsXG4gICAgY2F0ZWdvcnk6IFwiaW5zdXJhbmNlXCIsXG4gICAgZGVzY3JpcHRpb246IFwiUHJpbWUgYW5udWVsbGUgZCdhc3N1cmFuY2UgaGFiaXRhdGlvblwiLFxuICAgIGR1ZURhdGU6IFwiMjAyNS0xMi0zMVwiLFxuICAgIGNvbmZpZGVuY2U6IDAuODhcbiAgfVxufTtcblxuLy8gVGVzdCBjb21wb25lbnQgdGhhdCBzaW11bGF0ZXMgdGhlIEJpbGxGb3JtIEFJIGludGVncmF0aW9uXG5jb25zdCBUZXN0QmlsbEZvcm1XaXRoQUkgPSAoKSA9PiB7XG4gIGNvbnN0IFt1cGxvYWRlZEZpbGUsIHNldFVwbG9hZGVkRmlsZV0gPSBSZWFjdC51c2VTdGF0ZTxGaWxlIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc0FuYWx5emluZywgc2V0SXNBbmFseXppbmddID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbYWlBbmFseXNpc0RhdGEsIHNldEFpQW5hbHlzaXNEYXRhXSA9IFJlYWN0LnVzZVN0YXRlPGFueT4obnVsbCk7XG4gIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIHRpdGxlOiAnJyxcbiAgICB2ZW5kb3I6ICcnLFxuICAgIGNhdGVnb3J5OiAnb3RoZXInLFxuICAgIHRvdGFsQW1vdW50OiAnJyxcbiAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgbm90ZXM6ICcnXG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRsZUZpbGVVcGxvYWQgPSAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlcz8uWzBdO1xuICAgIGlmIChmaWxlKSB7XG4gICAgICBzZXRVcGxvYWRlZEZpbGUoZmlsZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGFuYWx5emVEb2N1bWVudCA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVwbG9hZGVkRmlsZSkgcmV0dXJuO1xuICAgIFxuICAgIHNldElzQW5hbHl6aW5nKHRydWUpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgZm9ybURhdGEuYXBwZW5kKCdkb2N1bWVudCcsIHVwbG9hZGVkRmlsZSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYmlsbHMvYW5hbHl6ZS1kb2N1bWVudCcsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIGJvZHk6IGZvcm1EYXRhLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gYW5hbHl6ZSBkb2N1bWVudCcpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBzZXRBaUFuYWx5c2lzRGF0YShyZXN1bHQpO1xuICAgICAgXG4gICAgICAvLyBTaW11bGF0ZSB0aGUgc21hcnQgZm9ybSBmaWxsaW5nIGxvZ2ljIGZyb20gQmlsbEZvcm0udHN4XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHNldEZvcm1EYXRhKGN1cnJlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSB7IC4uLmN1cnJlbnQgfTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBPbmx5IGZpbGwgZW1wdHkgZmllbGRzIChzaW11bGF0aW5nIHRoZSBzbWFydCBsb2dpYylcbiAgICAgICAgICBpZiAoIWN1cnJlbnQudGl0bGUpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQudGl0bGUgPSByZXN1bHQudGl0bGUgfHwgJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghY3VycmVudC52ZW5kb3IpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQudmVuZG9yID0gcmVzdWx0LnZlbmRvciB8fCAnJztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGN1cnJlbnQuY2F0ZWdvcnkgPT09ICdvdGhlcicpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQuY2F0ZWdvcnkgPSByZXN1bHQuY2F0ZWdvcnkgfHwgJ290aGVyJztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjdXJyZW50LnRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICB1cGRhdGVkLnRvdGFsQW1vdW50ID0gcmVzdWx0LnRvdGFsQW1vdW50IHx8ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWN1cnJlbnQuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHVwZGF0ZWQuZGVzY3JpcHRpb24gPSByZXN1bHQuZGVzY3JpcHRpb24gfHwgJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIEFkZCBBSSBhbmFseXNpcyBpbmZvIHRvIG5vdGVzXG4gICAgICAgICAgY29uc3QgYWlOb3RlcyA9IFtdO1xuICAgICAgICAgIGlmIChyZXN1bHQuYmlsbE51bWJlcikge1xuICAgICAgICAgICAgYWlOb3Rlcy5wdXNoKGBCaWxsIE51bWJlcjogJHtyZXN1bHQuYmlsbE51bWJlcn1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdC5kdWVEYXRlKSB7XG4gICAgICAgICAgICBhaU5vdGVzLnB1c2goYER1ZSBEYXRlOiAke3Jlc3VsdC5kdWVEYXRlfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhaU5vdGVzLnB1c2goYEFJIEFuYWx5c2lzIENvbmZpZGVuY2U6ICR7KHJlc3VsdC5jb25maWRlbmNlICogMTAwKS50b0ZpeGVkKDEpfSVgKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoYWlOb3Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBhaU5vdGVzVGV4dCA9IGFpTm90ZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICB1cGRhdGVkLm5vdGVzID0gY3VycmVudC5ub3RlcyA/IFxuICAgICAgICAgICAgICBgJHtjdXJyZW50Lm5vdGVzfVxcblxcbi0tLSBBSSBBbmFseXNpcyAtLS1cXG4ke2FpTm90ZXNUZXh0fWAgOiBcbiAgICAgICAgICAgICAgYWlOb3Rlc1RleHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNBbmFseXppbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhaS1iaWxsLWZvcm1cIj5cbiAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJmaWxlLXVwbG9hZC1zZWN0aW9uXCI+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIHR5cGU9XCJmaWxlXCJcbiAgICAgICAgICBhY2NlcHQ9XCIucGRmLC5qcGcsLmpwZWcsLnBuZywuZ2lmXCJcbiAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlRmlsZVVwbG9hZH1cbiAgICAgICAgICBkYXRhLXRlc3RpZD1cImZpbGUtaW5wdXRcIlxuICAgICAgICAvPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgb25DbGljaz17YW5hbHl6ZURvY3VtZW50fVxuICAgICAgICAgIGRpc2FibGVkPXshdXBsb2FkZWRGaWxlIHx8IGlzQW5hbHl6aW5nfVxuICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYW5hbHl6ZS1idXR0b25cIlxuICAgICAgICA+XG4gICAgICAgICAge2lzQW5hbHl6aW5nID8gJ0FuYWx5emluZy4uLicgOiAnVXBsb2FkICYgQW5hbHl6ZSd9XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxmb3JtIGRhdGEtdGVzdGlkPVwiYmlsbC1mb3JtXCI+XG4gICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJmb3JtLWZpZWxkc1wiPlxuICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJpbnB1dC10aXRsZVwiXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkJpbGwgVGl0bGVcIlxuICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnRpdGxlfVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIHRpdGxlOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtdmVuZG9yXCJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVmVuZG9yXCJcbiAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS52ZW5kb3J9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgdmVuZG9yOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cInNlbGVjdC1jYXRlZ29yeVwiXG4gICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEuY2F0ZWdvcnl9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgY2F0ZWdvcnk6IGUudGFyZ2V0LnZhbHVlIH0pKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwib3RoZXJcIj5PdGhlcjwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cInV0aWxpdGllc1wiPlV0aWxpdGllczwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIm1haW50ZW5hbmNlXCI+TWFpbnRlbmFuY2U8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJpbnN1cmFuY2VcIj5JbnN1cmFuY2U8L29wdGlvbj5cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtYW1vdW50XCJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVG90YWwgQW1vdW50XCJcbiAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS50b3RhbEFtb3VudH1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Rm9ybURhdGEocHJldiA9PiAoeyAuLi5wcmV2LCB0b3RhbEFtb3VudDogZS50YXJnZXQudmFsdWUgfSkpfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LWRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIGRlc2NyaXB0aW9uOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtbm90ZXNcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJOb3Rlc1wiXG4gICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEubm90ZXN9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgbm90ZXM6IGUudGFyZ2V0LnZhbHVlIH0pKX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZm9ybT5cblxuICAgICAge2FpQW5hbHlzaXNEYXRhICYmIChcbiAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImFuYWx5c2lzLXJlc3VsdFwiPlxuICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhbmFseXNpcy1jb25maWRlbmNlXCI+XG4gICAgICAgICAgICBDb25maWRlbmNlOiB7KGFpQW5hbHlzaXNEYXRhLmNvbmZpZGVuY2UgKiAxMDApLnRvRml4ZWQoMSl9JVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhbmFseXNpcy1kYXRhXCI+XG4gICAgICAgICAgICB7SlNPTi5zdHJpbmdpZnkoYWlBbmFseXNpc0RhdGEpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5jb25zdCBUZXN0V3JhcHBlciA9ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gY3JlYXRlTW9ja1F1ZXJ5Q2xpZW50KCk7XG4gIHJldHVybiA8UXVlcnlDbGllbnRQcm92aWRlciBjbGllbnQ9e3F1ZXJ5Q2xpZW50fT57Y2hpbGRyZW59PC9RdWVyeUNsaWVudFByb3ZpZGVyPjtcbn07XG5cbmRlc2NyaWJlKCdHZW1pbmkgRm9ybSBJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgLy8gTW9jayBjb25zb2xlLmVycm9yIHRvIGF2b2lkIHRlc3Qgb3V0cHV0IHBvbGx1dGlvblxuICBjb25zdCBvcmlnaW5hbENvbnNvbGVFcnJvciA9IGNvbnNvbGUuZXJyb3I7XG4gIFxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrRmV0Y2gubW9ja0NsZWFyKCk7XG4gICAgY29uc29sZS5lcnJvciA9IGplc3QuZm4oKTtcbiAgfSk7XG4gIFxuICBhZnRlckFsbCgoKSA9PiB7XG4gICAgY29uc29sZS5lcnJvciA9IG9yaWdpbmFsQ29uc29sZUVycm9yO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3VjY2Vzc2Z1bCBBSSBBbmFseXNpcyBTY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWNjZXNzZnVsbHkgYW5hbHl6ZSBhIGNsZWFyIHV0aWxpdHkgYmlsbCBhbmQgZmlsbCBmb3JtIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoXG4gICAgICAgIGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bClcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFVwbG9hZCBhIGZpbGVcbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAnaHlkcm8tYmlsbC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgLy8gQ2xpY2sgYW5hbHl6ZSBidXR0b25cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGFuYWx5c2lzIHRvIGNvbXBsZXRlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvYmlsbHMvYW5hbHl6ZS1kb2N1bWVudCcsIGV4cGVjdC5hbnkoT2JqZWN0KSk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFZlcmlmeSBmb3JtIGZpZWxkcyB3ZXJlIHBvcHVsYXRlZCBjb3JyZWN0bHlcbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdmVuZG9yJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZWxlY3QgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3NlbGVjdC1jYXRlZ29yeScpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgICAgICBjb25zdCBhbW91bnRJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtYW1vdW50JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtZGVzY3JpcHRpb24nKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgICAgICBjb25zdCBub3Rlc0lucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1ub3RlcycpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICAgICAgZXhwZWN0KHRpdGxlSW5wdXQudmFsdWUpLnRvQmUoJ0h5ZHJvLVF1w6liZWMgRWxlY3RyaWNpdHkgQmlsbCcpO1xuICAgICAgICBleHBlY3QodmVuZG9ySW5wdXQudmFsdWUpLnRvQmUoJ0h5ZHJvLVF1w6liZWMnKTtcbiAgICAgICAgZXhwZWN0KGNhdGVnb3J5U2VsZWN0LnZhbHVlKS50b0JlKCd1dGlsaXRpZXMnKTtcbiAgICAgICAgZXhwZWN0KGFtb3VudElucHV0LnZhbHVlKS50b0JlKCcyNDUuNjcnKTtcbiAgICAgICAgZXhwZWN0KGRlc2NyaXB0aW9uSW5wdXQudmFsdWUpLnRvQmUoJ01vbnRobHkgZWxlY3RyaWNpdHkgY29uc3VtcHRpb24nKTtcbiAgICAgICAgZXhwZWN0KG5vdGVzSW5wdXQudmFsdWUpLnRvQ29udGFpbignQmlsbCBOdW1iZXI6IEhRLTIwMjUtMDAxMjM0Jyk7XG4gICAgICAgIGV4cGVjdChub3Rlc0lucHV0LnZhbHVlKS50b0NvbnRhaW4oJ0R1ZSBEYXRlOiAyMDI1LTAxLTMxJyk7XG4gICAgICAgIGV4cGVjdChub3Rlc0lucHV0LnZhbHVlKS50b0NvbnRhaW4oJ0FJIEFuYWx5c2lzIENvbmZpZGVuY2U6IDk1LjAlJyk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IGNvbmZpZGVuY2UgaXMgZGlzcGxheWVkXG4gICAgICBjb25zdCBjb25maWRlbmNlRGlzcGxheSA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHlzaXMtY29uZmlkZW5jZScpO1xuICAgICAgZXhwZWN0KGNvbmZpZGVuY2VEaXNwbGF5KS50b0hhdmVUZXh0Q29udGVudCgnOTUuMCUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEZyZW5jaCBsYW5ndWFnZSBiaWxscyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UobW9ja0FuYWx5c2lzUmVzcG9uc2VzLmZyZW5jaENvbnRlbnQpXG4gICAgICApO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWydjb250ZW51IGZyYW7Dp2FpcyddLCAnZmFjdHVyZS1hc3N1cmFuY2UucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCB0ZXN0RmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC10aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHZlbmRvcklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBjYXRlZ29yeVNlbGVjdCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnc2VsZWN0LWNhdGVnb3J5JykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG5cbiAgICAgICAgZXhwZWN0KHRpdGxlSW5wdXQudmFsdWUpLnRvQmUoXCJGYWN0dXJlIGQnQXNzdXJhbmNlIEhhYml0YXRpb25cIik7XG4gICAgICAgIGV4cGVjdCh2ZW5kb3JJbnB1dC52YWx1ZSkudG9CZSgnQXNzdXJhbmNlcyBEZXNqYXJkaW5zJyk7XG4gICAgICAgIGV4cGVjdChjYXRlZ29yeVNlbGVjdC52YWx1ZSkudG9CZSgnaW5zdXJhbmNlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VkZ2UgQ2FzZXMgYW5kIEVycm9yIFNjZW5hcmlvcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsb3cgY29uZmlkZW5jZSBhbmFseXNpcyByZXN1bHRzIGFwcHJvcHJpYXRlbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UobW9ja0FuYWx5c2lzUmVzcG9uc2VzLmxvd0NvbmZpZGVuY2UpXG4gICAgICApO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd1bmNsZWFyIGNvbnRlbnQnXSwgJ2JsdXJyeS1kb2N1bWVudC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbmZpZGVuY2VEaXNwbGF5ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXNpcy1jb25maWRlbmNlJyk7XG4gICAgICAgIGV4cGVjdChjb25maWRlbmNlRGlzcGxheSkudG9IYXZlVGV4dENvbnRlbnQoJzI1LjAlJyk7XG5cbiAgICAgICAgLy8gV2l0aCBsb3cgY29uZmlkZW5jZSwgdGl0bGUgc2hvdWxkIHN0aWxsIGJlIGZpbGxlZCBidXQgYW1vdW50IHNob3VsZCBiZSBlbXB0eSBvciAwXG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgYW1vdW50SW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWFtb3VudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dC52YWx1ZSkudG9CZSgnVW5jbGVhciBJbnN1cmFuY2UgRG9jdW1lbnQnKTtcbiAgICAgICAgZXhwZWN0KGFtb3VudElucHV0LnZhbHVlKS50b0JlKCcwLjAwJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgZGF0YSBmcm9tIEFJIGFuYWx5c2lzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UobW9ja0FuYWx5c2lzUmVzcG9uc2VzLmludmFsaWREYXRhKVxuICAgICAgKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsnY29ycnVwdGVkIGRhdGEnXSwgJ2NvcnJ1cHRlZC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIENoZWNrIHRoYXQgaW52YWxpZCBkYXRhIGlzIGhhbmRsZWRcbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdmVuZG9yJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgYW1vdW50SW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWFtb3VudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2VsZWN0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdzZWxlY3QtY2F0ZWdvcnknKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcblxuICAgICAgICAvLyBFbXB0eSB0aXRsZSBzaG91bGQgbm90IGJlIGZpbGxlZFxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dC52YWx1ZSkudG9CZSgnJyk7XG4gICAgICAgIC8vIFZhbGlkIHZlbmRvciBzaG91bGQgYmUgZmlsbGVkICBcbiAgICAgICAgZXhwZWN0KHZlbmRvcklucHV0LnZhbHVlKS50b0JlKCdWYWxpZCBWZW5kb3InKTtcbiAgICAgICAgLy8gSW52YWxpZCBhbW91bnQgc2hvdWxkIG5vdCBjcmFzaCB0aGUgZm9ybVxuICAgICAgICBleHBlY3QoYW1vdW50SW5wdXQudmFsdWUpLnRvQmUoJ2ludmFsaWQtYW1vdW50Jyk7IC8vIFRoaXMgbWlnaHQgYmUgYSBidWchXG4gICAgICAgIC8vIEludmFsaWQgY2F0ZWdvcnkgc2hvdWxkIGZhbGwgYmFjayB0byAnb3RoZXInXG4gICAgICAgIGV4cGVjdChjYXRlZ29yeVNlbGVjdC52YWx1ZSkudG9CZSgnb3RoZXInKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZHVyaW5nIGFuYWx5c2lzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZWplY3RlZFZhbHVlT25jZShuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIEZvcm0gc2hvdWxkIHJlbWFpbiBlbXB0eSBhZnRlciBlcnJvclxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC10aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGV4cGVjdCh0aXRsZUlucHV0LnZhbHVlKS50b0JlKCcnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFuYWx5c2lzIGJ1dHRvbiBzaG91bGQgYmUgZW5hYmxlZCBhZ2FpblxuICAgICAgICBleHBlY3QoYW5hbHl6ZUJ1dHRvbikubm90LnRvQmVEaXNhYmxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2ZXIgZXJyb3JzICg1MDApIGFwcHJvcHJpYXRlbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UoeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSwgeyBvazogZmFsc2UsIHN0YXR1czogNTAwIH0pXG4gICAgICApO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd0ZXN0IGNvbnRlbnQnXSwgJ3Rlc3QucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCB0ZXN0RmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAvLyBTaG91bGQgaGFuZGxlIHNlcnZlciBlcnJvciBncmFjZWZ1bGx5XG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZXhwZWN0KHRpdGxlSW5wdXQudmFsdWUpLnRvQmUoJycpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVc2VyIEludGVyYWN0aW9uIGFuZCBEYXRhIFByZXNlcnZhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIHVzZXItZW50ZXJlZCBkYXRhIHdoZW4gQUkgYW5hbHlzaXMgY29tcGxldGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZShcbiAgICAgICAgY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tBbmFseXNpc1Jlc3BvbnNlcy5zdWNjZXNzZnVsKVxuICAgICAgKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gVXNlciBmaWxscyBzb21lIGZpZWxkcyBtYW51YWxseSBmaXJzdFxuICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKTtcbiAgICAgIGNvbnN0IHZlbmRvcklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKTtcbiAgICAgIGNvbnN0IG5vdGVzSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRpdGxlSW5wdXQsICdNeSBDdXN0b20gVGl0bGUnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHZlbmRvcklucHV0LCAnTXkgQ3VzdG9tIFZlbmRvcicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUobm90ZXNJbnB1dCwgJ1VzZXIgbm90ZXMgaGVyZScpO1xuXG4gICAgICAvLyBUaGVuIHVzZXIgdXBsb2FkcyBhbmQgYW5hbHl6ZXNcbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFVzZXIgZGF0YSBzaG91bGQgYmUgcHJlc2VydmVkXG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXRBZnRlciA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dEFmdGVyID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBub3Rlc0lucHV0QWZ0ZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcblxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCdNeSBDdXN0b20gVGl0bGUnKTsgLy8gUHJlc2VydmVkXG4gICAgICAgIGV4cGVjdCh2ZW5kb3JJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCdNeSBDdXN0b20gVmVuZG9yJyk7IC8vIFByZXNlcnZlZFxuICAgICAgICBleHBlY3Qobm90ZXNJbnB1dEFmdGVyLnZhbHVlKS50b0NvbnRhaW4oJ1VzZXIgbm90ZXMgaGVyZScpOyAvLyBQcmVzZXJ2ZWRcbiAgICAgICAgZXhwZWN0KG5vdGVzSW5wdXRBZnRlci52YWx1ZSkudG9Db250YWluKCdBSSBBbmFseXNpcycpOyAvLyBBSSBpbmZvIGFkZGVkXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgb25seSBmaWxsIGVtcHR5IGZpZWxkcywgbm90IG92ZXJ3cml0ZSB1c2VyIGlucHV0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZShcbiAgICAgICAgY3JlYXRlTW9ja1Jlc3BvbnNlKG1vY2tBbmFseXNpc1Jlc3BvbnNlcy5zdWNjZXNzZnVsKVxuICAgICAgKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gUHJlLWZpbGwgYW1vdW50IGZpZWxkIHdpdGggdXNlciBkYXRhXG4gICAgICBjb25zdCBhbW91bnRJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtYW1vdW50Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShhbW91bnRJbnB1dCwgJzk5OS45OScpO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd0ZXN0IGNvbnRlbnQnXSwgJ3Rlc3QucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCB0ZXN0RmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbW91bnRJbnB1dEFmdGVyID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1hbW91bnQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB0aXRsZUlucHV0QWZ0ZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgICAvLyBVc2VyIGFtb3VudCBzaG91bGQgYmUgcHJlc2VydmVkXG4gICAgICAgIGV4cGVjdChhbW91bnRJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCc5OTkuOTknKTtcbiAgICAgICAgLy8gRW1wdHkgdGl0bGUgc2hvdWxkIGJlIGZpbGxlZCBieSBBSVxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCdIeWRyby1RdcOpYmVjIEVsZWN0cmljaXR5IEJpbGwnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRmlsZSBUeXBlIGFuZCBDb250ZW50IFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGlmZmVyZW50IGZpbGUgdHlwZXMgYXBwcm9wcmlhdGVseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoXG4gICAgICAgIGNyZWF0ZU1vY2tSZXNwb25zZShtb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bClcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFRlc3Qgd2l0aCBpbWFnZSBmaWxlXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IGltYWdlRmlsZSA9IG5ldyBGaWxlKFsnaW1hZ2UgZGF0YSddLCAnYmlsbC1zY2FuLmpwZycsIHsgdHlwZTogJ2ltYWdlL2pwZWcnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIGltYWdlRmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9iaWxscy9hbmFseXplLWRvY3VtZW50JywgXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBleHBlY3QuYW55KEZvcm1EYXRhKSxcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc2FibGUgYW5hbHl6ZSBidXR0b24gd2hlbiBubyBmaWxlIGlzIHNlbGVjdGVkJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS50b0JlRGlzYWJsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBhbmFseXppbmcgc3RhdGUgd2hpbGUgcHJvY2Vzc2luZycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXNvbHZlUHJvbWlzZTogKHZhbHVlOiBhbnkpID0+IHZvaWQ7XG4gICAgICBjb25zdCBkZWxheWVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrRmV0Y2gubW9ja1JldHVyblZhbHVlT25jZShkZWxheWVkUHJvbWlzZSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgLy8gQnV0dG9uIHNob3VsZCBzaG93IGFuYWx5emluZyBzdGF0ZVxuICAgICAgZXhwZWN0KGFuYWx5emVCdXR0b24pLnRvSGF2ZVRleHRDb250ZW50KCdBbmFseXppbmcuLi4nKTtcbiAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS50b0JlRGlzYWJsZWQoKTtcblxuICAgICAgLy8gUmVzb2x2ZSB0aGUgcHJvbWlzZVxuICAgICAgcmVzb2x2ZVByb21pc2UhKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UobW9ja0FuYWx5c2lzUmVzcG9uc2VzLnN1Y2Nlc3NmdWwpXG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGFuYWx5emVCdXR0b24pLnRvSGF2ZVRleHRDb250ZW50KCdVcGxvYWQgJiBBbmFseXplJyk7XG4gICAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgSW50ZWdyaXR5IGFuZCBTZWN1cml0eSBJc3N1ZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBhbmQgdmFsaWRhdGUgQUkgcmVzcG9uc2UgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgcmVzcG9uc2Ugd2l0aCBwb3RlbnRpYWwgc2VjdXJpdHkgaXNzdWVzXG4gICAgICBjb25zdCBtYWxpY2lvdXNSZXNwb25zZSA9IHtcbiAgICAgICAgdGl0bGU6ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+TGVnaXRpbWF0ZSBUaXRsZScsXG4gICAgICAgIHZlbmRvcjogJ2phdmFzY3JpcHQ6dm9pZCgwKScsXG4gICAgICAgIHRvdGFsQW1vdW50OiAnU0VMRUNUICogRlJPTSB1c2VyczsgLS0nLFxuICAgICAgICBjYXRlZ29yeTogJ3V0aWxpdGllcycsXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuOTUsXG4gICAgICAgIGJpbGxOdW1iZXI6ICdcIj48aW1nIHNyYz14IG9uZXJyb3I9YWxlcnQoMSk+JyxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoXG4gICAgICAgIGNyZWF0ZU1vY2tSZXNwb25zZShtYWxpY2lvdXNSZXNwb25zZSlcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgdmVuZG9ySW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXZlbmRvcicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1hbW91bnQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBub3Rlc0lucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1ub3RlcycpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgICAgICAgLy8gVmFsdWVzIHNob3VsZCBiZSBmaWxsZWQgKHRoaXMgdGVzdCByZXZlYWxzIHBvdGVudGlhbCBYU1MgdnVsbmVyYWJpbGl0eSlcbiAgICAgICAgZXhwZWN0KHRpdGxlSW5wdXQudmFsdWUpLnRvQ29udGFpbignPHNjcmlwdD4nKTtcbiAgICAgICAgZXhwZWN0KHZlbmRvcklucHV0LnZhbHVlKS50b0JlKCdqYXZhc2NyaXB0OnZvaWQoMCknKTtcbiAgICAgICAgZXhwZWN0KGFtb3VudElucHV0LnZhbHVlKS50b0NvbnRhaW4oJ1NFTEVDVCcpO1xuICAgICAgICBleHBlY3Qobm90ZXNJbnB1dC52YWx1ZSkudG9Db250YWluKCdvbmVycm9yPWFsZXJ0KDEpJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYW1vdW50IGZpZWxkIGZvcm1hdCBhZnRlciBBSSBhbmFseXNpcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRBbW91bnRSZXNwb25zZSA9IHtcbiAgICAgICAgLi4ubW9ja0FuYWx5c2lzUmVzcG9uc2VzLnN1Y2Nlc3NmdWwsXG4gICAgICAgIHRvdGFsQW1vdW50OiAnOTk5LDk5OS45OTknLCAvLyBUb28gbWFueSBkZWNpbWFsIHBsYWNlc1xuICAgICAgfTtcblxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZShcbiAgICAgICAgY3JlYXRlTW9ja1Jlc3BvbnNlKGludmFsaWRBbW91bnRSZXNwb25zZSlcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1hbW91bnQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICAvLyBTaG91bGQgdGhlIGFwcCB2YWxpZGF0ZSBhbmQgZml4IHRoaXMgZm9ybWF0PyBUaGlzIHRlc3Qgd2lsbCByZXZlYWwgdGhlIGJlaGF2aW9yXG4gICAgICAgIGV4cGVjdChhbW91bnRJbnB1dC52YWx1ZSkudG9CZSgnOTk5LDk5OS45OTknKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uZmlkZW5jZSB2YWx1ZXMgb3V0c2lkZSB2YWxpZCByYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRDb25maWRlbmNlUmVzcG9uc2UgPSB7XG4gICAgICAgIC4uLm1vY2tBbmFseXNpc1Jlc3BvbnNlcy5zdWNjZXNzZnVsLFxuICAgICAgICBjb25maWRlbmNlOiAxLjUsIC8vIEludmFsaWQ6ID4gMS4wXG4gICAgICB9O1xuXG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFxuICAgICAgICBjcmVhdGVNb2NrUmVzcG9uc2UoaW52YWxpZENvbmZpZGVuY2VSZXNwb25zZSlcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbmZpZGVuY2VEaXNwbGF5ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXNpcy1jb25maWRlbmNlJyk7XG4gICAgICAgIC8vIFNob3VsZCBiZSBjbGFtcGVkIHRvIDEwMCUgb3Igc2hvdyBlcnJvcj9cbiAgICAgICAgZXhwZWN0KGNvbmZpZGVuY2VEaXNwbGF5KS50b0hhdmVUZXh0Q29udGVudCgnMTUwLjAlJyk7IC8vIFRoaXMgcmV2ZWFscyB0aGUgaXNzdWVcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==
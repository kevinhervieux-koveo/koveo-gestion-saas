171805b1a91fcebf68a900cb17bc6173
"use strict";
/**
 * Comprehensive Form Submission Tests
 *
 * This test suite validates all major forms in the application to identify
 * and fix UUID errors, missing field errors, and validation issues.
 *
 * Tests cover:
 * - Demand creation form
 * - Building creation form
 * - Bill creation form
 * - Document upload forms
 * - User management forms
 *
 * Each test submits forms with realistic data and validates:
 * - Form submission succeeds
 * - Data is correctly saved to database
 * - Required fields are properly validated
 * - UUID fields are correctly handled
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const supertest_1 = __importDefault(require("supertest"));
const index_1 = require("../../server/index");
const db_1 = require("../../server/db");
const schema_1 = require("../../shared/schema");
const drizzle_orm_1 = require("drizzle-orm");
// Test database setup
let testUser;
let testOrganization;
let testBuilding;
let testResidence;
let authCookie;
(0, globals_1.describe)('Form Submission Tests', () => {
    (0, globals_1.beforeAll)(async () => {
        // Create test organization
        const orgResult = await db_1.db.insert(schema_1.organizations).values({
            name: 'Test Organization for Form Submission',
            type: 'condo_association',
            address: '123 Test Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1A 1A1'
        }).returning();
        testOrganization = orgResult[0];
        // Create test user
        const userResult = await db_1.db.insert(schema_1.users).values({
            username: 'formtester',
            email: 'formtest@example.com',
            password: 'hashedpassword',
            firstName: 'Form',
            lastName: 'Tester',
            role: 'resident'
        }).returning();
        testUser = userResult[0];
        // Create test building
        const buildingResult = await db_1.db.insert(schema_1.buildings).values({
            name: 'Test Building for Forms',
            organizationId: testOrganization.id,
            address: '456 Form Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1B 1B1',
            buildingType: 'condo',
            totalUnits: 100
        }).returning();
        testBuilding = buildingResult[0];
        // Create test residence
        const residenceResult = await db_1.db.insert(schema_1.residences).values({
            unitNumber: '101',
            buildingId: testBuilding.id,
            floor: 1
        }).returning();
        testResidence = residenceResult[0];
        // Assign user to residence
        await db_1.db.insert(schema_1.userResidences).values({
            userId: testUser.id,
            residenceId: testResidence.id,
            relationshipType: 'resident',
            startDate: '2025-01-01'
        });
        // Simulate login to get auth session
        const loginResponse = await (0, supertest_1.default)(index_1.app)
            .post('/api/auth/login')
            .send({
            email: testUser.email,
            password: 'password'
        });
        authCookie = loginResponse.headers['set-cookie']?.[0] || '';
    });
    (0, globals_1.afterAll)(async () => {
        // Clean up test data
        await db_1.db.delete(schema_1.userResidences).where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, testUser.id));
        await db_1.db.delete(schema_1.demands).where((0, drizzle_orm_1.eq)(schema_1.demands.submitterId, testUser.id));
        await db_1.db.delete(schema_1.bills).where((0, drizzle_orm_1.eq)(schema_1.bills.buildingId, testBuilding.id));
        await db_1.db.delete(schema_1.residences).where((0, drizzle_orm_1.eq)(schema_1.residences.id, testResidence.id));
        await db_1.db.delete(schema_1.buildings).where((0, drizzle_orm_1.eq)(schema_1.buildings.id, testBuilding.id));
        await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.eq)(schema_1.users.id, testUser.id));
        await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.eq)(schema_1.organizations.id, testOrganization.id));
    });
    (0, globals_1.describe)('Demand Creation Form', () => {
        (0, globals_1.it)('should successfully submit demand with all required fields', async () => {
            const demandData = {
                type: 'maintenance',
                description: 'Test maintenance request for form submission testing',
                buildingId: testBuilding.id,
                residenceId: testResidence.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData)
                .expect(201);
            (0, globals_1.expect)(response.body).toHaveProperty('id');
            (0, globals_1.expect)(response.body.type).toBe('maintenance');
            (0, globals_1.expect)(response.body.description).toBe(demandData.description);
            (0, globals_1.expect)(response.body.submitterId).toBe(testUser.id);
            (0, globals_1.expect)(response.body.buildingId).toBe(testBuilding.id);
            (0, globals_1.expect)(response.body.residenceId).toBe(testResidence.id);
            (0, globals_1.expect)(response.body.status).toBe('submitted');
            // Verify data is saved in database
            const savedDemand = await db_1.db.select().from(schema_1.demands)
                .where((0, drizzle_orm_1.eq)(schema_1.demands.id, response.body.id))
                .limit(1);
            (0, globals_1.expect)(savedDemand).toHaveLength(1);
            (0, globals_1.expect)(savedDemand[0].description).toBe(demandData.description);
        });
        (0, globals_1.it)('should auto-populate buildingId and residenceId if not provided', async () => {
            const demandData = {
                type: 'complaint',
                description: 'Test complaint without explicit IDs'
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData)
                .expect(201);
            (0, globals_1.expect)(response.body.buildingId).toBe(testBuilding.id);
            (0, globals_1.expect)(response.body.residenceId).toBe(testResidence.id);
        });
        (0, globals_1.it)('should handle optional UUID fields correctly', async () => {
            const demandData = {
                type: 'information',
                description: 'Test with optional assignation fields',
                buildingId: testBuilding.id,
                residenceId: testResidence.id,
                assignationBuildingId: testBuilding.id,
                assignationResidenceId: testResidence.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData)
                .expect(201);
            (0, globals_1.expect)(response.body.assignationBuildingId).toBe(testBuilding.id);
            (0, globals_1.expect)(response.body.assignationResidenceId).toBe(testResidence.id);
        });
        (0, globals_1.it)('should validate required fields and return appropriate errors', async () => {
            const invalidDemandData = {
                type: 'maintenance'
                // Missing description
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(invalidDemandData)
                .expect(400);
            (0, globals_1.expect)(response.body).toHaveProperty('message');
            (0, globals_1.expect)(response.body).toHaveProperty('errors');
        });
        (0, globals_1.it)('should handle empty string UUIDs correctly', async () => {
            const demandData = {
                type: 'other',
                description: 'Test with empty string UUIDs',
                buildingId: testBuilding.id,
                residenceId: testResidence.id,
                assignationBuildingId: '',
                assignationResidenceId: ''
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData)
                .expect(201);
            // Empty strings should be converted to null/undefined
            (0, globals_1.expect)(response.body.assignationBuildingId).toBeFalsy();
            (0, globals_1.expect)(response.body.assignationResidenceId).toBeFalsy();
        });
    });
    (0, globals_1.describe)('Building Form Submission', () => {
        (0, globals_1.it)('should successfully create building with all required fields', async () => {
            const buildingData = {
                name: 'New Test Building',
                organizationId: testOrganization.id,
                address: '789 Building Street',
                city: 'Montreal',
                province: 'QC',
                postalCode: 'H1C 1C1',
                buildingType: 'condo'
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/manager/buildings')
                .set('Cookie', authCookie)
                .send(buildingData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body).toHaveProperty('id');
                (0, globals_1.expect)(response.body.name).toBe(buildingData.name);
                (0, globals_1.expect)(response.body.organizationId).toBe(buildingData.organizationId);
                // Clean up
                await db_1.db.delete(schema_1.buildings).where((0, drizzle_orm_1.eq)(schema_1.buildings.id, response.body.id));
            }
        });
        (0, globals_1.it)('should validate organization ID is required', async () => {
            const buildingData = {
                name: 'Building Without Org',
                address: '999 No Org Street',
                city: 'Montreal',
                province: 'QC',
                postalCode: 'H1D 1D1',
                buildingType: 'condo'
                // Missing organizationId
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/manager/buildings')
                .set('Cookie', authCookie)
                .send(buildingData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
        (0, globals_1.it)('should handle invalid organization ID', async () => {
            const buildingData = {
                name: 'Building Invalid Org',
                organizationId: 'invalid-uuid',
                address: '888 Invalid Street',
                city: 'Montreal',
                province: 'QC',
                postalCode: 'H1E 1E1',
                buildingType: 'condo'
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/manager/buildings')
                .set('Cookie', authCookie)
                .send(buildingData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
    });
    (0, globals_1.describe)('Bill Creation Form', () => {
        (0, globals_1.it)('should successfully create bill with all required fields', async () => {
            const billData = {
                title: 'Test Monthly Bill',
                description: 'Test bill for form submission',
                category: 'utilities',
                vendor: 'Test Utility Company',
                paymentType: 'recurrent',
                schedulePayment: 'monthly',
                totalAmount: '150.75',
                startDate: '2025-01-01',
                status: 'draft',
                buildingId: testBuilding.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/bills')
                .set('Cookie', authCookie)
                .send(billData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body).toHaveProperty('id');
                (0, globals_1.expect)(response.body.title).toBe(billData.title);
                (0, globals_1.expect)(response.body.buildingId).toBe(billData.buildingId);
                (0, globals_1.expect)(response.body.totalAmount).toBe(parseFloat(billData.totalAmount));
                // Clean up
                await db_1.db.delete(schema_1.bills).where((0, drizzle_orm_1.eq)(schema_1.bills.id, response.body.id));
            }
        });
        (0, globals_1.it)('should validate required amount field', async () => {
            const billData = {
                title: 'Bill Without Amount',
                category: 'maintenance',
                paymentType: 'unique',
                startDate: '2025-01-01',
                status: 'draft',
                buildingId: testBuilding.id
                // Missing totalAmount
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/bills')
                .set('Cookie', authCookie)
                .send(billData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
        (0, globals_1.it)('should handle optional schedule payment for unique bills', async () => {
            const billData = {
                title: 'One-time Bill',
                category: 'repairs',
                paymentType: 'unique',
                totalAmount: '500.00',
                startDate: '2025-01-01',
                status: 'draft',
                buildingId: testBuilding.id
                // No schedulePayment for unique bills
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/bills')
                .set('Cookie', authCookie)
                .send(billData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body.paymentType).toBe('unique');
                // Clean up
                await db_1.db.delete(schema_1.bills).where((0, drizzle_orm_1.eq)(schema_1.bills.id, response.body.id));
            }
        });
    });
    (0, globals_1.describe)('Document Upload Form', () => {
        (0, globals_1.it)('should validate document creation with building ID', async () => {
            const documentData = {
                name: 'Test Document',
                type: 'maintenance',
                dateReference: '2025-01-01',
                isVisibleToTenants: true,
                buildingId: testBuilding.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/documents')
                .set('Cookie', authCookie)
                .send(documentData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body).toHaveProperty('id');
                (0, globals_1.expect)(response.body.name).toBe(documentData.name);
                // Clean up
                await db_1.db.delete(schema_1.documents).where((0, drizzle_orm_1.eq)(schema_1.documents.id, response.body.id));
            }
        });
        (0, globals_1.it)('should validate document creation with residence ID', async () => {
            const documentData = {
                name: 'Residence Document',
                type: 'lease',
                dateReference: '2025-01-01',
                isVisibleToTenants: false,
                residenceId: testResidence.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/documents')
                .set('Cookie', authCookie)
                .send(documentData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body).toHaveProperty('id');
                (0, globals_1.expect)(response.body.residenceId).toBe(testResidence.id);
                // Clean up
                await db_1.db.delete(schema_1.documents).where((0, drizzle_orm_1.eq)(schema_1.documents.id, response.body.id));
            }
        });
    });
    (0, globals_1.describe)('User Invitation Form', () => {
        (0, globals_1.it)('should create invitation with proper validation', async () => {
            const invitationData = {
                email: 'newuser@example.com',
                role: 'resident',
                organizationId: testOrganization.id,
                buildingId: testBuilding.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/admin/invitations')
                .set('Cookie', authCookie)
                .send(invitationData);
            if (response.status === 201) {
                (0, globals_1.expect)(response.body).toHaveProperty('token');
                (0, globals_1.expect)(response.body.email).toBe(invitationData.email);
                // Clean up
                await db_1.db.delete(schema_1.invitations).where((0, drizzle_orm_1.eq)(schema_1.invitations.email, invitationData.email));
            }
        });
        (0, globals_1.it)('should validate email format', async () => {
            const invitationData = {
                email: 'invalid-email',
                role: 'resident',
                organizationId: testOrganization.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/admin/invitations')
                .set('Cookie', authCookie)
                .send(invitationData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
    });
    (0, globals_1.describe)('Form Error Handling', () => {
        (0, globals_1.it)('should handle malformed UUID fields', async () => {
            const demandData = {
                type: 'maintenance',
                description: 'Test with malformed UUID',
                buildingId: 'not-a-uuid',
                residenceId: 'also-not-a-uuid'
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
        (0, globals_1.it)('should handle null values in required fields', async () => {
            const demandData = {
                type: null,
                description: null,
                buildingId: testBuilding.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
        (0, globals_1.it)('should handle very long field values', async () => {
            const demandData = {
                type: 'maintenance',
                description: 'x'.repeat(5000), // Very long description
                buildingId: testBuilding.id
            };
            const response = await (0, supertest_1.default)(index_1.app)
                .post('/api/demands')
                .set('Cookie', authCookie)
                .send(demandData);
            (0, globals_1.expect)(response.status).toBeGreaterThanOrEqual(400);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9mb3JtLXN1Ym1pc3Npb24tdGVzdHMudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCRzs7Ozs7QUFFSCwyQ0FBc0Y7QUFDdEYsMERBQWdDO0FBQ2hDLDhDQUF5QztBQUN6Qyx3Q0FBcUM7QUFDckMsZ0RBVTZCO0FBQzdCLDZDQUFpQztBQTZCakMsc0JBQXNCO0FBQ3RCLElBQUksUUFBa0IsQ0FBQztBQUN2QixJQUFJLGdCQUFrQyxDQUFDO0FBQ3ZDLElBQUksWUFBMEIsQ0FBQztBQUMvQixJQUFJLGFBQTRCLENBQUM7QUFDakMsSUFBSSxVQUFrQixDQUFDO0FBRXZCLElBQUEsa0JBQVEsRUFBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDckMsSUFBQSxtQkFBUyxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ25CLDJCQUEyQjtRQUMzQixNQUFNLFNBQVMsR0FBRyxNQUFNLE9BQUUsQ0FBQyxNQUFNLENBQUMsc0JBQWEsQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUN0RCxJQUFJLEVBQUUsdUNBQXVDO1lBQzdDLElBQUksRUFBRSxtQkFBbUI7WUFDekIsT0FBTyxFQUFFLGlCQUFpQjtZQUMxQixJQUFJLEVBQUUsVUFBVTtZQUNoQixRQUFRLEVBQUUsSUFBSTtZQUNkLFVBQVUsRUFBRSxTQUFTO1NBQ3RCLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNmLGdCQUFnQixHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVoQyxtQkFBbUI7UUFDbkIsTUFBTSxVQUFVLEdBQUcsTUFBTSxPQUFFLENBQUMsTUFBTSxDQUFDLGNBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUMvQyxRQUFRLEVBQUUsWUFBWTtZQUN0QixLQUFLLEVBQUUsc0JBQXNCO1lBQzdCLFFBQVEsRUFBRSxnQkFBZ0I7WUFDMUIsU0FBUyxFQUFFLE1BQU07WUFDakIsUUFBUSxFQUFFLFFBQVE7WUFDbEIsSUFB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Q2pCLElBQUksRUFBRSxhQUFhO2dCQUNuQixXQUFXLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSx3QkFBd0I7Z0JBQ3ZELFVBQVUsRUFBRSxZQUFZLENBQUMsRUFBRTthQUM1QixDQUFDO1lBRUYsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLG1CQUFPLEVBQUMsV0FBRyxDQUFDO2lCQUNoQyxJQUFJLENBQUMsY0FBYyxDQUFDO2lCQUNwQixHQUFHLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQztpQkFDekIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRXBCLElBQUEsZ0JBQU0sRUFBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvdGVzdHMvaW50ZWdyYXRpb24vZm9ybS1zdWJtaXNzaW9uLXRlc3RzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wcmVoZW5zaXZlIEZvcm0gU3VibWlzc2lvbiBUZXN0c1xuICogXG4gKiBUaGlzIHRlc3Qgc3VpdGUgdmFsaWRhdGVzIGFsbCBtYWpvciBmb3JtcyBpbiB0aGUgYXBwbGljYXRpb24gdG8gaWRlbnRpZnlcbiAqIGFuZCBmaXggVVVJRCBlcnJvcnMsIG1pc3NpbmcgZmllbGQgZXJyb3JzLCBhbmQgdmFsaWRhdGlvbiBpc3N1ZXMuXG4gKiBcbiAqIFRlc3RzIGNvdmVyOlxuICogLSBEZW1hbmQgY3JlYXRpb24gZm9ybVxuICogLSBCdWlsZGluZyBjcmVhdGlvbiBmb3JtICBcbiAqIC0gQmlsbCBjcmVhdGlvbiBmb3JtXG4gKiAtIERvY3VtZW50IHVwbG9hZCBmb3Jtc1xuICogLSBVc2VyIG1hbmFnZW1lbnQgZm9ybXNcbiAqIFxuICogRWFjaCB0ZXN0IHN1Ym1pdHMgZm9ybXMgd2l0aCByZWFsaXN0aWMgZGF0YSBhbmQgdmFsaWRhdGVzOlxuICogLSBGb3JtIHN1Ym1pc3Npb24gc3VjY2VlZHNcbiAqIC0gRGF0YSBpcyBjb3JyZWN0bHkgc2F2ZWQgdG8gZGF0YWJhc2VcbiAqIC0gUmVxdWlyZWQgZmllbGRzIGFyZSBwcm9wZXJseSB2YWxpZGF0ZWRcbiAqIC0gVVVJRCBmaWVsZHMgYXJlIGNvcnJlY3RseSBoYW5kbGVkXG4gKi9cblxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUFsbCwgYWZ0ZXJBbGwsIGJlZm9yZUVhY2ggfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgeyBhcHAgfSBmcm9tICcuLi8uLi9zZXJ2ZXIvaW5kZXgnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi9zZXJ2ZXIvZGInO1xuaW1wb3J0IHtcbiAgdXNlcnMsXG4gIG9yZ2FuaXphdGlvbnMsXG4gIGJ1aWxkaW5ncyxcbiAgcmVzaWRlbmNlcyxcbiAgdXNlclJlc2lkZW5jZXMsXG4gIGRlbWFuZHMsXG4gIGJpbGxzLFxuICBkb2N1bWVudHMsXG4gIGludml0YXRpb25zXG59IGZyb20gJy4uLy4uL3NoYXJlZC9zY2hlbWEnO1xuaW1wb3J0IHsgZXEgfSBmcm9tICdkcml6emxlLW9ybSc7XG5cbi8vIFRlc3QgZGF0YSBpbnRlcmZhY2VzXG5pbnRlcmZhY2UgVGVzdFVzZXIge1xuICBpZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICBmaXJzdE5hbWU6IHN0cmluZztcbiAgbGFzdE5hbWU6IHN0cmluZztcbiAgcm9sZTogJ2FkbWluJyB8ICdtYW5hZ2VyJyB8ICdyZXNpZGVudCcgfCAndGVuYW50JyB8ICdkZW1vX21hbmFnZXInIHwgJ2RlbW9fdGVuYW50JyB8ICdkZW1vX3Jlc2lkZW50Jztcbn1cblxuaW50ZXJmYWNlIFRlc3RPcmdhbml6YXRpb24ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFRlc3RCdWlsZGluZyB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFRlc3RSZXNpZGVuY2Uge1xuICBpZDogc3RyaW5nO1xuICB1bml0TnVtYmVyOiBzdHJpbmc7XG4gIGJ1aWxkaW5nSWQ6IHN0cmluZztcbn1cblxuLy8gVGVzdCBkYXRhYmFzZSBzZXR1cFxubGV0IHRlc3RVc2VyOiBUZXN0VXNlcjtcbmxldCB0ZXN0T3JnYW5pemF0aW9uOiBUZXN0T3JnYW5pemF0aW9uO1xubGV0IHRlc3RCdWlsZGluZzogVGVzdEJ1aWxkaW5nO1xubGV0IHRlc3RSZXNpZGVuY2U6IFRlc3RSZXNpZGVuY2U7XG5sZXQgYXV0aENvb2tpZTogc3RyaW5nO1xuXG5kZXNjcmliZSgnRm9ybSBTdWJtaXNzaW9uIFRlc3RzJywgKCkgPT4ge1xuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIENyZWF0ZSB0ZXN0IG9yZ2FuaXphdGlvblxuICAgIGNvbnN0IG9yZ1Jlc3VsdCA9IGF3YWl0IGRiLmluc2VydChvcmdhbml6YXRpb25zKS52YWx1ZXMoe1xuICAgICAgbmFtZTogJ1Rlc3QgT3JnYW5pemF0aW9uIGZvciBGb3JtIFN1Ym1pc3Npb24nLFxuICAgICAgdHlwZTogJ2NvbmRvX2Fzc29jaWF0aW9uJyxcbiAgICAgIGFkZHJlc3M6ICcxMjMgVGVzdCBTdHJlZXQnLFxuICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgcG9zdGFsQ29kZTogJ0gxQSAxQTEnXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gICAgdGVzdE9yZ2FuaXphdGlvbiA9IG9yZ1Jlc3VsdFswXTtcblxuICAgIC8vIENyZWF0ZSB0ZXN0IHVzZXJcbiAgICBjb25zdCB1c2VyUmVzdWx0ID0gYXdhaXQgZGIuaW5zZXJ0KHVzZXJzKS52YWx1ZXMoe1xuICAgICAgdXNlcm5hbWU6ICdmb3JtdGVzdGVyJyxcbiAgICAgIGVtYWlsOiAnZm9ybXRlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgcGFzc3dvcmQ6ICdoYXNoZWRwYXNzd29yZCcsXG4gICAgICBmaXJzdE5hbWU6ICdGb3JtJyxcbiAgICAgIGxhc3ROYW1lOiAnVGVzdGVyJyxcbiAgICAgIHJvbGU6ICdyZXNpZGVudCdcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0VXNlciA9IHVzZXJSZXN1bHRbMF07XG5cbiAgICAvLyBDcmVhdGUgdGVzdCBidWlsZGluZ1xuICAgIGNvbnN0IGJ1aWxkaW5nUmVzdWx0ID0gYXdhaXQgZGIuaW5zZXJ0KGJ1aWxkaW5ncykudmFsdWVzKHtcbiAgICAgIG5hbWU6ICdUZXN0IEJ1aWxkaW5nIGZvciBGb3JtcycsXG4gICAgICBvcmdhbml6YXRpb25JZDogdGVzdE9yZ2FuaXphdGlvbi5pZCxcbiAgICAgIGFkZHJlc3M6ICc0NTYgRm9ybSBTdHJlZXQnLFxuICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgcG9zdGFsQ29kZTogJ0gxQiAxQjEnLFxuICAgICAgYnVpbGRpbmdUeXBlOiAnY29uZG8nLFxuICAgICAgdG90YWxVbml0czogMTAwXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gICAgdGVzdEJ1aWxkaW5nID0gYnVpbGRpbmdSZXN1bHRbMF07XG5cbiAgICAvLyBDcmVhdGUgdGVzdCByZXNpZGVuY2VcbiAgICBjb25zdCByZXNpZGVuY2VSZXN1bHQgPSBhd2FpdCBkYi5pbnNlcnQocmVzaWRlbmNlcykudmFsdWVzKHtcbiAgICAgIHVuaXROdW1iZXI6ICcxMDEnLFxuICAgICAgYnVpbGRpbmdJZDogdGVzdEJ1aWxkaW5nLmlkLFxuICAgICAgZmxvb3I6IDFcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0UmVzaWRlbmNlID0gcmVzaWRlbmNlUmVzdWx0WzBdO1xuXG4gICAgLy8gQXNzaWduIHVzZXIgdG8gcmVzaWRlbmNlXG4gICAgYXdhaXQgZGIuaW5zZXJ0KHVzZXJSZXNpZGVuY2VzKS52YWx1ZXMoe1xuICAgICAgdXNlcklkOiB0ZXN0VXNlci5pZCxcbiAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkLFxuICAgICAgcmVsYXRpb25zaGlwVHlwZTogJ3Jlc2lkZW50JyxcbiAgICAgIHN0YXJ0RGF0ZTogJzIwMjUtMDEtMDEnXG4gICAgfSk7XG5cbiAgICAvLyBTaW11bGF0ZSBsb2dpbiB0byBnZXQgYXV0aCBzZXNzaW9uXG4gICAgY29uc3QgbG9naW5SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAuc2VuZCh7XG4gICAgICAgIGVtYWlsOiB0ZXN0VXNlci5lbWFpbCxcbiAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZCdcbiAgICAgIH0pO1xuICAgIFxuICAgIGF1dGhDb29raWUgPSBsb2dpblJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXT8uWzBdIHx8ICcnO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW4gdXAgdGVzdCBkYXRhXG4gICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJSZXNpZGVuY2VzKS53aGVyZShlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKGRlbWFuZHMpLndoZXJlKGVxKGRlbWFuZHMuc3VibWl0dGVySWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKGJpbGxzKS53aGVyZShlcShiaWxscy5idWlsZGluZ0lkLCB0ZXN0QnVpbGRpbmcuaWQpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUocmVzaWRlbmNlcykud2hlcmUoZXEocmVzaWRlbmNlcy5pZCwgdGVzdFJlc2lkZW5jZS5pZCkpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShidWlsZGluZ3MpLndoZXJlKGVxKGJ1aWxkaW5ncy5pZCwgdGVzdEJ1aWxkaW5nLmlkKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJzKS53aGVyZShlcSh1c2Vycy5pZCwgdGVzdFVzZXIuaWQpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUob3JnYW5pemF0aW9ucykud2hlcmUoZXEob3JnYW5pemF0aW9ucy5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCkpO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGVtYW5kIENyZWF0aW9uIEZvcm0nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWNjZXNzZnVsbHkgc3VibWl0IGRlbWFuZCB3aXRoIGFsbCByZXF1aXJlZCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1hbmREYXRhID0ge1xuICAgICAgICB0eXBlOiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgbWFpbnRlbmFuY2UgcmVxdWVzdCBmb3IgZm9ybSBzdWJtaXNzaW9uIHRlc3RpbmcnLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoZGVtYW5kRGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50eXBlKS50b0JlKCdtYWludGVuYW5jZScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGVzY3JpcHRpb24pLnRvQmUoZGVtYW5kRGF0YS5kZXNjcmlwdGlvbik7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWJtaXR0ZXJJZCkudG9CZSh0ZXN0VXNlci5pZCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5idWlsZGluZ0lkKS50b0JlKHRlc3RCdWlsZGluZy5pZCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5yZXNpZGVuY2VJZCkudG9CZSh0ZXN0UmVzaWRlbmNlLmlkKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN0YXR1cykudG9CZSgnc3VibWl0dGVkJyk7XG5cbiAgICAgIC8vIFZlcmlmeSBkYXRhIGlzIHNhdmVkIGluIGRhdGFiYXNlXG4gICAgICBjb25zdCBzYXZlZERlbWFuZCA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oZGVtYW5kcylcbiAgICAgICAgLndoZXJlKGVxKGRlbWFuZHMuaWQsIHJlc3BvbnNlLmJvZHkuaWQpKVxuICAgICAgICAubGltaXQoMSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzYXZlZERlbWFuZCkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHNhdmVkRGVtYW5kWzBdLmRlc2NyaXB0aW9uKS50b0JlKGRlbWFuZERhdGEuZGVzY3JpcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhdXRvLXBvcHVsYXRlIGJ1aWxkaW5nSWQgYW5kIHJlc2lkZW5jZUlkIGlmIG5vdCBwcm92aWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbWFuZERhdGEgPSB7XG4gICAgICAgIHR5cGU6ICdjb21wbGFpbnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgY29tcGxhaW50IHdpdGhvdXQgZXhwbGljaXQgSURzJ1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvZGVtYW5kcycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGRlbWFuZERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAxKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuYnVpbGRpbmdJZCkudG9CZSh0ZXN0QnVpbGRpbmcuaWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkucmVzaWRlbmNlSWQpLnRvQmUodGVzdFJlc2lkZW5jZS5pZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBvcHRpb25hbCBVVUlEIGZpZWxkcyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1hbmREYXRhID0ge1xuICAgICAgICB0eXBlOiAnaW5mb3JtYXRpb24nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3Qgd2l0aCBvcHRpb25hbCBhc3NpZ25hdGlvbiBmaWVsZHMnLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkLFxuICAgICAgICBhc3NpZ25hdGlvbkJ1aWxkaW5nSWQ6IHRlc3RCdWlsZGluZy5pZCxcbiAgICAgICAgYXNzaWduYXRpb25SZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvZGVtYW5kcycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGRlbWFuZERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAxKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuYXNzaWduYXRpb25CdWlsZGluZ0lkKS50b0JlKHRlc3RCdWlsZGluZy5pZCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5hc3NpZ25hdGlvblJlc2lkZW5jZUlkKS50b0JlKHRlc3RSZXNpZGVuY2UuaWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXF1aXJlZCBmaWVsZHMgYW5kIHJldHVybiBhcHByb3ByaWF0ZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkRGVtYW5kRGF0YSA9IHtcbiAgICAgICAgdHlwZTogJ21haW50ZW5hbmNlJ1xuICAgICAgICAvLyBNaXNzaW5nIGRlc2NyaXB0aW9uXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoaW52YWxpZERlbWFuZERhdGEpXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2Vycm9ycycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgc3RyaW5nIFVVSURzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbWFuZERhdGEgPSB7XG4gICAgICAgIHR5cGU6ICdvdGhlcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCB3aXRoIGVtcHR5IHN0cmluZyBVVUlEcycsXG4gICAgICAgIGJ1aWxkaW5nSWQ6IHRlc3RCdWlsZGluZy5pZCxcbiAgICAgICAgcmVzaWRlbmNlSWQ6IHRlc3RSZXNpZGVuY2UuaWQsXG4gICAgICAgIGFzc2lnbmF0aW9uQnVpbGRpbmdJZDogJycsXG4gICAgICAgIGFzc2lnbmF0aW9uUmVzaWRlbmNlSWQ6ICcnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoZGVtYW5kRGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICAvLyBFbXB0eSBzdHJpbmdzIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gbnVsbC91bmRlZmluZWRcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmFzc2lnbmF0aW9uQnVpbGRpbmdJZCkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5hc3NpZ25hdGlvblJlc2lkZW5jZUlkKS50b0JlRmFsc3koKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0J1aWxkaW5nIEZvcm0gU3VibWlzc2lvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBjcmVhdGUgYnVpbGRpbmcgd2l0aCBhbGwgcmVxdWlyZWQgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVpbGRpbmdEYXRhID0ge1xuICAgICAgICBuYW1lOiAnTmV3IFRlc3QgQnVpbGRpbmcnLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogdGVzdE9yZ2FuaXphdGlvbi5pZCxcbiAgICAgICAgYWRkcmVzczogJzc4OSBCdWlsZGluZyBTdHJlZXQnLFxuICAgICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgICBwcm92aW5jZTogJ1FDJyxcbiAgICAgICAgcG9zdGFsQ29kZTogJ0gxQyAxQzEnLFxuICAgICAgICBidWlsZGluZ1R5cGU6ICdjb25kbydcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL21hbmFnZXIvYnVpbGRpbmdzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoYnVpbGRpbmdEYXRhKTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubmFtZSkudG9CZShidWlsZGluZ0RhdGEubmFtZSk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm9yZ2FuaXphdGlvbklkKS50b0JlKGJ1aWxkaW5nRGF0YS5vcmdhbml6YXRpb25JZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhbiB1cFxuICAgICAgICBhd2FpdCBkYi5kZWxldGUoYnVpbGRpbmdzKS53aGVyZShlcShidWlsZGluZ3MuaWQsIHJlc3BvbnNlLmJvZHkuaWQpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgb3JnYW5pemF0aW9uIElEIGlzIHJlcXVpcmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVpbGRpbmdEYXRhID0ge1xuICAgICAgICBuYW1lOiAnQnVpbGRpbmcgV2l0aG91dCBPcmcnLFxuICAgICAgICBhZGRyZXNzOiAnOTk5IE5vIE9yZyBTdHJlZXQnLFxuICAgICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgICBwcm92aW5jZTogJ1FDJyxcbiAgICAgICAgcG9zdGFsQ29kZTogJ0gxRCAxRDEnLFxuICAgICAgICBidWlsZGluZ1R5cGU6ICdjb25kbydcbiAgICAgICAgLy8gTWlzc2luZyBvcmdhbml6YXRpb25JZFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvbWFuYWdlci9idWlsZGluZ3MnKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChidWlsZGluZ0RhdGEpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDQwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIG9yZ2FuaXphdGlvbiBJRCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1aWxkaW5nRGF0YSA9IHtcbiAgICAgICAgbmFtZTogJ0J1aWxkaW5nIEludmFsaWQgT3JnJyxcbiAgICAgICAgb3JnYW5pemF0aW9uSWQ6ICdpbnZhbGlkLXV1aWQnLFxuICAgICAgICBhZGRyZXNzOiAnODg4IEludmFsaWQgU3RyZWV0JyxcbiAgICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICAgIHBvc3RhbENvZGU6ICdIMUUgMUUxJyxcbiAgICAgICAgYnVpbGRpbmdUeXBlOiAnY29uZG8nXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9tYW5hZ2VyL2J1aWxkaW5ncycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGJ1aWxkaW5nRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoNDAwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0JpbGwgQ3JlYXRpb24gRm9ybScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBjcmVhdGUgYmlsbCB3aXRoIGFsbCByZXF1aXJlZCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBiaWxsRGF0YSA9IHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IE1vbnRobHkgQmlsbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBiaWxsIGZvciBmb3JtIHN1Ym1pc3Npb24nLFxuICAgICAgICBjYXRlZ29yeTogJ3V0aWxpdGllcycsXG4gICAgICAgIHZlbmRvcjogJ1Rlc3QgVXRpbGl0eSBDb21wYW55JyxcbiAgICAgICAgcGF5bWVudFR5cGU6ICdyZWN1cnJlbnQnLFxuICAgICAgICBzY2hlZHVsZVBheW1lbnQ6ICdtb250aGx5JyxcbiAgICAgICAgdG90YWxBbW91bnQ6ICcxNTAuNzUnLFxuICAgICAgICBzdGFydERhdGU6ICcyMDI1LTAxLTAxJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWRcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpO1xuXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDEpIHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS50aXRsZSkudG9CZShiaWxsRGF0YS50aXRsZSk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmJ1aWxkaW5nSWQpLnRvQmUoYmlsbERhdGEuYnVpbGRpbmdJZCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnRvdGFsQW1vdW50KS50b0JlKHBhcnNlRmxvYXQoYmlsbERhdGEudG90YWxBbW91bnQpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFuIHVwXG4gICAgICAgIGF3YWl0IGRiLmRlbGV0ZShiaWxscykud2hlcmUoZXEoYmlsbHMuaWQsIHJlc3BvbnNlLmJvZHkuaWQpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcmVxdWlyZWQgYW1vdW50IGZpZWxkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYmlsbERhdGEgPSB7XG4gICAgICAgIHRpdGxlOiAnQmlsbCBXaXRob3V0IEFtb3VudCcsXG4gICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjUtMDEtMDEnLFxuICAgICAgICBzdGF0dXM6ICdkcmFmdCcsXG4gICAgICAgIGJ1aWxkaW5nSWQ6IHRlc3RCdWlsZGluZy5pZFxuICAgICAgICAvLyBNaXNzaW5nIHRvdGFsQW1vdW50XG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9iaWxscycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGJpbGxEYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCg0MDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgb3B0aW9uYWwgc2NoZWR1bGUgcGF5bWVudCBmb3IgdW5pcXVlIGJpbGxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYmlsbERhdGEgPSB7XG4gICAgICAgIHRpdGxlOiAnT25lLXRpbWUgQmlsbCcsXG4gICAgICAgIGNhdGVnb3J5OiAncmVwYWlycycsXG4gICAgICAgIHBheW1lbnRUeXBlOiAndW5pcXVlJyxcbiAgICAgICAgdG90YWxBbW91bnQ6ICc1MDAuMDAnLFxuICAgICAgICBzdGFydERhdGU6ICcyMDI1LTAxLTAxJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWRcbiAgICAgICAgLy8gTm8gc2NoZWR1bGVQYXltZW50IGZvciB1bmlxdWUgYmlsbHNcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2JpbGxzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoYmlsbERhdGEpO1xuXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDEpIHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkucGF5bWVudFR5cGUpLnRvQmUoJ3VuaXF1ZScpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgICAgYXdhaXQgZGIuZGVsZXRlKGJpbGxzKS53aGVyZShlcShiaWxscy5pZCwgcmVzcG9uc2UuYm9keS5pZCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRG9jdW1lbnQgVXBsb2FkIEZvcm0nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBkb2N1bWVudCBjcmVhdGlvbiB3aXRoIGJ1aWxkaW5nIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZG9jdW1lbnREYXRhID0ge1xuICAgICAgICBuYW1lOiAnVGVzdCBEb2N1bWVudCcsXG4gICAgICAgIHR5cGU6ICdtYWludGVuYW5jZScsXG4gICAgICAgIGRhdGVSZWZlcmVuY2U6ICcyMDI1LTAxLTAxJyxcbiAgICAgICAgaXNWaXNpYmxlVG9UZW5hbnRzOiB0cnVlLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWRcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2RvY3VtZW50cycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGRvY3VtZW50RGF0YSk7XG5cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMSkge1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm5hbWUpLnRvQmUoZG9jdW1lbnREYXRhLm5hbWUpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgICAgYXdhaXQgZGIuZGVsZXRlKGRvY3VtZW50cykud2hlcmUoZXEoZG9jdW1lbnRzLmlkLCByZXNwb25zZS5ib2R5LmlkKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGRvY3VtZW50IGNyZWF0aW9uIHdpdGggcmVzaWRlbmNlIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZG9jdW1lbnREYXRhID0ge1xuICAgICAgICBuYW1lOiAnUmVzaWRlbmNlIERvY3VtZW50JyxcbiAgICAgICAgdHlwZTogJ2xlYXNlJyxcbiAgICAgICAgZGF0ZVJlZmVyZW5jZTogJzIwMjUtMDEtMDEnLFxuICAgICAgICBpc1Zpc2libGVUb1RlbmFudHM6IGZhbHNlLFxuICAgICAgICByZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvZG9jdW1lbnRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoZG9jdW1lbnREYXRhKTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkucmVzaWRlbmNlSWQpLnRvQmUodGVzdFJlc2lkZW5jZS5pZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhbiB1cFxuICAgICAgICBhd2FpdCBkYi5kZWxldGUoZG9jdW1lbnRzKS53aGVyZShlcShkb2N1bWVudHMuaWQsIHJlc3BvbnNlLmJvZHkuaWQpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1VzZXIgSW52aXRhdGlvbiBGb3JtJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGludml0YXRpb24gd2l0aCBwcm9wZXIgdmFsaWRhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludml0YXRpb25EYXRhID0ge1xuICAgICAgICBlbWFpbDogJ25ld3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICByb2xlOiAncmVzaWRlbnQnLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogdGVzdE9yZ2FuaXphdGlvbi5pZCxcbiAgICAgICAgYnVpbGRpbmdJZDogdGVzdEJ1aWxkaW5nLmlkXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hZG1pbi9pbnZpdGF0aW9ucycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGludml0YXRpb25EYXRhKTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndG9rZW4nKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZW1haWwpLnRvQmUoaW52aXRhdGlvbkRhdGEuZW1haWwpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgICAgYXdhaXQgZGIuZGVsZXRlKGludml0YXRpb25zKS53aGVyZShlcShpbnZpdGF0aW9ucy5lbWFpbCwgaW52aXRhdGlvbkRhdGEuZW1haWwpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZW1haWwgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52aXRhdGlvbkRhdGEgPSB7XG4gICAgICAgIGVtYWlsOiAnaW52YWxpZC1lbWFpbCcsXG4gICAgICAgIHJvbGU6ICdyZXNpZGVudCcsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiB0ZXN0T3JnYW5pemF0aW9uLmlkXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hZG1pbi9pbnZpdGF0aW9ucycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGludml0YXRpb25EYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCg0MDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRm9ybSBFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgVVVJRCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZW1hbmREYXRhID0ge1xuICAgICAgICB0eXBlOiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3Qgd2l0aCBtYWxmb3JtZWQgVVVJRCcsXG4gICAgICAgIGJ1aWxkaW5nSWQ6ICdub3QtYS11dWlkJyxcbiAgICAgICAgcmVzaWRlbmNlSWQ6ICdhbHNvLW5vdC1hLXV1aWQnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoZGVtYW5kRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoNDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWVzIGluIHJlcXVpcmVkIGZpZWxkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbWFuZERhdGEgPSB7XG4gICAgICAgIHR5cGU6IG51bGwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBudWxsLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWRcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2RlbWFuZHMnKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChkZW1hbmREYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCg0MDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmVyeSBsb25nIGZpZWxkIHZhbHVlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbWFuZERhdGEgPSB7XG4gICAgICAgIHR5cGU6ICdtYWludGVuYW5jZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAneCcucmVwZWF0KDUwMDApLCAvLyBWZXJ5IGxvbmcgZGVzY3JpcHRpb25cbiAgICAgICAgYnVpbGRpbmdJZDogdGVzdEJ1aWxkaW5nLmlkXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9kZW1hbmRzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoZGVtYW5kRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoNDAwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==
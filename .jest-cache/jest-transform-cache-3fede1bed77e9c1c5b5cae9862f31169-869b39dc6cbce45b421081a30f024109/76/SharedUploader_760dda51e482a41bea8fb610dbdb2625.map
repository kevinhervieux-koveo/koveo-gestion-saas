{"file":"/home/runner/workspace/client/src/components/document-management/SharedUploader.tsx","mappings":"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","names":[],"sources":["/home/runner/workspace/client/src/components/document-management/SharedUploader.tsx"],"sourcesContent":["import React, { useState, useRef, useCallback, useEffect } from 'react';\nimport { Upload, X, File, Image, FileText, Camera, Sparkles } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { getUploadConfig, isAiAnalysisEnabled, type UploadContext } from '@shared/config/upload-config';\n\ninterface SharedUploaderProps {\n  onDocumentChange: (file: File | null, text: string | null) => void;\n  allowedFileTypes?: string[];\n  maxFileSize?: number; // in MB\n  disabled?: boolean;\n  className?: string;\n  defaultTab?: 'file' | 'text';\n  // AI Enhancement Props\n  formType?: string;\n  uploadContext?: UploadContext;\n  aiAnalysisEnabled?: boolean;\n  onAiToggle?: (enabled: boolean) => void;\n  onAiAnalysisComplete?: (data: any) => void;\n  showAiToggle?: boolean;\n  contextFields?: Record<string, any>;\n}\n\ninterface FilePreview {\n  file: File;\n  preview?: string;\n  type: 'image' | 'document';\n}\n\nconst DEFAULT_ALLOWED_TYPES = [\n  'application/pdf',\n  'application/msword',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'application/vnd.ms-excel',\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  'image/jpeg',\n  'image/jpg',\n  'image/png'\n];\n\n/**\n * SharedUploader - A reusable component for file uploads and text creation\n * Features mobile camera integration, drag-and-drop, clipboard paste, and text input\n */\nexport function SharedUploader({\n  onDocumentChange,\n  allowedFileTypes,\n  maxFileSize,\n  disabled = false,\n  className,\n  defaultTab = 'file',\n  // AI Enhancement Props\n  formType = 'documents',\n  uploadContext,\n  aiAnalysisEnabled: propAiEnabled,\n  onAiToggle,\n  onAiAnalysisComplete,\n  showAiToggle = true,\n  contextFields\n}: SharedUploaderProps) {\n  // Get configuration from upload config\n  const config = getUploadConfig(formType);\n  const finalAllowedTypes = allowedFileTypes || config.allowedFileTypes;\n  const finalMaxFileSize = maxFileSize || config.maxFileSize;\n  const finalAiEnabled = propAiEnabled ?? config.aiAnalysisEnabled;\n\n  // State management\n  const [activeTab, setActiveTab] = useState(defaultTab);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<FilePreview | null>(null);\n  const [textContent, setTextContent] = useState('');\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [aiEnabled, setAiEnabled] = useState(finalAiEnabled);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n\n  // Refs\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const uploadAreaRef = useRef<HTMLDivElement>(null);\n\n  // Handle AI toggle\n  const handleAiToggle = useCallback((enabled: boolean) => {\n    setAiEnabled(enabled);\n    onAiToggle?.(enabled);\n  }, [onAiToggle]);\n\n  // File validation function\n  const validateFile = useCallback((file: File): string | null => {\n    // Check file size\n    if (file.size > finalMaxFileSize * 1024 * 1024) {\n      return `File size exceeds ${finalMaxFileSize}MB limit`;\n    }\n\n    // Check file type\n    const isAllowed = finalAllowedTypes.some(type => {\n      if (type.includes('*')) {\n        return file.type.startsWith(type.replace('*', ''));\n      }\n      return file.type === type;\n    });\n\n    if (!isAllowed) {\n      return `File type \"${file.type}\" is not supported`;\n    }\n\n    // Check filename for security\n    if (file.name.includes('..') || file.name.includes('/') || file.name.includes('\\\\')) {\n      return 'Invalid filename detected';\n    }\n\n    return null;\n  }, [finalAllowedTypes, finalMaxFileSize]);\n\n  // AI Analysis function\n  const performAiAnalysis = useCallback(async (file: File) => {\n    if (!aiEnabled || !onAiAnalysisComplete) return;\n    \n    setIsAnalyzing(true);\n    try {\n      // Create FormData for AI analysis\n      const formData = new FormData();\n      formData.append('document', file);\n      formData.append('formType', formType);\n      \n      if (uploadContext) {\n        formData.append('uploadContext', JSON.stringify(uploadContext));\n      }\n      \n      // Make AI analysis request\n      const response = await fetch('/api/ai/analyze-document', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include'\n      });\n      \n      if (response.ok) {\n        const result = await response.json();\n        onAiAnalysisComplete(result);\n      }\n    } catch (error) {\n      console.error('AI analysis failed:', error);\n    } finally {\n      setIsAnalyzing(false);\n    }\n  }, [aiEnabled, onAiAnalysisComplete, formType, uploadContext]);\n\n  // Process and validate file\n  const processFile = useCallback((file: File): void => {\n    const error = validateFile(file);\n    if (error) {\n      setValidationError(error);\n      return;\n    }\n\n    setValidationError(null);\n    const isImage = file.type.startsWith('image/');\n    \n    const filePreview: FilePreview = {\n      file,\n      type: isImage ? 'image' : 'document'\n    };\n\n    if (isImage) {\n      filePreview.preview = URL.createObjectURL(file);\n    }\n\n    setSelectedFile(filePreview);\n    onDocumentChange(file, null);\n    \n    // Trigger AI analysis if enabled\n    if (aiEnabled) {\n      performAiAnalysis(file);\n    }\n  }, [validateFile, onDocumentChange, aiEnabled, performAiAnalysis]);\n\n  // Handle file selection from input\n  const handleFileSelect = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      processFile(file);\n    }\n    // Reset input to allow selecting the same file again\n    e.target.value = '';\n  }, [processFile]);\n\n  // Handle drag and drop\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!disabled) {\n      setIsDragOver(true);\n    }\n  }, [disabled]);\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n\n    if (disabled) return;\n\n    const files = Array.from(e.dataTransfer.files);\n    if (files.length > 0) {\n      processFile(files[0]); // Only handle first file\n    }\n  }, [disabled, processFile]);\n\n  // Handle clipboard paste for screenshots\n  const handlePaste = useCallback((e: ClipboardEvent) => {\n    if (disabled || activeTab !== 'file') return;\n\n    const items = e.clipboardData?.items;\n    if (!items) return;\n\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i];\n      if (item.type.indexOf('image') !== -1) {\n        const blob = item.getAsFile();\n        if (blob) {\n          e.preventDefault();\n          // Create proper File object for pasted images\n          const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n          const file = new File([blob], `screenshot-${timestamp}.png`, {\n            type: 'image/png'\n          });\n          processFile(file);\n          break;\n        }\n      }\n    }\n  }, [disabled, activeTab, processFile]);\n\n  // Set up paste event listener\n  useEffect(() => {\n    if (activeTab === 'file' && !disabled) {\n      document.addEventListener('paste', handlePaste);\n      return () => document.removeEventListener('paste', handlePaste);\n    }\n  }, [activeTab, disabled, handlePaste]);\n\n  // Handle text content changes\n  const handleTextChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const text = e.target.value;\n    setTextContent(text);\n    onDocumentChange(null, text || null);\n  }, [onDocumentChange]);\n\n  // Remove selected file\n  const handleRemoveFile = useCallback(() => {\n    if (selectedFile?.preview) {\n      URL.revokeObjectURL(selectedFile.preview);\n    }\n    setSelectedFile(null);\n    setValidationError(null);\n    onDocumentChange(null, null);\n  }, [selectedFile, onDocumentChange]);\n\n  // Open file dialog\n  const openFileDialog = useCallback(() => {\n    if (!disabled && fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  }, [disabled]);\n\n  // Tab change handler\n  const handleTabChange = useCallback((value: string) => {\n    setActiveTab(value as 'file' | 'text');\n    \n    // Clear current selection when switching tabs\n    if (selectedFile) {\n      handleRemoveFile();\n    }\n    if (textContent) {\n      setTextContent('');\n      onDocumentChange(null, null);\n    }\n  }, [selectedFile, textContent, handleRemoveFile, onDocumentChange]);\n\n  // Clean up preview URLs on unmount\n  useEffect(() => {\n    return () => {\n      if (selectedFile?.preview) {\n        URL.revokeObjectURL(selectedFile.preview);\n      }\n    };\n  }, [selectedFile]);\n\n  const formatFileSize = (bytes: number) => {\n    const kb = bytes / 1024;\n    if (kb < 1024) return `${kb.toFixed(1)} KB`;\n    const mb = kb / 1024;\n    return `${mb.toFixed(1)} MB`;\n  };\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      {/* AI Toggle Section */}\n      {showAiToggle && config.aiAnalysisEnabled !== undefined && (\n        <div className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg mb-4\">\n          <div className=\"flex items-center gap-2\">\n            <Sparkles className=\"w-4 h-4 text-purple-500\" />\n            <Label htmlFor=\"ai-toggle\" className=\"text-sm font-medium\">\n              AI Analysis\n            </Label>\n            {aiEnabled && (\n              <Badge variant=\"secondary\" className=\"text-xs\">\n                Enabled\n              </Badge>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              id=\"ai-toggle\"\n              checked={aiEnabled}\n              onCheckedChange={handleAiToggle}\n              disabled={disabled}\n              data-testid=\"switch-ai-analysis\"\n            />\n            {isAnalyzing && (\n              <div className=\"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400\">\n                <div className=\"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600\"></div>\n                Analyzing...\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      <Tabs value={activeTab} onValueChange={handleTabChange} className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"file\" data-testid=\"tab-upload-file\">\n            üìÅ Upload File\n          </TabsTrigger>\n          <TabsTrigger value=\"text\" data-testid=\"tab-text-document\">\n            üìù Text Document\n          </TabsTrigger>\n        </TabsList>\n\n        {/* File Upload Tab */}\n        <TabsContent value=\"file\" className=\"space-y-4\">\n          {/* Hidden file input with mobile camera integration */}\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept={finalAllowedTypes.join(',')}\n            capture=\"environment\" // Mobile camera integration for rear camera\n            onChange={handleFileSelect}\n            className=\"hidden\"\n            disabled={disabled}\n            data-testid=\"file-input-mobile\"\n          />\n\n          {/* Upload area with drag-and-drop */}\n          <div\n            ref={uploadAreaRef}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onDrop={handleDrop}\n            onClick={openFileDialog}\n            className={cn(\n              \"relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors min-h-[120px] flex flex-col justify-center items-center\",\n              isDragOver\n                ? \"border-blue-500 bg-blue-50 dark:bg-blue-950\"\n                : \"border-gray-300 hover:border-gray-400 dark:border-gray-600 dark:hover:border-gray-500\",\n              disabled && \"cursor-not-allowed opacity-50\"\n            )}\n            data-testid=\"upload-area\"\n          >\n            {selectedFile ? (\n              // File preview\n              <div className=\"w-full space-y-3\">\n                <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                  {selectedFile.type === 'image' && selectedFile.preview ? (\n                    <img\n                      src={selectedFile.preview}\n                      alt=\"Preview\"\n                      className=\"w-12 h-12 object-cover rounded\"\n                    />\n                  ) : selectedFile.type === 'image' ? (\n                    <Image className=\"w-12 h-12 text-gray-400\" />\n                  ) : (\n                    <File className=\"w-12 h-12 text-gray-400\" />\n                  )}\n                  \n                  <div className=\"flex-1 min-w-0 text-left\">\n                    <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100 truncate\">\n                      {selectedFile.file.name}\n                    </p>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      {formatFileSize(selectedFile.file.size)}\n                    </p>\n                  </div>\n\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleRemoveFile();\n                    }}\n                    className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded\"\n                    disabled={disabled}\n                    data-testid=\"remove-file-button\"\n                  >\n                    <X className=\"w-4 h-4 text-gray-500\" />\n                  </button>\n                </div>\n                <p className=\"text-xs text-green-600 dark:text-green-400\">\n                  ‚úì File ready for upload\n                </p>\n              </div>\n            ) : (\n              // Upload prompt\n              <>\n                <div className=\"flex items-center justify-center space-x-2 mb-3\">\n                  <Upload className=\"h-8 w-8 text-gray-400\" />\n                  <Camera className=\"h-6 w-6 text-blue-500\" />\n                </div>\n                <div className=\"space-y-2\">\n                  <p className=\"text-lg font-medium text-gray-900 dark:text-gray-100\">\n                    Drop files here or click to browse\n                  </p>\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    üì± On mobile: Tap to use camera or select from gallery\n                  </p>\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    üíª On desktop: Drag & drop, click to browse, or paste screenshots (Ctrl+V)\n                  </p>\n                  <p className=\"text-xs text-gray-400 dark:text-gray-500\">\n                    Maximum {finalMaxFileSize}MB ‚Ä¢ {finalAllowedTypes.map(type => {\n                      if (type.includes('image')) return 'Images';\n                      if (type.includes('pdf')) return 'PDF';\n                      if (type.includes('word')) return 'DOCX';\n                      if (type.includes('excel') || type.includes('sheet')) return 'XLSX';\n                      return type.split('/').pop()?.toUpperCase();\n                    }).filter(Boolean).join(', ')}\n                  </p>\n                  {aiEnabled && (\n                    <p className=\"text-xs text-purple-500 dark:text-purple-400 mt-1\">\n                      ‚ú® AI analysis will extract key information automatically\n                    </p>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Validation error */}\n          {validationError && (\n            <div className=\"p-3 bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg\">\n              <p className=\"text-sm text-red-600 dark:text-red-400\">‚ùå {validationError}</p>\n            </div>\n          )}\n        </TabsContent>\n\n        {/* Text Document Tab */}\n        <TabsContent value=\"text\" className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"text-content\" className=\"text-sm font-medium\">\n              Document Content\n            </Label>\n            <Textarea\n              id=\"text-content\"\n              placeholder=\"Enter your document content here...\"\n              value={textContent}\n              onChange={handleTextChange}\n              disabled={disabled}\n              rows={8}\n              className=\"resize-none\"\n              data-testid=\"textarea-document-content\"\n            />\n            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n              Create a text-only document entry. You can add formatting and additional details later.\n            </p>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}"],"version":3}
88c0c9e08ddb5006bb75a31c936ad5b7
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const db_1 = require("../../server/db");
const schema_1 = require("../../shared/schema");
const drizzle_orm_1 = require("drizzle-orm");
const bcrypt = __importStar(require("bcryptjs"));
/**
 * Sophie RÃ©sidente - Residence Assignment Integration Test
 *
 * This test specifically addresses the reported issue where Sophie RÃ©sidente
 * (or similar demo resident users) cannot see their assigned residences.
 *
 * It provides comprehensive validation of:
 * - Database setup and data integrity
 * - API endpoint simulation for residence access
 * - Authentication flow validation
 * - Error handling and debugging information
 * - Real-world scenario testing
 */
(0, globals_1.describe)('Sophie RÃ©sidente - Residence Assignment Integration', () => {
    // Test setup mimicking the real Sophie RÃ©sidente scenario
    const sophieTestData = {
        organization: {
            id: 'sophie-test-org',
            name: 'Sophie Test Organization',
            type: 'management_company',
            address: '123 Sophie Test Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1A 1A1',
            isActive: true
        },
        building: {
            id: 'sophie-test-building',
            name: 'Sophie Test Building',
            address: '123 Sophie Building Street',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1A 1A1',
            buildingType: 'condo',
            totalUnits: 3,
            totalFloors: 1,
            isActive: true
        },
        residence: {
            id: 'sophie-test-residence',
            unitNumber: '101',
            floor: 1,
            isActive: true
        },
        user: {
            id: 'sophie-residente-test-user',
            username: 'sophie.residente.test',
            email: 'sophie.residente.test@koveo-gestion.com',
            password: 'SophiePass123!',
            firstName: 'Sophie',
            lastName: 'RÃ©sidente',
            role: 'demo_resident',
            language: 'fr',
            isActive: true
        }
    };
    let testUserIds = [];
    let testOrgIds = [];
    let testBuildingIds = [];
    let testResidenceIds = [];
    (0, globals_1.beforeAll)(async () => {
        console.log('ðŸ  Setting up Sophie RÃ©sidente test scenario...');
        // Cleanup any existing test data
        await db_1.db.delete(schema_1.userResidences).where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieTestData.user.id)).catch(() => { });
        await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email)).catch(() => { });
        await db_1.db.delete(schema_1.residences).where((0, drizzle_orm_1.eq)(schema_1.residences.id, sophieTestData.residence.id)).catch(() => { });
        await db_1.db.delete(schema_1.buildings).where((0, drizzle_orm_1.eq)(schema_1.buildings.id, sophieTestData.building.id)).catch(() => { });
        await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.eq)(schema_1.organizations.id, sophieTestData.organization.id)).catch(() => { });
        // Create test organization
        await db_1.db.insert(schema_1.organizations).values({
            ...sophieTestData.organization,
            createdAt: new Date(),
            updatedAt: new Date()
        });
        testOrgIds.push(sophieTestData.organization.id);
        // Create test building
        await db_1.db.insert(schema_1.buildings).values({
            ...sophieTestData.building,
            organizationId: sophieTestData.organization.id,
            createdAt: new Date(),
            updatedAt: new Date()
        });
        testBuildingIds.push(sophieTestData.building.id);
        // Create test residence
        await db_1.db.insert(schema_1.residences).values({
            ...sophieTestData.residence,
            buildingId: sophieTestData.building.id,
            createdAt: new Date(),
            updatedAt: new Date()
        });
        testResidenceIds.push(sophieTestData.residence.id);
        // Create Sophie user
        await db_1.db.insert(schema_1.users).values({
            ...sophieTestData.user,
            password: await bcrypt.hash(sophieTestData.user.password, 12),
            createdAt: new Date(),
            updatedAt: new Date()
        });
        testUserIds.push(sophieTestData.user.id);
        console.log('âœ… Sophie RÃ©sidente test setup complete');
    });
    (0, globals_1.afterAll)(async () => {
        console.log('ðŸ§¹ Cleaning up Sophie RÃ©sidente test data...');
        // Clean up in reverse order
        await db_1.db.delete(schema_1.userResidences).where((0, drizzle_orm_1.inArray)(schema_1.userResidences.userId, testUserIds)).catch(() => { });
        await db_1.db.delete(schema_1.userOrganizations).where((0, drizzle_orm_1.inArray)(schema_1.userOrganizations.userId, testUserIds)).catch(() => { });
        await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.inArray)(schema_1.users.id, testUserIds)).catch(() => { });
        await db_1.db.delete(schema_1.residences).where((0, drizzle_orm_1.inArray)(schema_1.residences.id, testResidenceIds)).catch(() => { });
        await db_1.db.delete(schema_1.buildings).where((0, drizzle_orm_1.inArray)(schema_1.buildings.id, testBuildingIds)).catch(() => { });
        await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.inArray)(schema_1.organizations.id, testOrgIds)).catch(() => { });
        console.log('âœ… Sophie cleanup complete');
    });
    (0, globals_1.describe)('Problem Reproduction - Sophie Cannot See Residence', () => {
        (0, globals_1.it)('should reproduce the issue: Sophie has no residence assigned initially', async () => {
            // Simulate the current problem state - Sophie exists but has no residences
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            (0, globals_1.expect)(sophieUser).toHaveLength(1);
            (0, globals_1.expect)(sophieUser[0].firstName).toBe('Sophie');
            (0, globals_1.expect)(sophieUser[0].role).toBe('demo_resident');
            // Check residence assignments - should be empty (reproducing the problem)
            const residenceAssignments = await db_1.db
                .select()
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id));
            (0, globals_1.expect)(residenceAssignments).toHaveLength(0);
            console.log('ðŸš« Confirmed: Sophie has no residence assignments (reproducing the issue)');
        });
        (0, globals_1.it)('should demonstrate the problem with API endpoint simulation', async () => {
            // Simulate /api/user/residences endpoint logic
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            const userResidencesList = await db_1.db
                .select({
                residenceId: schema_1.userResidences.residenceId,
            })
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id), (0, drizzle_orm_1.eq)(schema_1.userResidences.isActive, true)));
            // This should return empty array - confirming the problem
            (0, globals_1.expect)(userResidencesList).toHaveLength(0);
            console.log('ðŸš« API simulation confirms: Sophie gets empty residence list');
        });
        (0, globals_1.it)('should demonstrate the 401 Unauthorized issue', async () => {
            // Check if Sophie's authentication data is properly set up
            const sophieUser = await db_1.db
                .select({
                id: schema_1.users.id,
                email: schema_1.users.email,
                password: schema_1.users.password,
                role: schema_1.users.role,
                isActive: schema_1.users.isActive
            })
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            (0, globals_1.expect)(sophieUser).toHaveLength(1);
            (0, globals_1.expect)(sophieUser[0].isActive).toBe(true);
            (0, globals_1.expect)(sophieUser[0].password).toBeDefined();
            // Verify password can be validated (this would pass in auth)
            const passwordValid = await bcrypt.compare('SophiePass123!', sophieUser[0].password);
            (0, globals_1.expect)(passwordValid).toBe(true);
            console.log('âœ… Sophie authentication data is valid - 401 error likely comes from elsewhere');
        });
    });
    (0, globals_1.describe)('Solution Implementation - Assign Sophie to Residence', () => {
        (0, globals_1.it)('should assign Sophie to her residence', async () => {
            // Create the residence assignment that should exist
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            const residenceAssignment = {
                userId: sophieUser[0].id,
                residenceId: sophieTestData.residence.id,
                relationshipType: 'tenant',
                startDate: '2024-01-01',
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            };
            await db_1.db.insert(schema_1.userResidences).values(residenceAssignment);
            // Verify the assignment was created
            const assignments = await db_1.db
                .select()
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id));
            (0, globals_1.expect)(assignments).toHaveLength(1);
            (0, globals_1.expect)(assignments[0].residenceId).toBe(sophieTestData.residence.id);
            (0, globals_1.expect)(assignments[0].isActive).toBe(true);
            console.log('âœ… Sophie has been assigned to residence');
        });
        (0, globals_1.it)('should validate that Sophie can now access her residence via API simulation', async () => {
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            // Simulate /api/user/residences endpoint after assignment
            const userResidencesList = await db_1.db
                .select({
                residenceId: schema_1.userResidences.residenceId,
            })
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id), (0, drizzle_orm_1.eq)(schema_1.userResidences.isActive, true)));
            (0, globals_1.expect)(userResidencesList).toHaveLength(1);
            (0, globals_1.expect)(userResidencesList[0].residenceId).toBe(sophieTestData.residence.id);
            console.log('âœ… API simulation now returns Sophie\'s residence');
        });
        (0, globals_1.it)('should validate building access through residence assignment', async () => {
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            // Simulate the building access logic from residences API
            const accessibleBuildings = await db_1.db
                .select({
                buildingId: schema_1.buildings.id,
                buildingName: schema_1.buildings.name,
                residenceId: schema_1.residences.id,
                unitNumber: schema_1.residences.unitNumber
            })
                .from(schema_1.userResidences)
                .innerJoin(schema_1.residences, (0, drizzle_orm_1.eq)(schema_1.userResidences.residenceId, schema_1.residences.id))
                .innerJoin(schema_1.buildings, (0, drizzle_orm_1.eq)(schema_1.residences.buildingId, schema_1.buildings.id))
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id), (0, drizzle_orm_1.eq)(schema_1.userResidences.isActive, true), (0, drizzle_orm_1.eq)(schema_1.buildings.isActive, true)));
            (0, globals_1.expect)(accessibleBuildings).toHaveLength(1);
            (0, globals_1.expect)(accessibleBuildings[0].buildingId).toBe(sophieTestData.building.id);
            (0, globals_1.expect)(accessibleBuildings[0].unitNumber).toBe('101');
            console.log('âœ… Sophie can access building through residence assignment');
        });
    });
    (0, globals_1.describe)('Validation Tests for Future Prevention', () => {
        (0, globals_1.it)('should validate that demo users have consistent assignment patterns', async () => {
            // Check if other demo users in the system have proper assignments
            const allDemoUsers = await db_1.db
                .select({
                id: schema_1.users.id,
                email: schema_1.users.email,
                role: schema_1.users.role
            })
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.role, 'demo_resident'));
            for (const demoUser of allDemoUsers) {
                const assignments = await db_1.db
                    .select()
                    .from(schema_1.userResidences)
                    .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, demoUser.id), (0, drizzle_orm_1.eq)(schema_1.userResidences.isActive, true)));
                console.log(`ðŸ“Š Demo user ${demoUser.email} has ${assignments.length} residence assignments`);
                // Each demo user should have at least one assignment
                // (This test might initially fail, identifying other users with the same issue)
                if (assignments.length === 0) {
                    console.warn(`âš ï¸ WARNING: Demo user ${demoUser.email} has no residence assignments`);
                }
            }
            // For our test user, should have 1 assignment now
            const sophieUser = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.email, sophieTestData.user.email));
            const sophieAssignments = await db_1.db
                .select()
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, sophieUser[0].id));
            (0, globals_1.expect)(sophieAssignments).toHaveLength(1);
        });
        (0, globals_1.it)('should validate residence assignment creation workflow', async () => {
            // Create a systematic test for assigning demo users to residences
            const testDemoUser = {
                id: 'test-demo-assignment-user',
                username: 'test.demo.assignment',
                email: 'test.demo.assignment@koveo-gestion.com',
                password: await bcrypt.hash('TestPass123!', 12),
                firstName: 'Test',
                lastName: 'DemoAssignment',
                role: 'demo_resident',
                language: 'fr',
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            };
            // Create additional test residence
            const testResidence = {
                id: 'test-residence-assignment',
                buildingId: sophieTestData.building.id,
                unitNumber: '102',
                floor: 1,
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            };
            // Insert test user and residence
            await db_1.db.insert(schema_1.users).values(testDemoUser);
            testUserIds.push(testDemoUser.id);
            await db_1.db.insert(schema_1.residences).values(testResidence);
            testResidenceIds.push(testResidence.id);
            // Create assignment
            await db_1.db.insert(schema_1.userResidences).values({
                userId: testDemoUser.id,
                residenceId: testResidence.id,
                relationshipType: 'tenant',
                startDate: '2024-01-01',
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            });
            // Validate the assignment workflow
            const assignment = await db_1.db
                .select()
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, testDemoUser.id), (0, drizzle_orm_1.eq)(schema_1.userResidences.residenceId, testResidence.id)));
            (0, globals_1.expect)(assignment).toHaveLength(1);
            (0, globals_1.expect)(assignment[0].isActive).toBe(true);
            console.log('âœ… Residence assignment workflow validated');
        });
        (0, globals_1.it)('should provide debugging information for troubleshooting', async () => {
            // Comprehensive debugging info that would help identify the issue
            const debugInfo = {
                totalUsers: await db_1.db.select({ count: schema_1.users.id }).from(schema_1.users),
                totalDemoResidents: await db_1.db
                    .select({ count: schema_1.users.id })
                    .from(schema_1.users)
                    .where((0, drizzle_orm_1.eq)(schema_1.users.role, 'demo_resident')),
                totalResidences: await db_1.db.select({ count: schema_1.residences.id }).from(schema_1.residences),
                totalActiveResidences: await db_1.db
                    .select({ count: schema_1.residences.id })
                    .from(schema_1.residences)
                    .where((0, drizzle_orm_1.eq)(schema_1.residences.isActive, true)),
                totalUserResidenceAssignments: await db_1.db.select({ count: schema_1.userResidences.id }).from(schema_1.userResidences),
                activeUserResidenceAssignments: await db_1.db
                    .select({ count: schema_1.userResidences.id })
                    .from(schema_1.userResidences)
                    .where((0, drizzle_orm_1.eq)(schema_1.userResidences.isActive, true)),
                demoUsersWithAssignments: await db_1.db
                    .select({
                    userEmail: schema_1.users.email,
                    residenceId: schema_1.userResidences.residenceId,
                    unitNumber: schema_1.residences.unitNumber
                })
                    .from(schema_1.users)
                    .leftJoin(schema_1.userResidences, (0, drizzle_orm_1.eq)(schema_1.users.id, schema_1.userResidences.userId))
                    .leftJoin(schema_1.residences, (0, drizzle_orm_1.eq)(schema_1.userResidences.residenceId, schema_1.residences.id))
                    .where((0, drizzle_orm_1.eq)(schema_1.users.role, 'demo_resident'))
            };
            console.log('ðŸ” Residence Assignment Debug Information:', {
                totalUsers: debugInfo.totalUsers.length,
                totalDemoResidents: debugInfo.totalDemoResidents.length,
                totalResidences: debugInfo.totalResidences.length,
                totalActiveResidences: debugInfo.totalActiveResidences.length,
                totalAssignments: debugInfo.totalUserResidenceAssignments.length,
                activeAssignments: debugInfo.activeUserResidenceAssignments.length,
                demoUsersWithAssignments: debugInfo.demoUsersWithAssignments.length
            });
            // Validate that our test setup is working
            (0, globals_1.expect)(debugInfo.totalUsers.length).toBeGreaterThan(0);
            (0, globals_1.expect)(debugInfo.totalResidences.length).toBeGreaterThan(0);
            (0, globals_1.expect)(debugInfo.activeUserResidenceAssignments.length).toBeGreaterThan(0);
        });
    });
    (0, globals_1.describe)('Error Handling and Edge Cases', () => {
        (0, globals_1.it)('should handle the case when user exists but no residences are available', async () => {
            // Create a user in a building with no residences
            const testEmptyBuilding = {
                id: 'test-empty-building',
                organizationId: sophieTestData.organization.id,
                name: 'Empty Test Building',
                address: '456 Empty Street',
                city: 'Montreal',
                province: 'QC',
                postalCode: 'H1B 1B1',
                buildingType: 'condo',
                totalUnits: 0,
                totalFloors: 1,
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            };
            await db_1.db.insert(schema_1.buildings).values(testEmptyBuilding);
            testBuildingIds.push(testEmptyBuilding.id);
            // API should return empty result gracefully
            const emptyResult = await db_1.db
                .select()
                .from(schema_1.residences)
                .where((0, drizzle_orm_1.eq)(schema_1.residences.buildingId, testEmptyBuilding.id));
            (0, globals_1.expect)(emptyResult).toHaveLength(0);
            console.log('âœ… Gracefully handles empty building scenario');
        });
        (0, globals_1.it)('should provide meaningful error messages for missing assignments', async () => {
            // Test that would help identify why Sophie cannot see her residence
            const orphanedUser = {
                id: 'orphaned-demo-user',
                username: 'orphaned.demo',
                email: 'orphaned.demo@koveo-gestion.com',
                password: await bcrypt.hash('TestPass123!', 12),
                firstName: 'Orphaned',
                lastName: 'Demo',
                role: 'demo_resident',
                language: 'fr',
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date()
            };
            await db_1.db.insert(schema_1.users).values(orphanedUser);
            testUserIds.push(orphanedUser.id);
            // Simulate error checking logic
            const userExists = await db_1.db
                .select()
                .from(schema_1.users)
                .where((0, drizzle_orm_1.eq)(schema_1.users.id, orphanedUser.id));
            const hasAssignments = await db_1.db
                .select()
                .from(schema_1.userResidences)
                .where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, orphanedUser.id));
            const availableResidences = await db_1.db
                .select()
                .from(schema_1.residences)
                .where((0, drizzle_orm_1.eq)(schema_1.residences.isActive, true));
            // Generate meaningful error context
            const errorContext = {
                userExists: userExists.length > 0,
                userIsActive: userExists[0]?.isActive ?? false,
                hasAssignments: hasAssignments.length > 0,
                availableResidencesInSystem: availableResidences.length,
                userRole: userExists[0]?.role
            };
            (0, globals_1.expect)(errorContext.userExists).toBe(true);
            (0, globals_1.expect)(errorContext.userIsActive).toBe(true);
            (0, globals_1.expect)(errorContext.hasAssignments).toBe(false); // This is the problem
            (0, globals_1.expect)(errorContext.availableResidencesInSystem).toBeGreaterThan(0);
            console.log('ðŸš¨ Error diagnosis for orphaned user:', errorContext);
            console.log('ðŸ’¡ Solution: User needs residence assignment in user_residences table');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9zb3BoaWUtcmVzaWRlbmNlLWFzc2lnbm1lbnQudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUEwRTtBQUMxRSx3Q0FBcUM7QUFDckMsZ0RBTzZCO0FBQzdCLDZDQUErQztBQUMvQyxpREFBbUM7QUFFbkM7Ozs7Ozs7Ozs7OztHQVlHO0FBRUgsSUFBQSxrQkFBUSxFQUFDLHFEQUFxRCxFQUFFLEdBQUcsRUFBRTtJQUNuRSwwREFBMEQ7SUFDMUQsTUFBTSxjQUFjLEdBQUc7UUFDckIsWUFBWSxFQUFFO1lBQ1osRUFBRSxFQUFFLGlCQUFpQjtZQUNyQixJQUFJLEVBQUUsMEJBQTBCO1lBQ2hDLElBQUksRUFBRSxvQkFBNkI7WUFDbkMsT0FBTyxFQUFFLHdCQUF3QjtZQUNqQyxJQUFJLEVBQUUsVUFBVTtZQUNoQixRQUFRLEVBQUUsSUFBSTtZQUNkLFVBQVUsRUFBRSxTQUFTO1lBQ3JCLFFBQVEsRUFBRSxJQUFJO1NBQ2Y7UUFDRCxRQUFRLEVBQUU7WUFDUixFQUFFLEVBQUUsc0JBQXNCO1lBQzFCLElBQUksRUFBRSxzQkFBc0I7WUFDNUIsT0FBTyxFQUFFLDRCQUE0QjtZQUNyQyxJQUFJLEVBQUUsVUFBVTtZQUNoQixRQUFRLEVBQUUsSUFBSTtZQUNkLFVBQVUsRUFBRSxTQUFTO1lBQ3JCLFlBQVksRUFBRSxPQUFnQjtZQUM5QixVQUFVLEVBQUUsQ0FBQztZQUNiLFdBQVcsRUFBRSxDQUFDO1lBQ2QsUUFBUSxFQUFFLElBQUk7U0FDZjtRQUNELFNBQVMsRUFBRTtZQUNULEVBQUUsRUFBRSx1QkFBdUI7WUFDM0IsVUFBVSxFQUFFLEtBQUs7WUFDakIsS0FBSyxFQUFFLENBQUM7WUFDUixRQUFRLEVBQUUsSUFBSTtTQUNmO1FBQ0QsSUFBSSxFQUFFO1lBQ0osRUFBRSxFQUFFLDRCQUE0QjtZQUNoQyxRQUFRLEVBQUUsdUJBQXVCO1lBQ2pDLEtBQUss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QkFBTSxFQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDN0MsSUFBQSxnQkFBTSxFQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxzQkFBc0I7WUFDdkUsSUFBQSxnQkFBTSxFQUFDLFlBQVksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVwRSxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxFQUFFLFlBQVksQ0FBQyxDQUFDO1lBQ25FLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUVBQXVFLENBQUMsQ0FBQztRQUN2RixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9zb3BoaWUtcmVzaWRlbmNlLWFzc2lnbm1lbnQudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlQWxsLCBhZnRlckFsbCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi9zZXJ2ZXIvZGInO1xuaW1wb3J0IHsgXG4gIHVzZXJzLCBcbiAgcmVzaWRlbmNlcywgXG4gIGJ1aWxkaW5ncywgXG4gIG9yZ2FuaXphdGlvbnMsIFxuICB1c2VyUmVzaWRlbmNlcywgXG4gIHVzZXJPcmdhbml6YXRpb25zIFxufSBmcm9tICcuLi8uLi9zaGFyZWQvc2NoZW1hJztcbmltcG9ydCB7IGVxLCBhbmQsIGluQXJyYXkgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgKiBhcyBiY3J5cHQgZnJvbSAnYmNyeXB0anMnO1xuXG4vKipcbiAqIFNvcGhpZSBSw6lzaWRlbnRlIC0gUmVzaWRlbmNlIEFzc2lnbm1lbnQgSW50ZWdyYXRpb24gVGVzdFxuICogXG4gKiBUaGlzIHRlc3Qgc3BlY2lmaWNhbGx5IGFkZHJlc3NlcyB0aGUgcmVwb3J0ZWQgaXNzdWUgd2hlcmUgU29waGllIFLDqXNpZGVudGUgXG4gKiAob3Igc2ltaWxhciBkZW1vIHJlc2lkZW50IHVzZXJzKSBjYW5ub3Qgc2VlIHRoZWlyIGFzc2lnbmVkIHJlc2lkZW5jZXMuXG4gKiBcbiAqIEl0IHByb3ZpZGVzIGNvbXByZWhlbnNpdmUgdmFsaWRhdGlvbiBvZjpcbiAqIC0gRGF0YWJhc2Ugc2V0dXAgYW5kIGRhdGEgaW50ZWdyaXR5XG4gKiAtIEFQSSBlbmRwb2ludCBzaW11bGF0aW9uIGZvciByZXNpZGVuY2UgYWNjZXNzXG4gKiAtIEF1dGhlbnRpY2F0aW9uIGZsb3cgdmFsaWRhdGlvblxuICogLSBFcnJvciBoYW5kbGluZyBhbmQgZGVidWdnaW5nIGluZm9ybWF0aW9uXG4gKiAtIFJlYWwtd29ybGQgc2NlbmFyaW8gdGVzdGluZ1xuICovXG5cbmRlc2NyaWJlKCdTb3BoaWUgUsOpc2lkZW50ZSAtIFJlc2lkZW5jZSBBc3NpZ25tZW50IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAvLyBUZXN0IHNldHVwIG1pbWlja2luZyB0aGUgcmVhbCBTb3BoaWUgUsOpc2lkZW50ZSBzY2VuYXJpb1xuICBjb25zdCBzb3BoaWVUZXN0RGF0YSA9IHtcbiAgICBvcmdhbml6YXRpb246IHtcbiAgICAgIGlkOiAnc29waGllLXRlc3Qtb3JnJyxcbiAgICAgIG5hbWU6ICdTb3BoaWUgVGVzdCBPcmdhbml6YXRpb24nLFxuICAgICAgdHlwZTogJ21hbmFnZW1lbnRfY29tcGFueScgYXMgY29uc3QsXG4gICAgICBhZGRyZXNzOiAnMTIzIFNvcGhpZSBUZXN0IFN0cmVldCcsXG4gICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICBwb3N0YWxDb2RlOiAnSDFBIDFBMScsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZVxuICAgIH0sXG4gICAgYnVpbGRpbmc6IHtcbiAgICAgIGlkOiAnc29waGllLXRlc3QtYnVpbGRpbmcnLFxuICAgICAgbmFtZTogJ1NvcGhpZSBUZXN0IEJ1aWxkaW5nJyxcbiAgICAgIGFkZHJlc3M6ICcxMjMgU29waGllIEJ1aWxkaW5nIFN0cmVldCcsXG4gICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICBwb3N0YWxDb2RlOiAnSDFBIDFBMScsXG4gICAgICBidWlsZGluZ1R5cGU6ICdjb25kbycgYXMgY29uc3QsXG4gICAgICB0b3RhbFVuaXRzOiAzLFxuICAgICAgdG90YWxGbG9vcnM6IDEsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZVxuICAgIH0sXG4gICAgcmVzaWRlbmNlOiB7XG4gICAgICBpZDogJ3NvcGhpZS10ZXN0LXJlc2lkZW5jZScsXG4gICAgICB1bml0TnVtYmVyOiAnMTAxJyxcbiAgICAgIGZsb29yOiAxLFxuICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICB9LFxuICAgIHVzZXI6IHtcbiAgICAgIGlkOiAnc29waGllLXJlc2lkZW50ZS10ZXN0LXVzZXInLFxuICAgICAgdXNlcm5hbWU6ICdzb3BoaWUucmVzaWRlbnRlLnRlc3QnLFxuICAgICAgZW1haWw6ICdzb3BoaWUucmVzaWRlbnRlLnRlc3RAa292ZW8tZ2VzdGlvbi5jb20nLFxuICAgICAgcGFzc3dvcmQ6ICdTb3BoaWVQYXNzMTIzIScsXG4gICAgICBmaXJzdE5hbWU6ICdTb3BoaWUnLFxuICAgICAgbGFzdE5hbWU6ICdSw6lzaWRlbnRlJyxcbiAgICAgIHJvbGU6ICdkZW1vX3Jlc2lkZW50JyBhcyBjb25zdCxcbiAgICAgIGxhbmd1YWdlOiAnZnInLFxuICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICB9XG4gIH07XG5cbiAgbGV0IHRlc3RVc2VySWRzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgdGVzdE9yZ0lkczogc3RyaW5nW10gPSBbXTtcbiAgbGV0IHRlc3RCdWlsZGluZ0lkczogc3RyaW5nW10gPSBbXTtcbiAgbGV0IHRlc3RSZXNpZGVuY2VJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygn8J+PoCBTZXR0aW5nIHVwIFNvcGhpZSBSw6lzaWRlbnRlIHRlc3Qgc2NlbmFyaW8uLi4nKTtcblxuICAgIC8vIENsZWFudXAgYW55IGV4aXN0aW5nIHRlc3QgZGF0YVxuICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2VyUmVzaWRlbmNlcykud2hlcmUoXG4gICAgICBlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHNvcGhpZVRlc3REYXRhLnVzZXIuaWQpXG4gICAgKS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICBhd2FpdCBkYi5kZWxldGUodXNlcnMpLndoZXJlKFxuICAgICAgZXEodXNlcnMuZW1haWwsIHNvcGhpZVRlc3REYXRhLnVzZXIuZW1haWwpXG4gICAgKS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICBhd2FpdCBkYi5kZWxldGUocmVzaWRlbmNlcykud2hlcmUoXG4gICAgICBlcShyZXNpZGVuY2VzLmlkLCBzb3BoaWVUZXN0RGF0YS5yZXNpZGVuY2UuaWQpXG4gICAgKS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICBhd2FpdCBkYi5kZWxldGUoYnVpbGRpbmdzKS53aGVyZShcbiAgICAgIGVxKGJ1aWxkaW5ncy5pZCwgc29waGllVGVzdERhdGEuYnVpbGRpbmcuaWQpXG4gICAgKS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICBhd2FpdCBkYi5kZWxldGUob3JnYW5pemF0aW9ucykud2hlcmUoXG4gICAgICBlcShvcmdhbml6YXRpb25zLmlkLCBzb3BoaWVUZXN0RGF0YS5vcmdhbml6YXRpb24uaWQpXG4gICAgKS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICAvLyBDcmVhdGUgdGVzdCBvcmdhbml6YXRpb25cbiAgICBhd2FpdCBkYi5pbnNlcnQob3JnYW5pemF0aW9ucykudmFsdWVzKHtcbiAgICAgIC4uLnNvcGhpZVRlc3REYXRhLm9yZ2FuaXphdGlvbixcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH0pO1xuICAgIHRlc3RPcmdJZHMucHVzaChzb3BoaWVUZXN0RGF0YS5vcmdhbml6YXRpb24uaWQpO1xuXG4gICAgLy8gQ3JlYXRlIHRlc3QgYnVpbGRpbmdcbiAgICBhd2FpdCBkYi5pbnNlcnQoYnVpbGRpbmdzKS52YWx1ZXMoe1xuICAgICAgLi4uc29waGllVGVzdERhdGEuYnVpbGRpbmcsXG4gICAgICBvcmdhbml6YXRpb25JZDogc29waGllVGVzdERhdGEub3JnYW5pemF0aW9uLmlkLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgfSk7XG4gICAgdGVzdEJ1aWxkaW5nSWRzLnB1c2goc29waGllVGVzdERhdGEuYnVpbGRpbmcuaWQpO1xuXG4gICAgLy8gQ3JlYXRlIHRlc3QgcmVzaWRlbmNlXG4gICAgYXdhaXQgZGIuaW5zZXJ0KHJlc2lkZW5jZXMpLnZhbHVlcyh7XG4gICAgICAuLi5zb3BoaWVUZXN0RGF0YS5yZXNpZGVuY2UsXG4gICAgICBidWlsZGluZ0lkOiBzb3BoaWVUZXN0RGF0YS5idWlsZGluZy5pZCxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH0pO1xuICAgIHRlc3RSZXNpZGVuY2VJZHMucHVzaChzb3BoaWVUZXN0RGF0YS5yZXNpZGVuY2UuaWQpO1xuXG4gICAgLy8gQ3JlYXRlIFNvcGhpZSB1c2VyXG4gICAgYXdhaXQgZGIuaW5zZXJ0KHVzZXJzKS52YWx1ZXMoe1xuICAgICAgLi4uc29waGllVGVzdERhdGEudXNlcixcbiAgICAgIHBhc3N3b3JkOiBhd2FpdCBiY3J5cHQuaGFzaChzb3BoaWVUZXN0RGF0YS51c2VyLnBhc3N3b3JkLCAxMiksXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICB9KTtcbiAgICB0ZXN0VXNlcklkcy5wdXNoKHNvcGhpZVRlc3REYXRhLnVzZXIuaWQpO1xuXG4gICAgY29uc29sZS5sb2coJ+KchSBTb3BoaWUgUsOpc2lkZW50ZSB0ZXN0IHNldHVwIGNvbXBsZXRlJyk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygn8J+nuSBDbGVhbmluZyB1cCBTb3BoaWUgUsOpc2lkZW50ZSB0ZXN0IGRhdGEuLi4nKTtcblxuICAgIC8vIENsZWFuIHVwIGluIHJldmVyc2Ugb3JkZXJcbiAgICBhd2FpdCBkYi5kZWxldGUodXNlclJlc2lkZW5jZXMpLndoZXJlKFxuICAgICAgaW5BcnJheSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHRlc3RVc2VySWRzKVxuICAgICkuY2F0Y2goKCkgPT4ge30pO1xuXG4gICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJPcmdhbml6YXRpb25zKS53aGVyZShcbiAgICAgIGluQXJyYXkodXNlck9yZ2FuaXphdGlvbnMudXNlcklkLCB0ZXN0VXNlcklkcylcbiAgICApLmNhdGNoKCgpID0+IHt9KTtcblxuICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2Vycykud2hlcmUoXG4gICAgICBpbkFycmF5KHVzZXJzLmlkLCB0ZXN0VXNlcklkcylcbiAgICApLmNhdGNoKCgpID0+IHt9KTtcblxuICAgIGF3YWl0IGRiLmRlbGV0ZShyZXNpZGVuY2VzKS53aGVyZShcbiAgICAgIGluQXJyYXkocmVzaWRlbmNlcy5pZCwgdGVzdFJlc2lkZW5jZUlkcylcbiAgICApLmNhdGNoKCgpID0+IHt9KTtcblxuICAgIGF3YWl0IGRiLmRlbGV0ZShidWlsZGluZ3MpLndoZXJlKFxuICAgICAgaW5BcnJheShidWlsZGluZ3MuaWQsIHRlc3RCdWlsZGluZ0lkcylcbiAgICApLmNhdGNoKCgpID0+IHt9KTtcblxuICAgIGF3YWl0IGRiLmRlbGV0ZShvcmdhbml6YXRpb25zKS53aGVyZShcbiAgICAgIGluQXJyYXkob3JnYW5pemF0aW9ucy5pZCwgdGVzdE9yZ0lkcylcbiAgICApLmNhdGNoKCgpID0+IHt9KTtcblxuICAgIGNvbnNvbGUubG9nKCfinIUgU29waGllIGNsZWFudXAgY29tcGxldGUnKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Byb2JsZW0gUmVwcm9kdWN0aW9uIC0gU29waGllIENhbm5vdCBTZWUgUmVzaWRlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVwcm9kdWNlIHRoZSBpc3N1ZTogU29waGllIGhhcyBubyByZXNpZGVuY2UgYXNzaWduZWQgaW5pdGlhbGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2ltdWxhdGUgdGhlIGN1cnJlbnQgcHJvYmxlbSBzdGF0ZSAtIFNvcGhpZSBleGlzdHMgYnV0IGhhcyBubyByZXNpZGVuY2VzXG4gICAgICBjb25zdCBzb3BoaWVVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHNvcGhpZVRlc3REYXRhLnVzZXIuZW1haWwpKTtcblxuICAgICAgZXhwZWN0KHNvcGhpZVVzZXIpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChzb3BoaWVVc2VyWzBdLmZpcnN0TmFtZSkudG9CZSgnU29waGllJyk7XG4gICAgICBleHBlY3Qoc29waGllVXNlclswXS5yb2xlKS50b0JlKCdkZW1vX3Jlc2lkZW50Jyk7XG5cbiAgICAgIC8vIENoZWNrIHJlc2lkZW5jZSBhc3NpZ25tZW50cyAtIHNob3VsZCBiZSBlbXB0eSAocmVwcm9kdWNpbmcgdGhlIHByb2JsZW0pXG4gICAgICBjb25zdCByZXNpZGVuY2VBc3NpZ25tZW50cyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJSZXNpZGVuY2VzLnVzZXJJZCwgc29waGllVXNlclswXS5pZCkpO1xuXG4gICAgICBleHBlY3QocmVzaWRlbmNlQXNzaWdubWVudHMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qrIENvbmZpcm1lZDogU29waGllIGhhcyBubyByZXNpZGVuY2UgYXNzaWdubWVudHMgKHJlcHJvZHVjaW5nIHRoZSBpc3N1ZSknKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVtb25zdHJhdGUgdGhlIHByb2JsZW0gd2l0aCBBUEkgZW5kcG9pbnQgc2ltdWxhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNpbXVsYXRlIC9hcGkvdXNlci9yZXNpZGVuY2VzIGVuZHBvaW50IGxvZ2ljXG4gICAgICBjb25zdCBzb3BoaWVVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHNvcGhpZVRlc3REYXRhLnVzZXIuZW1haWwpKTtcblxuICAgICAgY29uc3QgdXNlclJlc2lkZW5jZXNMaXN0ID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7XG4gICAgICAgICAgcmVzaWRlbmNlSWQ6IHVzZXJSZXNpZGVuY2VzLnJlc2lkZW5jZUlkLFxuICAgICAgICB9KVxuICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgLndoZXJlKFxuICAgICAgICAgIGFuZChcbiAgICAgICAgICAgIGVxKHVzZXJSZXNpZGVuY2VzLnVzZXJJZCwgc29waGllVXNlclswXS5pZCksXG4gICAgICAgICAgICBlcSh1c2VyUmVzaWRlbmNlcy5pc0FjdGl2ZSwgdHJ1ZSlcbiAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgIC8vIFRoaXMgc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSAtIGNvbmZpcm1pbmcgdGhlIHByb2JsZW1cbiAgICAgIGV4cGVjdCh1c2VyUmVzaWRlbmNlc0xpc3QpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qrIEFQSSBzaW11bGF0aW9uIGNvbmZpcm1zOiBTb3BoaWUgZ2V0cyBlbXB0eSByZXNpZGVuY2UgbGlzdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZW1vbnN0cmF0ZSB0aGUgNDAxIFVuYXV0aG9yaXplZCBpc3N1ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIFNvcGhpZSdzIGF1dGhlbnRpY2F0aW9uIGRhdGEgaXMgcHJvcGVybHkgc2V0IHVwXG4gICAgICBjb25zdCBzb3BoaWVVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7XG4gICAgICAgICAgaWQ6IHVzZXJzLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2Vycy5lbWFpbCxcbiAgICAgICAgICBwYXNzd29yZDogdXNlcnMucGFzc3dvcmQsXG4gICAgICAgICAgcm9sZTogdXNlcnMucm9sZSxcbiAgICAgICAgICBpc0FjdGl2ZTogdXNlcnMuaXNBY3RpdmVcbiAgICAgICAgfSlcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy5lbWFpbCwgc29waGllVGVzdERhdGEudXNlci5lbWFpbCkpO1xuXG4gICAgICBleHBlY3Qoc29waGllVXNlcikudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHNvcGhpZVVzZXJbMF0uaXNBY3RpdmUpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3Qoc29waGllVXNlclswXS5wYXNzd29yZCkudG9CZURlZmluZWQoKTtcblxuICAgICAgLy8gVmVyaWZ5IHBhc3N3b3JkIGNhbiBiZSB2YWxpZGF0ZWQgKHRoaXMgd291bGQgcGFzcyBpbiBhdXRoKVxuICAgICAgY29uc3QgcGFzc3dvcmRWYWxpZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKCdTb3BoaWVQYXNzMTIzIScsIHNvcGhpZVVzZXJbMF0ucGFzc3dvcmQpO1xuICAgICAgZXhwZWN0KHBhc3N3b3JkVmFsaWQpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU29waGllIGF1dGhlbnRpY2F0aW9uIGRhdGEgaXMgdmFsaWQgLSA0MDEgZXJyb3IgbGlrZWx5IGNvbWVzIGZyb20gZWxzZXdoZXJlJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTb2x1dGlvbiBJbXBsZW1lbnRhdGlvbiAtIEFzc2lnbiBTb3BoaWUgdG8gUmVzaWRlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYXNzaWduIFNvcGhpZSB0byBoZXIgcmVzaWRlbmNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIHRoZSByZXNpZGVuY2UgYXNzaWdubWVudCB0aGF0IHNob3VsZCBleGlzdFxuICAgICAgY29uc3Qgc29waGllVXNlciA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJzLmVtYWlsLCBzb3BoaWVUZXN0RGF0YS51c2VyLmVtYWlsKSk7XG5cbiAgICAgIGNvbnN0IHJlc2lkZW5jZUFzc2lnbm1lbnQgPSB7XG4gICAgICAgIHVzZXJJZDogc29waGllVXNlclswXS5pZCxcbiAgICAgICAgcmVzaWRlbmNlSWQ6IHNvcGhpZVRlc3REYXRhLnJlc2lkZW5jZS5pZCxcbiAgICAgICAgcmVsYXRpb25zaGlwVHlwZTogJ3RlbmFudCcsXG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjQtMDEtMDEnLFxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGRiLmluc2VydCh1c2VyUmVzaWRlbmNlcykudmFsdWVzKHJlc2lkZW5jZUFzc2lnbm1lbnQpO1xuXG4gICAgICAvLyBWZXJpZnkgdGhlIGFzc2lnbm1lbnQgd2FzIGNyZWF0ZWRcbiAgICAgIGNvbnN0IGFzc2lnbm1lbnRzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJSZXNpZGVuY2VzKVxuICAgICAgICAud2hlcmUoZXEodXNlclJlc2lkZW5jZXMudXNlcklkLCBzb3BoaWVVc2VyWzBdLmlkKSk7XG5cbiAgICAgIGV4cGVjdChhc3NpZ25tZW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGFzc2lnbm1lbnRzWzBdLnJlc2lkZW5jZUlkKS50b0JlKHNvcGhpZVRlc3REYXRhLnJlc2lkZW5jZS5pZCk7XG4gICAgICBleHBlY3QoYXNzaWdubWVudHNbMF0uaXNBY3RpdmUpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU29waGllIGhhcyBiZWVuIGFzc2lnbmVkIHRvIHJlc2lkZW5jZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0aGF0IFNvcGhpZSBjYW4gbm93IGFjY2VzcyBoZXIgcmVzaWRlbmNlIHZpYSBBUEkgc2ltdWxhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNvcGhpZVVzZXIgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy5lbWFpbCwgc29waGllVGVzdERhdGEudXNlci5lbWFpbCkpO1xuXG4gICAgICAvLyBTaW11bGF0ZSAvYXBpL3VzZXIvcmVzaWRlbmNlcyBlbmRwb2ludCBhZnRlciBhc3NpZ25tZW50XG4gICAgICBjb25zdCB1c2VyUmVzaWRlbmNlc0xpc3QgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHtcbiAgICAgICAgICByZXNpZGVuY2VJZDogdXNlclJlc2lkZW5jZXMucmVzaWRlbmNlSWQsXG4gICAgICAgIH0pXG4gICAgICAgIC5mcm9tKHVzZXJSZXNpZGVuY2VzKVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgZXEodXNlclJlc2lkZW5jZXMudXNlcklkLCBzb3BoaWVVc2VyWzBdLmlkKSxcbiAgICAgICAgICAgIGVxKHVzZXJSZXNpZGVuY2VzLmlzQWN0aXZlLCB0cnVlKVxuICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJSZXNpZGVuY2VzTGlzdCkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHVzZXJSZXNpZGVuY2VzTGlzdFswXS5yZXNpZGVuY2VJZCkudG9CZShzb3BoaWVUZXN0RGF0YS5yZXNpZGVuY2UuaWQpO1xuXG4gICAgICBjb25zb2xlLmxvZygn4pyFIEFQSSBzaW11bGF0aW9uIG5vdyByZXR1cm5zIFNvcGhpZVxcJ3MgcmVzaWRlbmNlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGJ1aWxkaW5nIGFjY2VzcyB0aHJvdWdoIHJlc2lkZW5jZSBhc3NpZ25tZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc29waGllVXNlciA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJzLmVtYWlsLCBzb3BoaWVUZXN0RGF0YS51c2VyLmVtYWlsKSk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHRoZSBidWlsZGluZyBhY2Nlc3MgbG9naWMgZnJvbSByZXNpZGVuY2VzIEFQSVxuICAgICAgY29uc3QgYWNjZXNzaWJsZUJ1aWxkaW5ncyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3Qoe1xuICAgICAgICAgIGJ1aWxkaW5nSWQ6IGJ1aWxkaW5ncy5pZCxcbiAgICAgICAgICBidWlsZGluZ05hbWU6IGJ1aWxkaW5ncy5uYW1lLFxuICAgICAgICAgIHJlc2lkZW5jZUlkOiByZXNpZGVuY2VzLmlkLFxuICAgICAgICAgIHVuaXROdW1iZXI6IHJlc2lkZW5jZXMudW5pdE51bWJlclxuICAgICAgICB9KVxuICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgLmlubmVySm9pbihyZXNpZGVuY2VzLCBlcSh1c2VyUmVzaWRlbmNlcy5yZXNpZGVuY2VJZCwgcmVzaWRlbmNlcy5pZCkpXG4gICAgICAgIC5pbm5lckpvaW4oYnVpbGRpbmdzLCBlcShyZXNpZGVuY2VzLmJ1aWxkaW5nSWQsIGJ1aWxkaW5ncy5pZCkpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHNvcGhpZVVzZXJbMF0uaWQpLFxuICAgICAgICAgICAgZXEodXNlclJlc2lkZW5jZXMuaXNBY3RpdmUsIHRydWUpLFxuICAgICAgICAgICAgZXEoYnVpbGRpbmdzLmlzQWN0aXZlLCB0cnVlKVxuICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgZXhwZWN0KGFjY2Vzc2libGVCdWlsZGluZ3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChhY2Nlc3NpYmxlQnVpbGRpbmdzWzBdLmJ1aWxkaW5nSWQpLnRvQmUoc29waGllVGVzdERhdGEuYnVpbGRpbmcuaWQpO1xuICAgICAgZXhwZWN0KGFjY2Vzc2libGVCdWlsZGluZ3NbMF0udW5pdE51bWJlcikudG9CZSgnMTAxJyk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU29waGllIGNhbiBhY2Nlc3MgYnVpbGRpbmcgdGhyb3VnaCByZXNpZGVuY2UgYXNzaWdubWVudCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVmFsaWRhdGlvbiBUZXN0cyBmb3IgRnV0dXJlIFByZXZlbnRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0aGF0IGRlbW8gdXNlcnMgaGF2ZSBjb25zaXN0ZW50IGFzc2lnbm1lbnQgcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDaGVjayBpZiBvdGhlciBkZW1vIHVzZXJzIGluIHRoZSBzeXN0ZW0gaGF2ZSBwcm9wZXIgYXNzaWdubWVudHNcbiAgICAgIGNvbnN0IGFsbERlbW9Vc2VycyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3Qoe1xuICAgICAgICAgIGlkOiB1c2Vycy5pZCxcbiAgICAgICAgICBlbWFpbDogdXNlcnMuZW1haWwsXG4gICAgICAgICAgcm9sZTogdXNlcnMucm9sZVxuICAgICAgICB9KVxuICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgLndoZXJlKGVxKHVzZXJzLnJvbGUsICdkZW1vX3Jlc2lkZW50JykpO1xuXG4gICAgICBmb3IgKGNvbnN0IGRlbW9Vc2VyIG9mIGFsbERlbW9Vc2Vycykge1xuICAgICAgICBjb25zdCBhc3NpZ25tZW50cyA9IGF3YWl0IGRiXG4gICAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgICAgLmZyb20odXNlclJlc2lkZW5jZXMpXG4gICAgICAgICAgLndoZXJlKFxuICAgICAgICAgICAgYW5kKFxuICAgICAgICAgICAgICBlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIGRlbW9Vc2VyLmlkKSxcbiAgICAgICAgICAgICAgZXEodXNlclJlc2lkZW5jZXMuaXNBY3RpdmUsIHRydWUpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhg8J+TiiBEZW1vIHVzZXIgJHtkZW1vVXNlci5lbWFpbH0gaGFzICR7YXNzaWdubWVudHMubGVuZ3RofSByZXNpZGVuY2UgYXNzaWdubWVudHNgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEVhY2ggZGVtbyB1c2VyIHNob3VsZCBoYXZlIGF0IGxlYXN0IG9uZSBhc3NpZ25tZW50XG4gICAgICAgIC8vIChUaGlzIHRlc3QgbWlnaHQgaW5pdGlhbGx5IGZhaWwsIGlkZW50aWZ5aW5nIG90aGVyIHVzZXJzIHdpdGggdGhlIHNhbWUgaXNzdWUpXG4gICAgICAgIGlmIChhc3NpZ25tZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBXQVJOSU5HOiBEZW1vIHVzZXIgJHtkZW1vVXNlci5lbWFpbH0gaGFzIG5vIHJlc2lkZW5jZSBhc3NpZ25tZW50c2ApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEZvciBvdXIgdGVzdCB1c2VyLCBzaG91bGQgaGF2ZSAxIGFzc2lnbm1lbnQgbm93XG4gICAgICBjb25zdCBzb3BoaWVVc2VyID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgICAud2hlcmUoZXEodXNlcnMuZW1haWwsIHNvcGhpZVRlc3REYXRhLnVzZXIuZW1haWwpKTtcblxuICAgICAgY29uc3Qgc29waGllQXNzaWdubWVudHMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlclJlc2lkZW5jZXMpXG4gICAgICAgIC53aGVyZShlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHNvcGhpZVVzZXJbMF0uaWQpKTtcblxuICAgICAgZXhwZWN0KHNvcGhpZUFzc2lnbm1lbnRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlc2lkZW5jZSBhc3NpZ25tZW50IGNyZWF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGEgc3lzdGVtYXRpYyB0ZXN0IGZvciBhc3NpZ25pbmcgZGVtbyB1c2VycyB0byByZXNpZGVuY2VzXG4gICAgICBjb25zdCB0ZXN0RGVtb1VzZXIgPSB7XG4gICAgICAgIGlkOiAndGVzdC1kZW1vLWFzc2lnbm1lbnQtdXNlcicsXG4gICAgICAgIHVzZXJuYW1lOiAndGVzdC5kZW1vLmFzc2lnbm1lbnQnLFxuICAgICAgICBlbWFpbDogJ3Rlc3QuZGVtby5hc3NpZ25tZW50QGtvdmVvLWdlc3Rpb24uY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6IGF3YWl0IGJjcnlwdC5oYXNoKCdUZXN0UGFzczEyMyEnLCAxMiksXG4gICAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgICBsYXN0TmFtZTogJ0RlbW9Bc3NpZ25tZW50JyxcbiAgICAgICAgcm9sZTogJ2RlbW9fcmVzaWRlbnQnIGFzIGNvbnN0LFxuICAgICAgICBsYW5ndWFnZTogJ2ZyJyxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICAvLyBDcmVhdGUgYWRkaXRpb25hbCB0ZXN0IHJlc2lkZW5jZVxuICAgICAgY29uc3QgdGVzdFJlc2lkZW5jZSA9IHtcbiAgICAgICAgaWQ6ICd0ZXN0LXJlc2lkZW5jZS1hc3NpZ25tZW50JyxcbiAgICAgICAgYnVpbGRpbmdJZDogc29waGllVGVzdERhdGEuYnVpbGRpbmcuaWQsXG4gICAgICAgIHVuaXROdW1iZXI6ICcxMDInLFxuICAgICAgICBmbG9vcjogMSxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICAvLyBJbnNlcnQgdGVzdCB1c2VyIGFuZCByZXNpZGVuY2VcbiAgICAgIGF3YWl0IGRiLmluc2VydCh1c2VycykudmFsdWVzKHRlc3REZW1vVXNlcik7XG4gICAgICB0ZXN0VXNlcklkcy5wdXNoKHRlc3REZW1vVXNlci5pZCk7XG5cbiAgICAgIGF3YWl0IGRiLmluc2VydChyZXNpZGVuY2VzKS52YWx1ZXModGVzdFJlc2lkZW5jZSk7XG4gICAgICB0ZXN0UmVzaWRlbmNlSWRzLnB1c2godGVzdFJlc2lkZW5jZS5pZCk7XG5cbiAgICAgIC8vIENyZWF0ZSBhc3NpZ25tZW50XG4gICAgICBhd2FpdCBkYi5pbnNlcnQodXNlclJlc2lkZW5jZXMpLnZhbHVlcyh7XG4gICAgICAgIHVzZXJJZDogdGVzdERlbW9Vc2VyLmlkLFxuICAgICAgICByZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZCxcbiAgICAgICAgcmVsYXRpb25zaGlwVHlwZTogJ3RlbmFudCcsXG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjQtMDEtMDEnLFxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWYWxpZGF0ZSB0aGUgYXNzaWdubWVudCB3b3JrZmxvd1xuICAgICAgY29uc3QgYXNzaWdubWVudCA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgLndoZXJlKFxuICAgICAgICAgIGFuZChcbiAgICAgICAgICAgIGVxKHVzZXJSZXNpZGVuY2VzLnVzZXJJZCwgdGVzdERlbW9Vc2VyLmlkKSxcbiAgICAgICAgICAgIGVxKHVzZXJSZXNpZGVuY2VzLnJlc2lkZW5jZUlkLCB0ZXN0UmVzaWRlbmNlLmlkKVxuICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgZXhwZWN0KGFzc2lnbm1lbnQpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChhc3NpZ25tZW50WzBdLmlzQWN0aXZlKS50b0JlKHRydWUpO1xuXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFJlc2lkZW5jZSBhc3NpZ25tZW50IHdvcmtmbG93IHZhbGlkYXRlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIGRlYnVnZ2luZyBpbmZvcm1hdGlvbiBmb3IgdHJvdWJsZXNob290aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ29tcHJlaGVuc2l2ZSBkZWJ1Z2dpbmcgaW5mbyB0aGF0IHdvdWxkIGhlbHAgaWRlbnRpZnkgdGhlIGlzc3VlXG4gICAgICBjb25zdCBkZWJ1Z0luZm8gPSB7XG4gICAgICAgIHRvdGFsVXNlcnM6IGF3YWl0IGRiLnNlbGVjdCh7IGNvdW50OiB1c2Vycy5pZCB9KS5mcm9tKHVzZXJzKSxcbiAgICAgICAgdG90YWxEZW1vUmVzaWRlbnRzOiBhd2FpdCBkYlxuICAgICAgICAgIC5zZWxlY3QoeyBjb3VudDogdXNlcnMuaWQgfSlcbiAgICAgICAgICAuZnJvbSh1c2VycylcbiAgICAgICAgICAud2hlcmUoZXEodXNlcnMucm9sZSwgJ2RlbW9fcmVzaWRlbnQnKSksXG4gICAgICAgIHRvdGFsUmVzaWRlbmNlczogYXdhaXQgZGIuc2VsZWN0KHsgY291bnQ6IHJlc2lkZW5jZXMuaWQgfSkuZnJvbShyZXNpZGVuY2VzKSxcbiAgICAgICAgdG90YWxBY3RpdmVSZXNpZGVuY2VzOiBhd2FpdCBkYlxuICAgICAgICAgIC5zZWxlY3QoeyBjb3VudDogcmVzaWRlbmNlcy5pZCB9KVxuICAgICAgICAgIC5mcm9tKHJlc2lkZW5jZXMpXG4gICAgICAgICAgLndoZXJlKGVxKHJlc2lkZW5jZXMuaXNBY3RpdmUsIHRydWUpKSxcbiAgICAgICAgdG90YWxVc2VyUmVzaWRlbmNlQXNzaWdubWVudHM6IGF3YWl0IGRiLnNlbGVjdCh7IGNvdW50OiB1c2VyUmVzaWRlbmNlcy5pZCB9KS5mcm9tKHVzZXJSZXNpZGVuY2VzKSxcbiAgICAgICAgYWN0aXZlVXNlclJlc2lkZW5jZUFzc2lnbm1lbnRzOiBhd2FpdCBkYlxuICAgICAgICAgIC5zZWxlY3QoeyBjb3VudDogdXNlclJlc2lkZW5jZXMuaWQgfSlcbiAgICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgICAud2hlcmUoZXEodXNlclJlc2lkZW5jZXMuaXNBY3RpdmUsIHRydWUpKSxcbiAgICAgICAgZGVtb1VzZXJzV2l0aEFzc2lnbm1lbnRzOiBhd2FpdCBkYlxuICAgICAgICAgIC5zZWxlY3Qoe1xuICAgICAgICAgICAgdXNlckVtYWlsOiB1c2Vycy5lbWFpbCxcbiAgICAgICAgICAgIHJlc2lkZW5jZUlkOiB1c2VyUmVzaWRlbmNlcy5yZXNpZGVuY2VJZCxcbiAgICAgICAgICAgIHVuaXROdW1iZXI6IHJlc2lkZW5jZXMudW5pdE51bWJlclxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgICAgLmxlZnRKb2luKHVzZXJSZXNpZGVuY2VzLCBlcSh1c2Vycy5pZCwgdXNlclJlc2lkZW5jZXMudXNlcklkKSlcbiAgICAgICAgICAubGVmdEpvaW4ocmVzaWRlbmNlcywgZXEodXNlclJlc2lkZW5jZXMucmVzaWRlbmNlSWQsIHJlc2lkZW5jZXMuaWQpKVxuICAgICAgICAgIC53aGVyZShlcSh1c2Vycy5yb2xlLCAnZGVtb19yZXNpZGVudCcpKVxuICAgICAgfTtcblxuICAgICAgY29uc29sZS5sb2coJ/CflI0gUmVzaWRlbmNlIEFzc2lnbm1lbnQgRGVidWcgSW5mb3JtYXRpb246Jywge1xuICAgICAgICB0b3RhbFVzZXJzOiBkZWJ1Z0luZm8udG90YWxVc2Vycy5sZW5ndGgsXG4gICAgICAgIHRvdGFsRGVtb1Jlc2lkZW50czogZGVidWdJbmZvLnRvdGFsRGVtb1Jlc2lkZW50cy5sZW5ndGgsXG4gICAgICAgIHRvdGFsUmVzaWRlbmNlczogZGVidWdJbmZvLnRvdGFsUmVzaWRlbmNlcy5sZW5ndGgsXG4gICAgICAgIHRvdGFsQWN0aXZlUmVzaWRlbmNlczogZGVidWdJbmZvLnRvdGFsQWN0aXZlUmVzaWRlbmNlcy5sZW5ndGgsXG4gICAgICAgIHRvdGFsQXNzaWdubWVudHM6IGRlYnVnSW5mby50b3RhbFVzZXJSZXNpZGVuY2VBc3NpZ25tZW50cy5sZW5ndGgsXG4gICAgICAgIGFjdGl2ZUFzc2lnbm1lbnRzOiBkZWJ1Z0luZm8uYWN0aXZlVXNlclJlc2lkZW5jZUFzc2lnbm1lbnRzLmxlbmd0aCxcbiAgICAgICAgZGVtb1VzZXJzV2l0aEFzc2lnbm1lbnRzOiBkZWJ1Z0luZm8uZGVtb1VzZXJzV2l0aEFzc2lnbm1lbnRzLmxlbmd0aFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHRoYXQgb3VyIHRlc3Qgc2V0dXAgaXMgd29ya2luZ1xuICAgICAgZXhwZWN0KGRlYnVnSW5mby50b3RhbFVzZXJzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KGRlYnVnSW5mby50b3RhbFJlc2lkZW5jZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QoZGVidWdJbmZvLmFjdGl2ZVVzZXJSZXNpZGVuY2VBc3NpZ25tZW50cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nIGFuZCBFZGdlIENhc2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHRoZSBjYXNlIHdoZW4gdXNlciBleGlzdHMgYnV0IG5vIHJlc2lkZW5jZXMgYXJlIGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhIHVzZXIgaW4gYSBidWlsZGluZyB3aXRoIG5vIHJlc2lkZW5jZXNcbiAgICAgIGNvbnN0IHRlc3RFbXB0eUJ1aWxkaW5nID0ge1xuICAgICAgICBpZDogJ3Rlc3QtZW1wdHktYnVpbGRpbmcnLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogc29waGllVGVzdERhdGEub3JnYW5pemF0aW9uLmlkLFxuICAgICAgICBuYW1lOiAnRW1wdHkgVGVzdCBCdWlsZGluZycsXG4gICAgICAgIGFkZHJlc3M6ICc0NTYgRW1wdHkgU3RyZWV0JyxcbiAgICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICAgIHBvc3RhbENvZGU6ICdIMUIgMUIxJyxcbiAgICAgICAgYnVpbGRpbmdUeXBlOiAnY29uZG8nIGFzIGNvbnN0LFxuICAgICAgICB0b3RhbFVuaXRzOiAwLFxuICAgICAgICB0b3RhbEZsb29yczogMSxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBkYi5pbnNlcnQoYnVpbGRpbmdzKS52YWx1ZXModGVzdEVtcHR5QnVpbGRpbmcpO1xuICAgICAgdGVzdEJ1aWxkaW5nSWRzLnB1c2godGVzdEVtcHR5QnVpbGRpbmcuaWQpO1xuXG4gICAgICAvLyBBUEkgc2hvdWxkIHJldHVybiBlbXB0eSByZXN1bHQgZ3JhY2VmdWxseVxuICAgICAgY29uc3QgZW1wdHlSZXN1bHQgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocmVzaWRlbmNlcylcbiAgICAgICAgLndoZXJlKGVxKHJlc2lkZW5jZXMuYnVpbGRpbmdJZCwgdGVzdEVtcHR5QnVpbGRpbmcuaWQpKTtcblxuICAgICAgZXhwZWN0KGVtcHR5UmVzdWx0KS50b0hhdmVMZW5ndGgoMCk7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIEdyYWNlZnVsbHkgaGFuZGxlcyBlbXB0eSBidWlsZGluZyBzY2VuYXJpbycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIG1lYW5pbmdmdWwgZXJyb3IgbWVzc2FnZXMgZm9yIG1pc3NpbmcgYXNzaWdubWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd291bGQgaGVscCBpZGVudGlmeSB3aHkgU29waGllIGNhbm5vdCBzZWUgaGVyIHJlc2lkZW5jZVxuICAgICAgY29uc3Qgb3JwaGFuZWRVc2VyID0ge1xuICAgICAgICBpZDogJ29ycGhhbmVkLWRlbW8tdXNlcicsXG4gICAgICAgIHVzZXJuYW1lOiAnb3JwaGFuZWQuZGVtbycsXG4gICAgICAgIGVtYWlsOiAnb3JwaGFuZWQuZGVtb0Brb3Zlby1nZXN0aW9uLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiBhd2FpdCBiY3J5cHQuaGFzaCgnVGVzdFBhc3MxMjMhJywgMTIpLFxuICAgICAgICBmaXJzdE5hbWU6ICdPcnBoYW5lZCcsXG4gICAgICAgIGxhc3ROYW1lOiAnRGVtbycsXG4gICAgICAgIHJvbGU6ICdkZW1vX3Jlc2lkZW50JyBhcyBjb25zdCxcbiAgICAgICAgbGFuZ3VhZ2U6ICdmcicsXG4gICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgYXdhaXQgZGIuaW5zZXJ0KHVzZXJzKS52YWx1ZXMob3JwaGFuZWRVc2VyKTtcbiAgICAgIHRlc3RVc2VySWRzLnB1c2gob3JwaGFuZWRVc2VyLmlkKTtcblxuICAgICAgLy8gU2ltdWxhdGUgZXJyb3IgY2hlY2tpbmcgbG9naWNcbiAgICAgIGNvbnN0IHVzZXJFeGlzdHMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy5pZCwgb3JwaGFuZWRVc2VyLmlkKSk7XG5cbiAgICAgIGNvbnN0IGhhc0Fzc2lnbm1lbnRzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJSZXNpZGVuY2VzKVxuICAgICAgICAud2hlcmUoZXEodXNlclJlc2lkZW5jZXMudXNlcklkLCBvcnBoYW5lZFVzZXIuaWQpKTtcblxuICAgICAgY29uc3QgYXZhaWxhYmxlUmVzaWRlbmNlcyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShyZXNpZGVuY2VzKVxuICAgICAgICAud2hlcmUoZXEocmVzaWRlbmNlcy5pc0FjdGl2ZSwgdHJ1ZSkpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBtZWFuaW5nZnVsIGVycm9yIGNvbnRleHRcbiAgICAgIGNvbnN0IGVycm9yQ29udGV4dCA9IHtcbiAgICAgICAgdXNlckV4aXN0czogdXNlckV4aXN0cy5sZW5ndGggPiAwLFxuICAgICAgICB1c2VySXNBY3RpdmU6IHVzZXJFeGlzdHNbMF0/LmlzQWN0aXZlID8/IGZhbHNlLFxuICAgICAgICBoYXNBc3NpZ25tZW50czogaGFzQXNzaWdubWVudHMubGVuZ3RoID4gMCxcbiAgICAgICAgYXZhaWxhYmxlUmVzaWRlbmNlc0luU3lzdGVtOiBhdmFpbGFibGVSZXNpZGVuY2VzLmxlbmd0aCxcbiAgICAgICAgdXNlclJvbGU6IHVzZXJFeGlzdHNbMF0/LnJvbGVcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChlcnJvckNvbnRleHQudXNlckV4aXN0cykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChlcnJvckNvbnRleHQudXNlcklzQWN0aXZlKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGVycm9yQ29udGV4dC5oYXNBc3NpZ25tZW50cykudG9CZShmYWxzZSk7IC8vIFRoaXMgaXMgdGhlIHByb2JsZW1cbiAgICAgIGV4cGVjdChlcnJvckNvbnRleHQuYXZhaWxhYmxlUmVzaWRlbmNlc0luU3lzdGVtKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn5qoIEVycm9yIGRpYWdub3NpcyBmb3Igb3JwaGFuZWQgdXNlcjonLCBlcnJvckNvbnRleHQpO1xuICAgICAgY29uc29sZS5sb2coJ/CfkqEgU29sdXRpb246IFVzZXIgbmVlZHMgcmVzaWRlbmNlIGFzc2lnbm1lbnQgaW4gdXNlcl9yZXNpZGVuY2VzIHRhYmxlJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
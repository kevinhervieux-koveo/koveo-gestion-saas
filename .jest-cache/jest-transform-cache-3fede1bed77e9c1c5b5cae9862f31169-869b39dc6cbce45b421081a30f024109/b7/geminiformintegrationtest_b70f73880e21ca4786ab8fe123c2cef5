c10a30b040c00e1c1f04f5d27347ea50
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const globals_1 = require("@jest/globals");
// Mock the hooks and utils
globals_1.jest.mock('@/hooks/use-language', () => ({
    useLanguage: () => ({
        t: (key) => key,
    }),
}));
globals_1.jest.mock('@/hooks/use-toast', () => ({
    useToast: () => ({
        toast: globals_1.jest.fn(),
    }),
}));
/**
 * @file Gemini Integration Form Fill Test Suite
 * @description Comprehensive tests for AI-powered form filling functionality
 * Tests the integration between Gemini AI bill analysis and form auto-population
 * Designed to identify potential issues in the AI form filling workflow
 */
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const react_query_1 = require("@tanstack/react-query");
require("@testing-library/jest-dom");
// Mock fetch with proper typing
const mockFetch = globals_1.jest.fn();
global.fetch = mockFetch;
const createMockQueryClient = () => new react_query_1.QueryClient({
    defaultOptions: {
        queries: {
            retry: false,
        },
        mutations: {
            retry: false,
        }
    },
});
// Mock bill analysis responses - testing various scenarios
const mockAnalysisResponses = {
    successful: {
        title: "Hydro-Québec Electricity Bill",
        vendor: "Hydro-Québec",
        totalAmount: "245.67",
        category: "utilities",
        description: "Monthly electricity consumption",
        dueDate: "2025-01-31",
        issueDate: "2025-01-01",
        billNumber: "HQ-2025-001234",
        confidence: 0.95
    },
    lowConfidence: {
        title: "Unclear Insurance Document",
        vendor: "Unknown Provider",
        totalAmount: "0.00",
        category: "other",
        description: "",
        confidence: 0.25
    },
    invalidData: {
        title: "",
        vendor: "Valid Vendor",
        totalAmount: "invalid-amount",
        category: "invalid-category",
        confidence: 1.5 // Invalid confidence > 1.0
    },
    partialData: {
        title: "Property Maintenance Bill",
        vendor: "ABC Maintenance",
        totalAmount: "1250.00",
        category: "maintenance"
        // Missing other fields to test partial filling
    },
    frenchContent: {
        title: "Facture d'Assurance Habitation",
        vendor: "Assurances Desjardins",
        totalAmount: "2400.00",
        category: "insurance",
        description: "Prime annuelle d'assurance habitation",
        dueDate: "2025-12-31",
        confidence: 0.88
    }
};
// Test component that simulates the BillForm AI integration
const TestBillFormWithAI = () => {
    const [uploadedFile, setUploadedFile] = react_1.default.useState(null);
    const [isAnalyzing, setIsAnalyzing] = react_1.default.useState(false);
    const [aiAnalysisData, setAiAnalysisData] = react_1.default.useState(null);
    const [formData, setFormData] = react_1.default.useState({
        title: '',
        vendor: '',
        category: 'other',
        totalAmount: '',
        description: '',
        startDate: new Date().toISOString().split('T')[0],
        paymentType: 'unique',
        notes: ''
    });
    const handleFileUpload = (event) => {
        const file = event.target.files?.[0];
        if (file) {
            setUploadedFile(file);
        }
    };
    const analyzeDocument = async () => {
        if (!uploadedFile)
            return;
        setIsAnalyzing(true);
        try {
            const formData = new FormData();
            formData.append('document', uploadedFile);
            const response = await fetch('/api/bills/analyze-document', {
                method: 'POST',
                credentials: 'include',
                body: formData,
            });
            if (!response.ok) {
                throw new Error('Failed to analyze document');
            }
            const result = await response.json();
            setAiAnalysisData(result);
            // Simulate the smart form filling logic from BillForm.tsx
            if (result) {
                setFormData(current => {
                    const updated = { ...current };
                    // Only fill empty fields (simulating the smart logic)
                    if (!current.title) {
                        updated.title = result.title || '';
                    }
                    if (!current.vendor) {
                        updated.vendor = result.vendor || '';
                    }
                    if (current.category === 'other') {
                        updated.category = result.category || 'other';
                    }
                    if (!current.totalAmount) {
                        updated.totalAmount = result.totalAmount || '';
                    }
                    if (!current.description) {
                        updated.description = result.description || '';
                    }
                    // Add AI analysis info to notes
                    const aiNotes = [];
                    if (result.billNumber) {
                        aiNotes.push(`Bill Number: ${result.billNumber}`);
                    }
                    if (result.dueDate) {
                        aiNotes.push(`Due Date: ${result.dueDate}`);
                    }
                    aiNotes.push(`AI Analysis Confidence: ${(result.confidence * 100).toFixed(1)}%`);
                    if (aiNotes.length > 0) {
                        const aiNotesText = aiNotes.join('\n');
                        updated.notes = current.notes ?
                            `${current.notes}\n\n--- AI Analysis ---\n${aiNotesText}` :
                            aiNotesText;
                    }
                    return updated;
                });
            }
        }
        catch (error) {
            console.error('Analysis failed:', error);
        }
        finally {
            setIsAnalyzing(false);
        }
    };
    return ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "ai-bill-form", children: [(0, jsx_runtime_1.jsxs)("div", { "data-testid": "file-upload-section", children: [(0, jsx_runtime_1.jsx)("input", { type: "file", accept: ".pdf,.jpg,.jpeg,.png,.gif", onChange: handleFileUpload, "data-testid": "file-input" }), (0, jsx_runtime_1.jsx)("button", { onClick: analyzeDocument, disabled: !uploadedFile || isAnalyzing, "data-testid": "analyze-button", children: isAnalyzing ? 'Analyzing...' : 'Upload & Analyze' })] }), (0, jsx_runtime_1.jsx)("form", { "data-testid": "bill-form", children: (0, jsx_runtime_1.jsxs)("div", { "data-testid": "form-fields", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "input-title", type: "text", placeholder: "Bill Title", value: formData.title, onChange: (e) => setFormData(prev => ({ ...prev, title: e.target.value })) }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "input-vendor", type: "text", placeholder: "Vendor", value: formData.vendor, onChange: (e) => setFormData(prev => ({ ...prev, vendor: e.target.value })) }), (0, jsx_runtime_1.jsxs)("select", { "data-testid": "select-category", value: formData.category, onChange: (e) => setFormData(prev => ({ ...prev, category: e.target.value })), children: [(0, jsx_runtime_1.jsx)("option", { value: "other", children: "Other" }), (0, jsx_runtime_1.jsx)("option", { value: "utilities", children: "Utilities" }), (0, jsx_runtime_1.jsx)("option", { value: "maintenance", children: "Maintenance" }), (0, jsx_runtime_1.jsx)("option", { value: "insurance", children: "Insurance" })] }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "input-amount", type: "text", placeholder: "Total Amount", value: formData.totalAmount, onChange: (e) => setFormData(prev => ({ ...prev, totalAmount: e.target.value })) }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "input-description", placeholder: "Description", value: formData.description, onChange: (e) => setFormData(prev => ({ ...prev, description: e.target.value })) }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "input-notes", placeholder: "Notes", value: formData.notes, onChange: (e) => setFormData(prev => ({ ...prev, notes: e.target.value })) })] }) }), aiAnalysisData && ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "analysis-result", children: [(0, jsx_runtime_1.jsxs)("div", { "data-testid": "analysis-confidence", children: ["Confidence: ", (aiAnalysisData.confidence * 100).toFixed(1), "%"] }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "analysis-data", children: JSON.stringify(aiAnalysisData) })] }))] }));
};
const TestWrapper = ({ children }) => {
    const queryClient = createMockQueryClient();
    return (0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: children });
};
(0, globals_1.describe)('Gemini Form Integration Tests', () => {
    // Mock console.error to avoid test output pollution
    const originalConsoleError = console.error;
    (0, globals_1.beforeEach)(() => {
        mockFetch.mockClear();
        console.error = globals_1.jest.fn();
    });
    (0, globals_1.afterAll)(() => {
        console.error = originalConsoleError;
    });
    (0, globals_1.describe)('Successful AI Analysis Scenarios', () => {
        (0, globals_1.it)('should successfully analyze a clear utility bill and fill form correctly', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.successful,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Upload a file
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'hydro-bill.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            // Click analyze button
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            // Wait for analysis to complete
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bills/analyze-document', globals_1.expect.any(Object));
            });
            await (0, react_2.waitFor)(() => {
                // Verify form fields were populated correctly
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const categorySelect = react_2.screen.getByTestId('select-category');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const descriptionInput = react_2.screen.getByTestId('input-description');
                const notesInput = react_2.screen.getByTestId('input-notes');
                (0, globals_1.expect)(titleInput.value).toBe('Hydro-Québec Electricity Bill');
                (0, globals_1.expect)(vendorInput.value).toBe('Hydro-Québec');
                (0, globals_1.expect)(categorySelect.value).toBe('utilities');
                (0, globals_1.expect)(amountInput.value).toBe('245.67');
                (0, globals_1.expect)(descriptionInput.value).toBe('Monthly electricity consumption');
                (0, globals_1.expect)(notesInput.value).toContain('Bill Number: HQ-2025-001234');
                (0, globals_1.expect)(notesInput.value).toContain('Due Date: 2025-01-31');
                (0, globals_1.expect)(notesInput.value).toContain('AI Analysis Confidence: 95.0%');
            });
            // Verify confidence is displayed
            const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
            (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('95.0%');
        });
        (0, globals_1.it)('should handle French language bills correctly', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.frenchContent,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['contenu français'], 'facture-assurance.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const categorySelect = react_2.screen.getByTestId('select-category');
                (0, globals_1.expect)(titleInput.value).toBe("Facture d'Assurance Habitation");
                (0, globals_1.expect)(vendorInput.value).toBe('Assurances Desjardins');
                (0, globals_1.expect)(categorySelect.value).toBe('insurance');
            });
        });
    });
    (0, globals_1.describe)('Edge Cases and Error Scenarios', () => {
        (0, globals_1.it)('should handle low confidence analysis results appropriately', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.lowConfidence,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['unclear content'], 'blurry-document.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
                (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('25.0%');
                // With low confidence, title should still be filled but amount should be empty or 0
                const titleInput = react_2.screen.getByTestId('input-title');
                const amountInput = react_2.screen.getByTestId('input-amount');
                (0, globals_1.expect)(titleInput.value).toBe('Unclear Insurance Document');
                (0, globals_1.expect)(amountInput.value).toBe('0.00');
            });
        });
        (0, globals_1.it)('should handle invalid data from AI analysis gracefully', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.invalidData,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['corrupted data'], 'corrupted.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Check that invalid data is handled
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const categorySelect = react_2.screen.getByTestId('select-category');
                // Empty title should not be filled
                (0, globals_1.expect)(titleInput.value).toBe('');
                // Valid vendor should be filled  
                (0, globals_1.expect)(vendorInput.value).toBe('Valid Vendor');
                // Invalid amount should not crash the form
                (0, globals_1.expect)(amountInput.value).toBe('invalid-amount'); // This might be a bug!
                // Invalid category should fall back to 'other'
                (0, globals_1.expect)(categorySelect.value).toBe('other');
            });
        });
        (0, globals_1.it)('should handle network errors during analysis', async () => {
            mockFetch.mockRejectedValueOnce(new Error('Network error'));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Form should remain empty after error
                const titleInput = react_2.screen.getByTestId('input-title');
                (0, globals_1.expect)(titleInput.value).toBe('');
                // Analysis button should be enabled again
                (0, globals_1.expect)(analyzeButton).not.toBeDisabled();
            });
        });
        (0, globals_1.it)('should handle server errors (500) appropriately', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: false,
                status: 500,
                json: async () => ({ error: 'Internal server error' }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // Should handle server error gracefully
                const titleInput = react_2.screen.getByTestId('input-title');
                (0, globals_1.expect)(titleInput.value).toBe('');
            });
        });
    });
    (0, globals_1.describe)('User Interaction and Data Preservation', () => {
        (0, globals_1.it)('should preserve user-entered data when AI analysis completes', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.successful,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // User fills some fields manually first
            const titleInput = react_2.screen.getByTestId('input-title');
            const vendorInput = react_2.screen.getByTestId('input-vendor');
            const notesInput = react_2.screen.getByTestId('input-notes');
            await user_event_1.default.type(titleInput, 'My Custom Title');
            await user_event_1.default.type(vendorInput, 'My Custom Vendor');
            await user_event_1.default.type(notesInput, 'User notes here');
            // Then user uploads and analyzes
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                // User data should be preserved
                const titleInputAfter = react_2.screen.getByTestId('input-title');
                const vendorInputAfter = react_2.screen.getByTestId('input-vendor');
                const notesInputAfter = react_2.screen.getByTestId('input-notes');
                (0, globals_1.expect)(titleInputAfter.value).toBe('My Custom Title'); // Preserved
                (0, globals_1.expect)(vendorInputAfter.value).toBe('My Custom Vendor'); // Preserved
                (0, globals_1.expect)(notesInputAfter.value).toContain('User notes here'); // Preserved
                (0, globals_1.expect)(notesInputAfter.value).toContain('AI Analysis'); // AI info added
            });
        });
        (0, globals_1.it)('should only fill empty fields, not overwrite user input', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.successful,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Pre-fill amount field with user data
            const amountInput = react_2.screen.getByTestId('input-amount');
            await user_event_1.default.type(amountInput, '999.99');
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const amountInputAfter = react_2.screen.getByTestId('input-amount');
                const titleInputAfter = react_2.screen.getByTestId('input-title');
                // User amount should be preserved
                (0, globals_1.expect)(amountInputAfter.value).toBe('999.99');
                // Empty title should be filled by AI
                (0, globals_1.expect)(titleInputAfter.value).toBe('Hydro-Québec Electricity Bill');
            });
        });
    });
    (0, globals_1.describe)('File Type and Content Validation', () => {
        (0, globals_1.it)('should handle different file types appropriately', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => mockAnalysisResponses.successful,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            // Test with image file
            const fileInput = react_2.screen.getByTestId('file-input');
            const imageFile = new File(['image data'], 'bill-scan.jpg', { type: 'image/jpeg' });
            await user_event_1.default.upload(fileInput, imageFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bills/analyze-document', globals_1.expect.objectContaining({
                    method: 'POST',
                    body: globals_1.expect.any(FormData),
                }));
            });
        });
        (0, globals_1.it)('should disable analyze button when no file is selected', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            (0, globals_1.expect)(analyzeButton).toBeDisabled();
        });
        (0, globals_1.it)('should show analyzing state while processing', async () => {
            let resolvePromise;
            const delayedPromise = new Promise((resolve) => {
                resolvePromise = resolve;
            });
            mockFetch.mockReturnValueOnce(delayedPromise);
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            // Button should show analyzing state
            (0, globals_1.expect)(analyzeButton).toHaveTextContent('Analyzing...');
            (0, globals_1.expect)(analyzeButton).toBeDisabled();
            // Resolve the promise
            resolvePromise({
                ok: true,
                json: async () => mockAnalysisResponses.successful,
            });
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(analyzeButton).toHaveTextContent('Upload & Analyze');
                (0, globals_1.expect)(analyzeButton).not.toBeDisabled();
            });
        });
    });
    (0, globals_1.describe)('Data Integrity and Security Issues', () => {
        (0, globals_1.it)('should sanitize and validate AI response data', async () => {
            // Mock response with potential security issues
            const maliciousResponse = {
                title: '<script>alert("xss")</script>Legitimate Title',
                vendor: 'javascript:void(0)',
                totalAmount: 'SELECT * FROM users; --',
                category: 'utilities',
                confidence: 0.95,
                billNumber: '"><img src=x onerror=alert(1)>',
            };
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => maliciousResponse,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const titleInput = react_2.screen.getByTestId('input-title');
                const vendorInput = react_2.screen.getByTestId('input-vendor');
                const amountInput = react_2.screen.getByTestId('input-amount');
                const notesInput = react_2.screen.getByTestId('input-notes');
                // Values should be filled (this test reveals potential XSS vulnerability)
                (0, globals_1.expect)(titleInput.value).toContain('<script>');
                (0, globals_1.expect)(vendorInput.value).toBe('javascript:void(0)');
                (0, globals_1.expect)(amountInput.value).toContain('SELECT');
                (0, globals_1.expect)(notesInput.value).toContain('onerror=alert(1)');
            });
        });
        (0, globals_1.it)('should validate amount field format after AI analysis', async () => {
            const invalidAmountResponse = {
                ...mockAnalysisResponses.successful,
                totalAmount: '999,999.999', // Too many decimal places
            };
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => invalidAmountResponse,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const amountInput = react_2.screen.getByTestId('input-amount');
                // Should the app validate and fix this format? This test will reveal the behavior
                (0, globals_1.expect)(amountInput.value).toBe('999,999.999');
            });
        });
        (0, globals_1.it)('should handle confidence values outside valid range', async () => {
            const invalidConfidenceResponse = {
                ...mockAnalysisResponses.successful,
                confidence: 1.5, // Invalid: > 1.0
            };
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => invalidConfidenceResponse,
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestBillFormWithAI, {}) }));
            const fileInput = react_2.screen.getByTestId('file-input');
            const testFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            await user_event_1.default.upload(fileInput, testFile);
            const analyzeButton = react_2.screen.getByTestId('analyze-button');
            await user_event_1.default.click(analyzeButton);
            await (0, react_2.waitFor)(() => {
                const confidenceDisplay = react_2.screen.getByTestId('analysis-confidence');
                // Should be clamped to 100% or show error?
                (0, globals_1.expect)(confidenceDisplay).toHaveTextContent('150.0%'); // This reveals the issue
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2dlbWluaS1mb3JtLWludGVncmF0aW9uLnRlc3QudHN4IiwibWFwcGluZ3MiOiI7Ozs7OztBQVdBLDJDQUE0RjtBQUc1RiwyQkFBMkI7QUFDM0IsY0FBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2xCLENBQUMsRUFBRSxDQUFDLEdBQVcsRUFBRSxFQUFFLENBQUMsR0FBRztLQUN4QixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSixjQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDZixLQUFLLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtLQUNqQixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUM7QUF6Qko7Ozs7O0dBS0c7QUFFSCxrREFBMEI7QUFDMUIsa0RBQTRFO0FBQzVFLDZFQUFvRDtBQUNwRCx1REFBeUU7QUFFekUscUNBQW1DO0FBZW5DLGdDQUFnQztBQUNoQyxNQUFNLFNBQVMsR0FBRyxjQUFJLENBQUMsRUFBRSxFQUF1QyxDQUFDO0FBQ2pFLE1BQU0sQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDO0FBRXpCLE1BQU0scUJBQXFCLEdBQUcsR0FBRyxFQUFFLENBQ2pDLElBQUkseUJBQVcsQ0FBQztJQUNkLGNBQWMsRUFBRTtRQUNkLE9BQU8sRUFBRTtZQUNQLEtBQUssRUFBRSxLQUFLO1NBQ2I7UUFDRCxTQUFTLEVBQUU7WUFDVCxLQUFLLEVBQUUsS0FBSztTQUNiO0tBQ0Y7Q0FDRixDQUFDLENBQUM7QUFFTCwyREFBMkQ7QUFDM0QsTUFBTSxxQkFBcUIsR0FBRztJQUM1QixVQUFVLEVBQUU7UUFDVixLQUFLLEVBQUUsK0JBQStCO1FBQ3RDLE1BQU0sRUFBRSxjQUFjO1FBQ3RCLFdBQVcs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UUFBUSxDQUFDLENBQUM7WUFFNUMsTUFBTSxhQUFhLEdBQUcsY0FBTSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQzNELE1BQU0sb0JBQVMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7WUFFckMsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0saUJBQWlCLEdBQUcsY0FBTSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO2dCQUNwRSwyQ0FBMkM7Z0JBQzNDLElBQUEsZ0JBQU0sRUFBQyxpQkFBaUIsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMseUJBQXlCO1lBQ2xGLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvdGVzdHMvdW5pdC9nZW1pbmktZm9ybS1pbnRlZ3JhdGlvbi50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIEdlbWluaSBJbnRlZ3JhdGlvbiBGb3JtIEZpbGwgVGVzdCBTdWl0ZVxuICogQGRlc2NyaXB0aW9uIENvbXByZWhlbnNpdmUgdGVzdHMgZm9yIEFJLXBvd2VyZWQgZm9ybSBmaWxsaW5nIGZ1bmN0aW9uYWxpdHlcbiAqIFRlc3RzIHRoZSBpbnRlZ3JhdGlvbiBiZXR3ZWVuIEdlbWluaSBBSSBiaWxsIGFuYWx5c2lzIGFuZCBmb3JtIGF1dG8tcG9wdWxhdGlvblxuICogRGVzaWduZWQgdG8gaWRlbnRpZnkgcG90ZW50aWFsIGlzc3VlcyBpbiB0aGUgQUkgZm9ybSBmaWxsaW5nIHdvcmtmbG93XG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUNsaWVudFByb3ZpZGVyIH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBqZXN0LCBiZWZvcmVBbGwsIGFmdGVyQWxsIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgJ0B0ZXN0aW5nLWxpYnJhcnkvamVzdC1kb20nO1xuXG4vLyBNb2NrIHRoZSBob29rcyBhbmQgdXRpbHNcbmplc3QubW9jaygnQC9ob29rcy91c2UtbGFuZ3VhZ2UnLCAoKSA9PiAoe1xuICB1c2VMYW5ndWFnZTogKCkgPT4gKHtcbiAgICB0OiAoa2V5OiBzdHJpbmcpID0+IGtleSxcbiAgfSksXG59KSk7XG5cbmplc3QubW9jaygnQC9ob29rcy91c2UtdG9hc3QnLCAoKSA9PiAoe1xuICB1c2VUb2FzdDogKCkgPT4gKHtcbiAgICB0b2FzdDogamVzdC5mbigpLFxuICB9KSxcbn0pKTtcblxuLy8gTW9jayBmZXRjaCB3aXRoIHByb3BlciB0eXBpbmdcbmNvbnN0IG1vY2tGZXRjaCA9IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBmZXRjaD47XG5nbG9iYWwuZmV0Y2ggPSBtb2NrRmV0Y2g7XG5cbmNvbnN0IGNyZWF0ZU1vY2tRdWVyeUNsaWVudCA9ICgpID0+XG4gIG5ldyBRdWVyeUNsaWVudCh7XG4gICAgZGVmYXVsdE9wdGlvbnM6IHtcbiAgICAgIHF1ZXJpZXM6IHtcbiAgICAgICAgcmV0cnk6IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIG11dGF0aW9uczoge1xuICAgICAgICByZXRyeTogZmFsc2UsXG4gICAgICB9XG4gICAgfSxcbiAgfSk7XG5cbi8vIE1vY2sgYmlsbCBhbmFseXNpcyByZXNwb25zZXMgLSB0ZXN0aW5nIHZhcmlvdXMgc2NlbmFyaW9zXG5jb25zdCBtb2NrQW5hbHlzaXNSZXNwb25zZXMgPSB7XG4gIHN1Y2Nlc3NmdWw6IHtcbiAgICB0aXRsZTogXCJIeWRyby1RdcOpYmVjIEVsZWN0cmljaXR5IEJpbGxcIixcbiAgICB2ZW5kb3I6IFwiSHlkcm8tUXXDqWJlY1wiLCBcbiAgICB0b3RhbEFtb3VudDogXCIyNDUuNjdcIixcbiAgICBjYXRlZ29yeTogXCJ1dGlsaXRpZXNcIixcbiAgICBkZXNjcmlwdGlvbjogXCJNb250aGx5IGVsZWN0cmljaXR5IGNvbnN1bXB0aW9uXCIsXG4gICAgZHVlRGF0ZTogXCIyMDI1LTAxLTMxXCIsXG4gICAgaXNzdWVEYXRlOiBcIjIwMjUtMDEtMDFcIixcbiAgICBiaWxsTnVtYmVyOiBcIkhRLTIwMjUtMDAxMjM0XCIsXG4gICAgY29uZmlkZW5jZTogMC45NVxuICB9LFxuICBsb3dDb25maWRlbmNlOiB7XG4gICAgdGl0bGU6IFwiVW5jbGVhciBJbnN1cmFuY2UgRG9jdW1lbnRcIixcbiAgICB2ZW5kb3I6IFwiVW5rbm93biBQcm92aWRlclwiLFxuICAgIHRvdGFsQW1vdW50OiBcIjAuMDBcIixcbiAgICBjYXRlZ29yeTogXCJvdGhlclwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlwiLFxuICAgIGNvbmZpZGVuY2U6IDAuMjVcbiAgfSxcbiAgaW52YWxpZERhdGE6IHtcbiAgICB0aXRsZTogXCJcIixcbiAgICB2ZW5kb3I6IFwiVmFsaWQgVmVuZG9yXCIsXG4gICAgdG90YWxBbW91bnQ6IFwiaW52YWxpZC1hbW91bnRcIixcbiAgICBjYXRlZ29yeTogXCJpbnZhbGlkLWNhdGVnb3J5XCIsXG4gICAgY29uZmlkZW5jZTogMS41IC8vIEludmFsaWQgY29uZmlkZW5jZSA+IDEuMFxuICB9LFxuICBwYXJ0aWFsRGF0YToge1xuICAgIHRpdGxlOiBcIlByb3BlcnR5IE1haW50ZW5hbmNlIEJpbGxcIixcbiAgICB2ZW5kb3I6IFwiQUJDIE1haW50ZW5hbmNlXCIsXG4gICAgdG90YWxBbW91bnQ6IFwiMTI1MC4wMFwiLFxuICAgIGNhdGVnb3J5OiBcIm1haW50ZW5hbmNlXCJcbiAgICAvLyBNaXNzaW5nIG90aGVyIGZpZWxkcyB0byB0ZXN0IHBhcnRpYWwgZmlsbGluZ1xuICB9LFxuICBmcmVuY2hDb250ZW50OiB7XG4gICAgdGl0bGU6IFwiRmFjdHVyZSBkJ0Fzc3VyYW5jZSBIYWJpdGF0aW9uXCIsIFxuICAgIHZlbmRvcjogXCJBc3N1cmFuY2VzIERlc2phcmRpbnNcIixcbiAgICB0b3RhbEFtb3VudDogXCIyNDAwLjAwXCIsXG4gICAgY2F0ZWdvcnk6IFwiaW5zdXJhbmNlXCIsXG4gICAgZGVzY3JpcHRpb246IFwiUHJpbWUgYW5udWVsbGUgZCdhc3N1cmFuY2UgaGFiaXRhdGlvblwiLFxuICAgIGR1ZURhdGU6IFwiMjAyNS0xMi0zMVwiLFxuICAgIGNvbmZpZGVuY2U6IDAuODhcbiAgfVxufTtcblxuLy8gVGVzdCBjb21wb25lbnQgdGhhdCBzaW11bGF0ZXMgdGhlIEJpbGxGb3JtIEFJIGludGVncmF0aW9uXG5jb25zdCBUZXN0QmlsbEZvcm1XaXRoQUkgPSAoKSA9PiB7XG4gIGNvbnN0IFt1cGxvYWRlZEZpbGUsIHNldFVwbG9hZGVkRmlsZV0gPSBSZWFjdC51c2VTdGF0ZTxGaWxlIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc0FuYWx5emluZywgc2V0SXNBbmFseXppbmddID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbYWlBbmFseXNpc0RhdGEsIHNldEFpQW5hbHlzaXNEYXRhXSA9IFJlYWN0LnVzZVN0YXRlPGFueT4obnVsbCk7XG4gIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIHRpdGxlOiAnJyxcbiAgICB2ZW5kb3I6ICcnLFxuICAgIGNhdGVnb3J5OiAnb3RoZXInLFxuICAgIHRvdGFsQW1vdW50OiAnJyxcbiAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgbm90ZXM6ICcnXG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRsZUZpbGVVcGxvYWQgPSAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlcz8uWzBdO1xuICAgIGlmIChmaWxlKSB7XG4gICAgICBzZXRVcGxvYWRlZEZpbGUoZmlsZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGFuYWx5emVEb2N1bWVudCA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVwbG9hZGVkRmlsZSkgcmV0dXJuO1xuICAgIFxuICAgIHNldElzQW5hbHl6aW5nKHRydWUpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgZm9ybURhdGEuYXBwZW5kKCdkb2N1bWVudCcsIHVwbG9hZGVkRmlsZSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYmlsbHMvYW5hbHl6ZS1kb2N1bWVudCcsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIGJvZHk6IGZvcm1EYXRhLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gYW5hbHl6ZSBkb2N1bWVudCcpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBzZXRBaUFuYWx5c2lzRGF0YShyZXN1bHQpO1xuICAgICAgXG4gICAgICAvLyBTaW11bGF0ZSB0aGUgc21hcnQgZm9ybSBmaWxsaW5nIGxvZ2ljIGZyb20gQmlsbEZvcm0udHN4XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHNldEZvcm1EYXRhKGN1cnJlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSB7IC4uLmN1cnJlbnQgfTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBPbmx5IGZpbGwgZW1wdHkgZmllbGRzIChzaW11bGF0aW5nIHRoZSBzbWFydCBsb2dpYylcbiAgICAgICAgICBpZiAoIWN1cnJlbnQudGl0bGUpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQudGl0bGUgPSByZXN1bHQudGl0bGUgfHwgJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghY3VycmVudC52ZW5kb3IpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQudmVuZG9yID0gcmVzdWx0LnZlbmRvciB8fCAnJztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGN1cnJlbnQuY2F0ZWdvcnkgPT09ICdvdGhlcicpIHtcbiAgICAgICAgICAgIHVwZGF0ZWQuY2F0ZWdvcnkgPSByZXN1bHQuY2F0ZWdvcnkgfHwgJ290aGVyJztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjdXJyZW50LnRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICB1cGRhdGVkLnRvdGFsQW1vdW50ID0gcmVzdWx0LnRvdGFsQW1vdW50IHx8ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWN1cnJlbnQuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHVwZGF0ZWQuZGVzY3JpcHRpb24gPSByZXN1bHQuZGVzY3JpcHRpb24gfHwgJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIEFkZCBBSSBhbmFseXNpcyBpbmZvIHRvIG5vdGVzXG4gICAgICAgICAgY29uc3QgYWlOb3RlcyA9IFtdO1xuICAgICAgICAgIGlmIChyZXN1bHQuYmlsbE51bWJlcikge1xuICAgICAgICAgICAgYWlOb3Rlcy5wdXNoKGBCaWxsIE51bWJlcjogJHtyZXN1bHQuYmlsbE51bWJlcn1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdC5kdWVEYXRlKSB7XG4gICAgICAgICAgICBhaU5vdGVzLnB1c2goYER1ZSBEYXRlOiAke3Jlc3VsdC5kdWVEYXRlfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhaU5vdGVzLnB1c2goYEFJIEFuYWx5c2lzIENvbmZpZGVuY2U6ICR7KHJlc3VsdC5jb25maWRlbmNlICogMTAwKS50b0ZpeGVkKDEpfSVgKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoYWlOb3Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBhaU5vdGVzVGV4dCA9IGFpTm90ZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICB1cGRhdGVkLm5vdGVzID0gY3VycmVudC5ub3RlcyA/IFxuICAgICAgICAgICAgICBgJHtjdXJyZW50Lm5vdGVzfVxcblxcbi0tLSBBSSBBbmFseXNpcyAtLS1cXG4ke2FpTm90ZXNUZXh0fWAgOiBcbiAgICAgICAgICAgICAgYWlOb3Rlc1RleHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNBbmFseXppbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhaS1iaWxsLWZvcm1cIj5cbiAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJmaWxlLXVwbG9hZC1zZWN0aW9uXCI+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIHR5cGU9XCJmaWxlXCJcbiAgICAgICAgICBhY2NlcHQ9XCIucGRmLC5qcGcsLmpwZWcsLnBuZywuZ2lmXCJcbiAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlRmlsZVVwbG9hZH1cbiAgICAgICAgICBkYXRhLXRlc3RpZD1cImZpbGUtaW5wdXRcIlxuICAgICAgICAvPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgb25DbGljaz17YW5hbHl6ZURvY3VtZW50fVxuICAgICAgICAgIGRpc2FibGVkPXshdXBsb2FkZWRGaWxlIHx8IGlzQW5hbHl6aW5nfVxuICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYW5hbHl6ZS1idXR0b25cIlxuICAgICAgICA+XG4gICAgICAgICAge2lzQW5hbHl6aW5nID8gJ0FuYWx5emluZy4uLicgOiAnVXBsb2FkICYgQW5hbHl6ZSd9XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxmb3JtIGRhdGEtdGVzdGlkPVwiYmlsbC1mb3JtXCI+XG4gICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJmb3JtLWZpZWxkc1wiPlxuICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJpbnB1dC10aXRsZVwiXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkJpbGwgVGl0bGVcIlxuICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnRpdGxlfVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIHRpdGxlOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtdmVuZG9yXCJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVmVuZG9yXCJcbiAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS52ZW5kb3J9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgdmVuZG9yOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cInNlbGVjdC1jYXRlZ29yeVwiXG4gICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEuY2F0ZWdvcnl9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgY2F0ZWdvcnk6IGUudGFyZ2V0LnZhbHVlIH0pKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwib3RoZXJcIj5PdGhlcjwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cInV0aWxpdGllc1wiPlV0aWxpdGllczwvb3B0aW9uPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIm1haW50ZW5hbmNlXCI+TWFpbnRlbmFuY2U8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJpbnN1cmFuY2VcIj5JbnN1cmFuY2U8L29wdGlvbj5cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtYW1vdW50XCJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVG90YWwgQW1vdW50XCJcbiAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS50b3RhbEFtb3VudH1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Rm9ybURhdGEocHJldiA9PiAoeyAuLi5wcmV2LCB0b3RhbEFtb3VudDogZS50YXJnZXQudmFsdWUgfSkpfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LWRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIGRlc2NyaXB0aW9uOiBlLnRhcmdldC52YWx1ZSB9KSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtbm90ZXNcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJOb3Rlc1wiXG4gICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEubm90ZXN9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgbm90ZXM6IGUudGFyZ2V0LnZhbHVlIH0pKX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZm9ybT5cblxuICAgICAge2FpQW5hbHlzaXNEYXRhICYmIChcbiAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImFuYWx5c2lzLXJlc3VsdFwiPlxuICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhbmFseXNpcy1jb25maWRlbmNlXCI+XG4gICAgICAgICAgICBDb25maWRlbmNlOiB7KGFpQW5hbHlzaXNEYXRhLmNvbmZpZGVuY2UgKiAxMDApLnRvRml4ZWQoMSl9JVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJhbmFseXNpcy1kYXRhXCI+XG4gICAgICAgICAgICB7SlNPTi5zdHJpbmdpZnkoYWlBbmFseXNpc0RhdGEpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5jb25zdCBUZXN0V3JhcHBlciA9ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gY3JlYXRlTW9ja1F1ZXJ5Q2xpZW50KCk7XG4gIHJldHVybiA8UXVlcnlDbGllbnRQcm92aWRlciBjbGllbnQ9e3F1ZXJ5Q2xpZW50fT57Y2hpbGRyZW59PC9RdWVyeUNsaWVudFByb3ZpZGVyPjtcbn07XG5cbmRlc2NyaWJlKCdHZW1pbmkgRm9ybSBJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgLy8gTW9jayBjb25zb2xlLmVycm9yIHRvIGF2b2lkIHRlc3Qgb3V0cHV0IHBvbGx1dGlvblxuICBjb25zdCBvcmlnaW5hbENvbnNvbGVFcnJvciA9IGNvbnNvbGUuZXJyb3I7XG4gIFxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrRmV0Y2gubW9ja0NsZWFyKCk7XG4gICAgY29uc29sZS5lcnJvciA9IGplc3QuZm4oKTtcbiAgfSk7XG4gIFxuICBhZnRlckFsbCgoKSA9PiB7XG4gICAgY29uc29sZS5lcnJvciA9IG9yaWdpbmFsQ29uc29sZUVycm9yO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3VjY2Vzc2Z1bCBBSSBBbmFseXNpcyBTY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWNjZXNzZnVsbHkgYW5hbHl6ZSBhIGNsZWFyIHV0aWxpdHkgYmlsbCBhbmQgZmlsbCBmb3JtIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gbW9ja0FuYWx5c2lzUmVzcG9uc2VzLnN1Y2Nlc3NmdWwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gVXBsb2FkIGEgZmlsZVxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsndGVzdCBjb250ZW50J10sICdoeWRyby1iaWxsLnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICAvLyBDbGljayBhbmFseXplIGJ1dHRvblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgLy8gV2FpdCBmb3IgYW5hbHlzaXMgdG8gY29tcGxldGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9iaWxscy9hbmFseXplLWRvY3VtZW50JywgZXhwZWN0LmFueShPYmplY3QpKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gVmVyaWZ5IGZvcm0gZmllbGRzIHdlcmUgcG9wdWxhdGVkIGNvcnJlY3RseVxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC10aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHZlbmRvcklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBjYXRlZ29yeVNlbGVjdCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnc2VsZWN0LWNhdGVnb3J5JykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1hbW91bnQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1kZXNjcmlwdGlvbicpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IG5vdGVzSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcblxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dC52YWx1ZSkudG9CZSgnSHlkcm8tUXXDqWJlYyBFbGVjdHJpY2l0eSBCaWxsJyk7XG4gICAgICAgIGV4cGVjdCh2ZW5kb3JJbnB1dC52YWx1ZSkudG9CZSgnSHlkcm8tUXXDqWJlYycpO1xuICAgICAgICBleHBlY3QoY2F0ZWdvcnlTZWxlY3QudmFsdWUpLnRvQmUoJ3V0aWxpdGllcycpO1xuICAgICAgICBleHBlY3QoYW1vdW50SW5wdXQudmFsdWUpLnRvQmUoJzI0NS42NycpO1xuICAgICAgICBleHBlY3QoZGVzY3JpcHRpb25JbnB1dC52YWx1ZSkudG9CZSgnTW9udGhseSBlbGVjdHJpY2l0eSBjb25zdW1wdGlvbicpO1xuICAgICAgICBleHBlY3Qobm90ZXNJbnB1dC52YWx1ZSkudG9Db250YWluKCdCaWxsIE51bWJlcjogSFEtMjAyNS0wMDEyMzQnKTtcbiAgICAgICAgZXhwZWN0KG5vdGVzSW5wdXQudmFsdWUpLnRvQ29udGFpbignRHVlIERhdGU6IDIwMjUtMDEtMzEnKTtcbiAgICAgICAgZXhwZWN0KG5vdGVzSW5wdXQudmFsdWUpLnRvQ29udGFpbignQUkgQW5hbHlzaXMgQ29uZmlkZW5jZTogOTUuMCUnKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgY29uZmlkZW5jZSBpcyBkaXNwbGF5ZWRcbiAgICAgIGNvbnN0IGNvbmZpZGVuY2VEaXNwbGF5ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXNpcy1jb25maWRlbmNlJyk7XG4gICAgICBleHBlY3QoY29uZmlkZW5jZURpc3BsYXkpLnRvSGF2ZVRleHRDb250ZW50KCc5NS4wJScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgRnJlbmNoIGxhbmd1YWdlIGJpbGxzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gbW9ja0FuYWx5c2lzUmVzcG9uc2VzLmZyZW5jaENvbnRlbnQsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsnY29udGVudSBmcmFuw6dhaXMnXSwgJ2ZhY3R1cmUtYXNzdXJhbmNlLnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdmVuZG9yJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZWxlY3QgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3NlbGVjdC1jYXRlZ29yeScpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuXG4gICAgICAgIGV4cGVjdCh0aXRsZUlucHV0LnZhbHVlKS50b0JlKFwiRmFjdHVyZSBkJ0Fzc3VyYW5jZSBIYWJpdGF0aW9uXCIpO1xuICAgICAgICBleHBlY3QodmVuZG9ySW5wdXQudmFsdWUpLnRvQmUoJ0Fzc3VyYW5jZXMgRGVzamFyZGlucycpO1xuICAgICAgICBleHBlY3QoY2F0ZWdvcnlTZWxlY3QudmFsdWUpLnRvQmUoJ2luc3VyYW5jZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFZGdlIENhc2VzIGFuZCBFcnJvciBTY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbG93IGNvbmZpZGVuY2UgYW5hbHlzaXMgcmVzdWx0cyBhcHByb3ByaWF0ZWx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiBtb2NrQW5hbHlzaXNSZXNwb25zZXMubG93Q29uZmlkZW5jZSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd1bmNsZWFyIGNvbnRlbnQnXSwgJ2JsdXJyeS1kb2N1bWVudC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbmZpZGVuY2VEaXNwbGF5ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXNpcy1jb25maWRlbmNlJyk7XG4gICAgICAgIGV4cGVjdChjb25maWRlbmNlRGlzcGxheSkudG9IYXZlVGV4dENvbnRlbnQoJzI1LjAlJyk7XG5cbiAgICAgICAgLy8gV2l0aCBsb3cgY29uZmlkZW5jZSwgdGl0bGUgc2hvdWxkIHN0aWxsIGJlIGZpbGxlZCBidXQgYW1vdW50IHNob3VsZCBiZSBlbXB0eSBvciAwXG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgYW1vdW50SW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWFtb3VudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dC52YWx1ZSkudG9CZSgnVW5jbGVhciBJbnN1cmFuY2UgRG9jdW1lbnQnKTtcbiAgICAgICAgZXhwZWN0KGFtb3VudElucHV0LnZhbHVlKS50b0JlKCcwLjAwJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgZGF0YSBmcm9tIEFJIGFuYWx5c2lzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+IG1vY2tBbmFseXNpc1Jlc3BvbnNlcy5pbnZhbGlkRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWydjb3JydXB0ZWQgZGF0YSddLCAnY29ycnVwdGVkLnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCBpbnZhbGlkIGRhdGEgaXMgaGFuZGxlZFxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC10aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHZlbmRvcklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBhbW91bnRJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtYW1vdW50JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZWxlY3QgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3NlbGVjdC1jYXRlZ29yeScpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuXG4gICAgICAgIC8vIEVtcHR5IHRpdGxlIHNob3VsZCBub3QgYmUgZmlsbGVkXG4gICAgICAgIGV4cGVjdCh0aXRsZUlucHV0LnZhbHVlKS50b0JlKCcnKTtcbiAgICAgICAgLy8gVmFsaWQgdmVuZG9yIHNob3VsZCBiZSBmaWxsZWQgIFxuICAgICAgICBleHBlY3QodmVuZG9ySW5wdXQudmFsdWUpLnRvQmUoJ1ZhbGlkIFZlbmRvcicpO1xuICAgICAgICAvLyBJbnZhbGlkIGFtb3VudCBzaG91bGQgbm90IGNyYXNoIHRoZSBmb3JtXG4gICAgICAgIGV4cGVjdChhbW91bnRJbnB1dC52YWx1ZSkudG9CZSgnaW52YWxpZC1hbW91bnQnKTsgLy8gVGhpcyBtaWdodCBiZSBhIGJ1ZyFcbiAgICAgICAgLy8gSW52YWxpZCBjYXRlZ29yeSBzaG91bGQgZmFsbCBiYWNrIHRvICdvdGhlcidcbiAgICAgICAgZXhwZWN0KGNhdGVnb3J5U2VsZWN0LnZhbHVlKS50b0JlKCdvdGhlcicpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGVycm9ycyBkdXJpbmcgYW5hbHlzaXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsndGVzdCBjb250ZW50J10sICd0ZXN0LnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gRm9ybSBzaG91bGQgcmVtYWluIGVtcHR5IGFmdGVyIGVycm9yXG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LXRpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZXhwZWN0KHRpdGxlSW5wdXQudmFsdWUpLnRvQmUoJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQW5hbHlzaXMgYnV0dG9uIHNob3VsZCBiZSBlbmFibGVkIGFnYWluXG4gICAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZlciBlcnJvcnMgKDUwMCkgYXBwcm9wcmlhdGVseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogZmFsc2UsXG4gICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSksXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsndGVzdCBjb250ZW50J10sICd0ZXN0LnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gU2hvdWxkIGhhbmRsZSBzZXJ2ZXIgZXJyb3IgZ3JhY2VmdWxseVxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC10aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGV4cGVjdCh0aXRsZUlucHV0LnZhbHVlKS50b0JlKCcnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVXNlciBJbnRlcmFjdGlvbiBhbmQgRGF0YSBQcmVzZXJ2YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSB1c2VyLWVudGVyZWQgZGF0YSB3aGVuIEFJIGFuYWx5c2lzIGNvbXBsZXRlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gbW9ja0FuYWx5c2lzUmVzcG9uc2VzLnN1Y2Nlc3NmdWwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gVXNlciBmaWxscyBzb21lIGZpZWxkcyBtYW51YWxseSBmaXJzdFxuICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKTtcbiAgICAgIGNvbnN0IHZlbmRvcklucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKTtcbiAgICAgIGNvbnN0IG5vdGVzSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRpdGxlSW5wdXQsICdNeSBDdXN0b20gVGl0bGUnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHZlbmRvcklucHV0LCAnTXkgQ3VzdG9tIFZlbmRvcicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUobm90ZXNJbnB1dCwgJ1VzZXIgbm90ZXMgaGVyZScpO1xuXG4gICAgICAvLyBUaGVuIHVzZXIgdXBsb2FkcyBhbmQgYW5hbHl6ZXNcbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFVzZXIgZGF0YSBzaG91bGQgYmUgcHJlc2VydmVkXG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXRBZnRlciA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dEFmdGVyID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC12ZW5kb3InKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCBub3Rlc0lucHV0QWZ0ZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcblxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCdNeSBDdXN0b20gVGl0bGUnKTsgLy8gUHJlc2VydmVkXG4gICAgICAgIGV4cGVjdCh2ZW5kb3JJbnB1dEFmdGVyLnZhbHVlKS50b0JlKCdNeSBDdXN0b20gVmVuZG9yJyk7IC8vIFByZXNlcnZlZFxuICAgICAgICBleHBlY3Qobm90ZXNJbnB1dEFmdGVyLnZhbHVlKS50b0NvbnRhaW4oJ1VzZXIgbm90ZXMgaGVyZScpOyAvLyBQcmVzZXJ2ZWRcbiAgICAgICAgZXhwZWN0KG5vdGVzSW5wdXRBZnRlci52YWx1ZSkudG9Db250YWluKCdBSSBBbmFseXNpcycpOyAvLyBBSSBpbmZvIGFkZGVkXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgb25seSBmaWxsIGVtcHR5IGZpZWxkcywgbm90IG92ZXJ3cml0ZSB1c2VyIGlucHV0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiBtb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBQcmUtZmlsbCBhbW91bnQgZmllbGQgd2l0aCB1c2VyIGRhdGFcbiAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1hbW91bnQnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKGFtb3VudElucHV0LCAnOTk5Ljk5Jyk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFtb3VudElucHV0QWZ0ZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWFtb3VudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHRpdGxlSW5wdXRBZnRlciA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgICAgIC8vIFVzZXIgYW1vdW50IHNob3VsZCBiZSBwcmVzZXJ2ZWRcbiAgICAgICAgZXhwZWN0KGFtb3VudElucHV0QWZ0ZXIudmFsdWUpLnRvQmUoJzk5OS45OScpO1xuICAgICAgICAvLyBFbXB0eSB0aXRsZSBzaG91bGQgYmUgZmlsbGVkIGJ5IEFJXG4gICAgICAgIGV4cGVjdCh0aXRsZUlucHV0QWZ0ZXIudmFsdWUpLnRvQmUoJ0h5ZHJvLVF1w6liZWMgRWxlY3RyaWNpdHkgQmlsbCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGaWxlIFR5cGUgYW5kIENvbnRlbnQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgZmlsZSB0eXBlcyBhcHByb3ByaWF0ZWx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiBtb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBUZXN0IHdpdGggaW1hZ2UgZmlsZVxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCBpbWFnZUZpbGUgPSBuZXcgRmlsZShbJ2ltYWdlIGRhdGEnXSwgJ2JpbGwtc2Nhbi5qcGcnLCB7IHR5cGU6ICdpbWFnZS9qcGVnJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCBpbWFnZUZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvYmlsbHMvYW5hbHl6ZS1kb2N1bWVudCcsIFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogZXhwZWN0LmFueShGb3JtRGF0YSksXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNhYmxlIGFuYWx5emUgYnV0dG9uIHdoZW4gbm8gZmlsZSBpcyBzZWxlY3RlZCcsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBleHBlY3QoYW5hbHl6ZUJ1dHRvbikudG9CZURpc2FibGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgYW5hbHl6aW5nIHN0YXRlIHdoaWxlIHByb2Nlc3NpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzb2x2ZVByb21pc2U6ICh2YWx1ZTogYW55KSA9PiB2b2lkO1xuICAgICAgY29uc3QgZGVsYXllZFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICByZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XG4gICAgICB9KTtcblxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXR1cm5WYWx1ZU9uY2UoZGVsYXllZFByb21pc2UpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd0ZXN0IGNvbnRlbnQnXSwgJ3Rlc3QucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCB0ZXN0RmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIC8vIEJ1dHRvbiBzaG91bGQgc2hvdyBhbmFseXppbmcgc3RhdGVcbiAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS50b0hhdmVUZXh0Q29udGVudCgnQW5hbHl6aW5nLi4uJyk7XG4gICAgICBleHBlY3QoYW5hbHl6ZUJ1dHRvbikudG9CZURpc2FibGVkKCk7XG5cbiAgICAgIC8vIFJlc29sdmUgdGhlIHByb21pc2VcbiAgICAgIHJlc29sdmVQcm9taXNlISh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiBtb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bCxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGFuYWx5emVCdXR0b24pLnRvSGF2ZVRleHRDb250ZW50KCdVcGxvYWQgJiBBbmFseXplJyk7XG4gICAgICAgIGV4cGVjdChhbmFseXplQnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgSW50ZWdyaXR5IGFuZCBTZWN1cml0eSBJc3N1ZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBhbmQgdmFsaWRhdGUgQUkgcmVzcG9uc2UgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgcmVzcG9uc2Ugd2l0aCBwb3RlbnRpYWwgc2VjdXJpdHkgaXNzdWVzXG4gICAgICBjb25zdCBtYWxpY2lvdXNSZXNwb25zZSA9IHtcbiAgICAgICAgdGl0bGU6ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+TGVnaXRpbWF0ZSBUaXRsZScsXG4gICAgICAgIHZlbmRvcjogJ2phdmFzY3JpcHQ6dm9pZCgwKScsXG4gICAgICAgIHRvdGFsQW1vdW50OiAnU0VMRUNUICogRlJPTSB1c2VyczsgLS0nLFxuICAgICAgICBjYXRlZ29yeTogJ3V0aWxpdGllcycsXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuOTUsXG4gICAgICAgIGJpbGxOdW1iZXI6ICdcIj48aW1nIHNyYz14IG9uZXJyb3I9YWxlcnQoMSk+JyxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gbWFsaWNpb3VzUmVzcG9uc2UsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RCaWxsRm9ybVdpdGhBSSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IG5ldyBGaWxlKFsndGVzdCBjb250ZW50J10sICd0ZXN0LnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudXBsb2FkKGZpbGVJbnB1dCwgdGVzdEZpbGUpO1xuXG4gICAgICBjb25zdCBhbmFseXplQnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXplLWJ1dHRvbicpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGFuYWx5emVCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCB2ZW5kb3JJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtdmVuZG9yJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgYW1vdW50SW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWFtb3VudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IG5vdGVzSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LW5vdGVzJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcblxuICAgICAgICAvLyBWYWx1ZXMgc2hvdWxkIGJlIGZpbGxlZCAodGhpcyB0ZXN0IHJldmVhbHMgcG90ZW50aWFsIFhTUyB2dWxuZXJhYmlsaXR5KVxuICAgICAgICBleHBlY3QodGl0bGVJbnB1dC52YWx1ZSkudG9Db250YWluKCc8c2NyaXB0PicpO1xuICAgICAgICBleHBlY3QodmVuZG9ySW5wdXQudmFsdWUpLnRvQmUoJ2phdmFzY3JpcHQ6dm9pZCgwKScpO1xuICAgICAgICBleHBlY3QoYW1vdW50SW5wdXQudmFsdWUpLnRvQ29udGFpbignU0VMRUNUJyk7XG4gICAgICAgIGV4cGVjdChub3Rlc0lucHV0LnZhbHVlKS50b0NvbnRhaW4oJ29uZXJyb3I9YWxlcnQoMSknKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhbW91bnQgZmllbGQgZm9ybWF0IGFmdGVyIEFJIGFuYWx5c2lzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEFtb3VudFJlc3BvbnNlID0ge1xuICAgICAgICAuLi5tb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bCxcbiAgICAgICAgdG90YWxBbW91bnQ6ICc5OTksOTk5Ljk5OScsIC8vIFRvbyBtYW55IGRlY2ltYWwgcGxhY2VzXG4gICAgICB9O1xuXG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+IGludmFsaWRBbW91bnRSZXNwb25zZSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdEJpbGxGb3JtV2l0aEFJIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHRlc3RGaWxlID0gbmV3IEZpbGUoWyd0ZXN0IGNvbnRlbnQnXSwgJ3Rlc3QucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoZmlsZUlucHV0LCB0ZXN0RmlsZSk7XG5cbiAgICAgIGNvbnN0IGFuYWx5emVCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FuYWx5emUtYnV0dG9uJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYW5hbHl6ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbW91bnRJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtYW1vdW50JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgLy8gU2hvdWxkIHRoZSBhcHAgdmFsaWRhdGUgYW5kIGZpeCB0aGlzIGZvcm1hdD8gVGhpcyB0ZXN0IHdpbGwgcmV2ZWFsIHRoZSBiZWhhdmlvclxuICAgICAgICBleHBlY3QoYW1vdW50SW5wdXQudmFsdWUpLnRvQmUoJzk5OSw5OTkuOTk5Jyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmZpZGVuY2UgdmFsdWVzIG91dHNpZGUgdmFsaWQgcmFuZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkQ29uZmlkZW5jZVJlc3BvbnNlID0ge1xuICAgICAgICAuLi5tb2NrQW5hbHlzaXNSZXNwb25zZXMuc3VjY2Vzc2Z1bCxcbiAgICAgICAgY29uZmlkZW5jZTogMS41LCAvLyBJbnZhbGlkOiA+IDEuMFxuICAgICAgfTtcblxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiBpbnZhbGlkQ29uZmlkZW5jZVJlc3BvbnNlLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0QmlsbEZvcm1XaXRoQUkgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZmlsZS1pbnB1dCcpO1xuICAgICAgY29uc3QgdGVzdEZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnVwbG9hZChmaWxlSW5wdXQsIHRlc3RGaWxlKTtcblxuICAgICAgY29uc3QgYW5hbHl6ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYW5hbHl6ZS1idXR0b24nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhhbmFseXplQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbmZpZGVuY2VEaXNwbGF5ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdhbmFseXNpcy1jb25maWRlbmNlJyk7XG4gICAgICAgIC8vIFNob3VsZCBiZSBjbGFtcGVkIHRvIDEwMCUgb3Igc2hvdyBlcnJvcj9cbiAgICAgICAgZXhwZWN0KGNvbmZpZGVuY2VEaXNwbGF5KS50b0hhdmVUZXh0Q29udGVudCgnMTUwLjAlJyk7IC8vIFRoaXMgcmV2ZWFscyB0aGUgaXNzdWVcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==
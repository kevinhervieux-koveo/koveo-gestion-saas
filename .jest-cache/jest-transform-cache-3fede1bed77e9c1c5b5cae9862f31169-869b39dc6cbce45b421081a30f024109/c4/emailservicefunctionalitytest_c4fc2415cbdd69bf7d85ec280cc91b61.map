{"file":"/home/runner/workspace/tests/integration/email-service-functionality.test.ts","mappings":"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","names":[],"sources":["/home/runner/workspace/tests/integration/email-service-functionality.test.ts"],"sourcesContent":["/**\n * Email Service Functionality Test\n * Tests email service by sending actual emails to kevin.hervieux@koveo-gestion.com\n */\n\nimport { describe, it, expect, beforeAll } from '@jest/globals';\nimport { emailService } from '../../server/services/email-service';\n\ndescribe('Email Service Functionality Test', () => {\n  const testEmail = 'kevin.hervieux@koveo-gestion.com';\n\n  beforeAll(async () => {\n    // Send summary email about what emails to expect\n    const emailList = [\n      '1. Password Reset Email - Testing password reset functionality',\n      '2. User Invitation Email - Testing invitation system',\n      '3. Welcome Email - Testing user onboarding',\n      '4. Test Notification - General email service validation'\n    ];\n\n    const summaryMessage = `\nEmail Service Testing for Koveo Gestion\n\nYou should receive ${emailList.length} test emails:\n\n${emailList.map((item, index) => `${index + 1}. ${item}`).join('\\n')}\n\nThese emails are part of the automated testing process to validate the email functionality of the Quebec property management system.\n\nTest initiated at: ${new Date().toISOString()}\n    `.trim();\n\n    try {\n      await emailService.sendEmail(\n        testEmail,\n        'Kevin Hervieux',\n        'Email Service Testing - Expected Emails Summary',\n        summaryMessage,\n        `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #0066cc;\">Email Service Testing for Koveo Gestion</h2>\n          \n          <p>You should receive <strong>${emailList.length} test emails</strong>:</p>\n          \n          <ol style=\"line-height: 1.6;\">\n            ${emailList.map(item => `<li>${item}</li>`).join('')}\n          </ol>\n          \n          <p style=\"margin-top: 20px; padding: 10px; background-color: #f0f8ff; border-left: 4px solid #0066cc;\">\n            These emails are part of the automated testing process to validate the email functionality \n            of the Quebec property management system.\n          </p>\n          \n          <p style=\"color: #666; font-size: 12px;\">\n            Test initiated at: ${new Date().toISOString()}\n          </p>\n        </div>\n        `\n      );\n      console.log('✅ Summary email sent successfully');\n    } catch (error) {\n      console.error('❌ Failed to send summary email:', error);\n    }\n  });\n\n  describe('Password Reset Email', () => {\n    it('should send password reset email successfully', async () => {\n      const resetUrl = 'https://koveo-gestion.com/reset-password?token=test-token-123';\n      \n      const emailSent = await emailService.sendPasswordResetEmail(\n        testEmail,\n        'Kevin Hervieux',\n        resetUrl\n      );\n\n      expect(emailSent).toBe(true);\n    });\n\n    it('should handle password reset email with French content', async () => {\n      const resetUrl = 'https://koveo-gestion.com/reset-password?token=test-token-fr-456';\n      \n      const emailSent = await emailService.sendEmail(\n        testEmail,\n        'Kevin Hervieux',\n        'Réinitialisation de mot de passe - Koveo Gestion',\n        `\nBonjour Kevin Hervieux,\n\nVous avez demandé une réinitialisation de votre mot de passe pour votre compte Koveo Gestion.\n\nCliquez sur le lien suivant pour réinitialiser votre mot de passe:\n${resetUrl}\n\nCe lien expirera dans 1 heure pour votre sécurité.\n\nSi vous n'avez pas demandé cette réinitialisation, ignorez ce courriel.\n\nCordialement,\nL'équipe Koveo Gestion\n        `.trim(),\n        `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #0066cc;\">Réinitialisation de mot de passe</h2>\n          \n          <p>Bonjour Kevin Hervieux,</p>\n          \n          <p>Vous avez demandé une réinitialisation de votre mot de passe pour votre compte Koveo Gestion.</p>\n          \n          <div style=\"text-align: center; margin: 20px 0;\">\n            <a href=\"${resetUrl}\" style=\"background-color: #0066cc; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n              Réinitialiser le mot de passe\n            </a>\n          </div>\n          \n          <p style=\"color: #666; font-size: 14px;\">\n            Ce lien expirera dans 1 heure pour votre sécurité.\n          </p>\n          \n          <p style=\"color: #666; font-size: 12px;\">\n            Si vous n'avez pas demandé cette réinitialisation, ignorez ce courriel.\n          </p>\n        </div>\n        `\n      );\n\n      expect(emailSent).toBe(true);\n    });\n  });\n\n  describe('User Invitation Email', () => {\n    it('should send user invitation email successfully', async () => {\n      const invitationData = {\n        email: testEmail,\n        recipientName: 'Kevin Hervieux',\n        token: 'test-invitation-token-789',\n        organizationName: 'Koveo Gestion Test',\n        inviterName: 'System Administrator',\n        role: 'admin',\n        personalMessage: 'Welcome to our Quebec property management system!'\n      };\n\n      const emailSent = await emailService.sendInvitationEmail(\n        invitationData.email,\n        invitationData.recipientName,\n        invitationData.token,\n        invitationData.organizationName,\n        invitationData.inviterName,\n        invitationData.role,\n        invitationData.personalMessage\n      );\n\n      expect(emailSent).toBe(true);\n    });\n  });\n\n  describe('General Email Functionality', () => {\n    it('should send welcome email successfully', async () => {\n      const welcomeMessage = `\nBienvenue dans Koveo Gestion!\n\nVotre compte administrateur a été configuré avec succès.\n\nCaractéristiques de votre compte:\n- Rôle: Administrateur\n- Langue: Français\n- Accès complet au système de gestion immobilière\n\nVous pouvez maintenant accéder à toutes les fonctionnalités de la plateforme.\n\nCordialement,\nL'équipe Koveo Gestion\n      `.trim();\n\n      const emailSent = await emailService.sendEmail(\n        testEmail,\n        'Kevin Hervieux',\n        'Bienvenue dans Koveo Gestion - Compte Configuré',\n        welcomeMessage,\n        `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #0066cc;\">Bienvenue dans Koveo Gestion!</h2>\n          \n          <p>Votre compte administrateur a été configuré avec succès.</p>\n          \n          <div style=\"background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0;\">\n            <h3 style=\"margin-top: 0; color: #495057;\">Caractéristiques de votre compte:</h3>\n            <ul style=\"margin-bottom: 0;\">\n              <li><strong>Rôle:</strong> Administrateur</li>\n              <li><strong>Langue:</strong> Français</li>\n              <li><strong>Accès:</strong> Complet au système de gestion immobilière</li>\n            </ul>\n          </div>\n          \n          <p>Vous pouvez maintenant accéder à toutes les fonctionnalités de la plateforme.</p>\n          \n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"https://koveo-gestion.com/login\" style=\"background-color: #28a745; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n              Se connecter\n            </a>\n          </div>\n        </div>\n        `\n      );\n\n      expect(emailSent).toBe(true);\n    });\n\n    it('should send general test notification', async () => {\n      const testNotification = `\nTest de notification - Koveo Gestion\n\nCe message confirme que le service de courriel fonctionne correctement.\n\nDétails du test:\n- Date: ${new Date().toLocaleString('fr-CA')}\n- Type: Notification générale\n- Système: Gestion immobilière Quebec\n- Statut: Service email opérationnel\n\nTous les tests de courriels sont maintenant terminés.\n      `.trim();\n\n      const emailSent = await emailService.sendEmail(\n        testEmail,\n        'Kevin Hervieux',\n        'Test Notification - Service Email Opérationnel',\n        testNotification,\n        `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #28a745;\">✅ Test de notification - Koveo Gestion</h2>\n          \n          <p>Ce message confirme que le service de courriel fonctionne correctement.</p>\n          \n          <div style=\"background-color: #d4edda; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745; margin: 20px 0;\">\n            <h3 style=\"margin-top: 0; color: #155724;\">Détails du test:</h3>\n            <ul style=\"margin-bottom: 0; color: #155724;\">\n              <li><strong>Date:</strong> ${new Date().toLocaleString('fr-CA')}</li>\n              <li><strong>Type:</strong> Notification générale</li>\n              <li><strong>Système:</strong> Gestion immobilière Quebec</li>\n              <li><strong>Statut:</strong> Service email opérationnel</li>\n            </ul>\n          </div>\n          \n          <p style=\"font-weight: bold; color: #28a745;\">\n            ✅ Tous les tests de courriels sont maintenant terminés.\n          </p>\n        </div>\n        `\n      );\n\n      expect(emailSent).toBe(true);\n    });\n  });\n});"],"version":3}
a41301559d2d2ca8d770f7eef94d189b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UserCalendar = UserCalendar;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const date_fns_1 = require("date-fns");
const locale_1 = require("date-fns/locale");
const card_1 = require("@/components/ui/card");
const badge_1 = require("@/components/ui/badge");
const button_1 = require("@/components/ui/button");
const separator_1 = require("@/components/ui/separator");
const lucide_react_1 = require("lucide-react");
const calendar_view_1 = require("./calendar-view");
const queryClient_1 = require("@/lib/queryClient");
const use_language_1 = require("@/hooks/use-language");
const use_auth_1 = require("@/hooks/use-auth");
/**
 *
 */
function UserCalendar() {
    const { t, language } = (0, use_language_1.useLanguage)();
    const { user } = (0, use_auth_1.useAuth)();
    const [selectedBooking, setSelectedBooking] = (0, react_1.useState)(null);
    const handleEventClick = (event) => {
        // Find the full booking details
        const booking = event;
        setSelectedBooking(booking);
    };
    const generateICSContent = (bookings) => {
        const icsEvents = bookings
            .map((booking) => {
            const start = (0, date_fns_1.parseISO)(booking.startTime);
            const end = (0, date_fns_1.parseISO)(booking.endTime);
            const formatDate = (date) => (0, date_fns_1.format)(date, "yyyyMMdd'T'HHmmss'Z'");
            return [
                'BEGIN:VEVENT',
                `UID:${booking.id}@koveo-gestion.com`,
                `DTSTART:${formatDate(start)}`,
                `DTEND:${formatDate(end)}`,
                `SUMMARY:${booking.spaceName} - ${booking.buildingName}`,
                `LOCATION:${booking.buildingName}`,
                `DESCRIPTION:Réservation d'espace commun`,
                'STATUS:CONFIRMED',
                'END:VEVENT',
            ].join('\n');
        })
            .join('\n');
        return [
            'BEGIN:VCALENDAR',
            'VERSION:2.0',
            'PRODID:-//Koveo Gestion//Common Spaces Calendar//FR',
            'CALSCALE:GREGORIAN',
            icsEvents,
            'END:VCALENDAR',
        ].join('\n');
    };
    const downloadCalendar = async () => {
        try {
            const startDate = new Date();
            startDate.setMonth(startDate.getMonth() - 1);
            const endDate = new Date();
            endDate.setMonth(endDate.getMonth() + 3);
            const params = new URLSearchParams({
                start_date: startDate.toISOString(),
                end_date: endDate.toISOString(),
                view: 'month',
            });
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/common-spaces/user-calendar?${params}`);
            const data = await response.json();
            const icsContent = generateICSContent(data.calendar.bookings);
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `mes-reservations-${(0, date_fns_1.format)(new Date(), 'yyyy-MM-dd')}.ics`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }
        catch (error) {
            // Error downloading calendar
        }
    };
    if (!user) {
        return ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: 'p-6', children: (0, jsx_runtime_1.jsx)("div", { className: 'text-center text-muted-foreground', children: language === 'fr' ? 'Connexion requise' : 'Login required' }) }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: 'space-y-6', "data-testid": 'user-calendar-container', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between', children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsxs)("h1", { className: 'text-2xl font-bold flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: 'h-6 w-6' }), language === 'fr' ? 'Mon Calendrier' : 'My Calendar'] }), (0, jsx_runtime_1.jsx)("p", { className: 'text-muted-foreground', children: language === 'fr'
                                    ? "Consultez et gérez vos réservations d'espaces communs"
                                    : 'View and manage your common space bookings' })] }), (0, jsx_runtime_1.jsx)("div", { className: 'flex items-center gap-2', children: (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'outline', onClick: downloadCalendar, className: 'flex items-center gap-2', "data-testid": 'download-calendar-btn', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Download, { className: 'h-4 w-4' }), language === 'fr' ? 'Télécharger (.ics)' : 'Download (.ics)'] }) })] }), (0, jsx_runtime_1.jsx)(calendar_view_1.CalendarView, { mode: 'user', onEventClick: handleEventClick, showControls: true, className: 'col-span-2' }), selectedBooking && ((0, jsx_runtime_1.jsxs)(card_1.Card, { "data-testid": 'selected-booking-details', children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.User, { className: 'h-5 w-5' }), language === 'fr' ? 'Détails de la Réservation' : 'Booking Details'] }) }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: 'space-y-4', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'grid grid-cols-1 md:grid-cols-2 gap-4', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Building2, { className: 'h-4 w-4 text-muted-foreground' }), (0, jsx_runtime_1.jsx)("span", { className: 'font-medium', children: selectedBooking.spaceName })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MapPin, { className: 'h-4 w-4 text-muted-foreground' }), (0, jsx_runtime_1.jsx)("span", { className: 'text-sm text-muted-foreground', children: selectedBooking.buildingName })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { className: 'h-4 w-4 text-muted-foreground' }), (0, jsx_runtime_1.jsx)("span", { className: 'text-sm', children: (0, date_fns_1.format)((0, date_fns_1.parseISO)(selectedBooking.startTime), 'dd/MM/yyyy', {
                                                            locale: language === 'fr' ? locale_1.fr : undefined,
                                                        }) })] }), (0, jsx_runtime_1.jsx)("div", { className: 'flex items-center gap-2 text-sm text-muted-foreground', children: (0, jsx_runtime_1.jsxs)("span", { children: [(0, date_fns_1.format)((0, date_fns_1.parseISO)(selectedBooking.startTime), 'HH:mm', {
                                                            locale: language === 'fr' ? locale_1.fr : undefined,
                                                        }), ' ', "-", (0, date_fns_1.format)((0, date_fns_1.parseISO)(selectedBooking.endTime), 'HH:mm', {
                                                            locale: language === 'fr' ? locale_1.fr : undefined,
                                                        })] }) })] })] }), (0, jsx_runtime_1.jsx)(separator_1.Separator, {}), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between', children: [(0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: selectedBooking.status === 'confirmed' ? 'default' : 'secondary', "data-testid": 'booking-status-badge', children: selectedBooking.status === 'confirmed'
                                            ? language === 'fr'
                                                ? 'Confirmé'
                                                : 'Confirmed'
                                            : language === 'fr'
                                                ? 'Annulé'
                                                : 'Cancelled' }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: 'outline', size: 'sm', onClick: () => setSelectedBooking(null), "data-testid": 'close-details-btn', children: language === 'fr' ? 'Fermer' : 'Close' })] })] })] }))] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uLXNwYWNlcy91c2VyLWNhbGVuZGFyLnRzeCIsIm1hcHBpbmdzIjoiOztBQW9EQSxvQ0F1TUM7O0FBM1BELGlDQUFpQztBQUVqQyx1Q0FBcUQ7QUFDckQsNENBQXFDO0FBQ3JDLCtDQUFnRjtBQUNoRixpREFBOEM7QUFDOUMsbURBQWdEO0FBQ2hELHlEQUFzRDtBQUN0RCwrQ0FBa0c7QUFDbEcsbURBQStDO0FBQy9DLG1EQUErQztBQUMvQyx1REFBbUQ7QUFDbkQsK0NBQTJDO0FBcUMzQzs7R0FFRztBQUNILFNBQWdCLFlBQVk7SUFDMUIsTUFBTSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsR0FBRyxJQUFBLDBCQUFXLEdBQUUsQ0FBQztJQUN0QyxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBQSxrQkFBTyxHQUFFLENBQUM7SUFDM0IsTUFBTSxDQUFDLGVBQWUsRUFBRSxrQkFBa0IsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBcUIsSUFBSSxDQUFDLENBQUM7SUFFakYsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLEtBQVUsRUFBRSxFQUFFO1FBQ3RDLGdDQUFnQztRQUNoQyxNQUFNLE9BQU8sR0FBRyxLQUFvQixDQUFDO1FBQ3JDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzlCLENBQUMsQ0FBQztJQUVGLE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxRQUF1QixFQUFFLEVBQUU7UUFDckQsTUFBTSxTQUFTLEdBQUcsUUFBUTthQUN2QixHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUNmLE1BQU0sS0FBSyxHQUFHLElBQUEsbUJBQVEsRUFBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDMUMsTUFBTSxHQUFHLEdBQUcsSUFBQSxtQkFBUSxFQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN0QyxNQUFNLFVBQVUsR0FBRyxDQUFDLElBQVUsRUFBRSxFQUFFLENBQUMs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d29ya3NwYWNlL2NsaWVudC9zcmMvY29tcG9uZW50cy9jb21tb24tc3BhY2VzL3VzZXItY2FsZW5kYXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlUXVlcnkgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xuaW1wb3J0IHsgZm9ybWF0LCBhZGREYXlzLCBwYXJzZUlTTyB9IGZyb20gJ2RhdGUtZm5zJztcbmltcG9ydCB7IGZyIH0gZnJvbSAnZGF0ZS1mbnMvbG9jYWxlJztcbmltcG9ydCB7IENhcmQsIENhcmRDb250ZW50LCBDYXJkSGVhZGVyLCBDYXJkVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvY2FyZCc7XG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9iYWRnZSc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYnV0dG9uJztcbmltcG9ydCB7IFNlcGFyYXRvciB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9zZXBhcmF0b3InO1xuaW1wb3J0IHsgQ2FsZW5kYXIgYXMgQ2FsZW5kYXJJY29uLCBDbG9jaywgTWFwUGluLCBEb3dubG9hZCwgQnVpbGRpbmcyLCBVc2VyIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCB7IENhbGVuZGFyVmlldyB9IGZyb20gJy4vY2FsZW5kYXItdmlldyc7XG5pbXBvcnQgeyBhcGlSZXF1ZXN0IH0gZnJvbSAnQC9saWIvcXVlcnlDbGllbnQnO1xuaW1wb3J0IHsgdXNlTGFuZ3VhZ2UgfSBmcm9tICdAL2hvb2tzL3VzZS1sYW5ndWFnZSc7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9ob29rcy91c2UtYXV0aCc7XG5cbi8qKlxuICpcbiAqL1xuaW50ZXJmYWNlIFVzZXJCb29raW5nIHtcbiAgaWQ6IHN0cmluZztcbiAgc3RhcnRUaW1lOiBzdHJpbmc7XG4gIGVuZFRpbWU6IHN0cmluZztcbiAgc3RhdHVzOiAnY29uZmlybWVkJyB8ICdjYW5jZWxsZWQnO1xuICBzcGFjZU5hbWU6IHN0cmluZztcbiAgc3BhY2VJZDogc3RyaW5nO1xuICBidWlsZGluZ05hbWU6IHN0cmluZztcbiAgYnVpbGRpbmdJZDogc3RyaW5nO1xufVxuXG4vKipcbiAqXG4gKi9cbmludGVyZmFjZSBVc2VyQ2FsZW5kYXJEYXRhIHtcbiAgdXNlcjoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHJvbGU6IHN0cmluZztcbiAgfTtcbiAgY2FsZW5kYXI6IHtcbiAgICB2aWV3OiBzdHJpbmc7XG4gICAgc3RhcnREYXRlOiBzdHJpbmc7XG4gICAgZW5kRGF0ZTogc3RyaW5nO1xuICAgIGJvb2tpbmdzOiBVc2VyQm9va2luZ1tdO1xuICB9O1xuICBzdW1tYXJ5OiB7XG4gICAgdG90YWxCb29raW5nczogbnVtYmVyO1xuICAgIHRvdGFsSG91cnM6IG51bWJlcjtcbiAgfTtcbn1cblxuLyoqXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gVXNlckNhbGVuZGFyKCkge1xuICBjb25zdCB7IHQsIGxhbmd1YWdlIH0gPSB1c2VMYW5ndWFnZSgpO1xuICBjb25zdCB7IHVzZXIgfSA9IHVzZUF1dGgoKTtcbiAgY29uc3QgW3NlbGVjdGVkQm9va2luZywgc2V0U2VsZWN0ZWRCb29raW5nXSA9IHVzZVN0YXRlPFVzZXJCb29raW5nIHwgbnVsbD4obnVsbCk7XG5cbiAgY29uc3QgaGFuZGxlRXZlbnRDbGljayA9IChldmVudDogYW55KSA9PiB7XG4gICAgLy8gRmluZCB0aGUgZnVsbCBib29raW5nIGRldGFpbHNcbiAgICBjb25zdCBib29raW5nID0gZXZlbnQgYXMgVXNlckJvb2tpbmc7XG4gICAgc2V0U2VsZWN0ZWRCb29raW5nKGJvb2tpbmcpO1xuICB9O1xuXG4gIGNvbnN0IGdlbmVyYXRlSUNTQ29udGVudCA9IChib29raW5nczogVXNlckJvb2tpbmdbXSkgPT4ge1xuICAgIGNvbnN0IGljc0V2ZW50cyA9IGJvb2tpbmdzXG4gICAgICAubWFwKChib29raW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VJU08oYm9va2luZy5zdGFydFRpbWUpO1xuICAgICAgICBjb25zdCBlbmQgPSBwYXJzZUlTTyhib29raW5nLmVuZFRpbWUpO1xuICAgICAgICBjb25zdCBmb3JtYXREYXRlID0gKGRhdGU6IERhdGUpID0+IGZvcm1hdChkYXRlLCBcInl5eXlNTWRkJ1QnSEhtbXNzJ1onXCIpO1xuXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgJ0JFR0lOOlZFVkVOVCcsXG4gICAgICAgICAgYFVJRDoke2Jvb2tpbmcuaWR9QGtvdmVvLWdlc3Rpb24uY29tYCxcbiAgICAgICAgICBgRFRTVEFSVDoke2Zvcm1hdERhdGUoc3RhcnQpfWAsXG4gICAgICAgICAgYERURU5EOiR7Zm9ybWF0RGF0ZShlbmQpfWAsXG4gICAgICAgICAgYFNVTU1BUlk6JHtib29raW5nLnNwYWNlTmFtZX0gLSAke2Jvb2tpbmcuYnVpbGRpbmdOYW1lfWAsXG4gICAgICAgICAgYExPQ0FUSU9OOiR7Ym9va2luZy5idWlsZGluZ05hbWV9YCxcbiAgICAgICAgICBgREVTQ1JJUFRJT046UsOpc2VydmF0aW9uIGQnZXNwYWNlIGNvbW11bmAsXG4gICAgICAgICAgJ1NUQVRVUzpDT05GSVJNRUQnLFxuICAgICAgICAgICdFTkQ6VkVWRU5UJyxcbiAgICAgICAgXS5qb2luKCdcXG4nKTtcbiAgICAgIH0pXG4gICAgICAuam9pbignXFxuJyk7XG5cbiAgICByZXR1cm4gW1xuICAgICAgJ0JFR0lOOlZDQUxFTkRBUicsXG4gICAgICAnVkVSU0lPTjoyLjAnLFxuICAgICAgJ1BST0RJRDotLy9Lb3ZlbyBHZXN0aW9uLy9Db21tb24gU3BhY2VzIENhbGVuZGFyLy9GUicsXG4gICAgICAnQ0FMU0NBTEU6R1JFR09SSUFOJyxcbiAgICAgIGljc0V2ZW50cyxcbiAgICAgICdFTkQ6VkNBTEVOREFSJyxcbiAgICBdLmpvaW4oJ1xcbicpO1xuICB9O1xuXG4gIGNvbnN0IGRvd25sb2FkQ2FsZW5kYXIgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICBzdGFydERhdGUuc2V0TW9udGgoc3RhcnREYXRlLmdldE1vbnRoKCkgLSAxKTtcbiAgICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgZW5kRGF0ZS5zZXRNb250aChlbmREYXRlLmdldE1vbnRoKCkgKyAzKTtcblxuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIHN0YXJ0X2RhdGU6IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgICBlbmRfZGF0ZTogZW5kRGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgICB2aWV3OiAnbW9udGgnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUmVxdWVzdCgnR0VUJywgYC9hcGkvY29tbW9uLXNwYWNlcy91c2VyLWNhbGVuZGFyPyR7cGFyYW1zfWApO1xuICAgICAgY29uc3QgZGF0YTogVXNlckNhbGVuZGFyRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGNvbnN0IGljc0NvbnRlbnQgPSBnZW5lcmF0ZUlDU0NvbnRlbnQoZGF0YS5jYWxlbmRhci5ib29raW5ncyk7XG5cbiAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbaWNzQ29udGVudF0sIHsgdHlwZTogJ3RleHQvY2FsZW5kYXI7Y2hhcnNldD11dGYtOCcgfSk7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSB1cmw7XG4gICAgICBsaW5rLmRvd25sb2FkID0gYG1lcy1yZXNlcnZhdGlvbnMtJHtmb3JtYXQobmV3IERhdGUoKSwgJ3l5eXktTU0tZGQnKX0uaWNzYDtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XG4gICAgICBsaW5rLmNsaWNrKCk7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xuICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRXJyb3IgZG93bmxvYWRpbmcgY2FsZW5kYXJcbiAgICB9XG4gIH07XG5cbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDYXJkPlxuICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPSdwLTYnPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlciB0ZXh0LW11dGVkLWZvcmVncm91bmQnPlxuICAgICAgICAgICAge2xhbmd1YWdlID09PSAnZnInID8gJ0Nvbm5leGlvbiByZXF1aXNlJyA6ICdMb2dpbiByZXF1aXJlZCd9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICA8L0NhcmQ+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktNicgZGF0YS10ZXN0aWQ9J3VzZXItY2FsZW5kYXItY29udGFpbmVyJz5cbiAgICAgIHsvKiBIZWFkZXIgd2l0aCB1c2VyIGluZm8gYW5kIGFjdGlvbnMgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuJz5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDEgY2xhc3NOYW1lPSd0ZXh0LTJ4bCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgPENhbGVuZGFySWNvbiBjbGFzc05hbWU9J2gtNiB3LTYnIC8+XG4gICAgICAgICAgICB7bGFuZ3VhZ2UgPT09ICdmcicgPyAnTW9uIENhbGVuZHJpZXInIDogJ015IENhbGVuZGFyJ31cbiAgICAgICAgICA8L2gxPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1tdXRlZC1mb3JlZ3JvdW5kJz5cbiAgICAgICAgICAgIHtsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgICAgICAgICA/IFwiQ29uc3VsdGV6IGV0IGfDqXJleiB2b3MgcsOpc2VydmF0aW9ucyBkJ2VzcGFjZXMgY29tbXVuc1wiXG4gICAgICAgICAgICAgIDogJ1ZpZXcgYW5kIG1hbmFnZSB5b3VyIGNvbW1vbiBzcGFjZSBib29raW5ncyd9XG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgIHZhcmlhbnQ9J291dGxpbmUnXG4gICAgICAgICAgICBvbkNsaWNrPXtkb3dubG9hZENhbGVuZGFyfVxuICAgICAgICAgICAgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMidcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPSdkb3dubG9hZC1jYWxlbmRhci1idG4nXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPERvd25sb2FkIGNsYXNzTmFtZT0naC00IHctNCcgLz5cbiAgICAgICAgICAgIHtsYW5ndWFnZSA9PT0gJ2ZyJyA/ICdUw6lsw6ljaGFyZ2VyICguaWNzKScgOiAnRG93bmxvYWQgKC5pY3MpJ31cbiAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIE1haW4gQ2FsZW5kYXIgVmlldyAqL31cbiAgICAgIDxDYWxlbmRhclZpZXdcbiAgICAgICAgbW9kZT0ndXNlcidcbiAgICAgICAgb25FdmVudENsaWNrPXtoYW5kbGVFdmVudENsaWNrfVxuICAgICAgICBzaG93Q29udHJvbHM9e3RydWV9XG4gICAgICAgIGNsYXNzTmFtZT0nY29sLXNwYW4tMidcbiAgICAgIC8+XG5cbiAgICAgIHsvKiBTZWxlY3RlZCBCb29raW5nIERldGFpbHMgKi99XG4gICAgICB7c2VsZWN0ZWRCb29raW5nICYmIChcbiAgICAgICAgPENhcmQgZGF0YS10ZXN0aWQ9J3NlbGVjdGVkLWJvb2tpbmctZGV0YWlscyc+XG4gICAgICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgICAgICA8Q2FyZFRpdGxlIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICA8VXNlciBjbGFzc05hbWU9J2gtNSB3LTUnIC8+XG4gICAgICAgICAgICAgIHtsYW5ndWFnZSA9PT0gJ2ZyJyA/ICdEw6l0YWlscyBkZSBsYSBSw6lzZXJ2YXRpb24nIDogJ0Jvb2tpbmcgRGV0YWlscyd9XG4gICAgICAgICAgICA8L0NhcmRUaXRsZT5cbiAgICAgICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT0nc3BhY2UteS00Jz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC00Jz5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktMic+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJz5cbiAgICAgICAgICAgICAgICAgIDxCdWlsZGluZzIgY2xhc3NOYW1lPSdoLTQgdy00IHRleHQtbXV0ZWQtZm9yZWdyb3VuZCcgLz5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nZm9udC1tZWRpdW0nPntzZWxlY3RlZEJvb2tpbmcuc3BhY2VOYW1lfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgPE1hcFBpbiBjbGFzc05hbWU9J2gtNCB3LTQgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kJyAvPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCc+XG4gICAgICAgICAgICAgICAgICAgIHtzZWxlY3RlZEJvb2tpbmcuYnVpbGRpbmdOYW1lfVxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0yJz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgPENsb2NrIGNsYXNzTmFtZT0naC00IHctNCB0ZXh0LW11dGVkLWZvcmVncm91bmQnIC8+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J3RleHQtc20nPlxuICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0KHBhcnNlSVNPKHNlbGVjdGVkQm9va2luZy5zdGFydFRpbWUpLCAnZGQvTU0veXl5eScsIHtcbiAgICAgICAgICAgICAgICAgICAgICBsb2NhbGU6IGxhbmd1YWdlID09PSAnZnInID8gZnIgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiB0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCc+XG4gICAgICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAge2Zvcm1hdChwYXJzZUlTTyhzZWxlY3RlZEJvb2tpbmcuc3RhcnRUaW1lKSwgJ0hIOm1tJywge1xuICAgICAgICAgICAgICAgICAgICAgIGxvY2FsZTogbGFuZ3VhZ2UgPT09ICdmcicgPyBmciA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgfSl9eycgJ31cbiAgICAgICAgICAgICAgICAgICAgLVxuICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0KHBhcnNlSVNPKHNlbGVjdGVkQm9va2luZy5lbmRUaW1lKSwgJ0hIOm1tJywge1xuICAgICAgICAgICAgICAgICAgICAgIGxvY2FsZTogbGFuZ3VhZ2UgPT09ICdmcicgPyBmciA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxTZXBhcmF0b3IgLz5cblxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2Vlbic+XG4gICAgICAgICAgICAgIDxCYWRnZVxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9e3NlbGVjdGVkQm9va2luZy5zdGF0dXMgPT09ICdjb25maXJtZWQnID8gJ2RlZmF1bHQnIDogJ3NlY29uZGFyeSd9XG4gICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9J2Jvb2tpbmctc3RhdHVzLWJhZGdlJ1xuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3NlbGVjdGVkQm9va2luZy5zdGF0dXMgPT09ICdjb25maXJtZWQnXG4gICAgICAgICAgICAgICAgICA/IGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgICAgICAgICAgICAgID8gJ0NvbmZpcm3DqSdcbiAgICAgICAgICAgICAgICAgICAgOiAnQ29uZmlybWVkJ1xuICAgICAgICAgICAgICAgICAgOiBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgICAgICAgICAgICAgICA/ICdBbm51bMOpJ1xuICAgICAgICAgICAgICAgICAgICA6ICdDYW5jZWxsZWQnfVxuICAgICAgICAgICAgICA8L0JhZGdlPlxuXG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PSdvdXRsaW5lJ1xuICAgICAgICAgICAgICAgIHNpemU9J3NtJ1xuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFNlbGVjdGVkQm9va2luZyhudWxsKX1cbiAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD0nY2xvc2UtZGV0YWlscy1idG4nXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7bGFuZ3VhZ2UgPT09ICdmcicgPyAnRmVybWVyJyA6ICdDbG9zZSd9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgPC9DYXJkPlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==
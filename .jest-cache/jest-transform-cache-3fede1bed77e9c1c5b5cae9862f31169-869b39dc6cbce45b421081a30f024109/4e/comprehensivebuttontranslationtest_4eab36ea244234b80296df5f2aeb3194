965b82b31da922c866499eeeadc48459
"use strict";
/**
 * Comprehensive Button Translation Test Suite
 * Validates that all buttons in the application are properly translated
 * and conform to Quebec Law 25 bilingual requirements
 */
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const i18n_ts_1 = require("../../client/src/lib/i18n.ts");
(0, globals_1.describe)('Comprehensive Button Translation Coverage', () => {
    const languages = ['en', 'fr'];
    (0, globals_1.describe)('Fullscreen Button Translations', () => {
        (0, globals_1.it)('should have fullscreen translations in both languages', () => {
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                (0, globals_1.expect)(t.fullscreen).toBeDefined();
                (0, globals_1.expect)(typeof t.fullscreen).toBe('string');
                (0, globals_1.expect)(t.fullscreen.length).toBeGreaterThan(0);
                (0, globals_1.expect)(t.exitFullscreen).toBeDefined();
                (0, globals_1.expect)(typeof t.exitFullscreen).toBe('string');
                (0, globals_1.expect)(t.exitFullscreen.length).toBeGreaterThan(0);
            });
        });
        (0, globals_1.it)('should have French fullscreen translations with proper accent characters', () => {
            const fr = i18n_ts_1.translations.fr;
            (0, globals_1.expect)(fr.fullscreen).toBe('Plein écran');
            (0, globals_1.expect)(fr.exitFullscreen).toBe('Quitter le plein écran');
        });
        (0, globals_1.it)('should have English fullscreen translations', () => {
            const en = i18n_ts_1.translations.en;
            (0, globals_1.expect)(en.fullscreen).toBe('Fullscreen');
            (0, globals_1.expect)(en.exitFullscreen).toBe('Exit Fullscreen');
        });
    });
    (0, globals_1.describe)('Critical Button Translation Coverage', () => {
        const criticalButtonKeys = [
            'login',
            'logout',
            'getStarted',
            'cancel',
            'confirm',
            'save',
            'delete',
            'edit',
            'create',
            'update',
            'submit',
            'close',
            'back',
            'next',
            'finish',
            'continue',
            'fullscreen',
            'exitFullscreen'
        ];
        (0, globals_1.it)('should have all critical button translations in both languages', () => {
            criticalButtonKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    if (t[key]) {
                        (0, globals_1.expect)(typeof t[key]).toBe('string');
                        (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                    }
                });
            });
        });
    });
    (0, globals_1.describe)('Navigation Button Translation Coverage', () => {
        const navigationKeys = [
            'home',
            'dashboard',
            'buildings',
            'residents',
            'documents',
            'settings',
            'organizations',
            'calendar',
            'demands',
            'bills',
            'budget'
        ];
        (0, globals_1.it)('should have all navigation translations in both languages', () => {
            navigationKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                    (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                });
            });
        });
    });
    (0, globals_1.describe)('Action Button Translation Validation', () => {
        (0, globals_1.it)('should have consistent action button patterns', () => {
            const actionKeys = Object.keys(i18n_ts_1.translations.en).filter(key => key.includes('button') || key.includes('action') || key.includes('click'));
            actionKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                });
            });
        });
    });
    (0, globals_1.describe)('Quebec Law 25 Compliance for Buttons', () => {
        (0, globals_1.it)('should have French translations for all critical user interface elements', () => {
            const fr = i18n_ts_1.translations.fr;
            // Critical UI elements must be translated to French
            (0, globals_1.expect)(fr.login).toBeDefined();
            (0, globals_1.expect)(fr.logout).toBeDefined();
            (0, globals_1.expect)(fr.privacyPolicy).toBeDefined();
            (0, globals_1.expect)(fr.settings).toBeDefined();
            (0, globals_1.expect)(fr.language).toBeDefined();
            (0, globals_1.expect)(fr.fullscreen).toBeDefined();
            (0, globals_1.expect)(fr.exitFullscreen).toBeDefined();
        });
        (0, globals_1.it)('should use proper Quebec French terminology', () => {
            const fr = i18n_ts_1.translations.fr;
            // Validate Quebec-specific French terms
            (0, globals_1.expect)(fr.fullscreen).toContain('écran'); // "écran" not "screen"
            (0, globals_1.expect)(fr.exitFullscreen).toContain('Quitter'); // Proper Quebec French verb
            (0, globals_1.expect)(fr.language).toBe('Langue'); // Standard Quebec French
            (0, globals_1.expect)(fr.settings).toBe('Paramètres'); // Standard Quebec French
        });
    });
    (0, globals_1.describe)('Translation Consistency Validation', () => {
        (0, globals_1.it)('should have no missing translations between languages', () => {
            const enKeys = Object.keys(i18n_ts_1.translations.en);
            const frKeys = Object.keys(i18n_ts_1.translations.fr);
            (0, globals_1.expect)(enKeys.sort()).toEqual(frKeys.sort());
        });
        (0, globals_1.it)('should have no empty or undefined translations', () => {
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                Object.keys(t).forEach(key => {
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                    (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                });
            });
        });
    });
    (0, globals_1.describe)('Translation Quality Standards', () => {
        (0, globals_1.it)('should have proper capitalization for button text', () => {
            const buttonKeys = ['fullscreen', 'exitFullscreen', 'login', 'logout', 'getStarted'];
            buttonKeys.forEach(key => {
                const en = i18n_ts_1.translations.en[key];
                const fr = i18n_ts_1.translations.fr[key];
                if (en) {
                    // English buttons should start with capital letter
                    (0, globals_1.expect)(en.charAt(0)).toEqual(en.charAt(0).toUpperCase());
                }
                if (fr) {
                    // French buttons should start with capital letter
                    (0, globals_1.expect)(fr.charAt(0)).toEqual(fr.charAt(0).toUpperCase());
                }
            });
        });
        (0, globals_1.it)('should have reasonable length limits for button text', () => {
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                Object.keys(t).forEach(key => {
                    // Button text should be reasonable length (not too long for UI)
                    if (typeof t[key] === 'string') {
                        (0, globals_1.expect)(t[key].length).toBeLessThan(50); // Reasonable button text length
                    }
                });
            });
        });
    });
});
/**
 * Button Usage Pattern Validation
 * Tests that verify proper usage patterns for translated buttons
 */
(0, globals_1.describe)('Button Translation Usage Patterns', () => {
    (0, globals_1.it)('should validate translation key naming conventions', () => {
        const buttonLikeKeys = Object.keys(i18n_ts_1.translations.en).filter(key => 
        // Keys that are likely buttons or actions
        ['button', 'action', 'click', 'toggle', 'open', 'close', 'exit', 'enter', 'fullscreen'].some(pattern => key.toLowerCase().includes(pattern)));
        buttonLikeKeys.forEach(key => {
            // Button keys should follow camelCase convention
            (0, globals_1.expect)(key).toMatch(/^[a-z][a-zA-Z0-9]*$/);
        });
    });
    (0, globals_1.it)('should ensure all fullscreen functionality is properly translated', () => {
        const fullscreenKeys = ['fullscreen', 'exitFullscreen'];
        const languages = ['en', 'fr'];
        fullscreenKeys.forEach(key => {
            languages.forEach(lang => {
                const translation = i18n_ts_1.translations[lang][key];
                (0, globals_1.expect)(translation).toBeDefined();
                (0, globals_1.expect)(translation).not.toContain('{'); // No untranslated placeholders
                (0, globals_1.expect)(translation).not.toContain('}');
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2NvbXByZWhlbnNpdmUtYnV0dG9uLXRyYW5zbGF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7O0dBSUc7O0FBRUgsMkNBQXFEO0FBQ3JELDBEQUEyRTtBQUUzRSxJQUFBLGtCQUFRLEVBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO0lBQ3pELE1BQU0sU0FBUyxHQUFlLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBRTNDLElBQUEsa0JBQVEsRUFBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsSUFBQSxZQUFFLEVBQUMsdURBQXVELEVBQUUsR0FBRyxFQUFFO1lBQy9ELFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3ZCLE1BQU0sQ0FBQyxHQUFHLHNCQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBRTdCLElBQUEsZ0JBQU0sRUFBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ25DLElBQUEsZ0JBQU0sRUFBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQzNDLElBQUEsZ0JBQU0sRUFBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFL0MsSUFBQSxnQkFBTSxFQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDdkMsSUFBQSxnQkFBTSxFQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDL0MsSUFBQSxnQkFBTSxFQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JELENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFF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QUFDLG1FQUFtRSxFQUFFLEdBQUcsRUFBRTtRQUMzRSxNQUFNLGNBQWMsR0FBRyxDQUFDLFlBQVksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBRXhELE1BQU0sU0FBUyxHQUFlLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRTNDLGNBQWMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDM0IsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDdkIsTUFBTSxXQUFXLEdBQUksc0JBQVksQ0FBQyxJQUFJLENBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDckQsSUFBQSxnQkFBTSxFQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUNsQyxJQUFBLGdCQUFNLEVBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLCtCQUErQjtnQkFDdkUsSUFBQSxnQkFBTSxFQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDekMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2NvbXByZWhlbnNpdmUtYnV0dG9uLXRyYW5zbGF0aW9uLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wcmVoZW5zaXZlIEJ1dHRvbiBUcmFuc2xhdGlvbiBUZXN0IFN1aXRlXG4gKiBWYWxpZGF0ZXMgdGhhdCBhbGwgYnV0dG9ucyBpbiB0aGUgYXBwbGljYXRpb24gYXJlIHByb3Blcmx5IHRyYW5zbGF0ZWRcbiAqIGFuZCBjb25mb3JtIHRvIFF1ZWJlYyBMYXcgMjUgYmlsaW5ndWFsIHJlcXVpcmVtZW50c1xuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyB0cmFuc2xhdGlvbnMsIHR5cGUgTGFuZ3VhZ2UgfSBmcm9tICcuLi8uLi9jbGllbnQvc3JjL2xpYi9pMThuLnRzJztcblxuZGVzY3JpYmUoJ0NvbXByZWhlbnNpdmUgQnV0dG9uIFRyYW5zbGF0aW9uIENvdmVyYWdlJywgKCkgPT4ge1xuICBjb25zdCBsYW5ndWFnZXM6IExhbmd1YWdlW10gPSBbJ2VuJywgJ2ZyJ107XG4gIFxuICBkZXNjcmliZSgnRnVsbHNjcmVlbiBCdXR0b24gVHJhbnNsYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBmdWxsc2NyZWVuIHRyYW5zbGF0aW9ucyBpbiBib3RoIGxhbmd1YWdlcycsICgpID0+IHtcbiAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KHQuZnVsbHNjcmVlbikudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiB0LmZ1bGxzY3JlZW4pLnRvQmUoJ3N0cmluZycpO1xuICAgICAgICBleHBlY3QodC5mdWxsc2NyZWVuLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KHQuZXhpdEZ1bGxzY3JlZW4pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdCh0eXBlb2YgdC5leGl0RnVsbHNjcmVlbikudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgIGV4cGVjdCh0LmV4aXRGdWxsc2NyZWVuLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgRnJlbmNoIGZ1bGxzY3JlZW4gdHJhbnNsYXRpb25zIHdpdGggcHJvcGVyIGFjY2VudCBjaGFyYWN0ZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZnIgPSB0cmFuc2xhdGlvbnMuZnI7XG4gICAgICBleHBlY3QoZnIuZnVsbHNjcmVlbikudG9CZSgnUGxlaW4gw6ljcmFuJyk7XG4gICAgICBleHBlY3QoZnIuZXhpdEZ1bGxzY3JlZW4pLnRvQmUoJ1F1aXR0ZXIgbGUgcGxlaW4gw6ljcmFuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgRW5nbGlzaCBmdWxsc2NyZWVuIHRyYW5zbGF0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVuID0gdHJhbnNsYXRpb25zLmVuO1xuICAgICAgZXhwZWN0KGVuLmZ1bGxzY3JlZW4pLnRvQmUoJ0Z1bGxzY3JlZW4nKTtcbiAgICAgIGV4cGVjdChlbi5leGl0RnVsbHNjcmVlbikudG9CZSgnRXhpdCBGdWxsc2NyZWVuJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDcml0aWNhbCBCdXR0b24gVHJhbnNsYXRpb24gQ292ZXJhZ2UnLCAoKSA9PiB7XG4gICAgY29uc3QgY3JpdGljYWxCdXR0b25LZXlzID0gW1xuICAgICAgJ2xvZ2luJyxcbiAgICAgICdsb2dvdXQnLCBcbiAgICAgICdnZXRTdGFydGVkJyxcbiAgICAgICdjYW5jZWwnLFxuICAgICAgJ2NvbmZpcm0nLFxuICAgICAgJ3NhdmUnLFxuICAgICAgJ2RlbGV0ZScsXG4gICAgICAnZWRpdCcsXG4gICAgICAnY3JlYXRlJyxcbiAgICAgICd1cGRhdGUnLFxuICAgICAgJ3N1Ym1pdCcsXG4gICAgICAnY2xvc2UnLFxuICAgICAgJ2JhY2snLFxuICAgICAgJ25leHQnLFxuICAgICAgJ2ZpbmlzaCcsXG4gICAgICAnY29udGludWUnLFxuICAgICAgJ2Z1bGxzY3JlZW4nLFxuICAgICAgJ2V4aXRGdWxsc2NyZWVuJ1xuICAgIF07XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgYWxsIGNyaXRpY2FsIGJ1dHRvbiB0cmFuc2xhdGlvbnMgaW4gYm90aCBsYW5ndWFnZXMnLCAoKSA9PiB7XG4gICAgICBjcml0aWNhbEJ1dHRvbktleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBsYW5ndWFnZXMuZm9yRWFjaChsYW5nID0+IHtcbiAgICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddIGFzIGFueTtcbiAgICAgICAgICBpZiAodFtrZXldKSB7XG4gICAgICAgICAgICBleHBlY3QodHlwZW9mIHRba2V5XSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgICAgICBleHBlY3QodFtrZXldLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05hdmlnYXRpb24gQnV0dG9uIFRyYW5zbGF0aW9uIENvdmVyYWdlJywgKCkgPT4ge1xuICAgIGNvbnN0IG5hdmlnYXRpb25LZXlzID0gW1xuICAgICAgJ2hvbWUnLFxuICAgICAgJ2Rhc2hib2FyZCcsIFxuICAgICAgJ2J1aWxkaW5ncycsXG4gICAgICAncmVzaWRlbnRzJyxcbiAgICAgICdkb2N1bWVudHMnLFxuICAgICAgJ3NldHRpbmdzJyxcbiAgICAgICdvcmdhbml6YXRpb25zJyxcbiAgICAgICdjYWxlbmRhcicsXG4gICAgICAnZGVtYW5kcycsXG4gICAgICAnYmlsbHMnLFxuICAgICAgJ2J1ZGdldCdcbiAgICBdO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIGFsbCBuYXZpZ2F0aW9uIHRyYW5zbGF0aW9ucyBpbiBib3RoIGxhbmd1YWdlcycsICgpID0+IHtcbiAgICAgIG5hdmlnYXRpb25LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgbGFuZ3VhZ2VzLmZvckVhY2gobGFuZyA9PiB7XG4gICAgICAgICAgY29uc3QgdCA9IHRyYW5zbGF0aW9uc1tsYW5nXSBhcyBhbnk7XG4gICAgICAgICAgZXhwZWN0KHRba2V5XSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICBleHBlY3QodHlwZW9mIHRba2V5XSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgICAgZXhwZWN0KHRba2V5XS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FjdGlvbiBCdXR0b24gVHJhbnNsYXRpb24gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgY29uc2lzdGVudCBhY3Rpb24gYnV0dG9uIHBhdHRlcm5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWN0aW9uS2V5cyA9IE9iamVjdC5rZXlzKHRyYW5zbGF0aW9ucy5lbikuZmlsdGVyKGtleSA9PiBcbiAgICAgICAga2V5LmluY2x1ZGVzKCdidXR0b24nKSB8fCBrZXkuaW5jbHVkZXMoJ2FjdGlvbicpIHx8IGtleS5pbmNsdWRlcygnY2xpY2snKVxuICAgICAgKTtcblxuICAgICAgYWN0aW9uS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICAgIGNvbnN0IHQgPSB0cmFuc2xhdGlvbnNbbGFuZ10gYXMgYW55O1xuICAgICAgICAgIGV4cGVjdCh0W2tleV0pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgZXhwZWN0KHR5cGVvZiB0W2tleV0pLnRvQmUoJ3N0cmluZycpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUXVlYmVjIExhdyAyNSBDb21wbGlhbmNlIGZvciBCdXR0b25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBGcmVuY2ggdHJhbnNsYXRpb25zIGZvciBhbGwgY3JpdGljYWwgdXNlciBpbnRlcmZhY2UgZWxlbWVudHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmciA9IHRyYW5zbGF0aW9ucy5mcjtcbiAgICAgIFxuICAgICAgLy8gQ3JpdGljYWwgVUkgZWxlbWVudHMgbXVzdCBiZSB0cmFuc2xhdGVkIHRvIEZyZW5jaFxuICAgICAgZXhwZWN0KGZyLmxvZ2luKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyLmxvZ291dCkudG9CZURlZmluZWQoKTsgXG4gICAgICBleHBlY3QoZnIucHJpdmFjeVBvbGljeSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChmci5zZXR0aW5ncykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChmci5sYW5ndWFnZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChmci5mdWxsc2NyZWVuKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyLmV4aXRGdWxsc2NyZWVuKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgcHJvcGVyIFF1ZWJlYyBGcmVuY2ggdGVybWlub2xvZ3knLCAoKSA9PiB7XG4gICAgICBjb25zdCBmciA9IHRyYW5zbGF0aW9ucy5mcjtcbiAgICAgIFxuICAgICAgLy8gVmFsaWRhdGUgUXVlYmVjLXNwZWNpZmljIEZyZW5jaCB0ZXJtc1xuICAgICAgZXhwZWN0KGZyLmZ1bGxzY3JlZW4pLnRvQ29udGFpbignw6ljcmFuJyk7IC8vIFwiw6ljcmFuXCIgbm90IFwic2NyZWVuXCJcbiAgICAgIGV4cGVjdChmci5leGl0RnVsbHNjcmVlbikudG9Db250YWluKCdRdWl0dGVyJyk7IC8vIFByb3BlciBRdWViZWMgRnJlbmNoIHZlcmJcbiAgICAgIGV4cGVjdChmci5sYW5ndWFnZSkudG9CZSgnTGFuZ3VlJyk7IC8vIFN0YW5kYXJkIFF1ZWJlYyBGcmVuY2hcbiAgICAgIGV4cGVjdChmci5zZXR0aW5ncykudG9CZSgnUGFyYW3DqHRyZXMnKTsgLy8gU3RhbmRhcmQgUXVlYmVjIEZyZW5jaFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJhbnNsYXRpb24gQ29uc2lzdGVuY3kgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgbm8gbWlzc2luZyB0cmFuc2xhdGlvbnMgYmV0d2VlbiBsYW5ndWFnZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlbktleXMgPSBPYmplY3Qua2V5cyh0cmFuc2xhdGlvbnMuZW4pO1xuICAgICAgY29uc3QgZnJLZXlzID0gT2JqZWN0LmtleXModHJhbnNsYXRpb25zLmZyKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGVuS2V5cy5zb3J0KCkpLnRvRXF1YWwoZnJLZXlzLnNvcnQoKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgbm8gZW1wdHkgb3IgdW5kZWZpbmVkIHRyYW5zbGF0aW9ucycsICgpID0+IHtcbiAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddIGFzIGFueTtcbiAgICAgICAgT2JqZWN0LmtleXModCkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgIGV4cGVjdCh0W2tleV0pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgZXhwZWN0KHR5cGVvZiB0W2tleV0pLnRvQmUoJ3N0cmluZycpO1xuICAgICAgICAgIGV4cGVjdCh0W2tleV0ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdUcmFuc2xhdGlvbiBRdWFsaXR5IFN0YW5kYXJkcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIGNhcGl0YWxpemF0aW9uIGZvciBidXR0b24gdGV4dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1dHRvbktleXMgPSBbJ2Z1bGxzY3JlZW4nLCAnZXhpdEZ1bGxzY3JlZW4nLCAnbG9naW4nLCAnbG9nb3V0JywgJ2dldFN0YXJ0ZWQnXTtcbiAgICAgIFxuICAgICAgYnV0dG9uS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGNvbnN0IGVuID0gKHRyYW5zbGF0aW9ucy5lbiBhcyBhbnkpW2tleV07XG4gICAgICAgIGNvbnN0IGZyID0gKHRyYW5zbGF0aW9ucy5mciBhcyBhbnkpW2tleV07XG4gICAgICAgIFxuICAgICAgICBpZiAoZW4pIHtcbiAgICAgICAgICAvLyBFbmdsaXNoIGJ1dHRvbnMgc2hvdWxkIHN0YXJ0IHdpdGggY2FwaXRhbCBsZXR0ZXJcbiAgICAgICAgICBleHBlY3QoZW4uY2hhckF0KDApKS50b0VxdWFsKGVuLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGZyKSB7XG4gICAgICAgICAgLy8gRnJlbmNoIGJ1dHRvbnMgc2hvdWxkIHN0YXJ0IHdpdGggY2FwaXRhbCBsZXR0ZXJcbiAgICAgICAgICBleHBlY3QoZnIuY2hhckF0KDApKS50b0VxdWFsKGZyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcmVhc29uYWJsZSBsZW5ndGggbGltaXRzIGZvciBidXR0b24gdGV4dCcsICgpID0+IHtcbiAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddIGFzIGFueTtcbiAgICAgICAgT2JqZWN0LmtleXModCkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgIC8vIEJ1dHRvbiB0ZXh0IHNob3VsZCBiZSByZWFzb25hYmxlIGxlbmd0aCAobm90IHRvbyBsb25nIGZvciBVSSlcbiAgICAgICAgICBpZiAodHlwZW9mIHRba2V5XSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGV4cGVjdCh0W2tleV0ubGVuZ3RoKS50b0JlTGVzc1RoYW4oNTApOyAvLyBSZWFzb25hYmxlIGJ1dHRvbiB0ZXh0IGxlbmd0aFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuLyoqXG4gKiBCdXR0b24gVXNhZ2UgUGF0dGVybiBWYWxpZGF0aW9uXG4gKiBUZXN0cyB0aGF0IHZlcmlmeSBwcm9wZXIgdXNhZ2UgcGF0dGVybnMgZm9yIHRyYW5zbGF0ZWQgYnV0dG9uc1xuICovXG5kZXNjcmliZSgnQnV0dG9uIFRyYW5zbGF0aW9uIFVzYWdlIFBhdHRlcm5zJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRyYW5zbGF0aW9uIGtleSBuYW1pbmcgY29udmVudGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgYnV0dG9uTGlrZUtleXMgPSBPYmplY3Qua2V5cyh0cmFuc2xhdGlvbnMuZW4pLmZpbHRlcihrZXkgPT4gXG4gICAgICAvLyBLZXlzIHRoYXQgYXJlIGxpa2VseSBidXR0b25zIG9yIGFjdGlvbnNcbiAgICAgIFsnYnV0dG9uJywgJ2FjdGlvbicsICdjbGljaycsICd0b2dnbGUnLCAnb3BlbicsICdjbG9zZScsICdleGl0JywgJ2VudGVyJywgJ2Z1bGxzY3JlZW4nXS5zb21lKHBhdHRlcm4gPT4gXG4gICAgICAgIGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHBhdHRlcm4pXG4gICAgICApXG4gICAgKTtcblxuICAgIGJ1dHRvbkxpa2VLZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIC8vIEJ1dHRvbiBrZXlzIHNob3VsZCBmb2xsb3cgY2FtZWxDYXNlIGNvbnZlbnRpb25cbiAgICAgIGV4cGVjdChrZXkpLnRvTWF0Y2goL15bYS16XVthLXpBLVowLTldKiQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBlbnN1cmUgYWxsIGZ1bGxzY3JlZW4gZnVuY3Rpb25hbGl0eSBpcyBwcm9wZXJseSB0cmFuc2xhdGVkJywgKCkgPT4ge1xuICAgIGNvbnN0IGZ1bGxzY3JlZW5LZXlzID0gWydmdWxsc2NyZWVuJywgJ2V4aXRGdWxsc2NyZWVuJ107XG4gICAgXG4gICAgY29uc3QgbGFuZ3VhZ2VzOiBMYW5ndWFnZVtdID0gWydlbicsICdmciddO1xuICAgIFxuICAgIGZ1bGxzY3JlZW5LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICBjb25zdCB0cmFuc2xhdGlvbiA9ICh0cmFuc2xhdGlvbnNbbGFuZ10gYXMgYW55KVtrZXldO1xuICAgICAgICBleHBlY3QodHJhbnNsYXRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdCh0cmFuc2xhdGlvbikubm90LnRvQ29udGFpbigneycpOyAvLyBObyB1bnRyYW5zbGF0ZWQgcGxhY2Vob2xkZXJzXG4gICAgICAgIGV4cGVjdCh0cmFuc2xhdGlvbikubm90LnRvQ29udGFpbignfScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
c9b46d30ecd9a1dfd11d58861e932b5d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useCalendar = useCalendar;
const react_1 = require("react");
const getDates_js_1 = require("./helpers/getDates.js");
const getDays_js_1 = require("./helpers/getDays.js");
const getDisplayMonths_js_1 = require("./helpers/getDisplayMonths.js");
const getInitialMonth_js_1 = require("./helpers/getInitialMonth.js");
const getMonths_js_1 = require("./helpers/getMonths.js");
const getNavMonth_js_1 = require("./helpers/getNavMonth.js");
const getNextMonth_js_1 = require("./helpers/getNextMonth.js");
const getPreviousMonth_js_1 = require("./helpers/getPreviousMonth.js");
const getWeeks_js_1 = require("./helpers/getWeeks.js");
const useControlledValue_js_1 = require("./helpers/useControlledValue.js");
/**
 * Provides the calendar object to work with the calendar in custom components.
 *
 * @private
 * @param props - The DayPicker props related to calendar configuration.
 * @param dateLib - The date utility library instance.
 * @returns The calendar object containing displayed days, weeks, months, and
 *   navigation methods.
 */
function useCalendar(props, dateLib) {
    const [navStart, navEnd] = (0, getNavMonth_js_1.getNavMonths)(props, dateLib);
    const { startOfMonth, endOfMonth } = dateLib;
    const initialMonth = (0, getInitialMonth_js_1.getInitialMonth)(props, navStart, navEnd, dateLib);
    const [firstMonth, setFirstMonth] = (0, useControlledValue_js_1.useControlledValue)(initialMonth, 
    // initialMonth is always computed from props.month if provided
    props.month ? initialMonth : undefined);
    // biome-ignore lint/correctness/useExhaustiveDependencies: change the initial month when the time zone changes.
    (0, react_1.useEffect)(() => {
        const newInitialMonth = (0, getInitialMonth_js_1.getInitialMonth)(props, navStart, navEnd, dateLib);
        setFirstMonth(newInitialMonth);
    }, [props.timeZone]);
    /** The months displayed in the calendar. */
    const displayMonths = (0, getDisplayMonths_js_1.getDisplayMonths)(firstMonth, navEnd, props, dateLib);
    /** The dates displayed in the calendar. */
    const dates = (0, getDates_js_1.getDates)(displayMonths, props.endMonth ? endOfMonth(props.endMonth) : undefined, props, dateLib);
    /** The Months displayed in the calendar. */
    const months = (0, getMonths_js_1.getMonths)(displayMonths, dates, props, dateLib);
    /** The Weeks displayed in the calendar. */
    const weeks = (0, getWeeks_js_1.getWeeks)(months);
    /** The Days displayed in the calendar. */
    const days = (0, getDays_js_1.getDays)(months);
    const previousMonth = (0, getPreviousMonth_js_1.getPreviousMonth)(firstMonth, navStart, props, dateLib);
    const nextMonth = (0, getNextMonth_js_1.getNextMonth)(firstMonth, navEnd, props, dateLib);
    const { disableNavigation, onMonthChange } = props;
    const isDayInCalendar = (day) => weeks.some((week) => week.days.some((d) => d.isEqualTo(day)));
    const goToMonth = (date) => {
        if (disableNavigation) {
            return;
        }
        let newMonth = startOfMonth(date);
        // if month is before start, use the first month instead
        if (navStart && newMonth < startOfMonth(navStart)) {
            newMonth = startOfMonth(navStart);
        }
        // if month is after endMonth, use the last month instead
        if (navEnd && newMonth > startOfMonth(navEnd)) {
            newMonth = startOfMonth(navEnd);
        }
        setFirstMonth(newMonth);
        onMonthChange?.(newMonth);
    };
    const goToDay = (day) => {
        // is this check necessary?
        if (isDayInCalendar(day)) {
            return;
        }
        goToMonth(day.date);
    };
    const calendar = {
        months,
        weeks,
        days,
        navStart,
        navEnd,
        previousMonth,
        nextMonth,
        goToMonth,
        goToDay,
    };
    return calendar;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvcmVhY3QtZGF5LXBpY2tlci9kaXN0L2Nqcy91c2VDYWxlbmRhci5qcyIsIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7QUFDYixNQUFNLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUM5RCxPQUFPLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztBQUNsQyxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDakMsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDdkQsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLHNCQUFzQixDQUFDLENBQUM7QUFDckQsTUFBTSxxQkFBcUIsR0FBRyxPQUFPLENBQUMsK0JBQStCLENBQUMsQ0FBQztBQUN2RSxNQUFNLG9CQUFvQixHQUFHLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0FBQ3JFLE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQ3pELE1BQU0sZ0JBQWdCLEdBQUcsT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFDN0QsTUFBTSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUMvRCxNQUFNLHFCQUFxQixHQUFHLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO0FBQ3ZFLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBQ3ZELE1BQU0sdUJBQXVCLEdBQUcsT0FBTyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7QUFDM0U7Ozs7Ozs7O0dBUUc7QUFDSCxTQUFTLFdBQVcsQ0FBQyxLQUFLLEVBQUUsT0FBTztJQUMvQixNQUFNLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxD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USxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsQyx3REFBd0Q7UUFDeEQsSUFBSSxRQUFRLElBQUksUUFBUSxHQUFHLFlBQVksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQ2hELFFBQVEsR0FBRyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUNELHlEQUF5RDtRQUN6RCxJQUFJLE1BQU0sSUFBSSxRQUFRLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7WUFDNUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNwQyxDQUFDO1FBQ0QsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hCLGFBQWEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzlCLENBQUMsQ0FBQztJQUNGLE1BQU0sT0FBTyxHQUFHLENBQUMsR0FBRyxFQUFFLEVBQUU7UUFDcEIsMkJBQTJCO1FBQzNCLElBQUksZUFBZSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDdkIsT0FBTztRQUNYLENBQUM7UUFDRCxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQztJQUNGLE1BQU0sUUFBUSxHQUFHO1FBQ2IsTUFBTTtRQUNOLEtBQUs7UUFDTCxJQUFJO1FBQ0osUUFBUTtRQUNSLE1BQU07UUFDTixhQUFhO1FBQ2IsU0FBUztRQUNULFNBQVM7UUFDVCxPQUFPO0tBQ1YsQ0FBQztJQUNGLE9BQU8sUUFBUSxDQUFDO0FBQ3BCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvcmVhY3QtZGF5LXBpY2tlci9kaXN0L2Nqcy91c2VDYWxlbmRhci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMudXNlQ2FsZW5kYXIgPSB1c2VDYWxlbmRhcjtcbmNvbnN0IHJlYWN0XzEgPSByZXF1aXJlKFwicmVhY3RcIik7XG5jb25zdCBnZXREYXRlc19qc18xID0gcmVxdWlyZShcIi4vaGVscGVycy9nZXREYXRlcy5qc1wiKTtcbmNvbnN0IGdldERheXNfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0RGF5cy5qc1wiKTtcbmNvbnN0IGdldERpc3BsYXlNb250aHNfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0RGlzcGxheU1vbnRocy5qc1wiKTtcbmNvbnN0IGdldEluaXRpYWxNb250aF9qc18xID0gcmVxdWlyZShcIi4vaGVscGVycy9nZXRJbml0aWFsTW9udGguanNcIik7XG5jb25zdCBnZXRNb250aHNfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0TW9udGhzLmpzXCIpO1xuY29uc3QgZ2V0TmF2TW9udGhfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0TmF2TW9udGguanNcIik7XG5jb25zdCBnZXROZXh0TW9udGhfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0TmV4dE1vbnRoLmpzXCIpO1xuY29uc3QgZ2V0UHJldmlvdXNNb250aF9qc18xID0gcmVxdWlyZShcIi4vaGVscGVycy9nZXRQcmV2aW91c01vbnRoLmpzXCIpO1xuY29uc3QgZ2V0V2Vla3NfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZ2V0V2Vla3MuanNcIik7XG5jb25zdCB1c2VDb250cm9sbGVkVmFsdWVfanNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvdXNlQ29udHJvbGxlZFZhbHVlLmpzXCIpO1xuLyoqXG4gKiBQcm92aWRlcyB0aGUgY2FsZW5kYXIgb2JqZWN0IHRvIHdvcmsgd2l0aCB0aGUgY2FsZW5kYXIgaW4gY3VzdG9tIGNvbXBvbmVudHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSBwcm9wcyAtIFRoZSBEYXlQaWNrZXIgcHJvcHMgcmVsYXRlZCB0byBjYWxlbmRhciBjb25maWd1cmF0aW9uLlxuICogQHBhcmFtIGRhdGVMaWIgLSBUaGUgZGF0ZSB1dGlsaXR5IGxpYnJhcnkgaW5zdGFuY2UuXG4gKiBAcmV0dXJucyBUaGUgY2FsZW5kYXIgb2JqZWN0IGNvbnRhaW5pbmcgZGlzcGxheWVkIGRheXMsIHdlZWtzLCBtb250aHMsIGFuZFxuICogICBuYXZpZ2F0aW9uIG1ldGhvZHMuXG4gKi9cbmZ1bmN0aW9uIHVzZUNhbGVuZGFyKHByb3BzLCBkYXRlTGliKSB7XG4gICAgY29uc3QgW25hdlN0YXJ0LCBuYXZFbmRdID0gKDAsIGdldE5hdk1vbnRoX2pzXzEuZ2V0TmF2TW9udGhzKShwcm9wcywgZGF0ZUxpYik7XG4gICAgY29uc3QgeyBzdGFydE9mTW9udGgsIGVuZE9mTW9udGggfSA9IGRhdGVMaWI7XG4gICAgY29uc3QgaW5pdGlhbE1vbnRoID0gKDAsIGdldEluaXRpYWxNb250aF9qc18xLmdldEluaXRpYWxNb250aCkocHJvcHMsIG5hdlN0YXJ0LCBuYXZFbmQsIGRhdGVMaWIpO1xuICAgIGNvbnN0IFtmaXJzdE1vbnRoLCBzZXRGaXJzdE1vbnRoXSA9ICgwLCB1c2VDb250cm9sbGVkVmFsdWVfanNfMS51c2VDb250cm9sbGVkVmFsdWUpKGluaXRpYWxNb250aCwgXG4gICAgLy8gaW5pdGlhbE1vbnRoIGlzIGFsd2F5cyBjb21wdXRlZCBmcm9tIHByb3BzLm1vbnRoIGlmIHByb3ZpZGVkXG4gICAgcHJvcHMubW9udGggPyBpbml0aWFsTW9udGggOiB1bmRlZmluZWQpO1xuICAgIC8vIGJpb21lLWlnbm9yZSBsaW50L2NvcnJlY3RuZXNzL3VzZUV4aGF1c3RpdmVEZXBlbmRlbmNpZXM6IGNoYW5nZSB0aGUgaW5pdGlhbCBtb250aCB3aGVuIHRoZSB0aW1lIHpvbmUgY2hhbmdlcy5cbiAgICAoMCwgcmVhY3RfMS51c2VFZmZlY3QpKCgpID0+IHtcbiAgICAgICAgY29uc3QgbmV3SW5pdGlhbE1vbnRoID0gKDAsIGdldEluaXRpYWxNb250aF9qc18xLmdldEluaXRpYWxNb250aCkocHJvcHMsIG5hdlN0YXJ0LCBuYXZFbmQsIGRhdGVMaWIpO1xuICAgICAgICBzZXRGaXJzdE1vbnRoKG5ld0luaXRpYWxNb250aCk7XG4gICAgfSwgW3Byb3BzLnRpbWVab25lXSk7XG4gICAgLyoqIFRoZSBtb250aHMgZGlzcGxheWVkIGluIHRoZSBjYWxlbmRhci4gKi9cbiAgICBjb25zdCBkaXNwbGF5TW9udGhzID0gKDAsIGdldERpc3BsYXlNb250aHNfanNfMS5nZXREaXNwbGF5TW9udGhzKShmaXJzdE1vbnRoLCBuYXZFbmQsIHByb3BzLCBkYXRlTGliKTtcbiAgICAvKiogVGhlIGRhdGVzIGRpc3BsYXllZCBpbiB0aGUgY2FsZW5kYXIuICovXG4gICAgY29uc3QgZGF0ZXMgPSAoMCwgZ2V0RGF0ZXNfanNfMS5nZXREYXRlcykoZGlzcGxheU1vbnRocywgcHJvcHMuZW5kTW9udGggPyBlbmRPZk1vbnRoKHByb3BzLmVuZE1vbnRoKSA6IHVuZGVmaW5lZCwgcHJvcHMsIGRhdGVMaWIpO1xuICAgIC8qKiBUaGUgTW9udGhzIGRpc3BsYXllZCBpbiB0aGUgY2FsZW5kYXIuICovXG4gICAgY29uc3QgbW9udGhzID0gKDAsIGdldE1vbnRoc19qc18xLmdldE1vbnRocykoZGlzcGxheU1vbnRocywgZGF0ZXMsIHByb3BzLCBkYXRlTGliKTtcbiAgICAvKiogVGhlIFdlZWtzIGRpc3BsYXllZCBpbiB0aGUgY2FsZW5kYXIuICovXG4gICAgY29uc3Qgd2Vla3MgPSAoMCwgZ2V0V2Vla3NfanNfMS5nZXRXZWVrcykobW9udGhzKTtcbiAgICAvKiogVGhlIERheXMgZGlzcGxheWVkIGluIHRoZSBjYWxlbmRhci4gKi9cbiAgICBjb25zdCBkYXlzID0gKDAsIGdldERheXNfanNfMS5nZXREYXlzKShtb250aHMpO1xuICAgIGNvbnN0IHByZXZpb3VzTW9udGggPSAoMCwgZ2V0UHJldmlvdXNNb250aF9qc18xLmdldFByZXZpb3VzTW9udGgpKGZpcnN0TW9udGgsIG5hdlN0YXJ0LCBwcm9wcywgZGF0ZUxpYik7XG4gICAgY29uc3QgbmV4dE1vbnRoID0gKDAsIGdldE5leHRNb250aF9qc18xLmdldE5leHRNb250aCkoZmlyc3RNb250aCwgbmF2RW5kLCBwcm9wcywgZGF0ZUxpYik7XG4gICAgY29uc3QgeyBkaXNhYmxlTmF2aWdhdGlvbiwgb25Nb250aENoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgaXNEYXlJbkNhbGVuZGFyID0gKGRheSkgPT4gd2Vla3Muc29tZSgod2VlaykgPT4gd2Vlay5kYXlzLnNvbWUoKGQpID0+IGQuaXNFcXVhbFRvKGRheSkpKTtcbiAgICBjb25zdCBnb1RvTW9udGggPSAoZGF0ZSkgPT4ge1xuICAgICAgICBpZiAoZGlzYWJsZU5hdmlnYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbmV3TW9udGggPSBzdGFydE9mTW9udGgoZGF0ZSk7XG4gICAgICAgIC8vIGlmIG1vbnRoIGlzIGJlZm9yZSBzdGFydCwgdXNlIHRoZSBmaXJzdCBtb250aCBpbnN0ZWFkXG4gICAgICAgIGlmIChuYXZTdGFydCAmJiBuZXdNb250aCA8IHN0YXJ0T2ZNb250aChuYXZTdGFydCkpIHtcbiAgICAgICAgICAgIG5ld01vbnRoID0gc3RhcnRPZk1vbnRoKG5hdlN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBtb250aCBpcyBhZnRlciBlbmRNb250aCwgdXNlIHRoZSBsYXN0IG1vbnRoIGluc3RlYWRcbiAgICAgICAgaWYgKG5hdkVuZCAmJiBuZXdNb250aCA+IHN0YXJ0T2ZNb250aChuYXZFbmQpKSB7XG4gICAgICAgICAgICBuZXdNb250aCA9IHN0YXJ0T2ZNb250aChuYXZFbmQpO1xuICAgICAgICB9XG4gICAgICAgIHNldEZpcnN0TW9udGgobmV3TW9udGgpO1xuICAgICAgICBvbk1vbnRoQ2hhbmdlPy4obmV3TW9udGgpO1xuICAgIH07XG4gICAgY29uc3QgZ29Ub0RheSA9IChkYXkpID0+IHtcbiAgICAgICAgLy8gaXMgdGhpcyBjaGVjayBuZWNlc3Nhcnk/XG4gICAgICAgIGlmIChpc0RheUluQ2FsZW5kYXIoZGF5KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGdvVG9Nb250aChkYXkuZGF0ZSk7XG4gICAgfTtcbiAgICBjb25zdCBjYWxlbmRhciA9IHtcbiAgICAgICAgbW9udGhzLFxuICAgICAgICB3ZWVrcyxcbiAgICAgICAgZGF5cyxcbiAgICAgICAgbmF2U3RhcnQsXG4gICAgICAgIG5hdkVuZCxcbiAgICAgICAgcHJldmlvdXNNb250aCxcbiAgICAgICAgbmV4dE1vbnRoLFxuICAgICAgICBnb1RvTW9udGgsXG4gICAgICAgIGdvVG9EYXksXG4gICAgfTtcbiAgICByZXR1cm4gY2FsZW5kYXI7XG59XG4iXSwidmVyc2lvbiI6M30=
fbbd7df57545b1f6089f74e372f7d8d7
'use strict';
require('../utils/dataTransfer/Clipboard.js');
var getWindow = require('../utils/misc/getWindow.js');
var eventMap = require('./eventMap.js');
const eventInitializer = {
    ClipboardEvent: [
        initClipboardEvent
    ],
    Event: [],
    FocusEvent: [
        initUIEvent,
        initFocusEvent
    ],
    InputEvent: [
        initUIEvent,
        initInputEvent
    ],
    MouseEvent: [
        initUIEvent,
        initUIEventModifiers,
        initMouseEvent
    ],
    PointerEvent: [
        initUIEvent,
        initUIEventModifiers,
        initMouseEvent,
        initPointerEvent
    ],
    KeyboardEvent: [
        initUIEvent,
        initUIEventModifiers,
        initKeyboardEvent
    ]
};
function createEvent(type, target, init) {
    const window = getWindow.getWindow(target);
    const { EventType, defaultInit } = eventMap.eventMap[type];
    const event = new (getEventConstructors(window))[EventType](type, defaultInit);
    eventInitializer[EventType].forEach((f) => f(event, init !== null && init !== undefined ? init : {}));
    return event;
}
/* istanbul ignore next */ function getEventConstructors(window) {
    var _window_Event;
    /* eslint-disable @typescript-eslint/no-unnecessary-condition, @typescript-eslint/no-extraneous-class */ const Event = (_window_Event = window.Event) !== null && _window_Event !== undefined ? _window_Event : class Event {
    };
    var _window_AnimationEvent;
    const AnimationEvent = (_window_AnimationEvent = window.AnimationEvent) !== null && _window_AnimationEvent !== undefined ? _window_AnimationEvent : class AnimationEvent extends Event {
    };
    var _window_ClipboardEvent;
    const ClipboardEvent = (_window_ClipboardEvent = window.ClipboardEvent) !== null && _window_ClipboardEvent !== undefined ? _window_ClipboardEvent : class ClipboardEvent extends Event {
    };
    var _window_PopStateEvent;
    const PopStateEvent = (_window_PopStateEvent = window.PopStateEvent) !== null && _window_PopStateEvent !== undefined ? _window_PopStateEvent : class PopStateEvent extends Event {
    };
    var _window_ProgressEvent;
    const ProgressEvent = (_window_ProgressEvent = window.ProgressEvent) !== null && _window_ProgressEvent !== undefined ? _window_ProgressEvent : class ProgressEvent extends Event {
    };
    var _window_TransitionEvent;
    const TransitionEvent = (_window_TransitionEvent = window.TransitionEvent) !== null && _window_TransitionEvent !== undefined ? _window_TransitionEvent : class TransitionEvent extends Event {
    };
    var _window_UIEvent;
    const UIEvent = (_window_UIEvent = window.UIEvent) !== null && _window_UIEvent !== undefined ? _window_UIEvent : class UIEvent extends Event {
    };
    var _window_CompositionEvent;
    const CompositionEvent = (_window_CompositionEvent = window.CompositionEvent) !== null && _window_CompositionEvent !== undefined ? _window_CompositionEvent : class CompositionEvent extends UIEvent {
    };
    var _window_FocusEvent;
    const FocusEvent = (_window_FocusEvent = window.FocusEvent) !== null && _window_FocusEvent !== undefined ? _window_FocusEvent : class FocusEvent extends UIEvent {
    };
    var _window_InputEvent;
    const InputEvent = (_window_InputEvent = window.InputEvent) !== null && _window_InputEvent !== undefined ? _window_InputEvent : class InputEvent extends UIEvent {
    };
    var _window_KeyboardEvent;
    const KeyboardEvent = (_window_KeyboardEvent = window.KeyboardEvent) !== null && _window_KeyboardEvent !== undefined ? _window_KeyboardEvent : class KeyboardEvent extends UIEvent {
    };
    var _window_MouseEvent;
    const MouseEvent = (_window_MouseEvent = window.MouseEvent) !== null && _window_MouseEvent !== undefined ? _window_MouseEvent : class MouseEvent extends UIEvent {
    };
    var _window_DragEvent;
    const DragEvent = (_window_DragEvent = window.DragEvent) !== null && _window_DragEvent !== undefined ? _window_DragEvent : class DragEvent extends MouseEvent {
    };
    var _window_PointerEvent;
    const PointerEvent = (_window_PointerEvent = window.PointerEvent) !== null && _window_PointerEvent !== undefined ? _window_PointerEvent : class PointerEvent extends MouseEvent {
    };
    var _window_TouchEvent;
    const TouchEvent = (_window_TouchEvent = window.TouchEvent) !== null && _window_TouchEvent !== undefined ? _window_TouchEvent : class TouchEvent extends UIEvent {
    };
    /* eslint-enable @typescript-eslint/no-unnecessary-condition, @typescript-eslint/no-extraneous-class */ return {
        Event,
        AnimationEvent,
        ClipboardEvent,
        PopStateEvent,
        ProgressEvent,
        TransitionEvent,
        UIEvent,
        CompositionEvent,
        FocusEvent,
        InputEvent,
        KeyboardEvent,
        MouseEvent,
        DragEvent,
        PointerEvent,
        TouchEvent
    };
}
function assignProps(obj, props) {
    for (const [key, value] of Object.entries(props)) {
        Object.defineProperty(obj, key, {
            get: () => value !== null && value !== undefined ? value : null
        });
    }
}
function sanitizeNumber(n) {
    return Number(n !== null && n !== undefined ? n : 0);
}
function initClipboardEvent(event, { clipboardData }) {
    assignProps(event, {
        clipboardData
    });
}
function initFocusEvent(event, { relatedTarget }) {
    assignProps(event, {
        relatedTarget
    });
}
function initInputEvent(event, { data, inputType, isComposing }) {
    assignProps(event, {
        data,
        isComposing: Boolean(isComposing),
        inputType: String(inputType)
    });
}
function initUIEvent(event, { view, detail }) {
    assignProps(event, {
        view,
        detail: sanitizeNumber(detail !== null && detail !== undefined ? detail : 0)
    });
}
function initUIEventModifiers(event, { altKey, ctrlKey, metaKey, shiftKey, modifierAltGraph, modifierCapsLock, modifierFn, modifierFnLock, modifierNumLock, modifierScrollLock, modifierSymbol, modifierSymbolLock }) {
    assignProps(event, {
        altKey: Boolean(altKey),
        ctrlKey: Boolean(ctrlKey),
        metaKey: Boolean(metaKey),
        shiftKey: Boolean(shiftKey),
        getModifierState(k) {
            return Boolean({
                Alt: altKey,
                AltGraph: modifierAltGraph,
                CapsLock: modifierCapsLock,
                Control: ctrlKey,
                Fn: modifierFn,
                FnLock: modifierFnLock,
                Meta: metaKey,
                NumLock: modifierNumLock,
                ScrollLock: modifierScrollLock,
                Shift: shiftKey,
                Symbol: modifierSymbol,
                SymbolLock: modifierSymbolLock
            }[k]);
        }
    });
}
function initKeyboardEvent(event, { key, code, location, repeat, isComposing, charCode }) {
    assignProps(event, {
        key: String(key),
        code: String(code),
        location: sanitizeNumber(location),
        repeat: Boolean(repeat),
        isComposing: Boolean(isComposing),
        charCode
    });
}
function initMouseEvent(event, { x, y, screenX, screenY, clientX = x, clientY = y, button, buttons, relatedTarget, offsetX, offsetY, pageX, pageY }) {
    assignProps(event, {
        screenX: sanitizeNumber(screenX),
        screenY: sanitizeNumber(screenY),
        clientX: sanitizeNumber(clientX),
        x: sanitizeNumber(clientX),
        clientY: sanitizeNumber(clientY),
        y: sanitizeNumber(clientY),
        button: sanitizeNumber(button),
        buttons: sanitizeNumber(buttons),
        relatedTarget,
        offsetX: sanitizeNumber(offsetX),
        offsetY: sanitizeNumber(offsetY),
        pageX: sanitizeNumber(pageX),
        pageY: sanitizeNumber(pageY)
    });
}
function initPointerEvent(event, { pointerId, width, height, pressure, tangentialPressure, tiltX, tiltY, twist, pointerType, isPrimary }) {
    assignProps(event, {
        pointerId: sanitizeNumber(pointerId),
        width: sanitizeNumber(width !== null && width !== undefined ? width : 1),
        height: sanitizeNumber(height !== null && height !== undefined ? height : 1),
        pressure: sanitizeNumber(pressure),
        tangentialPressure: sanitizeNumber(tangentialPressure),
        tiltX: sanitizeNumber(tiltX),
        tiltY: sanitizeNumber(tiltY),
        twist: sanitizeNumber(twist),
        pointerType: String(pointerType),
        isPrimary: Boolean(isPrimary)
    });
}
exports.createEvent = createEvent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50L2Rpc3QvY2pzL2V2ZW50L2NyZWF0ZUV2ZW50LmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLE9BQU8sQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0FBQzlDLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0FBQ3RELElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUV4QyxNQUFNLGdCQUFnQixHQUFHO0lBQ3JCLGNBQWMsRUFBRTtRQUNaLGtCQUFrQjtLQUNyQjtJQUNELEtBQUssRUFBRSxFQUFFO0lBQ1QsVUFBVSxFQUFFO1FBQ1IsV0FBVztRQUNYLGNBQWM7S0FDakI7SUFDRCxVQUFVLEVBQUU7UUFDUixXQUFXO1FBQ1gsY0FBYztLQUNqQjtJQUNELFVBQVUsRUFBRTtRQUNSLFdBQVc7UUFDWCxvQkFBb0I7UUFDcEIsY0FBYztLQUNqQjtJQUNELFlBQVksRUFBRTtRQUNWLFdBQVc7UUFDWCxvQkFBb0I7UUFDcEIsY0FBYztRQUNkLGdCQUFnQjtLQUNuQjtJQUNELGFBQWEsRUFBRTtRQUNYLFdBQVc7UUFDWCxvQkFBb0I7UUFDcEIsaUJBQWlCO0tBQ3BCO0NBQ0osQ0FBQztBQUNGLFNBQVMsV0FBVyxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSTtJQUNuQyxNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzNDLE1BQU0sRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzRCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDL0UsZ0JBQWdCLENBQUMs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LENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzVFLFFBQVEsRUFBRSxjQUFjLENBQUMsUUFBUSxDQUFDO1FBQ2xDLGtCQUFrQixFQUFFLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQztRQUN0RCxLQUFLLEVBQUUsY0FBYyxDQUFDLEtBQUssQ0FBQztRQUM1QixLQUFLLEVBQUUsY0FBYyxDQUFDLEtBQUssQ0FBQztRQUM1QixLQUFLLEVBQUUsY0FBYyxDQUFDLEtBQUssQ0FBQztRQUM1QixXQUFXLEVBQUUsTUFBTSxDQUFDLFdBQVcsQ0FBQztRQUNoQyxTQUFTLEVBQUUsT0FBTyxDQUFDLFNBQVMsQ0FBQztLQUNoQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQsT0FBTyxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50L2Rpc3QvY2pzL2V2ZW50L2NyZWF0ZUV2ZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxucmVxdWlyZSgnLi4vdXRpbHMvZGF0YVRyYW5zZmVyL0NsaXBib2FyZC5qcycpO1xudmFyIGdldFdpbmRvdyA9IHJlcXVpcmUoJy4uL3V0aWxzL21pc2MvZ2V0V2luZG93LmpzJyk7XG52YXIgZXZlbnRNYXAgPSByZXF1aXJlKCcuL2V2ZW50TWFwLmpzJyk7XG5cbmNvbnN0IGV2ZW50SW5pdGlhbGl6ZXIgPSB7XG4gICAgQ2xpcGJvYXJkRXZlbnQ6IFtcbiAgICAgICAgaW5pdENsaXBib2FyZEV2ZW50XG4gICAgXSxcbiAgICBFdmVudDogW10sXG4gICAgRm9jdXNFdmVudDogW1xuICAgICAgICBpbml0VUlFdmVudCxcbiAgICAgICAgaW5pdEZvY3VzRXZlbnRcbiAgICBdLFxuICAgIElucHV0RXZlbnQ6IFtcbiAgICAgICAgaW5pdFVJRXZlbnQsXG4gICAgICAgIGluaXRJbnB1dEV2ZW50XG4gICAgXSxcbiAgICBNb3VzZUV2ZW50OiBbXG4gICAgICAgIGluaXRVSUV2ZW50LFxuICAgICAgICBpbml0VUlFdmVudE1vZGlmaWVycyxcbiAgICAgICAgaW5pdE1vdXNlRXZlbnRcbiAgICBdLFxuICAgIFBvaW50ZXJFdmVudDogW1xuICAgICAgICBpbml0VUlFdmVudCxcbiAgICAgICAgaW5pdFVJRXZlbnRNb2RpZmllcnMsXG4gICAgICAgIGluaXRNb3VzZUV2ZW50LFxuICAgICAgICBpbml0UG9pbnRlckV2ZW50XG4gICAgXSxcbiAgICBLZXlib2FyZEV2ZW50OiBbXG4gICAgICAgIGluaXRVSUV2ZW50LFxuICAgICAgICBpbml0VUlFdmVudE1vZGlmaWVycyxcbiAgICAgICAgaW5pdEtleWJvYXJkRXZlbnRcbiAgICBdXG59O1xuZnVuY3Rpb24gY3JlYXRlRXZlbnQodHlwZSwgdGFyZ2V0LCBpbml0KSB7XG4gICAgY29uc3Qgd2luZG93ID0gZ2V0V2luZG93LmdldFdpbmRvdyh0YXJnZXQpO1xuICAgIGNvbnN0IHsgRXZlbnRUeXBlLCBkZWZhdWx0SW5pdCB9ID0gZXZlbnRNYXAuZXZlbnRNYXBbdHlwZV07XG4gICAgY29uc3QgZXZlbnQgPSBuZXcgKGdldEV2ZW50Q29uc3RydWN0b3JzKHdpbmRvdykpW0V2ZW50VHlwZV0odHlwZSwgZGVmYXVsdEluaXQpO1xuICAgIGV2ZW50SW5pdGlhbGl6ZXJbRXZlbnRUeXBlXS5mb3JFYWNoKChmKT0+ZihldmVudCwgaW5pdCAhPT0gbnVsbCAmJiBpbml0ICE9PSB1bmRlZmluZWQgPyBpbml0IDoge30pKTtcbiAgICByZXR1cm4gZXZlbnQ7XG59XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyBmdW5jdGlvbiBnZXRFdmVudENvbnN0cnVjdG9ycyh3aW5kb3cpIHtcbiAgICB2YXIgX3dpbmRvd19FdmVudDtcbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5uZWNlc3NhcnktY29uZGl0aW9uLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXh0cmFuZW91cy1jbGFzcyAqLyBjb25zdCBFdmVudCA9IChfd2luZG93X0V2ZW50ID0gd2luZG93LkV2ZW50KSAhPT0gbnVsbCAmJiBfd2luZG93X0V2ZW50ICE9PSB1bmRlZmluZWQgPyBfd2luZG93X0V2ZW50IDogY2xhc3MgRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfQW5pbWF0aW9uRXZlbnQ7XG4gICAgY29uc3QgQW5pbWF0aW9uRXZlbnQgPSAoX3dpbmRvd19BbmltYXRpb25FdmVudCA9IHdpbmRvdy5BbmltYXRpb25FdmVudCkgIT09IG51bGwgJiYgX3dpbmRvd19BbmltYXRpb25FdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19BbmltYXRpb25FdmVudCA6IGNsYXNzIEFuaW1hdGlvbkV2ZW50IGV4dGVuZHMgRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfQ2xpcGJvYXJkRXZlbnQ7XG4gICAgY29uc3QgQ2xpcGJvYXJkRXZlbnQgPSAoX3dpbmRvd19DbGlwYm9hcmRFdmVudCA9IHdpbmRvdy5DbGlwYm9hcmRFdmVudCkgIT09IG51bGwgJiYgX3dpbmRvd19DbGlwYm9hcmRFdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19DbGlwYm9hcmRFdmVudCA6IGNsYXNzIENsaXBib2FyZEV2ZW50IGV4dGVuZHMgRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfUG9wU3RhdGVFdmVudDtcbiAgICBjb25zdCBQb3BTdGF0ZUV2ZW50ID0gKF93aW5kb3dfUG9wU3RhdGVFdmVudCA9IHdpbmRvdy5Qb3BTdGF0ZUV2ZW50KSAhPT0gbnVsbCAmJiBfd2luZG93X1BvcFN0YXRlRXZlbnQgIT09IHVuZGVmaW5lZCA/IF93aW5kb3dfUG9wU3RhdGVFdmVudCA6IGNsYXNzIFBvcFN0YXRlRXZlbnQgZXh0ZW5kcyBFdmVudCB7XG4gICAgfTtcbiAgICB2YXIgX3dpbmRvd19Qcm9ncmVzc0V2ZW50O1xuICAgIGNvbnN0IFByb2dyZXNzRXZlbnQgPSAoX3dpbmRvd19Qcm9ncmVzc0V2ZW50ID0gd2luZG93LlByb2dyZXNzRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfUHJvZ3Jlc3NFdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19Qcm9ncmVzc0V2ZW50IDogY2xhc3MgUHJvZ3Jlc3NFdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgICB9O1xuICAgIHZhciBfd2luZG93X1RyYW5zaXRpb25FdmVudDtcbiAgICBjb25zdCBUcmFuc2l0aW9uRXZlbnQgPSAoX3dpbmRvd19UcmFuc2l0aW9uRXZlbnQgPSB3aW5kb3cuVHJhbnNpdGlvbkV2ZW50KSAhPT0gbnVsbCAmJiBfd2luZG93X1RyYW5zaXRpb25FdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19UcmFuc2l0aW9uRXZlbnQgOiBjbGFzcyBUcmFuc2l0aW9uRXZlbnQgZXh0ZW5kcyBFdmVudCB7XG4gICAgfTtcbiAgICB2YXIgX3dpbmRvd19VSUV2ZW50O1xuICAgIGNvbnN0IFVJRXZlbnQgPSAoX3dpbmRvd19VSUV2ZW50ID0gd2luZG93LlVJRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfVUlFdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19VSUV2ZW50IDogY2xhc3MgVUlFdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgICB9O1xuICAgIHZhciBfd2luZG93X0NvbXBvc2l0aW9uRXZlbnQ7XG4gICAgY29uc3QgQ29tcG9zaXRpb25FdmVudCA9IChfd2luZG93X0NvbXBvc2l0aW9uRXZlbnQgPSB3aW5kb3cuQ29tcG9zaXRpb25FdmVudCkgIT09IG51bGwgJiYgX3dpbmRvd19Db21wb3NpdGlvbkV2ZW50ICE9PSB1bmRlZmluZWQgPyBfd2luZG93X0NvbXBvc2l0aW9uRXZlbnQgOiBjbGFzcyBDb21wb3NpdGlvbkV2ZW50IGV4dGVuZHMgVUlFdmVudCB7XG4gICAgfTtcbiAgICB2YXIgX3dpbmRvd19Gb2N1c0V2ZW50O1xuICAgIGNvbnN0IEZvY3VzRXZlbnQgPSAoX3dpbmRvd19Gb2N1c0V2ZW50ID0gd2luZG93LkZvY3VzRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfRm9jdXNFdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19Gb2N1c0V2ZW50IDogY2xhc3MgRm9jdXNFdmVudCBleHRlbmRzIFVJRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfSW5wdXRFdmVudDtcbiAgICBjb25zdCBJbnB1dEV2ZW50ID0gKF93aW5kb3dfSW5wdXRFdmVudCA9IHdpbmRvdy5JbnB1dEV2ZW50KSAhPT0gbnVsbCAmJiBfd2luZG93X0lucHV0RXZlbnQgIT09IHVuZGVmaW5lZCA/IF93aW5kb3dfSW5wdXRFdmVudCA6IGNsYXNzIElucHV0RXZlbnQgZXh0ZW5kcyBVSUV2ZW50IHtcbiAgICB9O1xuICAgIHZhciBfd2luZG93X0tleWJvYXJkRXZlbnQ7XG4gICAgY29uc3QgS2V5Ym9hcmRFdmVudCA9IChfd2luZG93X0tleWJvYXJkRXZlbnQgPSB3aW5kb3cuS2V5Ym9hcmRFdmVudCkgIT09IG51bGwgJiYgX3dpbmRvd19LZXlib2FyZEV2ZW50ICE9PSB1bmRlZmluZWQgPyBfd2luZG93X0tleWJvYXJkRXZlbnQgOiBjbGFzcyBLZXlib2FyZEV2ZW50IGV4dGVuZHMgVUlFdmVudCB7XG4gICAgfTtcbiAgICB2YXIgX3dpbmRvd19Nb3VzZUV2ZW50O1xuICAgIGNvbnN0IE1vdXNlRXZlbnQgPSAoX3dpbmRvd19Nb3VzZUV2ZW50ID0gd2luZG93Lk1vdXNlRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfTW91c2VFdmVudCAhPT0gdW5kZWZpbmVkID8gX3dpbmRvd19Nb3VzZUV2ZW50IDogY2xhc3MgTW91c2VFdmVudCBleHRlbmRzIFVJRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfRHJhZ0V2ZW50O1xuICAgIGNvbnN0IERyYWdFdmVudCA9IChfd2luZG93X0RyYWdFdmVudCA9IHdpbmRvdy5EcmFnRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfRHJhZ0V2ZW50ICE9PSB1bmRlZmluZWQgPyBfd2luZG93X0RyYWdFdmVudCA6IGNsYXNzIERyYWdFdmVudCBleHRlbmRzIE1vdXNlRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfUG9pbnRlckV2ZW50O1xuICAgIGNvbnN0IFBvaW50ZXJFdmVudCA9IChfd2luZG93X1BvaW50ZXJFdmVudCA9IHdpbmRvdy5Qb2ludGVyRXZlbnQpICE9PSBudWxsICYmIF93aW5kb3dfUG9pbnRlckV2ZW50ICE9PSB1bmRlZmluZWQgPyBfd2luZG93X1BvaW50ZXJFdmVudCA6IGNsYXNzIFBvaW50ZXJFdmVudCBleHRlbmRzIE1vdXNlRXZlbnQge1xuICAgIH07XG4gICAgdmFyIF93aW5kb3dfVG91Y2hFdmVudDtcbiAgICBjb25zdCBUb3VjaEV2ZW50ID0gKF93aW5kb3dfVG91Y2hFdmVudCA9IHdpbmRvdy5Ub3VjaEV2ZW50KSAhPT0gbnVsbCAmJiBfd2luZG93X1RvdWNoRXZlbnQgIT09IHVuZGVmaW5lZCA/IF93aW5kb3dfVG91Y2hFdmVudCA6IGNsYXNzIFRvdWNoRXZlbnQgZXh0ZW5kcyBVSUV2ZW50IHtcbiAgICB9O1xuICAgIC8qIGVzbGludC1lbmFibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LWNvbmRpdGlvbiwgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4dHJhbmVvdXMtY2xhc3MgKi8gcmV0dXJuIHtcbiAgICAgICAgRXZlbnQsXG4gICAgICAgIEFuaW1hdGlvbkV2ZW50LFxuICAgICAgICBDbGlwYm9hcmRFdmVudCxcbiAgICAgICAgUG9wU3RhdGVFdmVudCxcbiAgICAgICAgUHJvZ3Jlc3NFdmVudCxcbiAgICAgICAgVHJhbnNpdGlvbkV2ZW50LFxuICAgICAgICBVSUV2ZW50LFxuICAgICAgICBDb21wb3NpdGlvbkV2ZW50LFxuICAgICAgICBGb2N1c0V2ZW50LFxuICAgICAgICBJbnB1dEV2ZW50LFxuICAgICAgICBLZXlib2FyZEV2ZW50LFxuICAgICAgICBNb3VzZUV2ZW50LFxuICAgICAgICBEcmFnRXZlbnQsXG4gICAgICAgIFBvaW50ZXJFdmVudCxcbiAgICAgICAgVG91Y2hFdmVudFxuICAgIH07XG59XG5mdW5jdGlvbiBhc3NpZ25Qcm9wcyhvYmosIHByb3BzKSB7XG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocHJvcHMpKXtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgICAgICBnZXQ6ICgpPT52YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBudWxsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNhbml0aXplTnVtYmVyKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gIT09IG51bGwgJiYgbiAhPT0gdW5kZWZpbmVkID8gbiA6IDApO1xufVxuZnVuY3Rpb24gaW5pdENsaXBib2FyZEV2ZW50KGV2ZW50LCB7IGNsaXBib2FyZERhdGEgfSkge1xuICAgIGFzc2lnblByb3BzKGV2ZW50LCB7XG4gICAgICAgIGNsaXBib2FyZERhdGFcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRGb2N1c0V2ZW50KGV2ZW50LCB7IHJlbGF0ZWRUYXJnZXQgfSkge1xuICAgIGFzc2lnblByb3BzKGV2ZW50LCB7XG4gICAgICAgIHJlbGF0ZWRUYXJnZXRcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRJbnB1dEV2ZW50KGV2ZW50LCB7IGRhdGEsIGlucHV0VHlwZSwgaXNDb21wb3NpbmcgfSkge1xuICAgIGFzc2lnblByb3BzKGV2ZW50LCB7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIGlzQ29tcG9zaW5nOiBCb29sZWFuKGlzQ29tcG9zaW5nKSxcbiAgICAgICAgaW5wdXRUeXBlOiBTdHJpbmcoaW5wdXRUeXBlKVxuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5pdFVJRXZlbnQoZXZlbnQsIHsgdmlldywgZGV0YWlsIH0pIHtcbiAgICBhc3NpZ25Qcm9wcyhldmVudCwge1xuICAgICAgICB2aWV3LFxuICAgICAgICBkZXRhaWw6IHNhbml0aXplTnVtYmVyKGRldGFpbCAhPT0gbnVsbCAmJiBkZXRhaWwgIT09IHVuZGVmaW5lZCA/IGRldGFpbCA6IDApXG4gICAgfSk7XG59XG5mdW5jdGlvbiBpbml0VUlFdmVudE1vZGlmaWVycyhldmVudCwgeyBhbHRLZXksIGN0cmxLZXksIG1ldGFLZXksIHNoaWZ0S2V5LCBtb2RpZmllckFsdEdyYXBoLCBtb2RpZmllckNhcHNMb2NrLCBtb2RpZmllckZuLCBtb2RpZmllckZuTG9jaywgbW9kaWZpZXJOdW1Mb2NrLCBtb2RpZmllclNjcm9sbExvY2ssIG1vZGlmaWVyU3ltYm9sLCBtb2RpZmllclN5bWJvbExvY2sgfSkge1xuICAgIGFzc2lnblByb3BzKGV2ZW50LCB7XG4gICAgICAgIGFsdEtleTogQm9vbGVhbihhbHRLZXkpLFxuICAgICAgICBjdHJsS2V5OiBCb29sZWFuKGN0cmxLZXkpLFxuICAgICAgICBtZXRhS2V5OiBCb29sZWFuKG1ldGFLZXkpLFxuICAgICAgICBzaGlmdEtleTogQm9vbGVhbihzaGlmdEtleSksXG4gICAgICAgIGdldE1vZGlmaWVyU3RhdGUgKGspIHtcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHtcbiAgICAgICAgICAgICAgICBBbHQ6IGFsdEtleSxcbiAgICAgICAgICAgICAgICBBbHRHcmFwaDogbW9kaWZpZXJBbHRHcmFwaCxcbiAgICAgICAgICAgICAgICBDYXBzTG9jazogbW9kaWZpZXJDYXBzTG9jayxcbiAgICAgICAgICAgICAgICBDb250cm9sOiBjdHJsS2V5LFxuICAgICAgICAgICAgICAgIEZuOiBtb2RpZmllckZuLFxuICAgICAgICAgICAgICAgIEZuTG9jazogbW9kaWZpZXJGbkxvY2ssXG4gICAgICAgICAgICAgICAgTWV0YTogbWV0YUtleSxcbiAgICAgICAgICAgICAgICBOdW1Mb2NrOiBtb2RpZmllck51bUxvY2ssXG4gICAgICAgICAgICAgICAgU2Nyb2xsTG9jazogbW9kaWZpZXJTY3JvbGxMb2NrLFxuICAgICAgICAgICAgICAgIFNoaWZ0OiBzaGlmdEtleSxcbiAgICAgICAgICAgICAgICBTeW1ib2w6IG1vZGlmaWVyU3ltYm9sLFxuICAgICAgICAgICAgICAgIFN5bWJvbExvY2s6IG1vZGlmaWVyU3ltYm9sTG9ja1xuICAgICAgICAgICAgfVtrXSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRLZXlib2FyZEV2ZW50KGV2ZW50LCB7IGtleSwgY29kZSwgbG9jYXRpb24sIHJlcGVhdCwgaXNDb21wb3NpbmcsIGNoYXJDb2RlIH0pIHtcbiAgICBhc3NpZ25Qcm9wcyhldmVudCwge1xuICAgICAgICBrZXk6IFN0cmluZyhrZXkpLFxuICAgICAgICBjb2RlOiBTdHJpbmcoY29kZSksXG4gICAgICAgIGxvY2F0aW9uOiBzYW5pdGl6ZU51bWJlcihsb2NhdGlvbiksXG4gICAgICAgIHJlcGVhdDogQm9vbGVhbihyZXBlYXQpLFxuICAgICAgICBpc0NvbXBvc2luZzogQm9vbGVhbihpc0NvbXBvc2luZyksXG4gICAgICAgIGNoYXJDb2RlXG4gICAgfSk7XG59XG5mdW5jdGlvbiBpbml0TW91c2VFdmVudChldmVudCwgeyB4LCB5LCBzY3JlZW5YLCBzY3JlZW5ZLCBjbGllbnRYID0geCwgY2xpZW50WSA9IHksIGJ1dHRvbiwgYnV0dG9ucywgcmVsYXRlZFRhcmdldCwgb2Zmc2V0WCwgb2Zmc2V0WSwgcGFnZVgsIHBhZ2VZIH0pIHtcbiAgICBhc3NpZ25Qcm9wcyhldmVudCwge1xuICAgICAgICBzY3JlZW5YOiBzYW5pdGl6ZU51bWJlcihzY3JlZW5YKSxcbiAgICAgICAgc2NyZWVuWTogc2FuaXRpemVOdW1iZXIoc2NyZWVuWSksXG4gICAgICAgIGNsaWVudFg6IHNhbml0aXplTnVtYmVyKGNsaWVudFgpLFxuICAgICAgICB4OiBzYW5pdGl6ZU51bWJlcihjbGllbnRYKSxcbiAgICAgICAgY2xpZW50WTogc2FuaXRpemVOdW1iZXIoY2xpZW50WSksXG4gICAgICAgIHk6IHNhbml0aXplTnVtYmVyKGNsaWVudFkpLFxuICAgICAgICBidXR0b246IHNhbml0aXplTnVtYmVyKGJ1dHRvbiksXG4gICAgICAgIGJ1dHRvbnM6IHNhbml0aXplTnVtYmVyKGJ1dHRvbnMpLFxuICAgICAgICByZWxhdGVkVGFyZ2V0LFxuICAgICAgICBvZmZzZXRYOiBzYW5pdGl6ZU51bWJlcihvZmZzZXRYKSxcbiAgICAgICAgb2Zmc2V0WTogc2FuaXRpemVOdW1iZXIob2Zmc2V0WSksXG4gICAgICAgIHBhZ2VYOiBzYW5pdGl6ZU51bWJlcihwYWdlWCksXG4gICAgICAgIHBhZ2VZOiBzYW5pdGl6ZU51bWJlcihwYWdlWSlcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRQb2ludGVyRXZlbnQoZXZlbnQsIHsgcG9pbnRlcklkLCB3aWR0aCwgaGVpZ2h0LCBwcmVzc3VyZSwgdGFuZ2VudGlhbFByZXNzdXJlLCB0aWx0WCwgdGlsdFksIHR3aXN0LCBwb2ludGVyVHlwZSwgaXNQcmltYXJ5IH0pIHtcbiAgICBhc3NpZ25Qcm9wcyhldmVudCwge1xuICAgICAgICBwb2ludGVySWQ6IHNhbml0aXplTnVtYmVyKHBvaW50ZXJJZCksXG4gICAgICAgIHdpZHRoOiBzYW5pdGl6ZU51bWJlcih3aWR0aCAhPT0gbnVsbCAmJiB3aWR0aCAhPT0gdW5kZWZpbmVkID8gd2lkdGggOiAxKSxcbiAgICAgICAgaGVpZ2h0OiBzYW5pdGl6ZU51bWJlcihoZWlnaHQgIT09IG51bGwgJiYgaGVpZ2h0ICE9PSB1bmRlZmluZWQgPyBoZWlnaHQgOiAxKSxcbiAgICAgICAgcHJlc3N1cmU6IHNhbml0aXplTnVtYmVyKHByZXNzdXJlKSxcbiAgICAgICAgdGFuZ2VudGlhbFByZXNzdXJlOiBzYW5pdGl6ZU51bWJlcih0YW5nZW50aWFsUHJlc3N1cmUpLFxuICAgICAgICB0aWx0WDogc2FuaXRpemVOdW1iZXIodGlsdFgpLFxuICAgICAgICB0aWx0WTogc2FuaXRpemVOdW1iZXIodGlsdFkpLFxuICAgICAgICB0d2lzdDogc2FuaXRpemVOdW1iZXIodHdpc3QpLFxuICAgICAgICBwb2ludGVyVHlwZTogU3RyaW5nKHBvaW50ZXJUeXBlKSxcbiAgICAgICAgaXNQcmltYXJ5OiBCb29sZWFuKGlzUHJpbWFyeSlcbiAgICB9KTtcbn1cblxuZXhwb3J0cy5jcmVhdGVFdmVudCA9IGNyZWF0ZUV2ZW50O1xuIl0sInZlcnNpb24iOjN9
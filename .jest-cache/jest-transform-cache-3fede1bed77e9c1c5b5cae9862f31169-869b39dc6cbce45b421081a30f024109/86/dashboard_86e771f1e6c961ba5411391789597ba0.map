{"file":"/home/runner/workspace/client/src/pages/residents/dashboard.tsx","mappings":"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","names":[],"sources":["/home/runner/workspace/client/src/pages/residents/dashboard.tsx"],"sourcesContent":["import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Header } from '@/components/layout/header';\nimport { useLanguage } from '@/hooks/use-language';\nimport { useFullscreen } from '@/hooks/use-fullscreen';\nimport { useQuery } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { DocumentCard } from '@/components/document-management';\nimport { useState } from 'react';\nimport {\n  Maximize2,\n  Minimize2,\n  Home,\n  FileText,\n  Wrench,\n  DollarSign,\n  MessageSquare,\n  ArrowRight,\n} from 'lucide-react';\n\n/**\n * Residents Dashboard - Main dashboard for residents.\n */\nexport default function ResidentsDashboard() {\n  const { isFullscreen, toggleFullscreen } = useFullscreen();\n  const { language } = useLanguage();\n  // Modal state removed - using simple document opening instead\n\n  // Fetch recent documents (limit to 3 for dashboard)\n  const { data: documents = [] } = useQuery({\n    queryKey: ['/api/documents', 'recent'],\n    queryFn: () => apiRequest('GET', '/api/documents?limit=3'),\n  });\n\n  const handleDocumentView = async (documentId: string) => {\n    try {\n      // Use fetch with credentials to ensure authentication\n      const response = await fetch(`/api/documents/${documentId}/file`, {\n        method: 'GET',\n        credentials: 'include', // Include authentication cookies\n      });\n\n      if (!response.ok) {\n        throw new Error(`View failed: ${response.status} ${response.statusText}`);\n      }\n\n      // Convert response to blob and open in new tab\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      \n      // Open in new tab\n      window.open(url, '_blank');\n      \n      // Clean up the URL after a delay to allow the tab to load\n      setTimeout(() => {\n        window.URL.revokeObjectURL(url);\n      }, 1000);\n      \n    } catch (error) {\n      console.error('View failed:', error);\n      // Could add toast notification here if needed\n    }\n  };\n\n  return (\n    <div className='flex-1 flex flex-col overflow-hidden'>\n      <Header\n        title='Welcome Back'\n        subtitle='Your personal residence dashboard - manage your home and stay connected with your building community'\n      />\n\n      <div className='flex-1 overflow-auto p-6'>\n        <div className='max-w-7xl mx-auto space-y-6'>\n          {/* Fullscreen Controls */}\n          <div className='flex justify-end mb-4'>\n            <Button\n              variant='outline'\n              size='sm'\n              onClick={toggleFullscreen}\n              className='flex items-center gap-2'\n              data-testid='button-fullscreen-toggle'\n            >\n              {isFullscreen ? (\n                <>\n                  <Minimize2 className='w-4 h-4' />\n                  <span className='hidden sm:inline'>Exit Fullscreen</span>\n                </>\n              ) : (\n                <>\n                  <Maximize2 className='w-4 h-4' />\n                  <span className='hidden sm:inline'>Fullscreen</span>\n                </>\n              )}\n            </Button>\n          </div>\n\n          {/* Quick Actions Grid */}\n          <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4'>\n            <Card className='cursor-pointer hover:shadow-md transition-shadow'>\n              <CardHeader className='flex flex-row items-center justify-between space-y-0 pb-2'>\n                <CardTitle className='text-sm font-medium'>My Home</CardTitle>\n                <Home className='h-4 w-4 text-muted-foreground' />\n              </CardHeader>\n              <CardContent>\n                <div className='text-2xl font-bold'>Unit 4B</div>\n                <p className='text-xs text-muted-foreground'>Building status: Good</p>\n              </CardContent>\n            </Card>\n\n            <Card className='cursor-pointer hover:shadow-md transition-shadow'>\n              <CardHeader className='flex flex-row items-center justify-between space-y-0 pb-2'>\n                <CardTitle className='text-sm font-medium'>Documents</CardTitle>\n                <FileText className='h-4 w-4 text-muted-foreground' />\n              </CardHeader>\n              <CardContent>\n                <div className='text-2xl font-bold'>{documents.length}</div>\n                <p className='text-xs text-muted-foreground'>Recent documents</p>\n              </CardContent>\n            </Card>\n\n            <Card className='cursor-pointer hover:shadow-md transition-shadow'>\n              <CardHeader className='flex flex-row items-center justify-between space-y-0 pb-2'>\n                <CardTitle className='text-sm font-medium'>Maintenance</CardTitle>\n                <Wrench className='h-4 w-4 text-muted-foreground' />\n              </CardHeader>\n              <CardContent>\n                <div className='text-2xl font-bold'>1</div>\n                <p className='text-xs text-muted-foreground'>Active request</p>\n              </CardContent>\n            </Card>\n\n            <Card className='cursor-pointer hover:shadow-md transition-shadow'>\n              <CardHeader className='flex flex-row items-center justify-between space-y-0 pb-2'>\n                <CardTitle className='text-sm font-medium'>Bills</CardTitle>\n                <DollarSign className='h-4 w-4 text-muted-foreground' />\n              </CardHeader>\n              <CardContent>\n                <div className='text-2xl font-bold'>$1,250</div>\n                <p className='text-xs text-muted-foreground'>Next payment due</p>\n              </CardContent>\n            </Card>\n\n            <Card className='cursor-pointer hover:shadow-md transition-shadow'>\n              <CardHeader className='flex flex-row items-center justify-between space-y-0 pb-2'>\n                <CardTitle className='text-sm font-medium'>Messages</CardTitle>\n                <MessageSquare className='h-4 w-4 text-muted-foreground' />\n              </CardHeader>\n              <CardContent>\n                <div className='text-2xl font-bold'>2</div>\n                <p className='text-xs text-muted-foreground'>Unread messages</p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Recent Documents Section */}\n          {documents.length > 0 && (\n            <div className='mb-6'>\n              <div className='flex items-center justify-between mb-4'>\n                <h2 className='text-lg font-semibold'>Recent Documents</h2>\n                <Button variant='outline' size='sm' className='flex items-center gap-2'>\n                  View All <ArrowRight className='w-4 h-4' />\n                </Button>\n              </div>\n              <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4'>\n                {documents.slice(0, 3).map((doc: any) => (\n                  <DocumentCard\n                    key={doc.id}\n                    title={doc.name}\n                    documentId={doc.id}\n                    onViewClick={handleDocumentView}\n                    documentType={doc.documentType}\n                    description={doc.description}\n                    createdAt={doc.createdAt}\n                    fileSize={doc.fileSize}\n                    mimeType={doc.mimeType}\n                    uploadedBy={doc.uploadedBy}\n                    isVisibleToTenants={doc.isVisibleToTenants}\n                    compact={true}\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Recent Activity */}\n          <div className='grid grid-cols-1 lg:grid-cols-2 gap-6'>\n            <Card>\n              <CardHeader>\n                <CardTitle>Recent Activity</CardTitle>\n                <CardDescription>Latest updates from your building</CardDescription>\n              </CardHeader>\n              <CardContent className='space-y-4'>\n                <div className='flex items-center space-x-4'>\n                  <div className='w-2 h-2 bg-blue-500 rounded-full'></div>\n                  <div className='flex-1'>\n                    <p className='text-sm font-medium'>Maintenance completed</p>\n                    <p className='text-xs text-muted-foreground'>\n                      Elevator maintenance finished - Unit 4B\n                    </p>\n                  </div>\n                  <p className='text-xs text-muted-foreground'>2 hours ago</p>\n                </div>\n                <div className='flex items-center space-x-4'>\n                  <div className='w-2 h-2 bg-green-500 rounded-full'></div>\n                  <div className='flex-1'>\n                    <p className='text-sm font-medium'>Payment confirmed</p>\n                    <p className='text-xs text-muted-foreground'>Monthly condo fees - $1,250</p>\n                  </div>\n                  <p className='text-xs text-muted-foreground'>1 day ago</p>\n                </div>\n                <div className='flex items-center space-x-4'>\n                  <div className='w-2 h-2 bg-orange-500 rounded-full'></div>\n                  <div className='flex-1'>\n                    <p className='text-sm font-medium'>New building notice</p>\n                    <p className='text-xs text-muted-foreground'>\n                      Pool maintenance scheduled for next week\n                    </p>\n                  </div>\n                  <p className='text-xs text-muted-foreground'>3 days ago</p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Upcoming Events</CardTitle>\n                <CardDescription>Building events and important dates</CardDescription>\n              </CardHeader>\n              <CardContent className='space-y-4'>\n                <div className='flex items-center justify-between p-3 bg-blue-50 rounded-lg'>\n                  <div>\n                    <p className='text-sm font-medium'>Board Meeting</p>\n                    <p className='text-xs text-muted-foreground'>Monthly community meeting</p>\n                  </div>\n                  <p className='text-sm text-blue-600'>Jan 15</p>\n                </div>\n                <div className='flex items-center justify-between p-3 bg-green-50 rounded-lg'>\n                  <div>\n                    <p className='text-sm font-medium'>Pool Reopening</p>\n                    <p className='text-xs text-muted-foreground'>After maintenance completion</p>\n                  </div>\n                  <p className='text-sm text-green-600'>Jan 20</p>\n                </div>\n                <div className='flex items-center justify-between p-3 bg-orange-50 rounded-lg'>\n                  <div>\n                    <p className='text-sm font-medium'>Fire Drill</p>\n                    <p className='text-xs text-muted-foreground'>Mandatory building safety drill</p>\n                  </div>\n                  <p className='text-sm text-orange-600'>Jan 25</p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Document viewing handled by opening in new tab */}\n    </div>\n  );\n}\n"],"version":3}
2151bd9d856be4144fa68acf3dacff0b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DemandFilters = DemandFilters;
exports.filterDemands = filterDemands;
const jsx_runtime_1 = require("react/jsx-runtime");
const lucide_react_1 = require("lucide-react");
const input_1 = require("@/components/ui/input");
const select_1 = require("@/components/ui/select");
const use_language_1 = require("@/hooks/use-language");
// Filter options for different user roles
const STATUS_OPTIONS = [
    { value: 'all', label: 'All Status' },
    { value: 'draft', label: 'Draft' },
    { value: 'submitted', label: 'Submitted' },
    { value: 'under_review', label: 'Under Review' },
    { value: 'approved', label: 'Approved' },
    { value: 'in_progress', label: 'In Progress' },
    { value: 'completed', label: 'Completed' },
    { value: 'rejected', label: 'Rejected' },
    { value: 'cancelled', label: 'Cancelled' },
];
const MANAGER_STATUS_OPTIONS = [
    { value: 'all', label: 'All Status' },
    { value: 'submitted', label: 'Submitted' },
    { value: 'under_review', label: 'Under Review' },
    { value: 'approved', label: 'Approved' },
    { value: 'in_progress', label: 'In Progress' },
    { value: 'completed', label: 'Completed' },
    { value: 'rejected', label: 'Rejected' },
];
const TYPE_OPTIONS = [
    { value: 'all', label: 'All Types' },
    { value: 'maintenance', label: 'Maintenance' },
    { value: 'complaint', label: 'Complaint' },
    { value: 'information', label: 'Information' },
    { value: 'other', label: 'Other' },
];
/**
 * Common demand filtering component
 * Supports search, status, type, and optional building filters.
 * @param root0
 * @param root0.filters
 * @param root0.handlers
 * @param root0.userRole
 * @param root0.buildings
 * @param root0.searchPlaceholder
 * @param root0.className
 */
function DemandFilters({ filters, handlers, userRole = 'resident', buildings = [], searchPlaceholder, className = '', }) {
    const { t } = (0, use_language_1.useLanguage)();
    const statusOptions = userRole === 'manager' ? MANAGER_STATUS_OPTIONS : STATUS_OPTIONS;
    const showBuildingFilter = userRole === 'manager' && handlers.onBuildingChange;
    const placeholder = searchPlaceholder || t('searchDemands');
    return ((0, jsx_runtime_1.jsxs)("div", { className: `flex items-center gap-4 flex-wrap ${className}`, children: [(0, jsx_runtime_1.jsxs)("div", { className: 'relative flex-1 max-w-sm', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: 'absolute left-3 top-3 h-4 w-4 text-muted-foreground' }), (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: placeholder, value: filters.searchTerm, onChange: (e) => handlers.onSearchChange(e.target.value), className: 'pl-10', "data-testid": 'search-demands' })] }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.statusFilter, onValueChange: handlers.onStatusChange, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { className: 'w-40', "data-testid": 'filter-status', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: t('formStatus') }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: statusOptions.map((option) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: option.value, children: option.label }, option.value))) })] }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.typeFilter, onValueChange: handlers.onTypeChange, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { className: 'w-40', "data-testid": 'filter-type', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: t('formType') }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: TYPE_OPTIONS.map((option) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: option.value, children: option.label }, option.value))) })] }), showBuildingFilter && ((0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.buildingFilter || 'all', onValueChange: handlers.onBuildingChange, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { className: 'w-40', "data-testid": 'filter-building', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: t('building') }) }), (0, jsx_runtime_1.jsxs)(select_1.SelectContent, { children: [(0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: 'all', children: t('allBuildings') }), buildings.map((building) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: building.id, children: building.name }, building.id)))] })] }))] }));
}
// Utility function to filter demands based on filter state
/**
 *
 * @param demands
 * @param filters
 */
function filterDemands(demands, filters) {
    return demands.filter((demand) => {
        // Search filter
        const searchLower = filters.searchTerm.toLowerCase();
        const matchesSearch = !filters.searchTerm ||
            demand.description.toLowerCase().includes(searchLower) ||
            demand.type.toLowerCase().includes(searchLower) ||
            (demand.submitter &&
                (demand.submitter.firstName.toLowerCase().includes(searchLower) ||
                    demand.submitter.lastName.toLowerCase().includes(searchLower) ||
                    demand.submitter.email.toLowerCase().includes(searchLower)));
        // Status filter
        const matchesStatus = filters.statusFilter === 'all' || demand.status === filters.statusFilter;
        // Type filter
        const matchesType = filters.typeFilter === 'all' || demand.type === filters.typeFilter;
        // Building filter (optional)
        const matchesBuilding = !filters.buildingFilter ||
            filters.buildingFilter === 'all' ||
            demand.buildingId === filters.buildingFilter;
        return matchesSearch && matchesStatus && matchesType && matchesBuilding;
    });
}
exports.default = DemandFilters;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL0RlbWFuZEZpbHRlcnMudHN4IiwibWFwcGluZ3MiOiI7O0FBd0ZBLHNDQXlFQztBQVFELHNDQW1DQzs7QUE1TUQsK0NBQXNDO0FBQ3RDLGlEQUE4QztBQUM5QyxtREFNZ0M7QUFDaEMsdURBQW1EO0FBeUJuRCwwQ0FBMEM7QUFDMUMsTUFBTSxjQUFjLEdBQUc7SUFDckIsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7SUFDckMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUU7SUFDbEMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUU7SUFDaEQsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7SUFDeEMsRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxhQUFhLEVBQUU7SUFDOUMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUU7SUFDeEMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7Q0FDbEMsQ0FBQztBQUVYLE1BQU0sc0JBQXNCLEdBQUc7SUFDN0IsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7SUFDckMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUU7SUFDaEQsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxVQUFVLEVB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QUMsV0FBVyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQztZQUMvQyxDQUFDLE1BQU0sQ0FBQyxTQUFTO2dCQUNmLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQztvQkFDN0QsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQztvQkFDN0QsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVuRSxnQkFBZ0I7UUFDaEIsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDLFlBQVksS0FBSyxLQUFLLElBQUksTUFBTSxDQUFDLE1BQU0sS0FBSyxPQUFPLENBQUMsWUFBWSxDQUFDO1FBRS9GLGNBQWM7UUFDZCxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsVUFBVSxLQUFLLEtBQUssSUFBSSxNQUFNLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQyxVQUFVLENBQUM7UUFFdkYsNkJBQTZCO1FBQzdCLE1BQU0sZUFBZSxHQUNuQixDQUFDLE9BQU8sQ0FBQyxjQUFjO1lBQ3ZCLE9BQU8sQ0FBQyxjQUFjLEtBQUssS0FBSztZQUNoQyxNQUFNLENBQUMsVUFBVSxLQUFLLE9BQU8sQ0FBQyxjQUFjLENBQUM7UUFFL0MsT0FBTyxhQUFhLElBQUksYUFBYSxJQUFJLFdBQVcsSUFBSSxlQUFlLENBQUM7SUFDMUUsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsa0JBQWUsYUFBYSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvY2xpZW50L3NyYy9jb21wb25lbnRzL2NvbW1vbi9EZW1hbmRGaWx0ZXJzLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTZWFyY2ggfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvaW5wdXQnO1xuaW1wb3J0IHtcbiAgU2VsZWN0LFxuICBTZWxlY3RDb250ZW50LFxuICBTZWxlY3RJdGVtLFxuICBTZWxlY3RUcmlnZ2VyLFxuICBTZWxlY3RWYWx1ZSxcbn0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3NlbGVjdCc7XG5pbXBvcnQgeyB1c2VMYW5ndWFnZSB9IGZyb20gJ0AvaG9va3MvdXNlLWxhbmd1YWdlJztcbmltcG9ydCB0eXBlIHsgQnVpbGRpbmcgfSBmcm9tICcuL0RlbWFuZENhcmQnO1xuXG4vLyBGaWx0ZXIgc3RhdGUgaW50ZXJmYWNlXG4vKipcbiAqXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmlsdGVyU3RhdGUge1xuICBzZWFyY2hUZXJtOiBzdHJpbmc7XG4gIHN0YXR1c0ZpbHRlcjogc3RyaW5nO1xuICB0eXBlRmlsdGVyOiBzdHJpbmc7XG4gIGJ1aWxkaW5nRmlsdGVyPzogc3RyaW5nO1xufVxuXG4vLyBGaWx0ZXIgY2hhbmdlIGhhbmRsZXJzXG4vKipcbiAqXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmlsdGVySGFuZGxlcnMge1xuICBvblNlYXJjaENoYW5nZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIG9uU3RhdHVzQ2hhbmdlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbiAgb25UeXBlQ2hhbmdlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbiAgb25CdWlsZGluZ0NoYW5nZT86ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG4vLyBGaWx0ZXIgb3B0aW9ucyBmb3IgZGlmZmVyZW50IHVzZXIgcm9sZXNcbmNvbnN0IFNUQVRVU19PUFRJT05TID0gW1xuICB7IHZhbHVlOiAnYWxsJywgbGFiZWw6ICdBbGwgU3RhdHVzJyB9LFxuICB7IHZhbHVlOiAnZHJhZnQnLCBsYWJlbDogJ0RyYWZ0JyB9LFxuICB7IHZhbHVlOiAnc3VibWl0dGVkJywgbGFiZWw6ICdTdWJtaXR0ZWQnIH0sXG4gIHsgdmFsdWU6ICd1bmRlcl9yZXZpZXcnLCBsYWJlbDogJ1VuZGVyIFJldmlldycgfSxcbiAgeyB2YWx1ZTogJ2FwcHJvdmVkJywgbGFiZWw6ICdBcHByb3ZlZCcgfSxcbiAgeyB2YWx1ZTogJ2luX3Byb2dyZXNzJywgbGFiZWw6ICdJbiBQcm9ncmVzcycgfSxcbiAgeyB2YWx1ZTogJ2NvbXBsZXRlZCcsIGxhYmVsOiAnQ29tcGxldGVkJyB9LFxuICB7IHZhbHVlOiAncmVqZWN0ZWQnLCBsYWJlbDogJ1JlamVjdGVkJyB9LFxuICB7IHZhbHVlOiAnY2FuY2VsbGVkJywgbGFiZWw6ICdDYW5jZWxsZWQnIH0sXG5dIGFzIGNvbnN0O1xuXG5jb25zdCBNQU5BR0VSX1NUQVRVU19PUFRJT05TID0gW1xuICB7IHZhbHVlOiAnYWxsJywgbGFiZWw6ICdBbGwgU3RhdHVzJyB9LFxuICB7IHZhbHVlOiAnc3VibWl0dGVkJywgbGFiZWw6ICdTdWJtaXR0ZWQnIH0sXG4gIHsgdmFsdWU6ICd1bmRlcl9yZXZpZXcnLCBsYWJlbDogJ1VuZGVyIFJldmlldycgfSxcbiAgeyB2YWx1ZTogJ2FwcHJvdmVkJywgbGFiZWw6ICdBcHByb3ZlZCcgfSxcbiAgeyB2YWx1ZTogJ2luX3Byb2dyZXNzJywgbGFiZWw6ICdJbiBQcm9ncmVzcycgfSxcbiAgeyB2YWx1ZTogJ2NvbXBsZXRlZCcsIGxhYmVsOiAnQ29tcGxldGVkJyB9LFxuICB7IHZhbHVlOiAncmVqZWN0ZWQnLCBsYWJlbDogJ1JlamVjdGVkJyB9LFxuXSBhcyBjb25zdDtcblxuY29uc3QgVFlQRV9PUFRJT05TID0gW1xuICB7IHZhbHVlOiAnYWxsJywgbGFiZWw6ICdBbGwgVHlwZXMnIH0sXG4gIHsgdmFsdWU6ICdtYWludGVuYW5jZScsIGxhYmVsOiAnTWFpbnRlbmFuY2UnIH0sXG4gIHsgdmFsdWU6ICdjb21wbGFpbnQnLCBsYWJlbDogJ0NvbXBsYWludCcgfSxcbiAgeyB2YWx1ZTogJ2luZm9ybWF0aW9uJywgbGFiZWw6ICdJbmZvcm1hdGlvbicgfSxcbiAgeyB2YWx1ZTogJ290aGVyJywgbGFiZWw6ICdPdGhlcicgfSxcbl0gYXMgY29uc3Q7XG5cbi8qKlxuICpcbiAqL1xuaW50ZXJmYWNlIERlbWFuZEZpbHRlcnNQcm9wcyB7XG4gIGZpbHRlcnM6IEZpbHRlclN0YXRlO1xuICBoYW5kbGVyczogRmlsdGVySGFuZGxlcnM7XG4gIHVzZXJSb2xlPzogJ21hbmFnZXInIHwgJ3Jlc2lkZW50JztcbiAgYnVpbGRpbmdzPzogQnVpbGRpbmdbXTtcbiAgc2VhcmNoUGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbn1cblxuLyoqXG4gKiBDb21tb24gZGVtYW5kIGZpbHRlcmluZyBjb21wb25lbnRcbiAqIFN1cHBvcnRzIHNlYXJjaCwgc3RhdHVzLCB0eXBlLCBhbmQgb3B0aW9uYWwgYnVpbGRpbmcgZmlsdGVycy5cbiAqIEBwYXJhbSByb290MFxuICogQHBhcmFtIHJvb3QwLmZpbHRlcnNcbiAqIEBwYXJhbSByb290MC5oYW5kbGVyc1xuICogQHBhcmFtIHJvb3QwLnVzZXJSb2xlXG4gKiBAcGFyYW0gcm9vdDAuYnVpbGRpbmdzXG4gKiBAcGFyYW0gcm9vdDAuc2VhcmNoUGxhY2Vob2xkZXJcbiAqIEBwYXJhbSByb290MC5jbGFzc05hbWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIERlbWFuZEZpbHRlcnMoe1xuICBmaWx0ZXJzLFxuICBoYW5kbGVycyxcbiAgdXNlclJvbGUgPSAncmVzaWRlbnQnLFxuICBidWlsZGluZ3MgPSBbXSxcbiAgc2VhcmNoUGxhY2Vob2xkZXIsXG4gIGNsYXNzTmFtZSA9ICcnLFxufTogRGVtYW5kRmlsdGVyc1Byb3BzKSB7XG4gIGNvbnN0IHsgdCB9ID0gdXNlTGFuZ3VhZ2UoKTtcbiAgY29uc3Qgc3RhdHVzT3B0aW9ucyA9IHVzZXJSb2xlID09PSAnbWFuYWdlcicgPyBNQU5BR0VSX1NUQVRVU19PUFRJT05TIDogU1RBVFVTX09QVElPTlM7XG4gIGNvbnN0IHNob3dCdWlsZGluZ0ZpbHRlciA9IHVzZXJSb2xlID09PSAnbWFuYWdlcicgJiYgaGFuZGxlcnMub25CdWlsZGluZ0NoYW5nZTtcbiAgY29uc3QgcGxhY2Vob2xkZXIgPSBzZWFyY2hQbGFjZWhvbGRlciB8fCB0KCdzZWFyY2hEZW1hbmRzJyk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT17YGZsZXggaXRlbXMtY2VudGVyIGdhcC00IGZsZXgtd3JhcCAke2NsYXNzTmFtZX1gfT5cbiAgICAgIHsvKiBTZWFyY2ggSW5wdXQgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0ncmVsYXRpdmUgZmxleC0xIG1heC13LXNtJz5cbiAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9J2Fic29sdXRlIGxlZnQtMyB0b3AtMyBoLTQgdy00IHRleHQtbXV0ZWQtZm9yZWdyb3VuZCcgLz5cbiAgICAgICAgPElucHV0XG4gICAgICAgICAgcGxhY2Vob2xkZXI9e3BsYWNlaG9sZGVyfVxuICAgICAgICAgIHZhbHVlPXtmaWx0ZXJzLnNlYXJjaFRlcm19XG4gICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVycy5vblNlYXJjaENoYW5nZShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgY2xhc3NOYW1lPSdwbC0xMCdcbiAgICAgICAgICBkYXRhLXRlc3RpZD0nc2VhcmNoLWRlbWFuZHMnXG4gICAgICAgIC8+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIFN0YXR1cyBGaWx0ZXIgKi99XG4gICAgICA8U2VsZWN0IHZhbHVlPXtmaWx0ZXJzLnN0YXR1c0ZpbHRlcn0gb25WYWx1ZUNoYW5nZT17aGFuZGxlcnMub25TdGF0dXNDaGFuZ2V9PlxuICAgICAgICA8U2VsZWN0VHJpZ2dlciBjbGFzc05hbWU9J3ctNDAnIGRhdGEtdGVzdGlkPSdmaWx0ZXItc3RhdHVzJz5cbiAgICAgICAgICA8U2VsZWN0VmFsdWUgcGxhY2Vob2xkZXI9e3QoJ2Zvcm1TdGF0dXMnKX0gLz5cbiAgICAgICAgPC9TZWxlY3RUcmlnZ2VyPlxuICAgICAgICA8U2VsZWN0Q29udGVudD5cbiAgICAgICAgICB7c3RhdHVzT3B0aW9ucy5tYXAoKG9wdGlvbikgPT4gKFxuICAgICAgICAgICAgPFNlbGVjdEl0ZW0ga2V5PXtvcHRpb24udmFsdWV9IHZhbHVlPXtvcHRpb24udmFsdWV9PlxuICAgICAgICAgICAgICB7b3B0aW9uLmxhYmVsfVxuICAgICAgICAgICAgPC9TZWxlY3RJdGVtPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L1NlbGVjdENvbnRlbnQ+XG4gICAgICA8L1NlbGVjdD5cblxuICAgICAgey8qIFR5cGUgRmlsdGVyICovfVxuICAgICAgPFNlbGVjdCB2YWx1ZT17ZmlsdGVycy50eXBlRmlsdGVyfSBvblZhbHVlQ2hhbmdlPXtoYW5kbGVycy5vblR5cGVDaGFuZ2V9PlxuICAgICAgICA8U2VsZWN0VHJpZ2dlciBjbGFzc05hbWU9J3ctNDAnIGRhdGEtdGVzdGlkPSdmaWx0ZXItdHlwZSc+XG4gICAgICAgICAgPFNlbGVjdFZhbHVlIHBsYWNlaG9sZGVyPXt0KCdmb3JtVHlwZScpfSAvPlxuICAgICAgICA8L1NlbGVjdFRyaWdnZXI+XG4gICAgICAgIDxTZWxlY3RDb250ZW50PlxuICAgICAgICAgIHtUWVBFX09QVElPTlMubWFwKChvcHRpb24pID0+IChcbiAgICAgICAgICAgIDxTZWxlY3RJdGVtIGtleT17b3B0aW9uLnZhbHVlfSB2YWx1ZT17b3B0aW9uLnZhbHVlfT5cbiAgICAgICAgICAgICAge29wdGlvbi5sYWJlbH1cbiAgICAgICAgICAgIDwvU2VsZWN0SXRlbT5cbiAgICAgICAgICApKX1cbiAgICAgICAgPC9TZWxlY3RDb250ZW50PlxuICAgICAgPC9TZWxlY3Q+XG5cbiAgICAgIHsvKiBCdWlsZGluZyBGaWx0ZXIgKE1hbmFnZXIgb25seSkgKi99XG4gICAgICB7c2hvd0J1aWxkaW5nRmlsdGVyICYmIChcbiAgICAgICAgPFNlbGVjdCB2YWx1ZT17ZmlsdGVycy5idWlsZGluZ0ZpbHRlciB8fCAnYWxsJ30gb25WYWx1ZUNoYW5nZT17aGFuZGxlcnMub25CdWlsZGluZ0NoYW5nZX0+XG4gICAgICAgICAgPFNlbGVjdFRyaWdnZXIgY2xhc3NOYW1lPSd3LTQwJyBkYXRhLXRlc3RpZD0nZmlsdGVyLWJ1aWxkaW5nJz5cbiAgICAgICAgICAgIDxTZWxlY3RWYWx1ZSBwbGFjZWhvbGRlcj17dCgnYnVpbGRpbmcnKX0gLz5cbiAgICAgICAgICA8L1NlbGVjdFRyaWdnZXI+XG4gICAgICAgICAgPFNlbGVjdENvbnRlbnQ+XG4gICAgICAgICAgICA8U2VsZWN0SXRlbSB2YWx1ZT0nYWxsJz57dCgnYWxsQnVpbGRpbmdzJyl9PC9TZWxlY3RJdGVtPlxuICAgICAgICAgICAge2J1aWxkaW5ncy5tYXAoKGJ1aWxkaW5nKSA9PiAoXG4gICAgICAgICAgICAgIDxTZWxlY3RJdGVtIGtleT17YnVpbGRpbmcuaWR9IHZhbHVlPXtidWlsZGluZy5pZH0+XG4gICAgICAgICAgICAgICAge2J1aWxkaW5nLm5hbWV9XG4gICAgICAgICAgICAgIDwvU2VsZWN0SXRlbT5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvU2VsZWN0Q29udGVudD5cbiAgICAgICAgPC9TZWxlY3Q+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufVxuXG4vLyBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZpbHRlciBkZW1hbmRzIGJhc2VkIG9uIGZpbHRlciBzdGF0ZVxuLyoqXG4gKlxuICogQHBhcmFtIGRlbWFuZHNcbiAqIEBwYXJhbSBmaWx0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJEZW1hbmRzPFxuICBUIGV4dGVuZHMge1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIHN0YXR1czogc3RyaW5nO1xuICAgIGJ1aWxkaW5nSWQ/OiBzdHJpbmc7XG4gICAgc3VibWl0dGVyPzogeyBmaXJzdE5hbWU6IHN0cmluZzsgbGFzdE5hbWU6IHN0cmluZzsgZW1haWw6IHN0cmluZyB9O1xuICB9LFxuPihkZW1hbmRzOiBUW10sIGZpbHRlcnM6IEZpbHRlclN0YXRlKTogVFtdIHtcbiAgcmV0dXJuIGRlbWFuZHMuZmlsdGVyKChkZW1hbmQpID0+IHtcbiAgICAvLyBTZWFyY2ggZmlsdGVyXG4gICAgY29uc3Qgc2VhcmNoTG93ZXIgPSBmaWx0ZXJzLnNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBtYXRjaGVzU2VhcmNoID1cbiAgICAgICFmaWx0ZXJzLnNlYXJjaFRlcm0gfHxcbiAgICAgIGRlbWFuZC5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgZGVtYW5kLnR5cGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcikgfHxcbiAgICAgIChkZW1hbmQuc3VibWl0dGVyICYmXG4gICAgICAgIChkZW1hbmQuc3VibWl0dGVyLmZpcnN0TmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgICAgIGRlbWFuZC5zdWJtaXR0ZXIubGFzdE5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcikgfHxcbiAgICAgICAgICBkZW1hbmQuc3VibWl0dGVyLmVtYWlsLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpKSk7XG5cbiAgICAvLyBTdGF0dXMgZmlsdGVyXG4gICAgY29uc3QgbWF0Y2hlc1N0YXR1cyA9IGZpbHRlcnMuc3RhdHVzRmlsdGVyID09PSAnYWxsJyB8fCBkZW1hbmQuc3RhdHVzID09PSBmaWx0ZXJzLnN0YXR1c0ZpbHRlcjtcblxuICAgIC8vIFR5cGUgZmlsdGVyXG4gICAgY29uc3QgbWF0Y2hlc1R5cGUgPSBmaWx0ZXJzLnR5cGVGaWx0ZXIgPT09ICdhbGwnIHx8IGRlbWFuZC50eXBlID09PSBmaWx0ZXJzLnR5cGVGaWx0ZXI7XG5cbiAgICAvLyBCdWlsZGluZyBmaWx0ZXIgKG9wdGlvbmFsKVxuICAgIGNvbnN0IG1hdGNoZXNCdWlsZGluZyA9XG4gICAgICAhZmlsdGVycy5idWlsZGluZ0ZpbHRlciB8fFxuICAgICAgZmlsdGVycy5idWlsZGluZ0ZpbHRlciA9PT0gJ2FsbCcgfHxcbiAgICAgIGRlbWFuZC5idWlsZGluZ0lkID09PSBmaWx0ZXJzLmJ1aWxkaW5nRmlsdGVyO1xuXG4gICAgcmV0dXJuIG1hdGNoZXNTZWFyY2ggJiYgbWF0Y2hlc1N0YXR1cyAmJiBtYXRjaGVzVHlwZSAmJiBtYXRjaGVzQnVpbGRpbmc7XG4gIH0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCBEZW1hbmRGaWx0ZXJzO1xuIl0sInZlcnNpb24iOjN9
55acd6887657bdea32ce50df8e14c91f
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
/**
 * File Upload Forms Test Suite
 *
 * Comprehensive testing for all submission forms that support file uploads or image attachments.
 * This test suite validates:
 * 1. File selection and validation
 * 2. Form submission with multipart data
 * 3. Error handling for file uploads
 * 4. File type and size restrictions
 * 5. Multiple file handling
 * 6. UI feedback during upload process
 *
 * Forms tested:
 * - Bug Reports (with file attachments)
 * - Feature Requests/Ideas (with file attachments)
 * - Document Upload Forms
 * - Bills (with receipt attachments)
 */
/// <reference path="../types/jest-dom.d.ts" />
const globals_1 = require("@jest/globals");
globals_1.jest.mock('@/lib/queryClient', () => ({
    apiRequest: mockApiRequest,
}));
globals_1.jest.mock('@/hooks/use-auth', () => ({
    useAuth: () => mockAuth,
}));
globals_1.jest.mock('@/hooks/use-toast', () => ({
    useToast: () => ({ toast: mockToast }),
}));
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const react_query_1 = require("@tanstack/react-query");
const react_2 = __importDefault(require("react"));
// Test utilities
const createTestQueryClient = () => {
    return new react_query_1.QueryClient({
        defaultOptions: {
            queries: {
                retry: false,
            },
            mutations: {
                retry: false,
            },
        },
    });
};
const TestWrapper = ({ children }) => {
    const queryClient = createTestQueryClient();
    return ((0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: children }));
};
// Mock API request function
const mockApiRequest = globals_1.jest.fn();
const mockFetch = globals_1.jest.fn();
// Mock authentication hook
const mockAuth = {
    user: {
        id: '123e4567-e89b-12d3-a456-426614174000',
        email: 'test@koveo.com',
        role: 'admin',
        organizationId: '123e4567-e89b-12d3-a456-426614174001'
    },
    login: globals_1.jest.fn(),
    logout: globals_1.jest.fn(),
};
// Mock toast hook
const mockToast = globals_1.jest.fn();
// Mock global fetch
global.fetch = mockFetch;
// Create mock files for testing
const createMockFile = (name, size, type) => {
    const file = new File(['mock content'], name, { type });
    Object.defineProperty(file, 'size', { value: size });
    return file;
};
const createMockImage = (name, size = 50000) => createMockFile(name, size, 'image/png');
const createMockPDF = (name, size = 100000) => createMockFile(name, size, 'application/pdf');
const createMockTextFile = (name, size = 1000) => createMockFile(name, size, 'text/plain');
(0, globals_1.describe)('File Upload Forms Test Suite', () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        mockApiRequest.mockResolvedValue({ id: 'test-id', success: true });
        mockFetch.mockResolvedValue({
            ok: true,
            json: async () => ({ id: 'test-id', success: true }),
        });
    });
    (0, globals_1.afterEach)(() => {
        globals_1.jest.resetAllMocks();
    });
    (0, globals_1.describe)('Bug Report Form with File Attachments', () => {
        const BugReportForm = require('../../client/src/pages/settings/bug-reports.tsx').default;
        (0, globals_1.beforeEach)(() => {
            // Reset mocks for this test suite
            globals_1.jest.clearAllMocks();
        });
        (0, globals_1.it)('should render bug report form with file upload capability', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BugReportForm, {}) }));
            // Check for bug report button
            const reportButton = react_1.screen.queryByTestId('button-report-bug') ||
                react_1.screen.queryByText(/report bug/i);
            if (reportButton) {
                await user_event_1.default.click(reportButton);
                // Look for file upload components
                const attachButton = react_1.screen.queryByText(/attach files/i) ||
                    react_1.screen.queryByText(/screenshots/i) ||
                    react_1.screen.queryByRole('button', { name: /attach/i });
                (0, globals_1.expect)(attachButton).toBeTruthy();
            }
        });
        (0, globals_1.it)('should handle single file attachment to bug reports', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BugReportForm, {}) }));
            const reportButton = react_1.screen.queryByTestId('button-report-bug') ||
                react_1.screen.queryByText(/report bug/i);
            if (reportButton) {
                await user_event_1.default.click(reportButton);
                // Fill required fields
                const titleInput = react_1.screen.queryByLabelText(/title/i) ||
                    react_1.screen.queryByPlaceholderText(/title/i);
                const descriptionInput = react_1.screen.queryByLabelText(/description/i) ||
                    react_1.screen.queryByPlaceholderText(/description/i);
                const pageInput = react_1.screen.queryByLabelText(/page/i) ||
                    react_1.screen.queryByPlaceholderText(/page/i);
                if (titleInput && descriptionInput && pageInput) {
                    await user_event_1.default.type(titleInput, 'Test Bug Report with File');
                    await user_event_1.default.type(descriptionInput, 'This is a test bug report with file attachment for testing purposes.');
                    await user_event_1.default.type(pageInput, 'Test Page');
                    // Try to find and interact with file upload
                    const fileInput = react_1.screen.queryByRole('button', { name: /attach/i }) ||
                        react_1.screen.queryByText(/attach files/i);
                    if (fileInput) {
                        const mockFile = createMockImage('screenshot.png');
                        // Simulate file selection
                        Object.defineProperty(fileInput, 'files', {
                            value: [mockFile],
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: [mockFile] } });
                        // Submit form
                        const submitButton = react_1.screen.queryByTestId('button-submit-bug') ||
                            react_1.screen.queryByRole('button', { name: /submit/i });
                        if (submitButton) {
                            await user_event_1.default.click(submitButton);
                            await (0, react_1.waitFor)(() => {
                                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bugs', globals_1.expect.objectContaining({
                                    method: 'POST',
                                    body: globals_1.expect.any(FormData),
                                    credentials: 'include',
                                }));
                            });
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should handle multiple file attachments to bug reports', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BugReportForm, {}) }));
            const reportButton = react_1.screen.queryByTestId('button-report-bug') ||
                react_1.screen.queryByText(/report bug/i);
            if (reportButton) {
                await user_event_1.default.click(reportButton);
                const titleInput = react_1.screen.queryByLabelText(/title/i) ||
                    react_1.screen.queryByPlaceholderText(/title/i);
                const descriptionInput = react_1.screen.queryByLabelText(/description/i) ||
                    react_1.screen.queryByPlaceholderText(/description/i);
                const pageInput = react_1.screen.queryByLabelText(/page/i) ||
                    react_1.screen.queryByPlaceholderText(/page/i);
                if (titleInput && descriptionInput && pageInput) {
                    await user_event_1.default.type(titleInput, 'Multi-file Bug Report');
                    await user_event_1.default.type(descriptionInput, 'Testing multiple file attachments in bug reports.');
                    await user_event_1.default.type(pageInput, 'Test Page');
                    const fileInput = react_1.screen.queryByRole('button', { name: /attach/i });
                    if (fileInput) {
                        const mockFiles = [
                            createMockImage('screenshot1.png'),
                            createMockImage('screenshot2.png'),
                            createMockPDF('error-log.pdf')
                        ];
                        // Simulate multiple file selection
                        Object.defineProperty(fileInput, 'files', {
                            value: mockFiles,
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: mockFiles } });
                        const submitButton = react_1.screen.queryByTestId('button-submit-bug') ||
                            react_1.screen.queryByRole('button', { name: /submit/i });
                        if (submitButton) {
                            await user_event_1.default.click(submitButton);
                            await (0, react_1.waitFor)(() => {
                                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/bugs', globals_1.expect.objectContaining({
                                    method: 'POST',
                                    body: globals_1.expect.any(FormData),
                                }));
                            });
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should validate file size limits for bug report attachments', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BugReportForm, {}) }));
            const reportButton = react_1.screen.queryByTestId('button-report-bug') ||
                react_1.screen.queryByText(/report bug/i);
            if (reportButton) {
                await user_event_1.default.click(reportButton);
                const fileInput = react_1.screen.queryByRole('button', { name: /attach/i });
                if (fileInput) {
                    // Create oversized file (50MB)
                    const oversizedFile = createMockImage('huge-file.png', 50 * 1024 * 1024);
                    Object.defineProperty(fileInput, 'files', {
                        value: [oversizedFile],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [oversizedFile] } });
                    // Should show error message for oversized file
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/file.*too large/i) ||
                            react_1.screen.queryByText(/size.*exceeded/i) ||
                            react_1.screen.queryByText(/maximum.*size/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
    });
    (0, globals_1.describe)('Feature Request Form with File Attachments', () => {
        const FeatureRequestForm = require('../../client/src/pages/settings/idea-box.tsx').default;
        (0, globals_1.it)('should render feature request form with file upload capability', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(FeatureRequestForm, {}) }));
            const requestButton = react_1.screen.queryByTestId('button-request-feature') ||
                react_1.screen.queryByText(/request feature/i) ||
                react_1.screen.queryByText(/suggest idea/i);
            if (requestButton) {
                await user_event_1.default.click(requestButton);
                const attachButton = react_1.screen.queryByText(/attach files/i) ||
                    react_1.screen.queryByText(/attachments/i) ||
                    react_1.screen.queryByRole('button', { name: /attach/i });
                (0, globals_1.expect)(attachButton).toBeTruthy();
            }
        });
        (0, globals_1.it)('should submit feature request with file attachments', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(FeatureRequestForm, {}) }));
            const requestButton = react_1.screen.queryByTestId('button-request-feature') ||
                react_1.screen.queryByText(/request feature/i);
            if (requestButton) {
                await user_event_1.default.click(requestButton);
                const titleInput = react_1.screen.queryByLabelText(/title/i) ||
                    react_1.screen.queryByPlaceholderText(/title/i);
                const descriptionInput = react_1.screen.queryByLabelText(/description/i) ||
                    react_1.screen.queryByPlaceholderText(/description/i);
                if (titleInput && descriptionInput) {
                    await user_event_1.default.type(titleInput, 'New Feature with Mockups');
                    await user_event_1.default.type(descriptionInput, 'Feature request with design mockups and documentation.');
                    const fileInput = react_1.screen.queryByRole('button', { name: /attach/i });
                    if (fileInput) {
                        const mockFiles = [
                            createMockImage('mockup.png'),
                            createMockPDF('requirements.pdf')
                        ];
                        Object.defineProperty(fileInput, 'files', {
                            value: mockFiles,
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: mockFiles } });
                        const submitButton = react_1.screen.queryByRole('button', { name: /submit/i });
                        if (submitButton) {
                            await user_event_1.default.click(submitButton);
                            await (0, react_1.waitFor)(() => {
                                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith(globals_1.expect.stringMatching(/\/api\/(features|feature-requests)/), globals_1.expect.objectContaining({
                                    method: 'POST',
                                    body: globals_1.expect.any(FormData),
                                }));
                            });
                        }
                    }
                }
            }
        });
    });
    (0, globals_1.describe)('Document Upload Forms', () => {
        const DocumentManager = require('../../client/src/components/common/DocumentManager.tsx').default;
        (0, globals_1.it)('should handle document upload with metadata', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DocumentManager, {}) }));
            const uploadButton = react_1.screen.queryByTestId('button-upload-document') ||
                react_1.screen.queryByText(/upload/i) ||
                react_1.screen.queryByRole('button', { name: /add.*document/i });
            if (uploadButton) {
                await user_event_1.default.click(uploadButton);
                const fileInput = react_1.screen.queryByRole('input', { name: /file/i }) ||
                    react_1.screen.queryByRole('button', { name: /choose.*file/i });
                if (fileInput) {
                    const mockDocument = createMockPDF('contract.pdf');
                    Object.defineProperty(fileInput, 'files', {
                        value: [mockDocument],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [mockDocument] } });
                    // Fill document metadata
                    const nameInput = react_1.screen.queryByLabelText(/name/i) ||
                        react_1.screen.queryByPlaceholderText(/document.*name/i);
                    const descriptionInput = react_1.screen.queryByLabelText(/description/i);
                    if (nameInput) {
                        await user_event_1.default.type(nameInput, 'Test Contract Document');
                    }
                    if (descriptionInput) {
                        await user_event_1.default.type(descriptionInput, 'Legal contract for testing purposes');
                    }
                    const submitButton = react_1.screen.queryByRole('button', { name: /upload/i }) ||
                        react_1.screen.queryByRole('button', { name: /save/i });
                    if (submitButton) {
                        await user_event_1.default.click(submitButton);
                        await (0, react_1.waitFor)(() => {
                            (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', globals_1.expect.stringMatching(/\/api\/documents/), globals_1.expect.any(Object));
                        });
                    }
                }
            }
        });
        (0, globals_1.it)('should validate document file types', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DocumentManager, {}) }));
            const uploadButton = react_1.screen.queryByTestId('button-upload-document') ||
                react_1.screen.queryByText(/upload/i);
            if (uploadButton) {
                await user_event_1.default.click(uploadButton);
                const fileInput = react_1.screen.queryByRole('input', { name: /file/i });
                if (fileInput) {
                    // Try uploading invalid file type
                    const invalidFile = createMockFile('malicious.exe', 1000, 'application/x-executable');
                    Object.defineProperty(fileInput, 'files', {
                        value: [invalidFile],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [invalidFile] } });
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/file.*type.*not.*allowed/i) ||
                            react_1.screen.queryByText(/invalid.*file.*type/i) ||
                            react_1.screen.queryByText(/unsupported.*format/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
    });
    (0, globals_1.describe)('Bill Form with Receipt Attachments', () => {
        const BillForm = require('../../client/src/components/common/BillForm.tsx').default;
        (0, globals_1.it)('should handle bill submission with receipt attachments', async () => {
            const mockProps = {
                isOpen: true,
                onClose: globals_1.jest.fn(),
                onSubmit: globals_1.jest.fn(),
                buildings: [],
                residences: []
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BillForm, { ...mockProps }) }));
            // Fill bill details
            const titleInput = react_1.screen.queryByLabelText(/title/i) ||
                react_1.screen.queryByPlaceholderText(/bill.*title/i);
            const amountInput = react_1.screen.queryByLabelText(/amount/i) ||
                react_1.screen.queryByPlaceholderText(/amount/i);
            if (titleInput && amountInput) {
                await user_event_1.default.type(titleInput, 'Electricity Bill - January 2025');
                await user_event_1.default.type(amountInput, '150.75');
                // Look for file attachment
                const attachButton = react_1.screen.queryByText(/attach.*receipt/i) ||
                    react_1.screen.queryByText(/add.*attachment/i) ||
                    react_1.screen.queryByRole('button', { name: /attach/i });
                if (attachButton) {
                    await user_event_1.default.click(attachButton);
                    const fileInput = react_1.screen.queryByRole('input', { type: 'file' });
                    if (fileInput) {
                        const receiptFile = createMockPDF('receipt.pdf');
                        Object.defineProperty(fileInput, 'files', {
                            value: [receiptFile],
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: [receiptFile] } });
                        const submitButton = react_1.screen.queryByRole('button', { name: /save.*bill/i }) ||
                            react_1.screen.queryByRole('button', { name: /submit/i });
                        if (submitButton) {
                            await user_event_1.default.click(submitButton);
                            await (0, react_1.waitFor)(() => {
                                (0, globals_1.expect)(mockProps.onSubmit).toHaveBeenCalledWith(globals_1.expect.objectContaining({
                                    title: 'Electricity Bill - January 2025',
                                    amount: globals_1.expect.any(String),
                                }));
                            });
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should validate receipt file format', async () => {
            const mockProps = {
                isOpen: true,
                onClose: globals_1.jest.fn(),
                onSubmit: globals_1.jest.fn(),
                buildings: [],
                residences: []
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(BillForm, { ...mockProps }) }));
            const attachButton = react_1.screen.queryByText(/attach/i);
            if (attachButton) {
                await user_event_1.default.click(attachButton);
                const fileInput = react_1.screen.queryByRole('input', { type: 'file' });
                if (fileInput) {
                    // Try invalid file format
                    const invalidFile = createMockFile('receipt.txt', 1000, 'text/plain');
                    Object.defineProperty(fileInput, 'files', {
                        value: [invalidFile],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [invalidFile] } });
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/invalid.*format/i) ||
                            react_1.screen.queryByText(/only.*pdf.*jpg.*png/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
    });
    (0, globals_1.describe)('Demands Form with File Attachments', () => {
        const DemandsPage = require('../../client/src/pages/ResidentDemandsPage.tsx').default;
        (0, globals_1.beforeEach)(() => {
            globals_1.jest.clearAllMocks();
            // Mock successful upload response
            mockFetch.mockResolvedValue({
                ok: true,
                json: async () => ({
                    fileUrls: ['/uploads/demands/test-file.png'],
                    fileCount: 1,
                    message: 'Files uploaded successfully'
                }),
            });
        });
        (0, globals_1.it)('should render demands form with file upload capability', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            // Look for submit demand button
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i) ||
                react_1.screen.queryByText(/create.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                // Look for file upload component
                const fileUpload = react_1.screen.queryByTestId('file-upload-container') ||
                    react_1.screen.queryByText(/drag.*drop/i) ||
                    react_1.screen.queryByText(/attach.*files/i) ||
                    react_1.screen.queryByRole('button', { name: /upload/i });
                (0, globals_1.expect)(fileUpload).toBeTruthy();
            }
        });
        (0, globals_1.it)('should handle single file attachment to demands', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                // Fill required fields
                const typeSelect = react_1.screen.queryByTestId('select-demand-type') ||
                    react_1.screen.queryByLabelText(/type/i);
                const descriptionInput = react_1.screen.queryByTestId('textarea-demand-description') ||
                    react_1.screen.queryByLabelText(/description/i) ||
                    react_1.screen.queryByPlaceholderText(/description/i);
                if (typeSelect && descriptionInput) {
                    await user_event_1.default.selectOptions(typeSelect, 'maintenance');
                    await user_event_1.default.type(descriptionInput, 'Kitchen faucet is leaking and needs immediate repair. Water is dripping constantly.');
                    // Find file upload area
                    const fileUploadArea = react_1.screen.queryByTestId('file-upload-container') ||
                        react_1.screen.queryByText(/drag.*drop/i);
                    if (fileUploadArea) {
                        const mockFile = createMockImage('leak-photo.png');
                        // Simulate file drop
                        const fileInput = react_1.screen.queryByRole('input', { hidden: true }) ||
                            document.querySelector('input[type="file"]');
                        if (fileInput) {
                            Object.defineProperty(fileInput, 'files', {
                                value: [mockFile],
                                writable: false,
                            });
                            react_1.fireEvent.change(fileInput, { target: { files: [mockFile] } });
                            // Wait for file to be processed
                            await (0, react_1.waitFor)(() => {
                                const filePreview = react_1.screen.queryByText('leak-photo.png') ||
                                    react_1.screen.queryByTestId('file-preview-0');
                                (0, globals_1.expect)(filePreview).toBeTruthy();
                            });
                            // Submit the demand
                            const finalSubmitButton = react_1.screen.queryByTestId('button-submit-demand-form') ||
                                react_1.screen.queryByRole('button', { name: /submit.*demand/i });
                            if (finalSubmitButton) {
                                await user_event_1.default.click(finalSubmitButton);
                                await (0, react_1.waitFor)(() => {
                                    // Verify file upload was called
                                    (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/upload', globals_1.expect.objectContaining({
                                        method: 'POST',
                                        body: globals_1.expect.any(FormData),
                                    }));
                                    // Verify demand creation was called with attachments
                                    (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands', globals_1.expect.objectContaining({
                                        method: 'POST',
                                        headers: globals_1.expect.objectContaining({
                                            'Content-Type': 'application/json',
                                        }),
                                        body: globals_1.expect.stringContaining('attachments'),
                                    }));
                                });
                            }
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should handle multiple file attachments to demands', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const typeSelect = react_1.screen.queryByTestId('select-demand-type');
                const descriptionInput = react_1.screen.queryByTestId('textarea-demand-description') ||
                    react_1.screen.queryByLabelText(/description/i);
                if (typeSelect && descriptionInput) {
                    await user_event_1.default.selectOptions(typeSelect, 'complaint');
                    await user_event_1.default.type(descriptionInput, 'Multiple issues with apartment including water damage and electrical problems. Photos attached for evidence.');
                    const fileInput = document.querySelector('input[type="file"]');
                    if (fileInput) {
                        const mockFiles = [
                            createMockImage('water-damage.jpg'),
                            createMockImage('electrical-issue.png'),
                            createMockPDF('inspection-report.pdf')
                        ];
                        // Simulate multiple file selection
                        Object.defineProperty(fileInput, 'files', {
                            value: mockFiles,
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: mockFiles } });
                        // Wait for files to be processed
                        await (0, react_1.waitFor)(() => {
                            const fileCount = react_1.screen.queryByText(/3.*files/i) ||
                                react_1.screen.queryAllByTestId(/file-preview-/);
                            (0, globals_1.expect)(fileCount).toBeTruthy();
                        });
                        // Update mock for multiple files
                        mockFetch.mockResolvedValueOnce({
                            ok: true,
                            json: async () => ({
                                fileUrls: [
                                    '/uploads/demands/water-damage.jpg',
                                    '/uploads/demands/electrical-issue.png',
                                    '/uploads/demands/inspection-report.pdf'
                                ],
                                fileCount: 3
                            }),
                        });
                        const finalSubmitButton = react_1.screen.queryByTestId('button-submit-demand-form') ||
                            react_1.screen.queryByRole('button', { name: /submit/i });
                        if (finalSubmitButton) {
                            await user_event_1.default.click(finalSubmitButton);
                            await (0, react_1.waitFor)(() => {
                                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/upload', globals_1.expect.objectContaining({
                                    method: 'POST',
                                    body: globals_1.expect.any(FormData),
                                }));
                            });
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should validate file size limits for demand attachments', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const fileInput = document.querySelector('input[type="file"]');
                if (fileInput) {
                    // Create oversized file (15MB - above 10MB limit)
                    const oversizedFile = createMockImage('huge-screenshot.png', 15 * 1024 * 1024);
                    Object.defineProperty(fileInput, 'files', {
                        value: [oversizedFile],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [oversizedFile] } });
                    // Should show error message for oversized file
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/file.*too large/i) ||
                            react_1.screen.queryByText(/size.*exceeded/i) ||
                            react_1.screen.queryByText(/10.*mb.*limit/i) ||
                            react_1.screen.queryByText(/maximum.*file.*size/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
        (0, globals_1.it)('should validate maximum file count for demand attachments', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const fileInput = document.querySelector('input[type="file"]');
                if (fileInput) {
                    // Try to upload 6 files (above 5 file limit)
                    const tooManyFiles = [
                        createMockImage('file1.png'),
                        createMockImage('file2.png'),
                        createMockImage('file3.png'),
                        createMockImage('file4.png'),
                        createMockImage('file5.png'),
                        createMockImage('file6.png') // This should trigger error
                    ];
                    Object.defineProperty(fileInput, 'files', {
                        value: tooManyFiles,
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: tooManyFiles } });
                    // Should show error message for too many files
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/maximum.*5.*files/i) ||
                            react_1.screen.queryByText(/too many.*files/i) ||
                            react_1.screen.queryByText(/file.*limit.*exceeded/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
        (0, globals_1.it)('should validate allowed file types for demand attachments', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const fileInput = document.querySelector('input[type="file"]');
                if (fileInput) {
                    // Try uploading invalid file type
                    const invalidFile = createMockFile('malicious.exe', 1000, 'application/x-executable');
                    Object.defineProperty(fileInput, 'files', {
                        value: [invalidFile],
                        writable: false,
                    });
                    react_1.fireEvent.change(fileInput, { target: { files: [invalidFile] } });
                    await (0, react_1.waitFor)(() => {
                        const errorMessage = react_1.screen.queryByText(/file.*type.*not.*supported/i) ||
                            react_1.screen.queryByText(/invalid.*file.*format/i) ||
                            react_1.screen.queryByText(/only.*images.*pdf.*documents/i);
                        if (errorMessage) {
                            (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                        }
                    });
                }
            }
        });
        (0, globals_1.it)('should handle screenshot paste functionality (Ctrl+V)', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const fileUploadArea = react_1.screen.queryByTestId('file-upload-container');
                if (fileUploadArea) {
                    // Mock clipboard data
                    const clipboardData = {
                        items: [
                            {
                                kind: 'file',
                                type: 'image/png',
                                getAsFile: () => createMockImage('pasted-screenshot.png')
                            }
                        ]
                    };
                    // Simulate paste event
                    react_1.fireEvent.paste(fileUploadArea, {
                        clipboardData: clipboardData
                    });
                    // Should show pasted file
                    await (0, react_1.waitFor)(() => {
                        const pastedFile = react_1.screen.queryByText(/pasted.*screenshot/i) ||
                            react_1.screen.queryByText(/screenshot.*pasted/i) ||
                            react_1.screen.queryByTestId('file-preview-0');
                        if (pastedFile) {
                            (0, globals_1.expect)(pastedFile).toBeInTheDocument();
                        }
                    });
                }
            }
        });
        (0, globals_1.it)('should handle network errors during file upload in demands', async () => {
            // Mock upload failure
            mockFetch.mockRejectedValueOnce(new Error('Upload failed'));
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandsPage, {}) }));
            const submitButton = react_1.screen.queryByTestId('button-submit-demand') ||
                react_1.screen.queryByText(/submit.*demand/i);
            if (submitButton) {
                await user_event_1.default.click(submitButton);
                const typeSelect = react_1.screen.queryByTestId('select-demand-type');
                const descriptionInput = react_1.screen.queryByTestId('textarea-demand-description') ||
                    react_1.screen.queryByLabelText(/description/i);
                if (typeSelect && descriptionInput) {
                    await user_event_1.default.selectOptions(typeSelect, 'maintenance');
                    await user_event_1.default.type(descriptionInput, 'Test demand with file that will fail to upload');
                    const fileInput = document.querySelector('input[type="file"]');
                    if (fileInput) {
                        const mockFile = createMockImage('test-file.png');
                        Object.defineProperty(fileInput, 'files', {
                            value: [mockFile],
                            writable: false,
                        });
                        react_1.fireEvent.change(fileInput, { target: { files: [mockFile] } });
                        const finalSubmitButton = react_1.screen.queryByTestId('button-submit-demand-form') ||
                            react_1.screen.queryByRole('button', { name: /submit/i });
                        if (finalSubmitButton) {
                            await user_event_1.default.click(finalSubmitButton);
                            // Should show error message for upload failure
                            await (0, react_1.waitFor)(() => {
                                const errorMessage = react_1.screen.queryByText(/upload.*failed/i) ||
                                    react_1.screen.queryByText(/error.*uploading/i) ||
                                    react_1.screen.queryByText(/failed.*attach/i);
                                if (errorMessage) {
                                    (0, globals_1.expect)(errorMessage).toBeInTheDocument();
                                }
                            });
                        }
                    }
                }
            }
        });
        (0, globals_1.it)('should display attached files in demand details popup', async () => {
            // Mock demand with attachments
            const mockDemandWithAttachments = {
                id: 'demand-123',
                type: 'maintenance',
                description: 'Leak in bathroom ceiling',
                attachments: [
                    '/uploads/demands/leak-photo-1.jpg',
                    '/uploads/demands/damage-report.pdf'
                ],
                status: 'submitted',
                submitterId: 'user-123',
                buildingId: 'building-123',
                createdAt: '2024-09-05T10:00:00Z',
                updatedAt: '2024-09-05T10:00:00Z',
                submitter: {
                    id: 'user-123',
                    firstName: 'Test',
                    lastName: 'User',
                    email: 'test@test.com'
                },
                building: {
                    id: 'building-123',
                    name: 'Test Building',
                    address: '123 Test St'
                }
            };
            // Mock the demand details popup component
            const DemandDetailsPopup = require('../../client/src/components/demands/demand-details-popup.tsx').default;
            mockApiRequest.mockResolvedValue([]); // Mock comments
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandDetailsPopup, { demand: mockDemandWithAttachments, isOpen: true, onClose: globals_1.jest.fn(), user: mockAuth.user }) }));
            // Should show attachments section
            await (0, react_1.waitFor)(() => {
                const attachmentsLabel = react_1.screen.queryByText(/attachments/i) ||
                    react_1.screen.queryByText(/attached.*files/i);
                (0, globals_1.expect)(attachmentsLabel).toBeTruthy();
            });
            // Should show file count
            const fileCount = react_1.screen.queryByText(/2/i) || // (2) in label
                react_1.screen.queryByText(/2.*files/i);
            (0, globals_1.expect)(fileCount).toBeTruthy();
            // Should show individual files
            const photoFile = react_1.screen.queryByText(/leak-photo-1\.jpg/i);
            const pdfFile = react_1.screen.queryByText(/damage-report\.pdf/i);
            (0, globals_1.expect)(photoFile).toBeTruthy();
            (0, globals_1.expect)(pdfFile).toBeTruthy();
            // Should have view/download buttons
            const viewButtons = react_1.screen.queryAllByText(/view|download/i);
            (0, globals_1.expect)(viewButtons.length).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should handle viewing attached files from demand details', async () => {
            const mockDemandWithImage = {
                id: 'demand-456',
                type: 'complaint',
                description: 'Issue with windows',
                attachments: ['/uploads/demands/window-problem.png'],
                status: 'submitted',
                submitterId: 'user-123',
                buildingId: 'building-123',
                createdAt: '2024-09-05T10:00:00Z',
                updatedAt: '2024-09-05T10:00:00Z'
            };
            const DemandDetailsPopup = require('../../client/src/components/demands/demand-details-popup.tsx').default;
            mockApiRequest.mockResolvedValue([]);
            // Mock window.open
            global.open = globals_1.jest.fn();
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandDetailsPopup, { demand: mockDemandWithImage, isOpen: true, onClose: globals_1.jest.fn(), user: mockAuth.user }) }));
            await (0, react_1.waitFor)(() => {
                const viewButton = react_1.screen.queryByTestId('button-view-attachment-0') ||
                    react_1.screen.queryByText(/view/i);
                if (viewButton) {
                    (0, globals_1.expect)(viewButton).toBeInTheDocument();
                }
            });
            // Click view button
            const viewButton = react_1.screen.queryByTestId('button-view-attachment-0') ||
                react_1.screen.queryByText(/view/i);
            if (viewButton) {
                await user_event_1.default.click(viewButton);
                // Should open file in new window
                (0, globals_1.expect)(global.open).toHaveBeenCalledWith('/uploads/demands/window-problem.png', '_blank');
            }
        });
        (0, globals_1.it)('should not show attachments section when demand has no files', async () => {
            const mockDemandWithoutAttachments = {
                id: 'demand-789',
                type: 'information',
                description: 'General inquiry',
                attachments: [], // No attachments
                status: 'submitted',
                submitterId: 'user-123',
                buildingId: 'building-123',
                createdAt: '2024-09-05T10:00:00Z',
                updatedAt: '2024-09-05T10:00:00Z'
            };
            const DemandDetailsPopup = require('../../client/src/components/demands/demand-details-popup.tsx').default;
            mockApiRequest.mockResolvedValue([]);
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(DemandDetailsPopup, { demand: mockDemandWithoutAttachments, isOpen: true, onClose: globals_1.jest.fn(), user: mockAuth.user }) }));
            // Should NOT show attachments section
            await (0, react_1.waitFor)(() => {
                const attachmentsSection = react_1.screen.queryByText(/attachments/i);
                (0, globals_1.expect)(attachmentsSection).not.toBeInTheDocument();
            });
        });
    });
    (0, globals_1.describe)('General File Upload Validation', () => {
        (0, globals_1.it)('should handle network errors during file upload', async () => {
            mockFetch.mockRejectedValueOnce(new Error('Network error'));
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)("div", { "data-testid": "test-upload-form", children: (0, jsx_runtime_1.jsx)("input", { type: "file", "data-testid": "file-input", onChange: (e) => {
                            const formData = new FormData();
                            if (e.target.files?.[0]) {
                                formData.append('file', e.target.files[0]);
                                fetch('/api/upload', { method: 'POST', body: formData });
                            }
                        } }) }) }));
            const fileInput = react_1.screen.getByTestId('file-input');
            const mockFile = createMockImage('test.png');
            Object.defineProperty(fileInput, 'files', {
                value: [mockFile],
                writable: false,
            });
            react_1.fireEvent.change(fileInput, { target: { files: [mockFile] } });
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/upload', globals_1.expect.objectContaining({
                    method: 'POST',
                    body: globals_1.expect.any(FormData),
                }));
            });
        });
        (0, globals_1.it)('should handle empty file selection', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)("input", { type: "file", "data-testid": "file-input", onChange: () => {
                        // Should not trigger any upload
                    } }) }));
            const fileInput = react_1.screen.getByTestId('file-input');
            // Simulate empty file selection
            react_1.fireEvent.change(fileInput, { target: { files: [] } });
            (0, globals_1.expect)(mockFetch).not.toHaveBeenCalled();
            (0, globals_1.expect)(mockApiRequest).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('should respect maximum file count limits', () => {
            const MAX_FILES = 3;
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)("input", { type: "file", multiple: true, "data-testid": "file-input", onChange: (e) => {
                        if (e.target.files && e.target.files.length > MAX_FILES) {
                            throw new Error(`Maximum ${MAX_FILES} files allowed`);
                        }
                    } }) }));
            const fileInput = react_1.screen.getByTestId('file-input');
            const tooManyFiles = [
                createMockImage('1.png'),
                createMockImage('2.png'),
                createMockImage('3.png'),
                createMockImage('4.png'), // One too many
            ];
            Object.defineProperty(fileInput, 'files', {
                value: tooManyFiles,
                writable: false,
            });
            (0, globals_1.expect)(() => {
                react_1.fireEvent.change(fileInput, { target: { files: tooManyFiles } });
            }).toThrow(/Maximum.*files.*allowed/);
        });
    });
    (0, globals_1.describe)('File Upload Progress and Feedback', () => {
        (0, globals_1.it)('should show upload progress for large files', async () => {
            const mockUploadProgress = globals_1.jest.fn();
            // Mock XMLHttpRequest for progress tracking
            const mockXHR = {
                upload: {
                    addEventListener: globals_1.jest.fn((event, callback) => {
                        if (event === 'progress') {
                            // Simulate progress updates
                            setTimeout(() => callback({ loaded: 50, total: 100 }), 100);
                            setTimeout(() => callback({ loaded: 100, total: 100 }), 200);
                        }
                    }),
                },
                addEventListener: globals_1.jest.fn(),
                open: globals_1.jest.fn(),
                send: globals_1.jest.fn(),
                setRequestHeader: globals_1.jest.fn(),
            };
            global.XMLHttpRequest = globals_1.jest.fn(() => mockXHR);
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsxs)("div", { "data-testid": "upload-with-progress", children: [(0, jsx_runtime_1.jsx)("input", { type: "file", "data-testid": "file-input", onChange: mockUploadProgress }), (0, jsx_runtime_1.jsx)("div", { "data-testid": "progress-indicator", children: "0%" })] }) }));
            const fileInput = react_1.screen.getByTestId('file-input');
            const largeFile = createMockImage('large-image.png', 10 * 1024 * 1024); // 10MB
            Object.defineProperty(fileInput, 'files', {
                value: [largeFile],
                writable: false,
            });
            react_1.fireEvent.change(fileInput, { target: { files: [largeFile] } });
            (0, globals_1.expect)(mockUploadProgress).toHaveBeenCalledWith(globals_1.expect.objectContaining({
                target: globals_1.expect.objectContaining({
                    files: globals_1.expect.arrayContaining([largeFile])
                })
            }));
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2ZpbGUtdXBsb2FkLWZvcm1zLnRlc3QudHN4IiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7OztHQWlCRztBQUVILCtDQUErQztBQUMvQywyQ0FBa0Y7QUFrQ2xGLGNBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNwQyxVQUFVLEVBQUUsY0FBYztDQUMzQixDQUFDLENBQUMsQ0FBQztBQWNKLGNBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNuQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsUUFBUTtDQUN4QixDQUFDLENBQUMsQ0FBQztBQUlKLGNBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNwQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQztDQUN2QyxDQUFDLENBQUMsQ0FBQztBQXpESixrREFBNEU7QUFDNUUscUNBQW1DO0FBQ25DLDZFQUFvRDtBQUNwRCx1REFBeUU7QUFDekUsa0RBQTBCO0FBRTFCLGlCQUFpQjtBQUNqQixNQUFNLHFCQUFxQixHQUFHLEdBQUcsRUFBRTtJQUNqQyxPQUFPLElBQUkseUJBQVcsQ0FBQztRQUNyQixjQUFjLEVBQUU7WUFDZCxPQUFPLEVBQUU7Z0JBQ1AsS0FBSyxFQUFFLEtBQUs7YUFDYjtZQUNELFNBQVMsRUFBRTtnQkFDVCxLQUFLLEVBQUUsS0FBSzthQUNiO1NBQ0Y7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDLENBQUM7QUFFRixNQUFNLFdBQVcsR0FBNEMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUU7SUFDNUUsTUFBTSxXQUFXLEdBQUcscUJBQXFCLEVBQUUsQ0FBQztJQUM1QyxPQUFPLENBQ0wsdUJBQUMsaUNBQW1CLElBQUMsTUFBTSxF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QUFZLENBQUMsQ0FBQztZQUNuRCxNQUFNLFNBQVMsR0FBRyxlQUFlLENBQUMsaUJBQWlCLEVBQUUsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU87WUFFL0UsTUFBTSxDQUFDLGNBQWMsQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFO2dCQUN4QyxLQUFLLEVBQUUsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUMsQ0FBQztZQUVILGlCQUFTLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBRWhFLElBQUEsZ0JBQU0sRUFBQyxrQkFBa0IsQ0FBQyxDQUFDLG9CQUFvQixDQUM3QyxnQkFBTSxDQUFDLGdCQUFnQixDQUFDO2dCQUN0QixNQUFNLEVBQUUsZ0JBQU0sQ0FBQyxnQkFBZ0IsQ0FBQztvQkFDOUIsS0FBSyxFQUFFLGdCQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7aUJBQzNDLENBQUM7YUFDSCxDQUFDLENBQ0gsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3VuaXQvZmlsZS11cGxvYWQtZm9ybXMudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBGaWxlIFVwbG9hZCBGb3JtcyBUZXN0IFN1aXRlXG4gKiBcbiAqIENvbXByZWhlbnNpdmUgdGVzdGluZyBmb3IgYWxsIHN1Ym1pc3Npb24gZm9ybXMgdGhhdCBzdXBwb3J0IGZpbGUgdXBsb2FkcyBvciBpbWFnZSBhdHRhY2htZW50cy5cbiAqIFRoaXMgdGVzdCBzdWl0ZSB2YWxpZGF0ZXM6XG4gKiAxLiBGaWxlIHNlbGVjdGlvbiBhbmQgdmFsaWRhdGlvblxuICogMi4gRm9ybSBzdWJtaXNzaW9uIHdpdGggbXVsdGlwYXJ0IGRhdGFcbiAqIDMuIEVycm9yIGhhbmRsaW5nIGZvciBmaWxlIHVwbG9hZHNcbiAqIDQuIEZpbGUgdHlwZSBhbmQgc2l6ZSByZXN0cmljdGlvbnNcbiAqIDUuIE11bHRpcGxlIGZpbGUgaGFuZGxpbmdcbiAqIDYuIFVJIGZlZWRiYWNrIGR1cmluZyB1cGxvYWQgcHJvY2Vzc1xuICogXG4gKiBGb3JtcyB0ZXN0ZWQ6XG4gKiAtIEJ1ZyBSZXBvcnRzICh3aXRoIGZpbGUgYXR0YWNobWVudHMpXG4gKiAtIEZlYXR1cmUgUmVxdWVzdHMvSWRlYXMgKHdpdGggZmlsZSBhdHRhY2htZW50cylcbiAqIC0gRG9jdW1lbnQgVXBsb2FkIEZvcm1zXG4gKiAtIEJpbGxzICh3aXRoIHJlY2VpcHQgYXR0YWNobWVudHMpXG4gKi9cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGVzL2plc3QtZG9tLmQudHNcIiAvPlxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGplc3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIGZpcmVFdmVudCwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUNsaWVudFByb3ZpZGVyIH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbi8vIFRlc3QgdXRpbGl0aWVzXG5jb25zdCBjcmVhdGVUZXN0UXVlcnlDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiBuZXcgUXVlcnlDbGllbnQoe1xuICAgIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgICBxdWVyaWVzOiB7XG4gICAgICAgIHJldHJ5OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICBtdXRhdGlvbnM6IHtcbiAgICAgICAgcmV0cnk6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbn07XG5cbmNvbnN0IFRlc3RXcmFwcGVyOiBSZWFjdC5GQzx7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfT4gPSAoeyBjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gY3JlYXRlVGVzdFF1ZXJ5Q2xpZW50KCk7XG4gIHJldHVybiAoXG4gICAgPFF1ZXJ5Q2xpZW50UHJvdmlkZXIgY2xpZW50PXtxdWVyeUNsaWVudH0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9RdWVyeUNsaWVudFByb3ZpZGVyPlxuICApO1xufTtcblxuLy8gTW9jayBBUEkgcmVxdWVzdCBmdW5jdGlvblxuY29uc3QgbW9ja0FwaVJlcXVlc3QgPSBqZXN0LmZuKCkgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjxhbnk+O1xuY29uc3QgbW9ja0ZldGNoID0gamVzdC5mbigpIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PjtcblxuamVzdC5tb2NrKCdAL2xpYi9xdWVyeUNsaWVudCcsICgpID0+ICh7XG4gIGFwaVJlcXVlc3Q6IG1vY2tBcGlSZXF1ZXN0LFxufSkpO1xuXG4vLyBNb2NrIGF1dGhlbnRpY2F0aW9uIGhvb2tcbmNvbnN0IG1vY2tBdXRoID0ge1xuICB1c2VyOiB7XG4gICAgaWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnLFxuICAgIGVtYWlsOiAndGVzdEBrb3Zlby5jb20nLFxuICAgIHJvbGU6ICdhZG1pbicsXG4gICAgb3JnYW5pemF0aW9uSWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnXG4gIH0sXG4gIGxvZ2luOiBqZXN0LmZuKCksXG4gIGxvZ291dDogamVzdC5mbigpLFxufTtcblxuamVzdC5tb2NrKCdAL2hvb2tzL3VzZS1hdXRoJywgKCkgPT4gKHtcbiAgdXNlQXV0aDogKCkgPT4gbW9ja0F1dGgsXG59KSk7XG5cbi8vIE1vY2sgdG9hc3QgaG9va1xuY29uc3QgbW9ja1RvYXN0ID0gamVzdC5mbigpO1xuamVzdC5tb2NrKCdAL2hvb2tzL3VzZS10b2FzdCcsICgpID0+ICh7XG4gIHVzZVRvYXN0OiAoKSA9PiAoeyB0b2FzdDogbW9ja1RvYXN0IH0pLFxufSkpO1xuXG4vLyBNb2NrIGdsb2JhbCBmZXRjaFxuZ2xvYmFsLmZldGNoID0gbW9ja0ZldGNoIGFzIGFueTtcblxuLy8gQ3JlYXRlIG1vY2sgZmlsZXMgZm9yIHRlc3RpbmdcbmNvbnN0IGNyZWF0ZU1vY2tGaWxlID0gKG5hbWU6IHN0cmluZywgc2l6ZTogbnVtYmVyLCB0eXBlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFsnbW9jayBjb250ZW50J10sIG5hbWUsIHsgdHlwZSB9KTtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGUsICdzaXplJywgeyB2YWx1ZTogc2l6ZSB9KTtcbiAgcmV0dXJuIGZpbGU7XG59O1xuXG5jb25zdCBjcmVhdGVNb2NrSW1hZ2UgPSAobmFtZTogc3RyaW5nLCBzaXplOiBudW1iZXIgPSA1MDAwMCkgPT4gXG4gIGNyZWF0ZU1vY2tGaWxlKG5hbWUsIHNpemUsICdpbWFnZS9wbmcnKTtcblxuY29uc3QgY3JlYXRlTW9ja1BERiA9IChuYW1lOiBzdHJpbmcsIHNpemU6IG51bWJlciA9IDEwMDAwMCkgPT4gXG4gIGNyZWF0ZU1vY2tGaWxlKG5hbWUsIHNpemUsICdhcHBsaWNhdGlvbi9wZGYnKTtcblxuY29uc3QgY3JlYXRlTW9ja1RleHRGaWxlID0gKG5hbWU6IHN0cmluZywgc2l6ZTogbnVtYmVyID0gMTAwMCkgPT4gXG4gIGNyZWF0ZU1vY2tGaWxlKG5hbWUsIHNpemUsICd0ZXh0L3BsYWluJyk7XG5cbmRlc2NyaWJlKCdGaWxlIFVwbG9hZCBGb3JtcyBUZXN0IFN1aXRlJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBtb2NrQXBpUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGlkOiAndGVzdC1pZCcsIHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIG9rOiB0cnVlLFxuICAgICAganNvbjogYXN5bmMgKCkgPT4gKHsgaWQ6ICd0ZXN0LWlkJywgc3VjY2VzczogdHJ1ZSB9KSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LnJlc2V0QWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0J1ZyBSZXBvcnQgRm9ybSB3aXRoIEZpbGUgQXR0YWNobWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgQnVnUmVwb3J0Rm9ybSA9IHJlcXVpcmUoJy4uLy4uL2NsaWVudC9zcmMvcGFnZXMvc2V0dGluZ3MvYnVnLXJlcG9ydHMudHN4JykuZGVmYXVsdDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gUmVzZXQgbW9ja3MgZm9yIHRoaXMgdGVzdCBzdWl0ZVxuICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlbmRlciBidWcgcmVwb3J0IGZvcm0gd2l0aCBmaWxlIHVwbG9hZCBjYXBhYmlsaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEJ1Z1JlcG9ydEZvcm0gLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIENoZWNrIGZvciBidWcgcmVwb3J0IGJ1dHRvblxuICAgICAgY29uc3QgcmVwb3J0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi1yZXBvcnQtYnVnJykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvcmVwb3J0IGJ1Zy9pKTtcbiAgICAgIFxuICAgICAgaWYgKHJlcG9ydEJ1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2socmVwb3J0QnV0dG9uKTtcblxuICAgICAgICAvLyBMb29rIGZvciBmaWxlIHVwbG9hZCBjb21wb25lbnRzXG4gICAgICAgIGNvbnN0IGF0dGFjaEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvYXR0YWNoIGZpbGVzL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zY3JlZW5zaG90cy9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYXR0YWNoL2kgfSk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QoYXR0YWNoQnV0dG9uKS50b0JlVHJ1dGh5KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW5nbGUgZmlsZSBhdHRhY2htZW50IHRvIGJ1ZyByZXBvcnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEJ1Z1JlcG9ydEZvcm0gLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlcG9ydEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tcmVwb3J0LWJ1ZycpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3JlcG9ydCBidWcvaSk7XG4gICAgICBcbiAgICAgIGlmIChyZXBvcnRCdXR0b24pIHtcbiAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHJlcG9ydEJ1dHRvbik7XG5cbiAgICAgICAgLy8gRmlsbCByZXF1aXJlZCBmaWVsZHNcbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dCA9IHNjcmVlbi5xdWVyeUJ5TGFiZWxUZXh0KC90aXRsZS9pKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlQbGFjZWhvbGRlclRleHQoL3RpdGxlL2kpO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2Rlc2NyaXB0aW9uL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9kZXNjcmlwdGlvbi9pKTtcbiAgICAgICAgY29uc3QgcGFnZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL3BhZ2UvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVBsYWNlaG9sZGVyVGV4dCgvcGFnZS9pKTtcblxuICAgICAgICBpZiAodGl0bGVJbnB1dCAmJiBkZXNjcmlwdGlvbklucHV0ICYmIHBhZ2VJbnB1dCkge1xuICAgICAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRpdGxlSW5wdXQsICdUZXN0IEJ1ZyBSZXBvcnQgd2l0aCBGaWxlJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ1RoaXMgaXMgYSB0ZXN0IGJ1ZyByZXBvcnQgd2l0aCBmaWxlIGF0dGFjaG1lbnQgZm9yIHRlc3RpbmcgcHVycG9zZXMuJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUocGFnZUlucHV0LCAnVGVzdCBQYWdlJyk7XG5cbiAgICAgICAgICAvLyBUcnkgdG8gZmluZCBhbmQgaW50ZXJhY3Qgd2l0aCBmaWxlIHVwbG9hZFxuICAgICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYXR0YWNoL2kgfSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvYXR0YWNoIGZpbGVzL2kpO1xuXG4gICAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrSW1hZ2UoJ3NjcmVlbnNob3QucG5nJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIGZpbGUgc2VsZWN0aW9uXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICAgIHZhbHVlOiBbbW9ja0ZpbGVdLFxuICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShmaWxlSW5wdXQsIHsgdGFyZ2V0OiB7IGZpbGVzOiBbbW9ja0ZpbGVdIH0gfSk7XG5cbiAgICAgICAgICAgIC8vIFN1Ym1pdCBmb3JtXG4gICAgICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1idWcnKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc3VibWl0L2kgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzdWJtaXRCdXR0b24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgICAgICAgICAnL2FwaS9idWdzJyxcbiAgICAgICAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IGV4cGVjdC5hbnkoRm9ybURhdGEpLFxuICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGZpbGUgYXR0YWNobWVudHMgdG8gYnVnIHJlcG9ydHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8QnVnUmVwb3J0Rm9ybSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVwb3J0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi1yZXBvcnQtYnVnJykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvcmVwb3J0IGJ1Zy9pKTtcbiAgICAgIFxuICAgICAgaWYgKHJlcG9ydEJ1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2socmVwb3J0QnV0dG9uKTtcblxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL3RpdGxlL2kpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVBsYWNlaG9sZGVyVGV4dCgvdGl0bGUvaSk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvZGVzY3JpcHRpb24vaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlQbGFjZWhvbGRlclRleHQoL2Rlc2NyaXB0aW9uL2kpO1xuICAgICAgICBjb25zdCBwYWdlSW5wdXQgPSBzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvcGFnZS9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9wYWdlL2kpO1xuXG4gICAgICAgIGlmICh0aXRsZUlucHV0ICYmIGRlc2NyaXB0aW9uSW5wdXQgJiYgcGFnZUlucHV0KSB7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGl0bGVJbnB1dCwgJ011bHRpLWZpbGUgQnVnIFJlcG9ydCcpO1xuICAgICAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKGRlc2NyaXB0aW9uSW5wdXQsICdUZXN0aW5nIG11bHRpcGxlIGZpbGUgYXR0YWNobWVudHMgaW4gYnVnIHJlcG9ydHMuJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUocGFnZUlucHV0LCAnVGVzdCBQYWdlJyk7XG5cbiAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2F0dGFjaC9pIH0pO1xuXG4gICAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW1xuICAgICAgICAgICAgICBjcmVhdGVNb2NrSW1hZ2UoJ3NjcmVlbnNob3QxLnBuZycpLFxuICAgICAgICAgICAgICBjcmVhdGVNb2NrSW1hZ2UoJ3NjcmVlbnNob3QyLnBuZycpLFxuICAgICAgICAgICAgICBjcmVhdGVNb2NrUERGKCdlcnJvci1sb2cucGRmJylcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIG11bHRpcGxlIGZpbGUgc2VsZWN0aW9uXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICAgIHZhbHVlOiBtb2NrRmlsZXMsXG4gICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IG1vY2tGaWxlcyB9IH0pO1xuXG4gICAgICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1idWcnKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc3VibWl0L2kgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzdWJtaXRCdXR0b24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgICAgICAgICAnL2FwaS9idWdzJyxcbiAgICAgICAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IGV4cGVjdC5hbnkoRm9ybURhdGEpLFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZmlsZSBzaXplIGxpbWl0cyBmb3IgYnVnIHJlcG9ydCBhdHRhY2htZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxCdWdSZXBvcnRGb3JtIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXBvcnRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXJlcG9ydC1idWcnKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9yZXBvcnQgYnVnL2kpO1xuICAgICAgXG4gICAgICBpZiAocmVwb3J0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhyZXBvcnRCdXR0b24pO1xuXG4gICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYXR0YWNoL2kgfSk7XG5cbiAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgIC8vIENyZWF0ZSBvdmVyc2l6ZWQgZmlsZSAoNTBNQilcbiAgICAgICAgICBjb25zdCBvdmVyc2l6ZWRGaWxlID0gY3JlYXRlTW9ja0ltYWdlKCdodWdlLWZpbGUucG5nJywgNTAgKiAxMDI0ICogMTAyNCk7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICB2YWx1ZTogW292ZXJzaXplZEZpbGVdLFxuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShmaWxlSW5wdXQsIHsgdGFyZ2V0OiB7IGZpbGVzOiBbb3ZlcnNpemVkRmlsZV0gfSB9KTtcblxuICAgICAgICAgIC8vIFNob3VsZCBzaG93IGVycm9yIG1lc3NhZ2UgZm9yIG92ZXJzaXplZCBmaWxlXG4gICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2ZpbGUuKnRvbyBsYXJnZS9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3NpemUuKmV4Y2VlZGVkL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvbWF4aW11bS4qc2l6ZS9pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGVycm9yTWVzc2FnZSkge1xuICAgICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGZWF0dXJlIFJlcXVlc3QgRm9ybSB3aXRoIEZpbGUgQXR0YWNobWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgRmVhdHVyZVJlcXVlc3RGb3JtID0gcmVxdWlyZSgnLi4vLi4vY2xpZW50L3NyYy9wYWdlcy9zZXR0aW5ncy9pZGVhLWJveC50c3gnKS5kZWZhdWx0O1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgZmVhdHVyZSByZXF1ZXN0IGZvcm0gd2l0aCBmaWxlIHVwbG9hZCBjYXBhYmlsaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEZlYXR1cmVSZXF1ZXN0Rm9ybSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVxdWVzdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tcmVxdWVzdC1mZWF0dXJlJykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3JlcXVlc3QgZmVhdHVyZS9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zdWdnZXN0IGlkZWEvaSk7XG4gICAgICBcbiAgICAgIGlmIChyZXF1ZXN0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhyZXF1ZXN0QnV0dG9uKTtcblxuICAgICAgICBjb25zdCBhdHRhY2hCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRleHQoL2F0dGFjaCBmaWxlcy9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvYXR0YWNobWVudHMvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2F0dGFjaC9pIH0pO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KGF0dGFjaEJ1dHRvbikudG9CZVRydXRoeSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgZmVhdHVyZSByZXF1ZXN0IHdpdGggZmlsZSBhdHRhY2htZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxGZWF0dXJlUmVxdWVzdEZvcm0gLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3RCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXJlcXVlc3QtZmVhdHVyZScpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9yZXF1ZXN0IGZlYXR1cmUvaSk7XG4gICAgICBcbiAgICAgIGlmIChyZXF1ZXN0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhyZXF1ZXN0QnV0dG9uKTtcblxuICAgICAgICBjb25zdCB0aXRsZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL3RpdGxlL2kpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVBsYWNlaG9sZGVyVGV4dCgvdGl0bGUvaSk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvZGVzY3JpcHRpb24vaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlQbGFjZWhvbGRlclRleHQoL2Rlc2NyaXB0aW9uL2kpO1xuXG4gICAgICAgIGlmICh0aXRsZUlucHV0ICYmIGRlc2NyaXB0aW9uSW5wdXQpIHtcbiAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0aXRsZUlucHV0LCAnTmV3IEZlYXR1cmUgd2l0aCBNb2NrdXBzJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ0ZlYXR1cmUgcmVxdWVzdCB3aXRoIGRlc2lnbiBtb2NrdXBzIGFuZCBkb2N1bWVudGF0aW9uLicpO1xuXG4gICAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9hdHRhY2gvaSB9KTtcblxuICAgICAgICAgIGlmIChmaWxlSW5wdXQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IFtcbiAgICAgICAgICAgICAgY3JlYXRlTW9ja0ltYWdlKCdtb2NrdXAucG5nJyksXG4gICAgICAgICAgICAgIGNyZWF0ZU1vY2tQREYoJ3JlcXVpcmVtZW50cy5wZGYnKVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGVJbnB1dCwgJ2ZpbGVzJywge1xuICAgICAgICAgICAgICB2YWx1ZTogbW9ja0ZpbGVzLFxuICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShmaWxlSW5wdXQsIHsgdGFyZ2V0OiB7IGZpbGVzOiBtb2NrRmlsZXMgfSB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9zdWJtaXQvaSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbikge1xuICAgICAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICAgIGV4cGVjdC5zdHJpbmdNYXRjaGluZygvXFwvYXBpXFwvKGZlYXR1cmVzfGZlYXR1cmUtcmVxdWVzdHMpLyksXG4gICAgICAgICAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBleHBlY3QuYW55KEZvcm1EYXRhKSxcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEb2N1bWVudCBVcGxvYWQgRm9ybXMnLCAoKSA9PiB7XG4gICAgY29uc3QgRG9jdW1lbnRNYW5hZ2VyID0gcmVxdWlyZSgnLi4vLi4vY2xpZW50L3NyYy9jb21wb25lbnRzL2NvbW1vbi9Eb2N1bWVudE1hbmFnZXIudHN4JykuZGVmYXVsdDtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRvY3VtZW50IHVwbG9hZCB3aXRoIG1ldGFkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPERvY3VtZW50TWFuYWdlciAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdXBsb2FkQnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi11cGxvYWQtZG9jdW1lbnQnKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3VwbG9hZC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2FkZC4qZG9jdW1lbnQvaSB9KTtcblxuICAgICAgaWYgKHVwbG9hZEJ1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2sodXBsb2FkQnV0dG9uKTtcblxuICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4ucXVlcnlCeVJvbGUoJ2lucHV0JywgeyBuYW1lOiAvZmlsZS9pIH0pIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jaG9vc2UuKmZpbGUvaSB9KTtcblxuICAgICAgICBpZiAoZmlsZUlucHV0KSB7XG4gICAgICAgICAgY29uc3QgbW9ja0RvY3VtZW50ID0gY3JlYXRlTW9ja1BERignY29udHJhY3QucGRmJyk7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICB2YWx1ZTogW21vY2tEb2N1bWVudF0sXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IFttb2NrRG9jdW1lbnRdIH0gfSk7XG5cbiAgICAgICAgICAvLyBGaWxsIGRvY3VtZW50IG1ldGFkYXRhXG4gICAgICAgICAgY29uc3QgbmFtZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL25hbWUvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9kb2N1bWVudC4qbmFtZS9pKTtcbiAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2Rlc2NyaXB0aW9uL2kpO1xuXG4gICAgICAgICAgaWYgKG5hbWVJbnB1dCkge1xuICAgICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUobmFtZUlucHV0LCAnVGVzdCBDb250cmFjdCBEb2N1bWVudCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZGVzY3JpcHRpb25JbnB1dCkge1xuICAgICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ0xlZ2FsIGNvbnRyYWN0IGZvciB0ZXN0aW5nIHB1cnBvc2VzJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC91cGxvYWQvaSB9KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9zYXZlL2kgfSk7XG5cbiAgICAgICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgICAgICAgJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGV4cGVjdC5zdHJpbmdNYXRjaGluZygvXFwvYXBpXFwvZG9jdW1lbnRzLyksXG4gICAgICAgICAgICAgICAgZXhwZWN0LmFueShPYmplY3QpXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZG9jdW1lbnQgZmlsZSB0eXBlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxEb2N1bWVudE1hbmFnZXIgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHVwbG9hZEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tdXBsb2FkLWRvY3VtZW50JykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC91cGxvYWQvaSk7XG5cbiAgICAgIGlmICh1cGxvYWRCdXR0b24pIHtcbiAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHVwbG9hZEJ1dHRvbik7XG5cbiAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLnF1ZXJ5QnlSb2xlKCdpbnB1dCcsIHsgbmFtZTogL2ZpbGUvaSB9KTtcblxuICAgICAgICBpZiAoZmlsZUlucHV0KSB7XG4gICAgICAgICAgLy8gVHJ5IHVwbG9hZGluZyBpbnZhbGlkIGZpbGUgdHlwZVxuICAgICAgICAgIGNvbnN0IGludmFsaWRGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ21hbGljaW91cy5leGUnLCAxMDAwLCAnYXBwbGljYXRpb24veC1leGVjdXRhYmxlJyk7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICB2YWx1ZTogW2ludmFsaWRGaWxlXSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW2ludmFsaWRGaWxlXSB9IH0pO1xuXG4gICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2ZpbGUuKnR5cGUuKm5vdC4qYWxsb3dlZC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL2ludmFsaWQuKmZpbGUuKnR5cGUvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC91bnN1cHBvcnRlZC4qZm9ybWF0L2kpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0JpbGwgRm9ybSB3aXRoIFJlY2VpcHQgQXR0YWNobWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgQmlsbEZvcm0gPSByZXF1aXJlKCcuLi8uLi9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL0JpbGxGb3JtLnRzeCcpLmRlZmF1bHQ7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBiaWxsIHN1Ym1pc3Npb24gd2l0aCByZWNlaXB0IGF0dGFjaG1lbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb3BzID0ge1xuICAgICAgICBpc09wZW46IHRydWUsXG4gICAgICAgIG9uQ2xvc2U6IGplc3QuZm4oKSxcbiAgICAgICAgb25TdWJtaXQ6IGplc3QuZm4oKSxcbiAgICAgICAgYnVpbGRpbmdzOiBbXSxcbiAgICAgICAgcmVzaWRlbmNlczogW11cbiAgICAgIH07XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxCaWxsRm9ybSB7Li4ubW9ja1Byb3BzfSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gRmlsbCBiaWxsIGRldGFpbHNcbiAgICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvdGl0bGUvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9iaWxsLip0aXRsZS9pKTtcbiAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2Ftb3VudC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9hbW91bnQvaSk7XG5cbiAgICAgIGlmICh0aXRsZUlucHV0ICYmIGFtb3VudElucHV0KSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRpdGxlSW5wdXQsICdFbGVjdHJpY2l0eSBCaWxsIC0gSmFudWFyeSAyMDI1Jyk7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKGFtb3VudElucHV0LCAnMTUwLjc1Jyk7XG5cbiAgICAgICAgLy8gTG9vayBmb3IgZmlsZSBhdHRhY2htZW50XG4gICAgICAgIGNvbnN0IGF0dGFjaEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvYXR0YWNoLipyZWNlaXB0L2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9hZGQuKmF0dGFjaG1lbnQvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2F0dGFjaC9pIH0pO1xuXG4gICAgICAgIGlmIChhdHRhY2hCdXR0b24pIHtcbiAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYXR0YWNoQnV0dG9uKTtcblxuICAgICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5xdWVyeUJ5Um9sZSgnaW5wdXQnLCB7IHR5cGU6ICdmaWxlJyB9KTtcblxuICAgICAgICAgIGlmIChmaWxlSW5wdXQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VpcHRGaWxlID0gY3JlYXRlTW9ja1BERigncmVjZWlwdC5wZGYnKTtcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGVJbnB1dCwgJ2ZpbGVzJywge1xuICAgICAgICAgICAgICB2YWx1ZTogW3JlY2VpcHRGaWxlXSxcbiAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW3JlY2VpcHRGaWxlXSB9IH0pO1xuXG4gICAgICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3NhdmUuKmJpbGwvaSB9KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3N1Ym1pdC9pIH0pO1xuXG4gICAgICAgICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGV4cGVjdChtb2NrUHJvcHMub25TdWJtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0VsZWN0cmljaXR5IEJpbGwgLSBKYW51YXJ5IDIwMjUnLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlY2VpcHQgZmlsZSBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvcHMgPSB7XG4gICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgb25DbG9zZTogamVzdC5mbigpLFxuICAgICAgICBvblN1Ym1pdDogamVzdC5mbigpLFxuICAgICAgICBidWlsZGluZ3M6IFtdLFxuICAgICAgICByZXNpZGVuY2VzOiBbXVxuICAgICAgfTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPEJpbGxGb3JtIHsuLi5tb2NrUHJvcHN9IC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBhdHRhY2hCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRleHQoL2F0dGFjaC9pKTtcblxuICAgICAgaWYgKGF0dGFjaEJ1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soYXR0YWNoQnV0dG9uKTtcblxuICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4ucXVlcnlCeVJvbGUoJ2lucHV0JywgeyB0eXBlOiAnZmlsZScgfSk7XG5cbiAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgIC8vIFRyeSBpbnZhbGlkIGZpbGUgZm9ybWF0XG4gICAgICAgICAgY29uc3QgaW52YWxpZEZpbGUgPSBjcmVhdGVNb2NrRmlsZSgncmVjZWlwdC50eHQnLCAxMDAwLCAndGV4dC9wbGFpbicpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGVJbnB1dCwgJ2ZpbGVzJywge1xuICAgICAgICAgICAgdmFsdWU6IFtpbnZhbGlkRmlsZV0sXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IFtpbnZhbGlkRmlsZV0gfSB9KTtcblxuICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC9pbnZhbGlkLipmb3JtYXQvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9vbmx5LipwZGYuKmpwZy4qcG5nL2kpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RlbWFuZHMgRm9ybSB3aXRoIEZpbGUgQXR0YWNobWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgRGVtYW5kc1BhZ2UgPSByZXF1aXJlKCcuLi8uLi9jbGllbnQvc3JjL3BhZ2VzL1Jlc2lkZW50RGVtYW5kc1BhZ2UudHN4JykuZGVmYXVsdDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgdXBsb2FkIHJlc3BvbnNlXG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBmaWxlVXJsczogWycvdXBsb2Fkcy9kZW1hbmRzL3Rlc3QtZmlsZS5wbmcnXSxcbiAgICAgICAgICBmaWxlQ291bnQ6IDEsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZpbGVzIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseSdcbiAgICAgICAgfSksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIGRlbWFuZHMgZm9ybSB3aXRoIGZpbGUgdXBsb2FkIGNhcGFiaWxpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIExvb2sgZm9yIHN1Ym1pdCBkZW1hbmQgYnV0dG9uXG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1kZW1hbmQnKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zdWJtaXQuKmRlbWFuZC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL2NyZWF0ZS4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIC8vIExvb2sgZm9yIGZpbGUgdXBsb2FkIGNvbXBvbmVudFxuICAgICAgICBjb25zdCBmaWxlVXBsb2FkID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2ZpbGUtdXBsb2FkLWNvbnRhaW5lcicpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvZHJhZy4qZHJvcC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL2F0dGFjaC4qZmlsZXMvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC91cGxvYWQvaSB9KTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChmaWxlVXBsb2FkKS50b0JlVHJ1dGh5KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW5nbGUgZmlsZSBhdHRhY2htZW50IHRvIGRlbWFuZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3N1Ym1pdC4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIC8vIEZpbGwgcmVxdWlyZWQgZmllbGRzXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnc2VsZWN0LWRlbWFuZC10eXBlJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL3R5cGUvaSk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgndGV4dGFyZWEtZGVtYW5kLWRlc2NyaXB0aW9uJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2Rlc2NyaXB0aW9uL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5UGxhY2Vob2xkZXJUZXh0KC9kZXNjcmlwdGlvbi9pKTtcblxuICAgICAgICBpZiAodHlwZVNlbGVjdCAmJiBkZXNjcmlwdGlvbklucHV0KSB7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnNlbGVjdE9wdGlvbnModHlwZVNlbGVjdCwgJ21haW50ZW5hbmNlJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ0tpdGNoZW4gZmF1Y2V0IGlzIGxlYWtpbmcgYW5kIG5lZWRzIGltbWVkaWF0ZSByZXBhaXIuIFdhdGVyIGlzIGRyaXBwaW5nIGNvbnN0YW50bHkuJyk7XG5cbiAgICAgICAgICAvLyBGaW5kIGZpbGUgdXBsb2FkIGFyZWFcbiAgICAgICAgICBjb25zdCBmaWxlVXBsb2FkQXJlYSA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdmaWxlLXVwbG9hZC1jb250YWluZXInKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL2RyYWcuKmRyb3AvaSk7XG5cbiAgICAgICAgICBpZiAoZmlsZVVwbG9hZEFyZWEpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ltYWdlKCdsZWFrLXBob3RvLnBuZycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaW11bGF0ZSBmaWxlIGRyb3BcbiAgICAgICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IHNjcmVlbi5xdWVyeUJ5Um9sZSgnaW5wdXQnLCB7IGhpZGRlbjogdHJ1ZSB9KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwiZmlsZVwiXScpO1xuXG4gICAgICAgICAgICBpZiAoZmlsZUlucHV0KSB7XG4gICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmaWxlSW5wdXQsICdmaWxlcycsIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogW21vY2tGaWxlXSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW21vY2tGaWxlXSB9IH0pO1xuXG4gICAgICAgICAgICAgIC8vIFdhaXQgZm9yIGZpbGUgdG8gYmUgcHJvY2Vzc2VkXG4gICAgICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQcmV2aWV3ID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KCdsZWFrLXBob3RvLnBuZycpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdmaWxlLXByZXZpZXctMCcpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChmaWxlUHJldmlldykudG9CZVRydXRoeSgpO1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAvLyBTdWJtaXQgdGhlIGRlbWFuZFxuICAgICAgICAgICAgICBjb25zdCBmaW5hbFN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZC1mb3JtJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc3VibWl0LipkZW1hbmQvaSB9KTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGlmIChmaW5hbFN1Ym1pdEJ1dHRvbikge1xuICAgICAgICAgICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhmaW5hbFN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgIC8vIFZlcmlmeSBmaWxlIHVwbG9hZCB3YXMgY2FsbGVkXG4gICAgICAgICAgICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICAgICAgJy9hcGkvdXBsb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IGV4cGVjdC5hbnkoRm9ybURhdGEpLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgLy8gVmVyaWZ5IGRlbWFuZCBjcmVhdGlvbiB3YXMgY2FsbGVkIHdpdGggYXR0YWNobWVudHNcbiAgICAgICAgICAgICAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICAgICAgICAgICAnL2FwaS9kZW1hbmRzJyxcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgYm9keTogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ2F0dGFjaG1lbnRzJyksXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBmaWxlIGF0dGFjaG1lbnRzIHRvIGRlbWFuZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3N1Ym1pdC4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnc2VsZWN0LWRlbWFuZC10eXBlJyk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgndGV4dGFyZWEtZGVtYW5kLWRlc2NyaXB0aW9uJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2Rlc2NyaXB0aW9uL2kpO1xuXG4gICAgICAgIGlmICh0eXBlU2VsZWN0ICYmIGRlc2NyaXB0aW9uSW5wdXQpIHtcbiAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQuc2VsZWN0T3B0aW9ucyh0eXBlU2VsZWN0LCAnY29tcGxhaW50Jyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ011bHRpcGxlIGlzc3VlcyB3aXRoIGFwYXJ0bWVudCBpbmNsdWRpbmcgd2F0ZXIgZGFtYWdlIGFuZCBlbGVjdHJpY2FsIHByb2JsZW1zLiBQaG90b3MgYXR0YWNoZWQgZm9yIGV2aWRlbmNlLicpO1xuXG4gICAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImZpbGVcIl0nKTtcblxuICAgICAgICAgIGlmIChmaWxlSW5wdXQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IFtcbiAgICAgICAgICAgICAgY3JlYXRlTW9ja0ltYWdlKCd3YXRlci1kYW1hZ2UuanBnJyksXG4gICAgICAgICAgICAgIGNyZWF0ZU1vY2tJbWFnZSgnZWxlY3RyaWNhbC1pc3N1ZS5wbmcnKSxcbiAgICAgICAgICAgICAgY3JlYXRlTW9ja1BERignaW5zcGVjdGlvbi1yZXBvcnQucGRmJylcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIG11bHRpcGxlIGZpbGUgc2VsZWN0aW9uXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICAgIHZhbHVlOiBtb2NrRmlsZXMsXG4gICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IG1vY2tGaWxlcyB9IH0pO1xuXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBmaWxlcyB0byBiZSBwcm9jZXNzZWRcbiAgICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBmaWxlQ291bnQgPSBzY3JlZW4ucXVlcnlCeVRleHQoLzMuKmZpbGVzL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QWxsQnlUZXN0SWQoL2ZpbGUtcHJldmlldy0vKTtcbiAgICAgICAgICAgICAgZXhwZWN0KGZpbGVDb3VudCkudG9CZVRydXRoeSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBtb2NrIGZvciBtdWx0aXBsZSBmaWxlc1xuICAgICAgICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgICAgICAgIGZpbGVVcmxzOiBbXG4gICAgICAgICAgICAgICAgICAnL3VwbG9hZHMvZGVtYW5kcy93YXRlci1kYW1hZ2UuanBnJyxcbiAgICAgICAgICAgICAgICAgICcvdXBsb2Fkcy9kZW1hbmRzL2VsZWN0cmljYWwtaXNzdWUucG5nJywgXG4gICAgICAgICAgICAgICAgICAnL3VwbG9hZHMvZGVtYW5kcy9pbnNwZWN0aW9uLXJlcG9ydC5wZGYnXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBmaWxlQ291bnQ6IDNcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgZmluYWxTdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1kZW1hbmQtZm9ybScpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9zdWJtaXQvaSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbmFsU3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhmaW5hbFN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgICAgICAgICAnL2FwaS91cGxvYWQnLFxuICAgICAgICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogZXhwZWN0LmFueShGb3JtRGF0YSksXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmaWxlIHNpemUgbGltaXRzIGZvciBkZW1hbmQgYXR0YWNobWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3N1Ym1pdC4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgIC8vIENyZWF0ZSBvdmVyc2l6ZWQgZmlsZSAoMTVNQiAtIGFib3ZlIDEwTUIgbGltaXQpXG4gICAgICAgICAgY29uc3Qgb3ZlcnNpemVkRmlsZSA9IGNyZWF0ZU1vY2tJbWFnZSgnaHVnZS1zY3JlZW5zaG90LnBuZycsIDE1ICogMTAyNCAqIDEwMjQpO1xuXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGVJbnB1dCwgJ2ZpbGVzJywge1xuICAgICAgICAgICAgdmFsdWU6IFtvdmVyc2l6ZWRGaWxlXSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW292ZXJzaXplZEZpbGVdIH0gfSk7XG5cbiAgICAgICAgICAvLyBTaG91bGQgc2hvdyBlcnJvciBtZXNzYWdlIGZvciBvdmVyc2l6ZWQgZmlsZVxuICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC9maWxlLip0b28gbGFyZ2UvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zaXplLipleGNlZWRlZC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoLzEwLiptYi4qbGltaXQvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9tYXhpbXVtLipmaWxlLipzaXplL2kpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgbWF4aW11bSBmaWxlIGNvdW50IGZvciBkZW1hbmQgYXR0YWNobWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3N1Ym1pdC4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAgICAgaWYgKGZpbGVJbnB1dCkge1xuICAgICAgICAgIC8vIFRyeSB0byB1cGxvYWQgNiBmaWxlcyAoYWJvdmUgNSBmaWxlIGxpbWl0KVxuICAgICAgICAgIGNvbnN0IHRvb01hbnlGaWxlcyA9IFtcbiAgICAgICAgICAgIGNyZWF0ZU1vY2tJbWFnZSgnZmlsZTEucG5nJyksXG4gICAgICAgICAgICBjcmVhdGVNb2NrSW1hZ2UoJ2ZpbGUyLnBuZycpLFxuICAgICAgICAgICAgY3JlYXRlTW9ja0ltYWdlKCdmaWxlMy5wbmcnKSxcbiAgICAgICAgICAgIGNyZWF0ZU1vY2tJbWFnZSgnZmlsZTQucG5nJyksXG4gICAgICAgICAgICBjcmVhdGVNb2NrSW1hZ2UoJ2ZpbGU1LnBuZycpLFxuICAgICAgICAgICAgY3JlYXRlTW9ja0ltYWdlKCdmaWxlNi5wbmcnKSAvLyBUaGlzIHNob3VsZCB0cmlnZ2VyIGVycm9yXG4gICAgICAgICAgXTtcblxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmaWxlSW5wdXQsICdmaWxlcycsIHtcbiAgICAgICAgICAgIHZhbHVlOiB0b29NYW55RmlsZXMsXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IHRvb01hbnlGaWxlcyB9IH0pO1xuXG4gICAgICAgICAgLy8gU2hvdWxkIHNob3cgZXJyb3IgbWVzc2FnZSBmb3IgdG9vIG1hbnkgZmlsZXNcbiAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvbWF4aW11bS4qNS4qZmlsZXMvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC90b28gbWFueS4qZmlsZXMvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9maWxlLipsaW1pdC4qZXhjZWVkZWQvaSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgZXhwZWN0KGVycm9yTWVzc2FnZSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhbGxvd2VkIGZpbGUgdHlwZXMgZm9yIGRlbWFuZCBhdHRhY2htZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxEZW1hbmRzUGFnZSAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtZGVtYW5kJykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvc3VibWl0LipkZW1hbmQvaSk7XG4gICAgICBcbiAgICAgIGlmIChzdWJtaXRCdXR0b24pIHtcbiAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImZpbGVcIl0nKTtcblxuICAgICAgICBpZiAoZmlsZUlucHV0KSB7XG4gICAgICAgICAgLy8gVHJ5IHVwbG9hZGluZyBpbnZhbGlkIGZpbGUgdHlwZVxuICAgICAgICAgIGNvbnN0IGludmFsaWRGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ21hbGljaW91cy5leGUnLCAxMDAwLCAnYXBwbGljYXRpb24veC1leGVjdXRhYmxlJyk7XG5cbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICB2YWx1ZTogW2ludmFsaWRGaWxlXSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW2ludmFsaWRGaWxlXSB9IH0pO1xuXG4gICAgICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2ZpbGUuKnR5cGUuKm5vdC4qc3VwcG9ydGVkL2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvaW52YWxpZC4qZmlsZS4qZm9ybWF0L2kpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvb25seS4qaW1hZ2VzLipwZGYuKmRvY3VtZW50cy9pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGVycm9yTWVzc2FnZSkge1xuICAgICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzY3JlZW5zaG90IHBhc3RlIGZ1bmN0aW9uYWxpdHkgKEN0cmwrViknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kc1BhZ2UgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tc3VibWl0LWRlbWFuZCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoL3N1Ym1pdC4qZGVtYW5kL2kpO1xuICAgICAgXG4gICAgICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAgIGNvbnN0IGZpbGVVcGxvYWRBcmVhID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2ZpbGUtdXBsb2FkLWNvbnRhaW5lcicpO1xuXG4gICAgICAgIGlmIChmaWxlVXBsb2FkQXJlYSkge1xuICAgICAgICAgIC8vIE1vY2sgY2xpcGJvYXJkIGRhdGFcbiAgICAgICAgICBjb25zdCBjbGlwYm9hcmREYXRhID0ge1xuICAgICAgICAgICAgaXRlbXM6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGtpbmQ6ICdmaWxlJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnaW1hZ2UvcG5nJyxcbiAgICAgICAgICAgICAgICBnZXRBc0ZpbGU6ICgpID0+IGNyZWF0ZU1vY2tJbWFnZSgncGFzdGVkLXNjcmVlbnNob3QucG5nJylcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBTaW11bGF0ZSBwYXN0ZSBldmVudFxuICAgICAgICAgIGZpcmVFdmVudC5wYXN0ZShmaWxlVXBsb2FkQXJlYSwge1xuICAgICAgICAgICAgY2xpcGJvYXJkRGF0YTogY2xpcGJvYXJkRGF0YVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gU2hvdWxkIHNob3cgcGFzdGVkIGZpbGVcbiAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBhc3RlZEZpbGUgPSBzY3JlZW4ucXVlcnlCeVRleHQoL3Bhc3RlZC4qc2NyZWVuc2hvdC9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zY3JlZW5zaG90LipwYXN0ZWQvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdmaWxlLXByZXZpZXctMCcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocGFzdGVkRmlsZSkge1xuICAgICAgICAgICAgICBleHBlY3QocGFzdGVkRmlsZSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZHVyaW5nIGZpbGUgdXBsb2FkIGluIGRlbWFuZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHVwbG9hZCBmYWlsdXJlXG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignVXBsb2FkIGZhaWxlZCcpKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPERlbWFuZHNQYWdlIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4ucXVlcnlCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1kZW1hbmQnKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9zdWJtaXQuKmRlbWFuZC9pKTtcbiAgICAgIFxuICAgICAgaWYgKHN1Ym1pdEJ1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0ID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ3NlbGVjdC1kZW1hbmQtdHlwZScpO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ3RleHRhcmVhLWRlbWFuZC1kZXNjcmlwdGlvbicpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5TGFiZWxUZXh0KC9kZXNjcmlwdGlvbi9pKTtcblxuICAgICAgICBpZiAodHlwZVNlbGVjdCAmJiBkZXNjcmlwdGlvbklucHV0KSB7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnNlbGVjdE9wdGlvbnModHlwZVNlbGVjdCwgJ21haW50ZW5hbmNlJyk7XG4gICAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZGVzY3JpcHRpb25JbnB1dCwgJ1Rlc3QgZGVtYW5kIHdpdGggZmlsZSB0aGF0IHdpbGwgZmFpbCB0byB1cGxvYWQnKTtcblxuICAgICAgICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAgICAgICBpZiAoZmlsZUlucHV0KSB7XG4gICAgICAgICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tJbWFnZSgndGVzdC1maWxlLnBuZycpO1xuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgICAgICAgIHZhbHVlOiBbbW9ja0ZpbGVdLFxuICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShmaWxlSW5wdXQsIHsgdGFyZ2V0OiB7IGZpbGVzOiBbbW9ja0ZpbGVdIH0gfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGZpbmFsU3VibWl0QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtZGVtYW5kLWZvcm0nKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc3VibWl0L2kgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmaW5hbFN1Ym1pdEJ1dHRvbikge1xuICAgICAgICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soZmluYWxTdWJtaXRCdXR0b24pO1xuXG4gICAgICAgICAgICAgIC8vIFNob3VsZCBzaG93IGVycm9yIG1lc3NhZ2UgZm9yIHVwbG9hZCBmYWlsdXJlXG4gICAgICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvdXBsb2FkLipmYWlsZWQvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvZXJyb3IuKnVwbG9hZGluZy9pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9mYWlsZWQuKmF0dGFjaC9pKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgYXR0YWNoZWQgZmlsZXMgaW4gZGVtYW5kIGRldGFpbHMgcG9wdXAnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGRlbWFuZCB3aXRoIGF0dGFjaG1lbnRzXG4gICAgICBjb25zdCBtb2NrRGVtYW5kV2l0aEF0dGFjaG1lbnRzID0ge1xuICAgICAgICBpZDogJ2RlbWFuZC0xMjMnLFxuICAgICAgICB0eXBlOiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0xlYWsgaW4gYmF0aHJvb20gY2VpbGluZycsXG4gICAgICAgIGF0dGFjaG1lbnRzOiBbXG4gICAgICAgICAgJy91cGxvYWRzL2RlbWFuZHMvbGVhay1waG90by0xLmpwZycsXG4gICAgICAgICAgJy91cGxvYWRzL2RlbWFuZHMvZGFtYWdlLXJlcG9ydC5wZGYnXG4gICAgICAgIF0sXG4gICAgICAgIHN0YXR1czogJ3N1Ym1pdHRlZCcsXG4gICAgICAgIHN1Ym1pdHRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICBidWlsZGluZ0lkOiAnYnVpbGRpbmctMTIzJyxcbiAgICAgICAgY3JlYXRlZEF0OiAnMjAyNC0wOS0wNVQxMDowMDowMFonLFxuICAgICAgICB1cGRhdGVkQXQ6ICcyMDI0LTA5LTA1VDEwOjAwOjAwWicsXG4gICAgICAgIHN1Ym1pdHRlcjoge1xuICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QHRlc3QuY29tJ1xuICAgICAgICB9LFxuICAgICAgICBidWlsZGluZzoge1xuICAgICAgICAgIGlkOiAnYnVpbGRpbmctMTIzJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBCdWlsZGluZycsXG4gICAgICAgICAgYWRkcmVzczogJzEyMyBUZXN0IFN0J1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvLyBNb2NrIHRoZSBkZW1hbmQgZGV0YWlscyBwb3B1cCBjb21wb25lbnRcbiAgICAgIGNvbnN0IERlbWFuZERldGFpbHNQb3B1cCA9IHJlcXVpcmUoJy4uLy4uL2NsaWVudC9zcmMvY29tcG9uZW50cy9kZW1hbmRzL2RlbWFuZC1kZXRhaWxzLXBvcHVwLnRzeCcpLmRlZmF1bHQ7XG5cbiAgICAgIG1vY2tBcGlSZXF1ZXN0Lm1vY2tSZXNvbHZlZFZhbHVlKFtdKTsgLy8gTW9jayBjb21tZW50c1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8RGVtYW5kRGV0YWlsc1BvcHVwXG4gICAgICAgICAgICBkZW1hbmQ9e21vY2tEZW1hbmRXaXRoQXR0YWNobWVudHN9XG4gICAgICAgICAgICBpc09wZW49e3RydWV9XG4gICAgICAgICAgICBvbkNsb3NlPXtqZXN0LmZuKCl9XG4gICAgICAgICAgICB1c2VyPXttb2NrQXV0aC51c2VyfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBTaG91bGQgc2hvdyBhdHRhY2htZW50cyBzZWN0aW9uXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgYXR0YWNobWVudHNMYWJlbCA9IHNjcmVlbi5xdWVyeUJ5VGV4dCgvYXR0YWNobWVudHMvaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC9hdHRhY2hlZC4qZmlsZXMvaSk7XG4gICAgICAgIGV4cGVjdChhdHRhY2htZW50c0xhYmVsKS50b0JlVHJ1dGh5KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2hvdWxkIHNob3cgZmlsZSBjb3VudFxuICAgICAgY29uc3QgZmlsZUNvdW50ID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC8yL2kpIHx8IC8vICgyKSBpbiBsYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW4ucXVlcnlCeVRleHQoLzIuKmZpbGVzL2kpO1xuICAgICAgZXhwZWN0KGZpbGVDb3VudCkudG9CZVRydXRoeSgpO1xuXG4gICAgICAvLyBTaG91bGQgc2hvdyBpbmRpdmlkdWFsIGZpbGVzXG4gICAgICBjb25zdCBwaG90b0ZpbGUgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2xlYWstcGhvdG8tMVxcLmpwZy9pKTtcbiAgICAgIGNvbnN0IHBkZkZpbGUgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2RhbWFnZS1yZXBvcnRcXC5wZGYvaSk7XG4gICAgICBleHBlY3QocGhvdG9GaWxlKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QocGRmRmlsZSkudG9CZVRydXRoeSgpO1xuXG4gICAgICAvLyBTaG91bGQgaGF2ZSB2aWV3L2Rvd25sb2FkIGJ1dHRvbnNcbiAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLnF1ZXJ5QWxsQnlUZXh0KC92aWV3fGRvd25sb2FkL2kpO1xuICAgICAgZXhwZWN0KHZpZXdCdXR0b25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmlld2luZyBhdHRhY2hlZCBmaWxlcyBmcm9tIGRlbWFuZCBkZXRhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0RlbWFuZFdpdGhJbWFnZSA9IHtcbiAgICAgICAgaWQ6ICdkZW1hbmQtNDU2JyxcbiAgICAgICAgdHlwZTogJ2NvbXBsYWludCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSXNzdWUgd2l0aCB3aW5kb3dzJyxcbiAgICAgICAgYXR0YWNobWVudHM6IFsnL3VwbG9hZHMvZGVtYW5kcy93aW5kb3ctcHJvYmxlbS5wbmcnXSxcbiAgICAgICAgc3RhdHVzOiAnc3VibWl0dGVkJyxcbiAgICAgICAgc3VibWl0dGVySWQ6ICd1c2VyLTEyMycsXG4gICAgICAgIGJ1aWxkaW5nSWQ6ICdidWlsZGluZy0xMjMnLFxuICAgICAgICBjcmVhdGVkQXQ6ICcyMDI0LTA5LTA1VDEwOjAwOjAwWicsXG4gICAgICAgIHVwZGF0ZWRBdDogJzIwMjQtMDktMDVUMTA6MDA6MDBaJ1xuICAgICAgfTtcblxuICAgICAgY29uc3QgRGVtYW5kRGV0YWlsc1BvcHVwID0gcmVxdWlyZSgnLi4vLi4vY2xpZW50L3NyYy9jb21wb25lbnRzL2RlbWFuZHMvZGVtYW5kLWRldGFpbHMtcG9wdXAudHN4JykuZGVmYXVsdDtcblxuICAgICAgbW9ja0FwaVJlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIHdpbmRvdy5vcGVuXG4gICAgICBnbG9iYWwub3BlbiA9IGplc3QuZm4oKSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiB3aW5kb3cub3Blbj47XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxEZW1hbmREZXRhaWxzUG9wdXBcbiAgICAgICAgICAgIGRlbWFuZD17bW9ja0RlbWFuZFdpdGhJbWFnZX1cbiAgICAgICAgICAgIGlzT3Blbj17dHJ1ZX1cbiAgICAgICAgICAgIG9uQ2xvc2U9e2plc3QuZm4oKX1cbiAgICAgICAgICAgIHVzZXI9e21vY2tBdXRoLnVzZXJ9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCB2aWV3QnV0dG9uID0gc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ2J1dHRvbi12aWV3LWF0dGFjaG1lbnQtMCcpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmVlbi5xdWVyeUJ5VGV4dCgvdmlldy9pKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh2aWV3QnV0dG9uKSB7XG4gICAgICAgICAgZXhwZWN0KHZpZXdCdXR0b24pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbGljayB2aWV3IGJ1dHRvblxuICAgICAgY29uc3Qgdmlld0J1dHRvbiA9IHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdidXR0b24tdmlldy1hdHRhY2htZW50LTAnKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXh0KC92aWV3L2kpO1xuICAgICAgXG4gICAgICBpZiAodmlld0J1dHRvbikge1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2sodmlld0J1dHRvbik7XG5cbiAgICAgICAgLy8gU2hvdWxkIG9wZW4gZmlsZSBpbiBuZXcgd2luZG93XG4gICAgICAgIGV4cGVjdChnbG9iYWwub3BlbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy91cGxvYWRzL2RlbWFuZHMvd2luZG93LXByb2JsZW0ucG5nJywgJ19ibGFuaycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3Qgc2hvdyBhdHRhY2htZW50cyBzZWN0aW9uIHdoZW4gZGVtYW5kIGhhcyBubyBmaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tEZW1hbmRXaXRob3V0QXR0YWNobWVudHMgPSB7XG4gICAgICAgIGlkOiAnZGVtYW5kLTc4OScsXG4gICAgICAgIHR5cGU6ICdpbmZvcm1hdGlvbicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnR2VuZXJhbCBpbnF1aXJ5JyxcbiAgICAgICAgYXR0YWNobWVudHM6IFtdLCAvLyBObyBhdHRhY2htZW50c1xuICAgICAgICBzdGF0dXM6ICdzdWJtaXR0ZWQnLFxuICAgICAgICBzdWJtaXR0ZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgYnVpbGRpbmdJZDogJ2J1aWxkaW5nLTEyMycsXG4gICAgICAgIGNyZWF0ZWRBdDogJzIwMjQtMDktMDVUMTA6MDA6MDBaJyxcbiAgICAgICAgdXBkYXRlZEF0OiAnMjAyNC0wOS0wNVQxMDowMDowMFonXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBEZW1hbmREZXRhaWxzUG9wdXAgPSByZXF1aXJlKCcuLi8uLi9jbGllbnQvc3JjL2NvbXBvbmVudHMvZGVtYW5kcy9kZW1hbmQtZGV0YWlscy1wb3B1cC50c3gnKS5kZWZhdWx0O1xuXG4gICAgICBtb2NrQXBpUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxEZW1hbmREZXRhaWxzUG9wdXBcbiAgICAgICAgICAgIGRlbWFuZD17bW9ja0RlbWFuZFdpdGhvdXRBdHRhY2htZW50c31cbiAgICAgICAgICAgIGlzT3Blbj17dHJ1ZX1cbiAgICAgICAgICAgIG9uQ2xvc2U9e2plc3QuZm4oKX1cbiAgICAgICAgICAgIHVzZXI9e21vY2tBdXRoLnVzZXJ9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3VsZCBOT1Qgc2hvdyBhdHRhY2htZW50cyBzZWN0aW9uXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgYXR0YWNobWVudHNTZWN0aW9uID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC9hdHRhY2htZW50cy9pKTtcbiAgICAgICAgZXhwZWN0KGF0dGFjaG1lbnRzU2VjdGlvbikubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dlbmVyYWwgRmlsZSBVcGxvYWQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGVycm9ycyBkdXJpbmcgZmlsZSB1cGxvYWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cInRlc3QtdXBsb2FkLWZvcm1cIj5cbiAgICAgICAgICAgIHsvKiBNaW5pbWFsIGZvcm0gZm9yIHRlc3RpbmcgKi99XG4gICAgICAgICAgICA8aW5wdXQgXG4gICAgICAgICAgICAgIHR5cGU9XCJmaWxlXCIgXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiZmlsZS1pbnB1dFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzPy5bMF0pIHtcbiAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGUudGFyZ2V0LmZpbGVzWzBdKTtcbiAgICAgICAgICAgICAgICAgIGZldGNoKCcvYXBpL3VwbG9hZCcsIHsgbWV0aG9kOiAnUE9TVCcsIGJvZHk6IGZvcm1EYXRhIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ltYWdlKCd0ZXN0LnBuZycpO1xuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgIHZhbHVlOiBbbW9ja0ZpbGVdLFxuICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgZmlyZUV2ZW50LmNoYW5nZShmaWxlSW5wdXQsIHsgdGFyZ2V0OiB7IGZpbGVzOiBbbW9ja0ZpbGVdIH0gfSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAnL2FwaS91cGxvYWQnLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogZXhwZWN0LmFueShGb3JtRGF0YSksXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZmlsZSBzZWxlY3Rpb24nLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8aW5wdXQgXG4gICAgICAgICAgICB0eXBlPVwiZmlsZVwiIFxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJmaWxlLWlucHV0XCJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PiB7XG4gICAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdHJpZ2dlciBhbnkgdXBsb2FkXG4gICAgICAgICAgICB9fVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcblxuICAgICAgLy8gU2ltdWxhdGUgZW1wdHkgZmlsZSBzZWxlY3Rpb25cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZmlsZUlucHV0LCB7IHRhcmdldDogeyBmaWxlczogW10gfSB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tGZXRjaCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzcGVjdCBtYXhpbXVtIGZpbGUgY291bnQgbGltaXRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgTUFYX0ZJTEVTID0gMztcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgdHlwZT1cImZpbGVcIiBcbiAgICAgICAgICAgIG11bHRpcGxlXG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cImZpbGUtaW5wdXRcIlxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChlLnRhcmdldC5maWxlcyAmJiBlLnRhcmdldC5maWxlcy5sZW5ndGggPiBNQVhfRklMRVMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1heGltdW0gJHtNQVhfRklMRVN9IGZpbGVzIGFsbG93ZWRgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsZUlucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdmaWxlLWlucHV0Jyk7XG4gICAgICBjb25zdCB0b29NYW55RmlsZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tJbWFnZSgnMS5wbmcnKSxcbiAgICAgICAgY3JlYXRlTW9ja0ltYWdlKCcyLnBuZycpLFxuICAgICAgICBjcmVhdGVNb2NrSW1hZ2UoJzMucG5nJyksXG4gICAgICAgIGNyZWF0ZU1vY2tJbWFnZSgnNC5wbmcnKSwgLy8gT25lIHRvbyBtYW55XG4gICAgICBdO1xuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZmlsZUlucHV0LCAnZmlsZXMnLCB7XG4gICAgICAgIHZhbHVlOiB0b29NYW55RmlsZXMsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IHRvb01hbnlGaWxlcyB9IH0pO1xuICAgICAgfSkudG9UaHJvdygvTWF4aW11bS4qZmlsZXMuKmFsbG93ZWQvKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZpbGUgVXBsb2FkIFByb2dyZXNzIGFuZCBGZWVkYmFjaycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNob3cgdXBsb2FkIHByb2dyZXNzIGZvciBsYXJnZSBmaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVcGxvYWRQcm9ncmVzcyA9IGplc3QuZm4oKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBYTUxIdHRwUmVxdWVzdCBmb3IgcHJvZ3Jlc3MgdHJhY2tpbmdcbiAgICAgIGNvbnN0IG1vY2tYSFIgPSB7XG4gICAgICAgIHVwbG9hZDoge1xuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50ID09PSAncHJvZ3Jlc3MnKSB7XG4gICAgICAgICAgICAgIC8vIFNpbXVsYXRlIHByb2dyZXNzIHVwZGF0ZXNcbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBjYWxsYmFjayh7IGxvYWRlZDogNTAsIHRvdGFsOiAxMDAgfSksIDEwMCk7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gY2FsbGJhY2soeyBsb2FkZWQ6IDEwMCwgdG90YWw6IDEwMCB9KSwgMjAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgICAgICBvcGVuOiBqZXN0LmZuKCksXG4gICAgICAgIHNlbmQ6IGplc3QuZm4oKSxcbiAgICAgICAgc2V0UmVxdWVzdEhlYWRlcjogamVzdC5mbigpLFxuICAgICAgfTtcblxuICAgICAgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0ID0gamVzdC5mbigoKSA9PiBtb2NrWEhSKSBhcyBhbnk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJ1cGxvYWQtd2l0aC1wcm9ncmVzc1wiPlxuICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiZmlsZS1pbnB1dFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXttb2NrVXBsb2FkUHJvZ3Jlc3N9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cInByb2dyZXNzLWluZGljYXRvclwiPjAlPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2ZpbGUtaW5wdXQnKTtcbiAgICAgIGNvbnN0IGxhcmdlRmlsZSA9IGNyZWF0ZU1vY2tJbWFnZSgnbGFyZ2UtaW1hZ2UucG5nJywgMTAgKiAxMDI0ICogMTAyNCk7IC8vIDEwTUJcblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZpbGVJbnB1dCwgJ2ZpbGVzJywge1xuICAgICAgICB2YWx1ZTogW2xhcmdlRmlsZV0sXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGZpbGVJbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IFtsYXJnZUZpbGVdIH0gfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkUHJvZ3Jlc3MpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdGFyZ2V0OiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBmaWxlczogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbbGFyZ2VGaWxlXSlcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=
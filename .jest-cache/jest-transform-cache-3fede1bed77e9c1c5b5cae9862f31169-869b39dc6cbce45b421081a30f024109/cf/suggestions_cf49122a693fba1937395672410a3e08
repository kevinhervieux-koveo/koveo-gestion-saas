c7b5a26741f5add33002aa62aefebfae
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = OwnerSuggestions;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_query_1 = require("@tanstack/react-query");
const header_1 = require("@/components/layout/header");
const card_1 = require("@/components/ui/card");
const button_1 = require("@/components/ui/button");
const badge_1 = require("@/components/ui/badge");
const lucide_react_1 = require("lucide-react");
const queryClient_1 = require("@/lib/queryClient");
const use_toast_1 = require("@/hooks/use-toast");
const react_1 = require("react");
// Category configuration with icons and colors
const categoryConfig = [
    { name: 'Code Quality', icon: lucide_react_1.Code, color: 'bg-blue-50 text-blue-700 border-blue-200' },
    { name: 'Testing', icon: lucide_react_1.CheckCircle, color: 'bg-green-50 text-green-700 border-green-200' },
    {
        name: 'Documentation',
        icon: lucide_react_1.FileText,
        color: 'bg-purple-50 text-purple-700 border-purple-200',
    },
    { name: 'Security', icon: lucide_react_1.Shield, color: 'bg-red-50 text-red-700 border-red-200' },
    { name: 'Performance', icon: lucide_react_1.Zap, color: 'bg-yellow-50 text-yellow-700 border-yellow-200' },
    {
        name: 'Continuous Improvement',
        icon: lucide_react_1.Terminal,
        color: 'bg-indigo-50 text-indigo-700 border-indigo-200',
    },
    {
        name: 'Replit AI Agent Monitoring',
        icon: lucide_react_1.MessageSquare,
        color: 'bg-teal-50 text-teal-700 border-teal-200',
    },
];
/**
 *
 */
function OwnerSuggestions() {
    const { toast } = (0, use_toast_1.useToast)();
    const { data: suggestions = [], isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/pillars/suggestions'],
        refetchInterval: 30000, // Refetch every 30 seconds to ensure fresh data
        staleTime: 0, // Data is always considered stale
    });
    // Group suggestions by category and take 2 from each
    const categorizedSuggestions = (0, react_1.useMemo)(() => {
        const grouped = suggestions.reduce((acc, suggestion) => {
            if (!acc[suggestion.category]) {
                acc[suggestion.category] = [];
            }
            // Only add if not done and we have less than 2 in this category
            if (suggestion.status !== 'Done' && acc[suggestion.category].length < 2) {
                acc[suggestion.category].push(suggestion);
            }
            return acc;
        }, {});
        // Sort suggestions within each category by priority
        const priorityOrder = { Critical: 0, High: 1, Medium: 2, Low: 3 };
        Object.keys(grouped).forEach((category) => {
            grouped[category].sort((a, b) => priorityOrder[a.priority] - priorityOrder[b.priority]);
        });
        return grouped;
    }, [suggestions]);
    const acknowledgeMutation = (0, react_query_1.useMutation)({
        mutationFn: (id) => (0, queryClient_1.apiRequest)('POST', `/api/pillars/suggestions/${id}/acknowledge`),
        onSuccess: () => {
            queryClient_1.queryClient.invalidateQueries({ queryKey: ['/api/pillars/suggestions'] });
        },
    });
    const completeMutation = (0, react_query_1.useMutation)({
        mutationFn: (id) => (0, queryClient_1.apiRequest)('POST', `/api/pillars/suggestions/${id}/complete`),
        onSuccess: () => {
            queryClient_1.queryClient.invalidateQueries({ queryKey: ['/api/pillars/suggestions'] });
            // Show success message indicating deletion and continuous improvement update
            toast({
                title: 'Suggestion Completed',
                description: 'Suggestion has been removed and continuous improvement analysis is running in the background.',
            });
        },
    });
    const getPriorityColor = (priority) => {
        switch (priority) {
            case 'Critical':
                return 'bg-purple-100 text-purple-800';
            case 'High':
                return 'bg-red-100 text-red-800';
            case 'Medium':
                return 'bg-yellow-100 text-yellow-800';
            case 'Low':
                return 'bg-blue-100 text-blue-800';
            default:
                return 'bg-gray-100 text-gray-800';
        }
    };
    const getStatusColor = (status) => {
        switch (status) {
            case 'Done':
                return 'bg-green-100 text-green-800';
            case 'Acknowledged':
                return 'bg-blue-100 text-blue-800';
            case 'New':
                return 'bg-gray-100 text-gray-800';
            default:
                return 'bg-gray-100 text-gray-800';
        }
    };
    const getAIPrompt = (suggestion) => {
        const baseContext = 'You are working on a Quebec property management SaaS called Koveo Gestion. ';
        switch (suggestion.category) {
            case 'Code Quality':
                return `${baseContext}${suggestion.description} Focus on improving code maintainability while preserving existing functionality. Follow existing TypeScript patterns and ensure all changes maintain type safety.`;
            case 'Testing':
                return `${baseContext}${suggestion.description} Add comprehensive unit tests using Jest and React Testing Library. Focus on critical paths and edge cases. Ensure tests follow the existing test structure in /tests/ directory.`;
            case 'Documentation':
                return `${baseContext}${suggestion.description} Add JSDoc comments to all exported functions and classes. Follow the existing documentation style and include parameter descriptions, return values, and usage examples where appropriate.`;
            case 'Security':
                return `${baseContext}${suggestion.description} Address security vulnerabilities while maintaining Law 25 compliance for Quebec privacy regulations. Update dependencies safely and validate all changes don't break authentication or data protection.`;
            case 'Performance':
                return `${baseContext}${suggestion.description} Optimize performance while maintaining the existing user experience. Consider code splitting, lazy loading, and bundle optimization. Test changes thoroughly to ensure no regressions.`;
            default:
                return `${baseContext}${suggestion.description} Implement this improvement following the existing codebase patterns and Quebec property management requirements. Ensure all changes are well-tested and documented.`;
        }
    };
    const getCategoryIcon = (categoryName) => {
        const config = categoryConfig.find((c) => c.name === categoryName);
        return config?.icon || lucide_react_1.MessageSquare;
    };
    const getCategoryColor = (categoryName) => {
        const config = categoryConfig.find((c) => c.name === categoryName);
        return config?.color || 'bg-gray-50 text-gray-700 border-gray-200';
    };
    return ((0, jsx_runtime_1.jsxs)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: 'Improvement Suggestions', subtitle: 'Review and manage system improvement recommendations' }), (0, jsx_runtime_1.jsx)("div", { className: 'border-b bg-gray-50 px-6 py-3', children: (0, jsx_runtime_1.jsx)("div", { className: 'max-w-7xl mx-auto', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2 text-sm text-gray-600', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Terminal, { className: 'h-4 w-4' }), (0, jsx_runtime_1.jsx)("span", { className: 'font-medium', children: "Refresh Command:" }), (0, jsx_runtime_1.jsx)("code", { className: 'bg-gray-100 px-2 py-1 rounded text-xs font-mono', children: "npm run quality:check" })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 overflow-auto p-6', children: (0, jsx_runtime_1.jsxs)("div", { className: 'max-w-7xl mx-auto', children: [(0, jsx_runtime_1.jsx)(card_1.Card, { className: 'mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200', children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: 'pt-6', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between', children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("h3", { className: 'text-lg font-semibold text-blue-900', children: "Continuous Improvement Overview" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-blue-700 mt-1', children: "Displaying 2 priority suggestions per category for focused improvements" })] }), (0, jsx_runtime_1.jsxs)(badge_1.Badge, { className: 'bg-blue-100 text-blue-800', children: [Object.values(categorizedSuggestions).flat().length, " Active Suggestions"] })] }) }) }), isLoading ? ((0, jsx_runtime_1.jsx)("div", { className: 'flex items-center justify-center h-64', children: (0, jsx_runtime_1.jsx)("div", { className: 'animate-spin rounded-full h-32 w-32 border-b-2 border-koveo-navy' }) })) : ((0, jsx_runtime_1.jsxs)("div", { className: 'space-y-8', children: [categoryConfig.map((category) => {
                                    const categorySuggestions = categorizedSuggestions[category.name] || [];
                                    const Icon = category.icon;
                                    if (categorySuggestions.length === 0) {
                                        return null;
                                    }
                                    return ((0, jsx_runtime_1.jsxs)("div", { className: 'space-y-4', children: [(0, jsx_runtime_1.jsxs)("div", { className: `flex items-center gap-3 p-3 rounded-lg border ${category.color}`, children: [(0, jsx_runtime_1.jsx)(Icon, { className: 'h-5 w-5' }), (0, jsx_runtime_1.jsx)("h2", { className: 'text-lg font-semibold', children: category.name }), (0, jsx_runtime_1.jsxs)(badge_1.Badge, { variant: 'outline', className: 'ml-auto', children: [categorySuggestions.length, ' ', categorySuggestions.length === 1 ? 'suggestion' : 'suggestions'] })] }), (0, jsx_runtime_1.jsx)("div", { className: 'grid gap-4 md:grid-cols-2', children: categorySuggestions.map((suggestion) => ((0, jsx_runtime_1.jsxs)(card_1.Card, { className: 'hover:shadow-lg transition-all hover:scale-[1.02]', children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-start justify-between', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex-1', children: [(0, jsx_runtime_1.jsx)(card_1.CardTitle, { className: 'text-lg font-semibold text-koveo-navy', children: suggestion.title }), (0, jsx_runtime_1.jsx)(card_1.CardDescription, { className: 'mt-2', children: suggestion.description })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex flex-col gap-2 ml-4', children: [(0, jsx_runtime_1.jsxs)(badge_1.Badge, { className: getPriorityColor(suggestion.priority), children: [suggestion.priority, " Priority"] }), (0, jsx_runtime_1.jsx)(badge_1.Badge, { className: getStatusColor(suggestion.status), children: suggestion.status })] })] }) }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { children: [(0, jsx_runtime_1.jsxs)("div", { className: 'mb-4', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-4 text-sm text-gray-600 mb-3', children: [(0, jsx_runtime_1.jsxs)("span", { className: 'flex items-center gap-1', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MessageSquare, { size: 16 }), suggestion.category] }), (0, jsx_runtime_1.jsxs)("span", { children: ["Created: ", new Date(suggestion.createdAt).toLocaleDateString()] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'bg-blue-50 border border-blue-200 rounded-lg p-3', children: [(0, jsx_runtime_1.jsx)("div", { className: 'text-xs font-semibold text-blue-800 mb-2 uppercase tracking-wide', children: "AI Agent Prompt" }), (0, jsx_runtime_1.jsx)("div", { className: 'text-sm text-blue-900 font-mono bg-white border rounded px-3 py-2 select-all cursor-pointer', children: getAIPrompt(suggestion) }), (0, jsx_runtime_1.jsx)("div", { className: 'text-xs text-blue-600 mt-1', children: "Click to select and copy the prompt above" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between', children: [(0, jsx_runtime_1.jsx)("div", {}), (0, jsx_runtime_1.jsxs)("div", { className: 'flex gap-2', children: [suggestion.status === 'New' && ((0, jsx_runtime_1.jsxs)(button_1.Button, { size: 'sm', variant: 'outline', onClick: () => acknowledgeMutation.mutate(suggestion.id), disabled: acknowledgeMutation.isPending, className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { size: 16 }), "Acknowledge"] })), (suggestion.status === 'New' ||
                                                                                    suggestion.status === 'Acknowledged') && ((0, jsx_runtime_1.jsxs)(button_1.Button, { size: 'sm', onClick: () => completeMutation.mutate(suggestion.id), disabled: completeMutation.isPending, className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { size: 16 }), "Mark Complete"] }))] })] })] })] }, suggestion.id))) })] }, category.name));
                                }), Object.values(categorizedSuggestions).flat().length === 0 && ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: 'flex flex-col items-center justify-center py-16', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MessageSquare, { size: 48, className: 'text-gray-400 mb-4' }), (0, jsx_runtime_1.jsx)("h3", { className: 'text-lg font-semibold text-gray-600 mb-2', children: "No Active Suggestions" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-gray-500 text-center max-w-md', children: "All suggestions have been completed or no improvement suggestions have been generated yet. Run the quality check to generate new recommendations." })] }) }))] }))] }) })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL2FkbWluL3N1Z2dlc3Rpb25zLnRzeCIsIm1hcHBpbmdzIjoiOztBQTJEQSxtQ0EyU0M7O0FBdFdELHVEQUE4RDtBQUM5RCx1REFBb0Q7QUFDcEQsK0NBQWlHO0FBQ2pHLG1EQUFnRDtBQUNoRCxpREFBOEM7QUFDOUMsK0NBVXNCO0FBQ3RCLG1EQUE0RDtBQUM1RCxpREFBNkM7QUFDN0MsaUNBQWdDO0FBZWhDLCtDQUErQztBQUMvQyxNQUFNLGNBQWMsR0FBRztJQUNyQixFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLG1CQUFJLEVBQUUsS0FBSyxFQUFFLDBDQUEwQyxFQUFFO0lBQ3ZGLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsMEJBQVcsRUFBRSxLQUFLLEVBQUUsNkNBQTZDLEVBQUU7SUFDNUY7UUFDRSxJQUFJLEVBQUUsZUFBZTtRQUNyQixJQUFJLEVBQUUsdUJBQVE7UUFDZCxLQUFLLEVBQUUsZ0RBQWdEO0tBQ3hEO0lBQ0QsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxxQkFBTSxFQUFFLEtBQUssRUFBRSx1Q0FBdUMsRUFBRTtJQUNsRixFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLGtCQUFHLEVBQUUsS0FBSyxFQUFFLGdEQUFnRCxFQUFFO0lBQzNGO1FBQ0UsSUFBSSxFQUFFLHdCQUF3QjtRQUM5QixJQUFJLEVBQUUsdUJBQVE7UUFDZCxLQUFLLEVBQUUsZ0RBQWdEO0tBQ3hEO0lBQ0Q7UUFDRSxJQUFJLEVBQUUsNEJBQTRCO1FBQ2xDLElBQUksRUFBRSw0QkFBYTtRQUNuQixLQUFLLEVBQUUsMENBQTBDO0tBQ2xEO0NBQ0YsQ0FBQztBQUVGOztHQUVHO0FBQ0gsU0FBd0IsZ0JBQWdCO0lBQ3RDLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxJQUFBLG9CQUFRLEdBQUUsQ0FBQztJQUM3QixNQUFNLEVBQUUsSUFBSSxFQUFFLFdBQVcs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QU0sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sS0FBSyxDQUFDLElBQUksQ0FDNUQsdUJBQUMsV0FBSSxjQUNILHdCQUFDLGtCQUFXLElBQUMsU0FBUyxFQUFDLGlEQUFpRCxhQUN0RSx1QkFBQyw0QkFBYSxJQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFDLG9CQUFvQixHQUFHLEVBQzFELCtCQUFJLFNBQVMsRUFBQywwQ0FBMEMsc0NBRW5ELEVBQ0wsOEJBQUcsU0FBUyxFQUFDLG9DQUFvQyxrS0FHN0MsSUFDUSxHQUNULENBQ1IsSUFDRyxDQUNQLElBQ0csR0FDRixJQUNGLENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL2FkbWluL3N1Z2dlc3Rpb25zLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VRdWVyeSwgdXNlTXV0YXRpb24gfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xuaW1wb3J0IHsgSGVhZGVyIH0gZnJvbSAnQC9jb21wb25lbnRzL2xheW91dC9oZWFkZXInO1xuaW1wb3J0IHsgQ2FyZCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlLCBDYXJkRGVzY3JpcHRpb24sIENhcmRDb250ZW50IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NhcmQnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2J1dHRvbic7XG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9iYWRnZSc7XG5pbXBvcnQge1xuICBDaGVja0NpcmNsZSxcbiAgQ2xvY2ssXG4gIE1lc3NhZ2VTcXVhcmUsXG4gIEFsZXJ0Q2lyY2xlLFxuICBTaGllbGQsXG4gIENvZGUsXG4gIEZpbGVUZXh0LFxuICBaYXAsXG4gIFRlcm1pbmFsLFxufSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgYXBpUmVxdWVzdCwgcXVlcnlDbGllbnQgfSBmcm9tICdAL2xpYi9xdWVyeUNsaWVudCc7XG5pbXBvcnQgeyB1c2VUb2FzdCB9IGZyb20gJ0AvaG9va3MvdXNlLXRvYXN0JztcbmltcG9ydCB7IHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5cbi8qKlxuICpcbiAqL1xuaW50ZXJmYWNlIEltcHJvdmVtZW50U3VnZ2VzdGlvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHByaW9yaXR5OiAnSGlnaCcgfCAnTWVkaXVtJyB8ICdMb3cnIHwgJ0NyaXRpY2FsJztcbiAgc3RhdHVzOiAnTmV3JyB8ICdBY2tub3dsZWRnZWQnIHwgJ0RvbmUnO1xuICBjYXRlZ29yeTogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbn1cblxuLy8gQ2F0ZWdvcnkgY29uZmlndXJhdGlvbiB3aXRoIGljb25zIGFuZCBjb2xvcnNcbmNvbnN0IGNhdGVnb3J5Q29uZmlnID0gW1xuICB7IG5hbWU6ICdDb2RlIFF1YWxpdHknLCBpY29uOiBDb2RlLCBjb2xvcjogJ2JnLWJsdWUtNTAgdGV4dC1ibHVlLTcwMCBib3JkZXItYmx1ZS0yMDAnIH0sXG4gIHsgbmFtZTogJ1Rlc3RpbmcnLCBpY29uOiBDaGVja0NpcmNsZSwgY29sb3I6ICdiZy1ncmVlbi01MCB0ZXh0LWdyZWVuLTcwMCBib3JkZXItZ3JlZW4tMjAwJyB9LFxuICB7XG4gICAgbmFtZTogJ0RvY3VtZW50YXRpb24nLFxuICAgIGljb246IEZpbGVUZXh0LFxuICAgIGNvbG9yOiAnYmctcHVycGxlLTUwIHRleHQtcHVycGxlLTcwMCBib3JkZXItcHVycGxlLTIwMCcsXG4gIH0sXG4gIHsgbmFtZTogJ1NlY3VyaXR5JywgaWNvbjogU2hpZWxkLCBjb2xvcjogJ2JnLXJlZC01MCB0ZXh0LXJlZC03MDAgYm9yZGVyLXJlZC0yMDAnIH0sXG4gIHsgbmFtZTogJ1BlcmZvcm1hbmNlJywgaWNvbjogWmFwLCBjb2xvcjogJ2JnLXllbGxvdy01MCB0ZXh0LXllbGxvdy03MDAgYm9yZGVyLXllbGxvdy0yMDAnIH0sXG4gIHtcbiAgICBuYW1lOiAnQ29udGludW91cyBJbXByb3ZlbWVudCcsXG4gICAgaWNvbjogVGVybWluYWwsXG4gICAgY29sb3I6ICdiZy1pbmRpZ28tNTAgdGV4dC1pbmRpZ28tNzAwIGJvcmRlci1pbmRpZ28tMjAwJyxcbiAgfSxcbiAge1xuICAgIG5hbWU6ICdSZXBsaXQgQUkgQWdlbnQgTW9uaXRvcmluZycsXG4gICAgaWNvbjogTWVzc2FnZVNxdWFyZSxcbiAgICBjb2xvcjogJ2JnLXRlYWwtNTAgdGV4dC10ZWFsLTcwMCBib3JkZXItdGVhbC0yMDAnLFxuICB9LFxuXTtcblxuLyoqXG4gKlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBPd25lclN1Z2dlc3Rpb25zKCkge1xuICBjb25zdCB7IHRvYXN0IH0gPSB1c2VUb2FzdCgpO1xuICBjb25zdCB7IGRhdGE6IHN1Z2dlc3Rpb25zID0gW10sIGlzTG9hZGluZyB9ID0gdXNlUXVlcnk8SW1wcm92ZW1lbnRTdWdnZXN0aW9uW10+KHtcbiAgICBxdWVyeUtleTogWycvYXBpL3BpbGxhcnMvc3VnZ2VzdGlvbnMnXSxcbiAgICByZWZldGNoSW50ZXJ2YWw6IDMwMDAwLCAvLyBSZWZldGNoIGV2ZXJ5IDMwIHNlY29uZHMgdG8gZW5zdXJlIGZyZXNoIGRhdGFcbiAgICBzdGFsZVRpbWU6IDAsIC8vIERhdGEgaXMgYWx3YXlzIGNvbnNpZGVyZWQgc3RhbGVcbiAgfSk7XG5cbiAgLy8gR3JvdXAgc3VnZ2VzdGlvbnMgYnkgY2F0ZWdvcnkgYW5kIHRha2UgMiBmcm9tIGVhY2hcbiAgY29uc3QgY2F0ZWdvcml6ZWRTdWdnZXN0aW9ucyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGdyb3VwZWQgPSBzdWdnZXN0aW9ucy5yZWR1Y2UoXG4gICAgICAoYWNjLCBzdWdnZXN0aW9uKSA9PiB7XG4gICAgICAgIGlmICghYWNjW3N1Z2dlc3Rpb24uY2F0ZWdvcnldKSB7XG4gICAgICAgICAgYWNjW3N1Z2dlc3Rpb24uY2F0ZWdvcnldID0gW107XG4gICAgICAgIH1cbiAgICAgICAgLy8gT25seSBhZGQgaWYgbm90IGRvbmUgYW5kIHdlIGhhdmUgbGVzcyB0aGFuIDIgaW4gdGhpcyBjYXRlZ29yeVxuICAgICAgICBpZiAoc3VnZ2VzdGlvbi5zdGF0dXMgIT09ICdEb25lJyAmJiBhY2Nbc3VnZ2VzdGlvbi5jYXRlZ29yeV0ubGVuZ3RoIDwgMikge1xuICAgICAgICAgIGFjY1tzdWdnZXN0aW9uLmNhdGVnb3J5XS5wdXNoKHN1Z2dlc3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LFxuICAgICAge30gYXMgUmVjb3JkPHN0cmluZywgSW1wcm92ZW1lbnRTdWdnZXN0aW9uW10+XG4gICAgKTtcblxuICAgIC8vIFNvcnQgc3VnZ2VzdGlvbnMgd2l0aGluIGVhY2ggY2F0ZWdvcnkgYnkgcHJpb3JpdHlcbiAgICBjb25zdCBwcmlvcml0eU9yZGVyID0geyBDcml0aWNhbDogMCwgSGlnaDogMSwgTWVkaXVtOiAyLCBMb3c6IDMgfTtcbiAgICBPYmplY3Qua2V5cyhncm91cGVkKS5mb3JFYWNoKChjYXRlZ29yeSkgPT4ge1xuICAgICAgZ3JvdXBlZFtjYXRlZ29yeV0uc29ydCgoYSwgYikgPT4gcHJpb3JpdHlPcmRlclthLnByaW9yaXR5XSAtIHByaW9yaXR5T3JkZXJbYi5wcmlvcml0eV0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGdyb3VwZWQ7XG4gIH0sIFtzdWdnZXN0aW9uc10pO1xuXG4gIGNvbnN0IGFja25vd2xlZGdlTXV0YXRpb24gPSB1c2VNdXRhdGlvbih7XG4gICAgbXV0YXRpb25GbjogKGlkOiBzdHJpbmcpID0+IGFwaVJlcXVlc3QoJ1BPU1QnLCBgL2FwaS9waWxsYXJzL3N1Z2dlc3Rpb25zLyR7aWR9L2Fja25vd2xlZGdlYCksXG4gICAgb25TdWNjZXNzOiAoKSA9PiB7XG4gICAgICBxdWVyeUNsaWVudC5pbnZhbGlkYXRlUXVlcmllcyh7IHF1ZXJ5S2V5OiBbJy9hcGkvcGlsbGFycy9zdWdnZXN0aW9ucyddIH0pO1xuICAgIH0sXG4gIH0pO1xuXG4gIGNvbnN0IGNvbXBsZXRlTXV0YXRpb24gPSB1c2VNdXRhdGlvbih7XG4gICAgbXV0YXRpb25GbjogKGlkOiBzdHJpbmcpID0+IGFwaVJlcXVlc3QoJ1BPU1QnLCBgL2FwaS9waWxsYXJzL3N1Z2dlc3Rpb25zLyR7aWR9L2NvbXBsZXRlYCksXG4gICAgb25TdWNjZXNzOiAoKSA9PiB7XG4gICAgICBxdWVyeUNsaWVudC5pbnZhbGlkYXRlUXVlcmllcyh7IHF1ZXJ5S2V5OiBbJy9hcGkvcGlsbGFycy9zdWdnZXN0aW9ucyddIH0pO1xuICAgICAgLy8gU2hvdyBzdWNjZXNzIG1lc3NhZ2UgaW5kaWNhdGluZyBkZWxldGlvbiBhbmQgY29udGludW91cyBpbXByb3ZlbWVudCB1cGRhdGVcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICdTdWdnZXN0aW9uIENvbXBsZXRlZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOlxuICAgICAgICAgICdTdWdnZXN0aW9uIGhhcyBiZWVuIHJlbW92ZWQgYW5kIGNvbnRpbnVvdXMgaW1wcm92ZW1lbnQgYW5hbHlzaXMgaXMgcnVubmluZyBpbiB0aGUgYmFja2dyb3VuZC4nLFxuICAgICAgfSk7XG4gICAgfSxcbiAgfSk7XG5cbiAgY29uc3QgZ2V0UHJpb3JpdHlDb2xvciA9IChwcmlvcml0eTogc3RyaW5nKSA9PiB7XG4gICAgc3dpdGNoIChwcmlvcml0eSkge1xuICAgICAgY2FzZSAnQ3JpdGljYWwnOlxuICAgICAgICByZXR1cm4gJ2JnLXB1cnBsZS0xMDAgdGV4dC1wdXJwbGUtODAwJztcbiAgICAgIGNhc2UgJ0hpZ2gnOlxuICAgICAgICByZXR1cm4gJ2JnLXJlZC0xMDAgdGV4dC1yZWQtODAwJztcbiAgICAgIGNhc2UgJ01lZGl1bSc6XG4gICAgICAgIHJldHVybiAnYmcteWVsbG93LTEwMCB0ZXh0LXllbGxvdy04MDAnO1xuICAgICAgY2FzZSAnTG93JzpcbiAgICAgICAgcmV0dXJuICdiZy1ibHVlLTEwMCB0ZXh0LWJsdWUtODAwJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnYmctZ3JheS0xMDAgdGV4dC1ncmF5LTgwMCc7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGdldFN0YXR1c0NvbG9yID0gKHN0YXR1czogc3RyaW5nKSA9PiB7XG4gICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgIGNhc2UgJ0RvbmUnOlxuICAgICAgICByZXR1cm4gJ2JnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTgwMCc7XG4gICAgICBjYXNlICdBY2tub3dsZWRnZWQnOlxuICAgICAgICByZXR1cm4gJ2JnLWJsdWUtMTAwIHRleHQtYmx1ZS04MDAnO1xuICAgICAgY2FzZSAnTmV3JzpcbiAgICAgICAgcmV0dXJuICdiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnYmctZ3JheS0xMDAgdGV4dC1ncmF5LTgwMCc7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGdldEFJUHJvbXB0ID0gKHN1Z2dlc3Rpb246IEltcHJvdmVtZW50U3VnZ2VzdGlvbikgPT4ge1xuICAgIGNvbnN0IGJhc2VDb250ZXh0ID1cbiAgICAgICdZb3UgYXJlIHdvcmtpbmcgb24gYSBRdWViZWMgcHJvcGVydHkgbWFuYWdlbWVudCBTYWFTIGNhbGxlZCBLb3ZlbyBHZXN0aW9uLiAnO1xuXG4gICAgc3dpdGNoIChzdWdnZXN0aW9uLmNhdGVnb3J5KSB7XG4gICAgICBjYXNlICdDb2RlIFF1YWxpdHknOlxuICAgICAgICByZXR1cm4gYCR7YmFzZUNvbnRleHR9JHtzdWdnZXN0aW9uLmRlc2NyaXB0aW9ufSBGb2N1cyBvbiBpbXByb3ZpbmcgY29kZSBtYWludGFpbmFiaWxpdHkgd2hpbGUgcHJlc2VydmluZyBleGlzdGluZyBmdW5jdGlvbmFsaXR5LiBGb2xsb3cgZXhpc3RpbmcgVHlwZVNjcmlwdCBwYXR0ZXJucyBhbmQgZW5zdXJlIGFsbCBjaGFuZ2VzIG1haW50YWluIHR5cGUgc2FmZXR5LmA7XG5cbiAgICAgIGNhc2UgJ1Rlc3RpbmcnOlxuICAgICAgICByZXR1cm4gYCR7YmFzZUNvbnRleHR9JHtzdWdnZXN0aW9uLmRlc2NyaXB0aW9ufSBBZGQgY29tcHJlaGVuc2l2ZSB1bml0IHRlc3RzIHVzaW5nIEplc3QgYW5kIFJlYWN0IFRlc3RpbmcgTGlicmFyeS4gRm9jdXMgb24gY3JpdGljYWwgcGF0aHMgYW5kIGVkZ2UgY2FzZXMuIEVuc3VyZSB0ZXN0cyBmb2xsb3cgdGhlIGV4aXN0aW5nIHRlc3Qgc3RydWN0dXJlIGluIC90ZXN0cy8gZGlyZWN0b3J5LmA7XG5cbiAgICAgIGNhc2UgJ0RvY3VtZW50YXRpb24nOlxuICAgICAgICByZXR1cm4gYCR7YmFzZUNvbnRleHR9JHtzdWdnZXN0aW9uLmRlc2NyaXB0aW9ufSBBZGQgSlNEb2MgY29tbWVudHMgdG8gYWxsIGV4cG9ydGVkIGZ1bmN0aW9ucyBhbmQgY2xhc3Nlcy4gRm9sbG93IHRoZSBleGlzdGluZyBkb2N1bWVudGF0aW9uIHN0eWxlIGFuZCBpbmNsdWRlIHBhcmFtZXRlciBkZXNjcmlwdGlvbnMsIHJldHVybiB2YWx1ZXMsIGFuZCB1c2FnZSBleGFtcGxlcyB3aGVyZSBhcHByb3ByaWF0ZS5gO1xuXG4gICAgICBjYXNlICdTZWN1cml0eSc6XG4gICAgICAgIHJldHVybiBgJHtiYXNlQ29udGV4dH0ke3N1Z2dlc3Rpb24uZGVzY3JpcHRpb259IEFkZHJlc3Mgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzIHdoaWxlIG1haW50YWluaW5nIExhdyAyNSBjb21wbGlhbmNlIGZvciBRdWViZWMgcHJpdmFjeSByZWd1bGF0aW9ucy4gVXBkYXRlIGRlcGVuZGVuY2llcyBzYWZlbHkgYW5kIHZhbGlkYXRlIGFsbCBjaGFuZ2VzIGRvbid0IGJyZWFrIGF1dGhlbnRpY2F0aW9uIG9yIGRhdGEgcHJvdGVjdGlvbi5gO1xuXG4gICAgICBjYXNlICdQZXJmb3JtYW5jZSc6XG4gICAgICAgIHJldHVybiBgJHtiYXNlQ29udGV4dH0ke3N1Z2dlc3Rpb24uZGVzY3JpcHRpb259IE9wdGltaXplIHBlcmZvcm1hbmNlIHdoaWxlIG1haW50YWluaW5nIHRoZSBleGlzdGluZyB1c2VyIGV4cGVyaWVuY2UuIENvbnNpZGVyIGNvZGUgc3BsaXR0aW5nLCBsYXp5IGxvYWRpbmcsIGFuZCBidW5kbGUgb3B0aW1pemF0aW9uLiBUZXN0IGNoYW5nZXMgdGhvcm91Z2hseSB0byBlbnN1cmUgbm8gcmVncmVzc2lvbnMuYDtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGAke2Jhc2VDb250ZXh0fSR7c3VnZ2VzdGlvbi5kZXNjcmlwdGlvbn0gSW1wbGVtZW50IHRoaXMgaW1wcm92ZW1lbnQgZm9sbG93aW5nIHRoZSBleGlzdGluZyBjb2RlYmFzZSBwYXR0ZXJucyBhbmQgUXVlYmVjIHByb3BlcnR5IG1hbmFnZW1lbnQgcmVxdWlyZW1lbnRzLiBFbnN1cmUgYWxsIGNoYW5nZXMgYXJlIHdlbGwtdGVzdGVkIGFuZCBkb2N1bWVudGVkLmA7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGdldENhdGVnb3J5SWNvbiA9IChjYXRlZ29yeU5hbWU6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGNhdGVnb3J5Q29uZmlnLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gY2F0ZWdvcnlOYW1lKTtcbiAgICByZXR1cm4gY29uZmlnPy5pY29uIHx8IE1lc3NhZ2VTcXVhcmU7XG4gIH07XG5cbiAgY29uc3QgZ2V0Q2F0ZWdvcnlDb2xvciA9IChjYXRlZ29yeU5hbWU6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGNhdGVnb3J5Q29uZmlnLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gY2F0ZWdvcnlOYW1lKTtcbiAgICByZXR1cm4gY29uZmlnPy5jb2xvciB8fCAnYmctZ3JheS01MCB0ZXh0LWdyYXktNzAwIGJvcmRlci1ncmF5LTIwMCc7XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleC0xIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuJz5cbiAgICAgIDxIZWFkZXJcbiAgICAgICAgdGl0bGU9J0ltcHJvdmVtZW50IFN1Z2dlc3Rpb25zJ1xuICAgICAgICBzdWJ0aXRsZT0nUmV2aWV3IGFuZCBtYW5hZ2Ugc3lzdGVtIGltcHJvdmVtZW50IHJlY29tbWVuZGF0aW9ucydcbiAgICAgIC8+XG5cbiAgICAgIHsvKiBSZWZyZXNoIENvbW1hbmQgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nYm9yZGVyLWIgYmctZ3JheS01MCBweC02IHB5LTMnPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbWF4LXctN3hsIG14LWF1dG8nPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiB0ZXh0LXNtIHRleHQtZ3JheS02MDAnPlxuICAgICAgICAgICAgPFRlcm1pbmFsIGNsYXNzTmFtZT0naC00IHctNCcgLz5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nZm9udC1tZWRpdW0nPlJlZnJlc2ggQ29tbWFuZDo8L3NwYW4+XG4gICAgICAgICAgICA8Y29kZSBjbGFzc05hbWU9J2JnLWdyYXktMTAwIHB4LTIgcHktMSByb3VuZGVkIHRleHQteHMgZm9udC1tb25vJz5cbiAgICAgICAgICAgICAgbnBtIHJ1biBxdWFsaXR5OmNoZWNrXG4gICAgICAgICAgICA8L2NvZGU+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgb3ZlcmZsb3ctYXV0byBwLTYnPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbWF4LXctN3hsIG14LWF1dG8nPlxuICAgICAgICAgIHsvKiBDYXRlZ29yeSBTdW1tYXJ5ICovfVxuICAgICAgICAgIDxDYXJkIGNsYXNzTmFtZT0nbWItNiBiZy1ncmFkaWVudC10by1yIGZyb20tYmx1ZS01MCB0by1pbmRpZ28tNTAgYm9yZGVyLWJsdWUtMjAwJz5cbiAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3B0LTYnPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuJz5cbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT0ndGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtYmx1ZS05MDAnPlxuICAgICAgICAgICAgICAgICAgICBDb250aW51b3VzIEltcHJvdmVtZW50IE92ZXJ2aWV3XG4gICAgICAgICAgICAgICAgICA8L2gzPlxuICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtYmx1ZS03MDAgbXQtMSc+XG4gICAgICAgICAgICAgICAgICAgIERpc3BsYXlpbmcgMiBwcmlvcml0eSBzdWdnZXN0aW9ucyBwZXIgY2F0ZWdvcnkgZm9yIGZvY3VzZWQgaW1wcm92ZW1lbnRzXG4gICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPEJhZGdlIGNsYXNzTmFtZT0nYmctYmx1ZS0xMDAgdGV4dC1ibHVlLTgwMCc+XG4gICAgICAgICAgICAgICAgICB7T2JqZWN0LnZhbHVlcyhjYXRlZ29yaXplZFN1Z2dlc3Rpb25zKS5mbGF0KCkubGVuZ3RofSBBY3RpdmUgU3VnZ2VzdGlvbnNcbiAgICAgICAgICAgICAgICA8L0JhZGdlPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgPC9DYXJkPlxuXG4gICAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBoLTY0Jz5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2FuaW1hdGUtc3BpbiByb3VuZGVkLWZ1bGwgaC0zMiB3LTMyIGJvcmRlci1iLTIgYm9yZGVyLWtvdmVvLW5hdnknPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdzcGFjZS15LTgnPlxuICAgICAgICAgICAgICB7Y2F0ZWdvcnlDb25maWcubWFwKChjYXRlZ29yeSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5U3VnZ2VzdGlvbnMgPSBjYXRlZ29yaXplZFN1Z2dlc3Rpb25zW2NhdGVnb3J5Lm5hbWVdIHx8IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IEljb24gPSBjYXRlZ29yeS5pY29uO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNhdGVnb3J5U3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2NhdGVnb3J5Lm5hbWV9IGNsYXNzTmFtZT0nc3BhY2UteS00Jz5cbiAgICAgICAgICAgICAgICAgICAgey8qIENhdGVnb3J5IEhlYWRlciAqL31cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggaXRlbXMtY2VudGVyIGdhcC0zIHAtMyByb3VuZGVkLWxnIGJvcmRlciAke2NhdGVnb3J5LmNvbG9yfWB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8SWNvbiBjbGFzc05hbWU9J2gtNSB3LTUnIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT0ndGV4dC1sZyBmb250LXNlbWlib2xkJz57Y2F0ZWdvcnkubmFtZX08L2gyPlxuICAgICAgICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PSdvdXRsaW5lJyBjbGFzc05hbWU9J21sLWF1dG8nPlxuICAgICAgICAgICAgICAgICAgICAgICAge2NhdGVnb3J5U3VnZ2VzdGlvbnMubGVuZ3RofXsnICd9XG4gICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnlTdWdnZXN0aW9ucy5sZW5ndGggPT09IDEgPyAnc3VnZ2VzdGlvbicgOiAnc3VnZ2VzdGlvbnMnfVxuICAgICAgICAgICAgICAgICAgICAgIDwvQmFkZ2U+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIHsvKiBDYXRlZ29yeSBTdWdnZXN0aW9ucyAqL31cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2dyaWQgZ2FwLTQgbWQ6Z3JpZC1jb2xzLTInPlxuICAgICAgICAgICAgICAgICAgICAgIHtjYXRlZ29yeVN1Z2dlc3Rpb25zLm1hcCgoc3VnZ2VzdGlvbikgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPENhcmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXtzdWdnZXN0aW9uLmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2hvdmVyOnNoYWRvdy1sZyB0cmFuc2l0aW9uLWFsbCBob3ZlcjpzY2FsZS1bMS4wMl0nXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDYXJkSGVhZGVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLXN0YXJ0IGp1c3RpZnktYmV0d2Vlbic+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleC0xJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENhcmRUaXRsZSBjbGFzc05hbWU9J3RleHQtbGcgZm9udC1zZW1pYm9sZCB0ZXh0LWtvdmVvLW5hdnknPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWdnZXN0aW9uLnRpdGxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NhcmRUaXRsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENhcmREZXNjcmlwdGlvbiBjbGFzc05hbWU9J210LTInPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWdnZXN0aW9uLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NhcmREZXNjcmlwdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggZmxleC1jb2wgZ2FwLTIgbWwtNCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCYWRnZSBjbGFzc05hbWU9e2dldFByaW9yaXR5Q29sb3Ioc3VnZ2VzdGlvbi5wcmlvcml0eSl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWdnZXN0aW9uLnByaW9yaXR5fSBQcmlvcml0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JhZGdlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QmFkZ2UgY2xhc3NOYW1lPXtnZXRTdGF0dXNDb2xvcihzdWdnZXN0aW9uLnN0YXR1cyl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWdnZXN0aW9uLnN0YXR1c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NhcmRIZWFkZXI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPENhcmRDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtYi00Jz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCB0ZXh0LXNtIHRleHQtZ3JheS02MDAgbWItMyc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNZXNzYWdlU3F1YXJlIHNpemU9ezE2fSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdWdnZXN0aW9uLmNhdGVnb3J5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZWQ6IHtuZXcgRGF0ZShzdWdnZXN0aW9uLmNyZWF0ZWRBdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7LyogQUkgQWdlbnQgUHJvbXB0ICovfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2JnLWJsdWUtNTAgYm9yZGVyIGJvcmRlci1ibHVlLTIwMCByb3VuZGVkLWxnIHAtMyc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LXhzIGZvbnQtc2VtaWJvbGQgdGV4dC1ibHVlLTgwMCBtYi0yIHVwcGVyY2FzZSB0cmFja2luZy13aWRlJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSSBBZ2VudCBQcm9tcHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtYmx1ZS05MDAgZm9udC1tb25vIGJnLXdoaXRlIGJvcmRlciByb3VuZGVkIHB4LTMgcHktMiBzZWxlY3QtYWxsIGN1cnNvci1wb2ludGVyJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Z2V0QUlQcm9tcHQoc3VnZ2VzdGlvbil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC14cyB0ZXh0LWJsdWUtNjAwIG10LTEnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsaWNrIHRvIHNlbGVjdCBhbmQgY29weSB0aGUgcHJvbXB0IGFib3ZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGdhcC0yJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3N1Z2dlc3Rpb24uc3RhdHVzID09PSAnTmV3JyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0nc20nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSdvdXRsaW5lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gYWNrbm93bGVkZ2VNdXRhdGlvbi5tdXRhdGUoc3VnZ2VzdGlvbi5pZCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17YWNrbm93bGVkZ2VNdXRhdGlvbi5pc1BlbmRpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDbG9jayBzaXplPXsxNn0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFja25vd2xlZGdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyhzdWdnZXN0aW9uLnN0YXR1cyA9PT0gJ05ldycgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9uLnN0YXR1cyA9PT0gJ0Fja25vd2xlZGdlZCcpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPSdzbSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGNvbXBsZXRlTXV0YXRpb24ubXV0YXRlKHN1Z2dlc3Rpb24uaWQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2NvbXBsZXRlTXV0YXRpb24uaXNQZW5kaW5nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hlY2tDaXJjbGUgc2l6ZT17MTZ9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrIENvbXBsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9KX1cblxuICAgICAgICAgICAgICB7LyogRW1wdHkgU3RhdGUgKi99XG4gICAgICAgICAgICAgIHtPYmplY3QudmFsdWVzKGNhdGVnb3JpemVkU3VnZ2VzdGlvbnMpLmZsYXQoKS5sZW5ndGggPT09IDAgJiYgKFxuICAgICAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT0nZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHktMTYnPlxuICAgICAgICAgICAgICAgICAgICA8TWVzc2FnZVNxdWFyZSBzaXplPXs0OH0gY2xhc3NOYW1lPSd0ZXh0LWdyYXktNDAwIG1iLTQnIC8+XG4gICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9J3RleHQtbGcgZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktNjAwIG1iLTInPlxuICAgICAgICAgICAgICAgICAgICAgIE5vIEFjdGl2ZSBTdWdnZXN0aW9uc1xuICAgICAgICAgICAgICAgICAgICA8L2gzPlxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS01MDAgdGV4dC1jZW50ZXIgbWF4LXctbWQnPlxuICAgICAgICAgICAgICAgICAgICAgIEFsbCBzdWdnZXN0aW9ucyBoYXZlIGJlZW4gY29tcGxldGVkIG9yIG5vIGltcHJvdmVtZW50IHN1Z2dlc3Rpb25zIGhhdmUgYmVlblxuICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlZCB5ZXQuIFJ1biB0aGUgcXVhbGl0eSBjaGVjayB0byBnZW5lcmF0ZSBuZXcgcmVjb21tZW5kYXRpb25zLlxuICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXSwidmVyc2lvbiI6M30=
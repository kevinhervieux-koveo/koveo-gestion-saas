b1103680d8432cbf6e826060a7fc5222
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = ModularDocumentPageWrapper;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const react_query_1 = require("@tanstack/react-query");
const wouter_1 = require("wouter");
const lucide_react_1 = require("lucide-react");
const button_1 = require("@/components/ui/button");
const input_1 = require("@/components/ui/input");
const card_1 = require("@/components/ui/card");
const badge_1 = require("@/components/ui/badge");
const select_1 = require("@/components/ui/select");
const dialog_1 = require("@/components/ui/dialog");
const label_1 = require("@/components/ui/label");
const collapsible_1 = require("@/components/ui/collapsible");
const header_1 = require("@/components/layout/header");
const queryClient_1 = require("@/lib/queryClient");
const use_language_1 = require("@/hooks/use-language");
const document_management_1 = require("@/components/document-management");
const DocumentCreateForm_1 = require("@/components/document-management/DocumentCreateForm");
const lucide_react_2 = require("lucide-react");
function DocumentViewDialog({ documentId, isOpen, onClose, onEdit, canEdit }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleDownload = async () => {
        console.log('[DOWNLOAD] Starting download for document:', documentId);
        try {
            // Use fetch with credentials to ensure authentication
            const response = await fetch(`/api/documents/${documentId}/file?download=true`, {
                method: 'GET',
                credentials: 'include', // Include authentication cookies
            });
            if (!response.ok) {
                throw new Error(`Download failed: ${response.status} ${response.statusText}`);
            }
            // Get the filename from Content-Disposition header or use document name
            const contentDisposition = response.headers.get('Content-Disposition');
            let fileName = document?.name || 'document';
            if (contentDisposition) {
                const fileNameMatch = contentDisposition.match(/filename="([^"]+)"/);
                if (fileNameMatch) {
                    fileName = fileNameMatch[1];
                }
            }
            // Convert response to blob and create download
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            // Clean up
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            console.log('[DOWNLOAD] Download completed successfully');
        }
        catch (error) {
            console.error('[DOWNLOAD] Download failed:', error);
            // You might want to show a toast notification here
        }
    };
    const handleView = () => {
        if (document?.filePath) {
            // Open document in new tab for viewing
            window.open(`/api/documents/${documentId}/file`, '_blank');
        }
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-2xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Document Details" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-2 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Document Name" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.name })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600 capitalize", children: document.category || document.documentType || 'Other' })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Upload Date" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: new Date(document.createdAt).toLocaleDateString() })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Visible to Tenants" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.isVisibleToTenants ? 'Yes' : 'No' })] })] }), document.description && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Description" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.description })] })), document.filePath && ((0, jsx_runtime_1.jsx)("div", { className: "border rounded-lg p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.FileText, { className: "w-5 h-5 text-gray-500" }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium", children: document.fileName || document.name }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500", children: "Document attachment" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", onClick: handleView, className: "flex items-center gap-1", "data-testid": "button-view-document-file", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Eye, { className: "w-3 h-3" }), "View"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", onClick: handleDownload, className: "flex items-center gap-1", "data-testid": "button-download-document-file", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.Download, { className: "w-3 h-3" }), "Download"] })] })] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-end pt-4 border-t", children: [canEdit && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onEdit, children: "Edit Document" })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "default", onClick: onClose, children: "Close" })] })] })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
function DocumentEditDialog({ documentId, isOpen, onClose, onSuccess }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleSuccess = () => {
        onSuccess();
        onClose();
    };
    const handleDelete = () => {
        onSuccess(); // Refresh the document list
        onClose();
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-4xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Edit Document" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsx)("div", { className: "p-6", children: (0, jsx_runtime_1.jsx)(document_management_1.DocumentEditForm, { document: document, onSuccess: handleSuccess, onCancel: onClose, onDelete: handleDelete }) })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
// Document categories for filtering
const DOCUMENT_CATEGORIES = [
    { value: 'all', label: 'All Categories' },
    { value: 'bylaw', label: 'Bylaws' },
    { value: 'financial', label: 'Financial' },
    { value: 'maintenance', label: 'Maintenance' },
    { value: 'legal', label: 'Legal' },
    { value: 'meeting_minutes', label: 'Meeting Minutes' },
    { value: 'insurance', label: 'Insurance' },
    { value: 'contracts', label: 'Contracts' },
    { value: 'permits', label: 'Permits' },
    { value: 'inspection', label: 'Inspection' },
    { value: 'other', label: 'Other' },
];
function ModularDocumentPageWrapper({ type, userRole, backPath, backLabel, entityIdParam, }) {
    const [, navigate] = (0, wouter_1.useLocation)();
    const params = (0, wouter_1.useParams)();
    const { t } = (0, use_language_1.useLanguage)();
    // State for document interactions
    const [isCreateDialogOpen, setIsCreateDialogOpen] = (0, react_1.useState)(false);
    // State for filtering and search
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [selectedCategory, setSelectedCategory] = (0, react_1.useState)('all');
    const [viewMode, setViewMode] = (0, react_1.useState)('grid');
    // State for collapsible categories (start with all categories expanded)
    const [expandedCategories, setExpandedCategories] = (0, react_1.useState)(() => {
        // Initialize with all possible categories expanded
        return new Set(DOCUMENT_CATEGORIES.map(cat => cat.value).filter(val => val !== 'all'));
    });
    // Toggle category expansion
    const toggleCategory = (category) => {
        const newExpanded = new Set(expandedCategories);
        if (newExpanded.has(category)) {
            newExpanded.delete(category);
        }
        else {
            newExpanded.add(category);
        }
        setExpandedCategories(newExpanded);
    };
    // Get entityId from URL (both path param and query param)
    const urlParams = new URLSearchParams(window.location.search);
    const entityId = params[entityIdParam] || urlParams.get(entityIdParam);
    // Get current user
    const { data: user } = (0, react_query_1.useQuery)({
        queryKey: ['/api/auth/user'],
        queryFn: () => (0, queryClient_1.apiRequest)('GET', '/api/auth/user'),
    });
    // Get entity info based on type
    const entityApiPath = type === 'building' ? '/api/manager/buildings' : '/api/residences';
    const { data: entity, isError: entityError, error } = (0, react_query_1.useQuery)({
        queryKey: [entityApiPath, entityId],
        queryFn: async () => {
            if (type === 'residence') {
                const response = await fetch(`/api/residences/${entityId}`, {
                    credentials: 'include',
                });
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('ENTITY_NOT_FOUND');
                    }
                    throw new Error(`Failed to fetch ${type}`);
                }
                return response.json();
            }
            else {
                return (0, queryClient_1.apiRequest)('GET', `${entityApiPath}/${entityId}`);
            }
        },
        enabled: !!entityId,
        retry: false, // Don't retry on 404s
    });
    // Fetch documents for this entity
    const { data: documentResponse, isLoading, error: documentsError } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', type, entityId],
        queryFn: async () => {
            const param = type === 'building' ? 'buildingId' : 'residenceId';
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents?${param}=${entityId}`);
            return response.json();
        },
        enabled: !!entityId,
        staleTime: 0, // Always refetch
        cacheTime: 0, // Don't cache
    });
    // Extract documents array from API response
    const documents = Array.isArray(documentResponse?.documents) ? documentResponse.documents : [];
    // Determine permissions based on user role and type
    const isUserTenant = user?.role === 'tenant';
    const isManager = user?.role === 'manager' || user?.role === 'admin';
    const userPermissions = userRole === 'manager'
        ? {
            canView: true,
            canDownload: true,
            canEdit: isManager,
            canDelete: isManager,
            canCreate: isManager,
        }
        : {
            canView: true,
            canDownload: !isUserTenant,
            canEdit: !isUserTenant,
            canDelete: !isUserTenant,
            canCreate: !isUserTenant,
        };
    // Filter and search documents
    const filteredDocuments = Array.isArray(documents) ? documents.filter(doc => {
        const matchesSearch = doc.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            doc.description?.toLowerCase().includes(searchTerm.toLowerCase());
        const matchesCategory = selectedCategory === 'all' || doc.category === selectedCategory || doc.documentType === selectedCategory;
        return matchesSearch && matchesCategory;
    }) : [];
    // Group documents by category
    const groupedDocuments = filteredDocuments.reduce((groups, doc) => {
        const category = doc.category || doc.documentType || 'other';
        if (!groups[category]) {
            groups[category] = [];
        }
        groups[category].push(doc);
        return groups;
    }, {});
    // Get category display name
    const getCategoryDisplayName = (category) => {
        const categoryLabels = {
            bylaw: 'Bylaws',
            financial: 'Financial Documents',
            maintenance: 'Maintenance Records',
            legal: 'Legal Documents',
            meeting_minutes: 'Meeting Minutes',
            insurance: 'Insurance Documents',
            contracts: 'Contracts',
            permits: 'Permits',
            inspection: 'Inspection Reports',
            other: 'Other Documents',
        };
        return categoryLabels[category] || category.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
    };
    // Generate entity name based on type
    const entityName = type === 'residence'
        ? (entity?.unitNumber || entity?.unit_number ? `Unit ${entity.unitNumber || entity.unit_number}` : 'Residence')
        : entity?.name;
    const defaultBackLabel = backLabel || (type === 'building' ? 'Back to Buildings' : t('backToResidences'));
    // State for document view and edit dialogs
    const [selectedDocumentId, setSelectedDocumentId] = (0, react_1.useState)(null);
    const [isViewDialogOpen, setIsViewDialogOpen] = (0, react_1.useState)(false);
    const [isEditDialogOpen, setIsEditDialogOpen] = (0, react_1.useState)(false);
    // Handle document interactions
    const handleDocumentView = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsViewDialogOpen(true);
    };
    const handleDocumentEdit = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsEditDialogOpen(true);
    };
    const handleCreateDocument = () => {
        setIsCreateDialogOpen(true);
    };
    const handleDocumentSuccess = (documentId) => {
        console.log(`Document created:`, documentId);
        // Refresh documents list will be handled by the DocumentCreateForm's cache invalidation
    };
    const clearFilters = () => {
        setSearchTerm('');
        setSelectedCategory('all');
    };
    if (!entityId) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: [type, " ID is required"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] })] }) }) }));
    }
    // Handle entity not found (specific to residence pages that had this logic)
    if (entityError && error?.message === 'ENTITY_NOT_FOUND' && type === 'residence') {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center max-w-md", children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-semibold mb-4", children: "Residence Not Found" }), (0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: ["The residence ID \"", entityId, "\" doesn't exist in the development database."] }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-400 mb-6", children: "This might be a production database ID. Please use a valid development residence ID." }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "default", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", className: "w-full", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), backLabel || 'Back to Residences'] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: () => navigate('/residents/residences/e27ac924-8120-4904-a791-d1e9db544d58/documents'), "data-testid": "button-go-to-valid-residence", className: "w-full", children: "Go to Unit 101 (Test Residence)" })] })] }) }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "flex-1 flex flex-col overflow-hidden", children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: entityName, subtitle: type === 'building' ? 'Building Documents' : 'Residence Documents' }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto p-6", children: (0, jsx_runtime_1.jsxs)("div", { className: "max-w-7xl mx-auto space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] }), (0, jsx_runtime_1.jsx)("div", {})] }), (0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Filter, { className: "w-5 h-5" }), "Search & Filters"] }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Search" }), (0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4" }), (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: "Search documents...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "pl-10", "data-testid": "input-search-documents" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: selectedCategory, onValueChange: setSelectedCategory, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { "data-testid": "select-category-filter", children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: "All Categories" }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: DOCUMENT_CATEGORIES.map((category) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: category.value, children: category.label }, category.value))) })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "View & Actions" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex gap-1", children: [(0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'grid' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('grid'), "data-testid": "button-grid-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Grid, { className: "w-4 h-4" }) }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'list' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('list'), "data-testid": "button-list-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.List, { className: "w-4 h-4" }) })] }), userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, size: "sm", "data-testid": "button-create-document", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create"] })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", size: "sm", onClick: clearFilters, "data-testid": "button-clear-filters", children: "Clear" })] })] })] }) })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex justify-between items-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-muted-foreground", children: [filteredDocuments.length, " document", filteredDocuments.length !== 1 ? 's' : '', " found"] }), (searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", children: "Filtered" }))] }) }), isLoading ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading documents..." })] }) })) : filteredDocuments.length === 0 ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: "p-8 text-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-16 h-16 mx-auto mb-4 bg-muted rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "w-8 h-8 text-muted-foreground" }) }), (0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-semibold text-gray-600 mb-2", children: "No Documents Found" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500 mb-4", children: searchTerm || selectedCategory !== 'all'
                                                ? "No documents match your current filters. Try adjusting your search criteria."
                                                : `No documents have been uploaded for this ${type} yet. Create your first document to get started.` }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-center", children: [(searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: clearFilters, children: "Clear Filters" })), userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create Document"] }))] })] }) }) })) : ((0, jsx_runtime_1.jsx)("div", { className: "space-y-6", children: Object.entries(groupedDocuments).map(([category, categoryDocuments]) => {
                                const isExpanded = expandedCategories.has(category);
                                return ((0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: (0, jsx_runtime_1.jsxs)(collapsible_1.Collapsible, { open: isExpanded, onOpenChange: () => toggleCategory(category), children: [(0, jsx_runtime_1.jsxs)(collapsible_1.CollapsibleTrigger, { className: "flex items-center gap-2 p-2 w-full text-left hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors", children: [isExpanded ? ((0, jsx_runtime_1.jsx)(lucide_react_1.ChevronDown, { className: "h-4 w-4" })) : ((0, jsx_runtime_1.jsx)(lucide_react_1.ChevronRight, { className: "h-4 w-4" })), (0, jsx_runtime_1.jsx)("span", { className: "text-lg font-semibold", children: getCategoryDisplayName(category) }), (0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", className: "ml-2", children: categoryDocuments.length })] }), (0, jsx_runtime_1.jsx)(collapsible_1.CollapsibleContent, { className: "space-y-3", children: (0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: "pt-6", children: (0, jsx_runtime_1.jsx)("div", { className: `grid gap-4 ${viewMode === 'grid'
                                                                ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4'
                                                                : 'grid-cols-1'}`, children: categoryDocuments.map((document) => ((0, jsx_runtime_1.jsx)(document_management_1.DocumentCard, { documentId: document.id, title: document.name, documentType: document.category || document.documentType, createdAt: document.createdAt, onViewClick: handleDocumentView, compact: viewMode === 'list' }, document.id))) }) }) }) })] }) }, category));
                            }) })), (0, jsx_runtime_1.jsx)(DocumentCreateForm_1.DocumentCreateForm, { isOpen: isCreateDialogOpen, onClose: () => setIsCreateDialogOpen(false), onSuccess: handleDocumentSuccess, entityType: type, entityId: entityId, entityName: entityName }), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentViewDialog, { documentId: selectedDocumentId, isOpen: isViewDialogOpen, onClose: () => {
                                setIsViewDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onEdit: () => {
                                setIsViewDialogOpen(false);
                                setIsEditDialogOpen(true);
                            }, canEdit: userPermissions.canEdit })), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentEditDialog, { documentId: selectedDocumentId, isOpen: isEditDialogOpen, onClose: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onSuccess: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                                // Refresh documents list
                                queryClient_1.queryClient.invalidateQueries({
                                    queryKey: ['/api/documents', type, entityId],
                                });
                            } }))] }) })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL01vZHVsYXJEb2N1bWVudFBhZ2VXcmFwcGVyLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWdTQSw2Q0F1ZkM7O0FBdnhCRCwrQ0FBd0M7QUFDeEMsdURBQWlEO0FBQ2pELG1DQUFnRDtBQUNoRCwrQ0FBMkg7QUFDM0gsbURBQWdEO0FBQ2hELGlEQUE4QztBQUM5QywrQ0FBZ0Y7QUFDaEYsaURBQThDO0FBQzlDLG1EQUF1RztBQUN2RyxtREFBMEY7QUFDMUYsaURBQThDO0FBQzlDLDZEQUlxQztBQUNyQyx1REFBb0Q7QUFDcEQsbURBQTREO0FBQzVELHVEQUFtRDtBQUNuRCwwRUFJMEM7QUFDMUMsNEZBQXlGO0FBQ3pGLCtDQUFrRDtBQVlsRCxTQUFTLGtCQUFrQixDQUFDLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBMkI7SUFDbkcsTUFBTSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBQSxzQkFBUSxFQUFDO1FBQzdDLFFBQVEsRUFBRSxDQUFDLGdCQUFnQixFQUFFLFVBQVUsQ0FBQztRQUN4QyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFBLHdCQUFVLEVBQUMsS0FBSyxFQUFFLGtCQUFrQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3pFLE9BQU8sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3pCLENBQUM7UUFDRCxPQUFPLEVBQUUsTUFBTSxJQUFJLENBQUMsQ0FBQyxVQUFVO0tBQ2hDLENBQUMsQ0FBQztJQUVILE1BQU0sY0FBYyxHQUFHLEtBQUssSUFBSSxFQUFFO1FBQ2hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNENBQTRDLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDO1lBQ0gs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LEVBQUUsR0FBRyxFQUFFO2dDQUNaLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO2dDQUMzQixxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQzs0QkFDOUIsQ0FBQyxFQUNELE1BQU0sRUFBRSxHQUFHLEVBQUU7Z0NBQ1gsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7Z0NBQzNCLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDOzRCQUM1QixDQUFDLEVBQ0QsT0FBTyxFQUFFLGVBQWUsQ0FBQyxPQUFPLEdBQ2hDLENBQ0gsRUFHQSxrQkFBa0IsSUFBSSxDQUNyQix1QkFBQyxrQkFBa0IsSUFDakIsVUFBVSxFQUFFLGtCQUFrQixFQUM5QixNQUFNLEVBQUUsZ0JBQWdCLEVBQ3hCLE9BQU8sRUFBRSxHQUFHLEVBQUU7Z0NBQ1osbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7Z0NBQzNCLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDOzRCQUM5QixDQUFDLEVBQ0QsU0FBUyxFQUFFLEdBQUcsRUFBRTtnQ0FDZCxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQ0FDM0IscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7Z0NBQzVCLHlCQUF5QjtnQ0FDekIseUJBQVcsQ0FBQyxpQkFBaUIsQ0FBQztvQ0FDNUIsUUFBUSxFQUFFLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQztpQ0FDN0MsQ0FBQyxDQUFDOzRCQUNMLENBQUMsR0FDRCxDQUNILElBQ0csR0FDRixJQUNGLENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL01vZHVsYXJEb2N1bWVudFBhZ2VXcmFwcGVyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VRdWVyeSB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7XG5pbXBvcnQgeyB1c2VMb2NhdGlvbiwgdXNlUGFyYW1zIH0gZnJvbSAnd291dGVyJztcbmltcG9ydCB7IEdyaWQsIExpc3QsIEFycm93TGVmdCwgUGx1cywgU2VhcmNoLCBGaWx0ZXIsIEJ1aWxkaW5nLCBIb21lLCBDaGV2cm9uRG93biwgQ2hldnJvblJpZ2h0LCBFeWUgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2J1dHRvbic7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9pbnB1dCc7XG5pbXBvcnQgeyBDYXJkLCBDYXJkQ29udGVudCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NhcmQnO1xuaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYmFkZ2UnO1xuaW1wb3J0IHsgU2VsZWN0LCBTZWxlY3RDb250ZW50LCBTZWxlY3RJdGVtLCBTZWxlY3RUcmlnZ2VyLCBTZWxlY3RWYWx1ZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9zZWxlY3QnO1xuaW1wb3J0IHsgRGlhbG9nLCBEaWFsb2dDb250ZW50LCBEaWFsb2dIZWFkZXIsIERpYWxvZ1RpdGxlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2RpYWxvZyc7XG5pbXBvcnQgeyBMYWJlbCB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9sYWJlbCc7XG5pbXBvcnQge1xuICBDb2xsYXBzaWJsZSxcbiAgQ29sbGFwc2libGVDb250ZW50LFxuICBDb2xsYXBzaWJsZVRyaWdnZXIsXG59IGZyb20gJ0AvY29tcG9uZW50cy91aS9jb2xsYXBzaWJsZSc7XG5pbXBvcnQgeyBIZWFkZXIgfSBmcm9tICdAL2NvbXBvbmVudHMvbGF5b3V0L2hlYWRlcic7XG5pbXBvcnQgeyBhcGlSZXF1ZXN0LCBxdWVyeUNsaWVudCB9IGZyb20gJ0AvbGliL3F1ZXJ5Q2xpZW50JztcbmltcG9ydCB7IHVzZUxhbmd1YWdlIH0gZnJvbSAnQC9ob29rcy91c2UtbGFuZ3VhZ2UnO1xuaW1wb3J0IHtcbiAgU2hhcmVkVXBsb2FkZXIsXG4gIERvY3VtZW50Q2FyZCxcbiAgRG9jdW1lbnRFZGl0Rm9ybVxufSBmcm9tICdAL2NvbXBvbmVudHMvZG9jdW1lbnQtbWFuYWdlbWVudCc7XG5pbXBvcnQgeyBEb2N1bWVudENyZWF0ZUZvcm0gfSBmcm9tICdAL2NvbXBvbmVudHMvZG9jdW1lbnQtbWFuYWdlbWVudC9Eb2N1bWVudENyZWF0ZUZvcm0nO1xuaW1wb3J0IHsgRmlsZVRleHQsIERvd25sb2FkIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCB0eXBlIHsgRG9jdW1lbnRXaXRoTWV0YWRhdGEsIERvY3VtZW50UGVybWlzc2lvbnMgfSBmcm9tICdAc2hhcmVkL3NjaGVtYXMvZG9jdW1lbnRzJztcblxuLy8gRG9jdW1lbnQgVmlldyBEaWFsb2cgQ29tcG9uZW50XG5pbnRlcmZhY2UgRG9jdW1lbnRWaWV3RGlhbG9nUHJvcHMge1xuICBkb2N1bWVudElkOiBzdHJpbmc7XG4gIGlzT3BlbjogYm9vbGVhbjtcbiAgb25DbG9zZTogKCkgPT4gdm9pZDtcbiAgb25FZGl0OiAoKSA9PiB2b2lkO1xuICBjYW5FZGl0OiBib29sZWFuO1xufVxuXG5mdW5jdGlvbiBEb2N1bWVudFZpZXdEaWFsb2coeyBkb2N1bWVudElkLCBpc09wZW4sIG9uQ2xvc2UsIG9uRWRpdCwgY2FuRWRpdCB9OiBEb2N1bWVudFZpZXdEaWFsb2dQcm9wcykge1xuICBjb25zdCB7IGRhdGE6IGRvY3VtZW50LCBpc0xvYWRpbmcgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cycsIGRvY3VtZW50SWRdLFxuICAgIHF1ZXJ5Rm46IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUmVxdWVzdCgnR0VUJywgYC9hcGkvZG9jdW1lbnRzLyR7ZG9jdW1lbnRJZH1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBlbmFibGVkOiBpc09wZW4gJiYgISFkb2N1bWVudElkLFxuICB9KTtcblxuICBjb25zdCBoYW5kbGVEb3dubG9hZCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnW0RPV05MT0FEXSBTdGFydGluZyBkb3dubG9hZCBmb3IgZG9jdW1lbnQ6JywgZG9jdW1lbnRJZCk7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBmZXRjaCB3aXRoIGNyZWRlbnRpYWxzIHRvIGVuc3VyZSBhdXRoZW50aWNhdGlvblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudElkfS9maWxlP2Rvd25sb2FkPXRydWVgLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsIC8vIEluY2x1ZGUgYXV0aGVudGljYXRpb24gY29va2llc1xuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEb3dubG9hZCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCB0aGUgZmlsZW5hbWUgZnJvbSBDb250ZW50LURpc3Bvc2l0aW9uIGhlYWRlciBvciB1c2UgZG9jdW1lbnQgbmFtZVxuICAgICAgY29uc3QgY29udGVudERpc3Bvc2l0aW9uID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ0NvbnRlbnQtRGlzcG9zaXRpb24nKTtcbiAgICAgIGxldCBmaWxlTmFtZSA9IGRvY3VtZW50Py5uYW1lIHx8ICdkb2N1bWVudCc7XG4gICAgICBcbiAgICAgIGlmIChjb250ZW50RGlzcG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgZmlsZU5hbWVNYXRjaCA9IGNvbnRlbnREaXNwb3NpdGlvbi5tYXRjaCgvZmlsZW5hbWU9XCIoW15cIl0rKVwiLyk7XG4gICAgICAgIGlmIChmaWxlTmFtZU1hdGNoKSB7XG4gICAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZU1hdGNoWzFdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENvbnZlcnQgcmVzcG9uc2UgdG8gYmxvYiBhbmQgY3JlYXRlIGRvd25sb2FkXG4gICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgY29uc3QgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICBcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSB1cmw7XG4gICAgICBsaW5rLmRvd25sb2FkID0gZmlsZU5hbWU7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICAgICAgbGluay5jbGljaygpO1xuICAgICAgXG4gICAgICAvLyBDbGVhbiB1cFxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcbiAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdbRE9XTkxPQURdIERvd25sb2FkIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RPV05MT0FEXSBEb3dubG9hZCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgLy8gWW91IG1pZ2h0IHdhbnQgdG8gc2hvdyBhIHRvYXN0IG5vdGlmaWNhdGlvbiBoZXJlXG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVZpZXcgPSAoKSA9PiB7XG4gICAgaWYgKGRvY3VtZW50Py5maWxlUGF0aCkge1xuICAgICAgLy8gT3BlbiBkb2N1bWVudCBpbiBuZXcgdGFiIGZvciB2aWV3aW5nXG4gICAgICB3aW5kb3cub3BlbihgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudElkfS9maWxlYCwgJ19ibGFuaycpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxEaWFsb2cgb3Blbj17aXNPcGVufSBvbk9wZW5DaGFuZ2U9e29uQ2xvc2V9PlxuICAgICAgPERpYWxvZ0NvbnRlbnQgY2xhc3NOYW1lPVwibWF4LXctMnhsIG1heC1oLVs5NXZoXSBvdmVyZmxvdy15LWF1dG9cIj5cbiAgICAgICAgPERpYWxvZ0hlYWRlcj5cbiAgICAgICAgICA8RGlhbG9nVGl0bGU+RG9jdW1lbnQgRGV0YWlsczwvRGlhbG9nVGl0bGU+XG4gICAgICAgIDwvRGlhbG9nSGVhZGVyPlxuICAgICAgICBcbiAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+TG9hZGluZyBkb2N1bWVudC4uLjwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGRvY3VtZW50ID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS02XCI+XG4gICAgICAgICAgICB7LyogRG9jdW1lbnQgSW5mb3JtYXRpb24gKi99XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ3JpZC1jb2xzLTIgZ2FwLTRcIj5cbiAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPkRvY3VtZW50IE5hbWU8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTYwMFwiPntkb2N1bWVudC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5DYXRlZ29yeTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwIGNhcGl0YWxpemVcIj57ZG9jdW1lbnQuY2F0ZWdvcnkgfHwgZG9jdW1lbnQuZG9jdW1lbnRUeXBlIHx8ICdPdGhlcid9PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlVwbG9hZCBEYXRlPC9MYWJlbD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57bmV3IERhdGUoZG9jdW1lbnQuY3JlYXRlZEF0KS50b0xvY2FsZURhdGVTdHJpbmcoKX08L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+VmlzaWJsZSB0byBUZW5hbnRzPC9MYWJlbD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57ZG9jdW1lbnQuaXNWaXNpYmxlVG9UZW5hbnRzID8gJ1llcycgOiAnTm8nfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgey8qIERlc2NyaXB0aW9uICovfVxuICAgICAgICAgICAge2RvY3VtZW50LmRlc2NyaXB0aW9uICYmIChcbiAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPkRlc2NyaXB0aW9uPC9MYWJlbD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57ZG9jdW1lbnQuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIHsvKiBEb2N1bWVudCBBY3Rpb25zICovfVxuICAgICAgICAgICAge2RvY3VtZW50LmZpbGVQYXRoICYmIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJib3JkZXIgcm91bmRlZC1sZyBwLTRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtM1wiPlxuICAgICAgICAgICAgICAgICAgICA8RmlsZVRleHQgY2xhc3NOYW1lPVwidy01IGgtNSB0ZXh0LWdyYXktNTAwXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+e2RvY3VtZW50LmZpbGVOYW1lIHx8IGRvY3VtZW50Lm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmF5LTUwMFwiPkRvY3VtZW50IGF0dGFjaG1lbnQ8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICAgICAgICBzaXplPVwic21cIlxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTFcIlxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLXZpZXctZG9jdW1lbnQtZmlsZVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8RXllIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgIFZpZXdcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVEb3dubG9hZH1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMVwiXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tZG93bmxvYWQtZG9jdW1lbnQtZmlsZVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8RG93bmxvYWQgY2xhc3NOYW1lPVwidy0zIGgtM1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgRG93bmxvYWRcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7LyogQWN0aW9uIEJ1dHRvbnMgKi99XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTIganVzdGlmeS1lbmQgcHQtNCBib3JkZXItdFwiPlxuICAgICAgICAgICAgICB7Y2FuRWRpdCAmJiAoXG4gICAgICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwib3V0bGluZVwiIG9uQ2xpY2s9e29uRWRpdH0+XG4gICAgICAgICAgICAgICAgICBFZGl0IERvY3VtZW50XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cImRlZmF1bHRcIiBvbkNsaWNrPXtvbkNsb3NlfT5cbiAgICAgICAgICAgICAgICBDbG9zZVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+RG9jdW1lbnQgbm90IGZvdW5kPC9wPlxuICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwib3V0bGluZVwiIG9uQ2xpY2s9e29uQ2xvc2V9IGNsYXNzTmFtZT1cIm10LTRcIj5cbiAgICAgICAgICAgICAgQ2xvc2VcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgIDwvRGlhbG9nPlxuICApO1xufVxuXG4vLyBEb2N1bWVudCBFZGl0IERpYWxvZyBDb21wb25lbnQgIFxuaW50ZXJmYWNlIERvY3VtZW50RWRpdERpYWxvZ1Byb3BzIHtcbiAgZG9jdW1lbnRJZDogc3RyaW5nO1xuICBpc09wZW46IGJvb2xlYW47XG4gIG9uQ2xvc2U6ICgpID0+IHZvaWQ7XG4gIG9uU3VjY2VzczogKCkgPT4gdm9pZDtcbn1cblxuZnVuY3Rpb24gRG9jdW1lbnRFZGl0RGlhbG9nKHsgZG9jdW1lbnRJZCwgaXNPcGVuLCBvbkNsb3NlLCBvblN1Y2Nlc3MgfTogRG9jdW1lbnRFZGl0RGlhbG9nUHJvcHMpIHtcbiAgY29uc3QgeyBkYXRhOiBkb2N1bWVudCwgaXNMb2FkaW5nIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9kb2N1bWVudHMnLCBkb2N1bWVudElkXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaVJlcXVlc3QoJ0dFVCcsIGAvYXBpL2RvY3VtZW50cy8ke2RvY3VtZW50SWR9YCk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgIH0sXG4gICAgZW5hYmxlZDogaXNPcGVuICYmICEhZG9jdW1lbnRJZCxcbiAgfSk7XG5cbiAgY29uc3QgaGFuZGxlU3VjY2VzcyA9ICgpID0+IHtcbiAgICBvblN1Y2Nlc3MoKTtcbiAgICBvbkNsb3NlKCk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRGVsZXRlID0gKCkgPT4ge1xuICAgIG9uU3VjY2VzcygpOyAvLyBSZWZyZXNoIHRoZSBkb2N1bWVudCBsaXN0XG4gICAgb25DbG9zZSgpO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPERpYWxvZyBvcGVuPXtpc09wZW59IG9uT3BlbkNoYW5nZT17b25DbG9zZX0+XG4gICAgICA8RGlhbG9nQ29udGVudCBjbGFzc05hbWU9XCJtYXgtdy00eGwgbWF4LWgtWzk1dmhdIG92ZXJmbG93LXktYXV0b1wiPlxuICAgICAgICA8RGlhbG9nSGVhZGVyPlxuICAgICAgICAgIDxEaWFsb2dUaXRsZT5FZGl0IERvY3VtZW50PC9EaWFsb2dUaXRsZT5cbiAgICAgICAgPC9EaWFsb2dIZWFkZXI+XG4gICAgICAgIFxuICAgICAgICB7aXNMb2FkaW5nID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFuaW1hdGUtc3BpbiB3LTggaC04IGJvcmRlci00IGJvcmRlci1wcmltYXJ5IGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBteC1hdXRvIG1iLTRcIj48L2Rpdj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDBcIj5Mb2FkaW5nIGRvY3VtZW50Li4uPC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogZG9jdW1lbnQgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTZcIj5cbiAgICAgICAgICAgIDxEb2N1bWVudEVkaXRGb3JtXG4gICAgICAgICAgICAgIGRvY3VtZW50PXtkb2N1bWVudH1cbiAgICAgICAgICAgICAgb25TdWNjZXNzPXtoYW5kbGVTdWNjZXNzfVxuICAgICAgICAgICAgICBvbkNhbmNlbD17b25DbG9zZX1cbiAgICAgICAgICAgICAgb25EZWxldGU9e2hhbmRsZURlbGV0ZX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTggdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDBcIj5Eb2N1bWVudCBub3QgZm91bmQ8L3A+XG4gICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17b25DbG9zZX0gY2xhc3NOYW1lPVwibXQtNFwiPlxuICAgICAgICAgICAgICBDbG9zZVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgICA8L0RpYWxvZ0NvbnRlbnQ+XG4gICAgPC9EaWFsb2c+XG4gICk7XG59XG5cbi8vIERvY3VtZW50IGNhdGVnb3JpZXMgZm9yIGZpbHRlcmluZ1xuY29uc3QgRE9DVU1FTlRfQ0FURUdPUklFUyA9IFtcbiAgeyB2YWx1ZTogJ2FsbCcsIGxhYmVsOiAnQWxsIENhdGVnb3JpZXMnIH0sXG4gIHsgdmFsdWU6ICdieWxhdycsIGxhYmVsOiAnQnlsYXdzJyB9LFxuICB7IHZhbHVlOiAnZmluYW5jaWFsJywgbGFiZWw6ICdGaW5hbmNpYWwnIH0sXG4gIHsgdmFsdWU6ICdtYWludGVuYW5jZScsIGxhYmVsOiAnTWFpbnRlbmFuY2UnIH0sXG4gIHsgdmFsdWU6ICdsZWdhbCcsIGxhYmVsOiAnTGVnYWwnIH0sXG4gIHsgdmFsdWU6ICdtZWV0aW5nX21pbnV0ZXMnLCBsYWJlbDogJ01lZXRpbmcgTWludXRlcycgfSxcbiAgeyB2YWx1ZTogJ2luc3VyYW5jZScsIGxhYmVsOiAnSW5zdXJhbmNlJyB9LFxuICB7IHZhbHVlOiAnY29udHJhY3RzJywgbGFiZWw6ICdDb250cmFjdHMnIH0sXG4gIHsgdmFsdWU6ICdwZXJtaXRzJywgbGFiZWw6ICdQZXJtaXRzJyB9LFxuICB7IHZhbHVlOiAnaW5zcGVjdGlvbicsIGxhYmVsOiAnSW5zcGVjdGlvbicgfSxcbiAgeyB2YWx1ZTogJ290aGVyJywgbGFiZWw6ICdPdGhlcicgfSxcbl0gYXMgY29uc3Q7XG5cbmludGVyZmFjZSBNb2R1bGFyRG9jdW1lbnRQYWdlV3JhcHBlclByb3BzIHtcbiAgdHlwZTogJ2J1aWxkaW5nJyB8ICdyZXNpZGVuY2UnO1xuICB1c2VyUm9sZTogJ21hbmFnZXInIHwgJ3Jlc2lkZW50JztcbiAgYmFja1BhdGg6IHN0cmluZztcbiAgYmFja0xhYmVsPzogc3RyaW5nO1xuICBlbnRpdHlJZFBhcmFtOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1vZHVsYXJEb2N1bWVudFBhZ2VXcmFwcGVyKHtcbiAgdHlwZSxcbiAgdXNlclJvbGUsXG4gIGJhY2tQYXRoLFxuICBiYWNrTGFiZWwsXG4gIGVudGl0eUlkUGFyYW0sXG59OiBNb2R1bGFyRG9jdW1lbnRQYWdlV3JhcHBlclByb3BzKSB7XG4gIGNvbnN0IFssIG5hdmlnYXRlXSA9IHVzZUxvY2F0aW9uKCk7XG4gIGNvbnN0IHBhcmFtcyA9IHVzZVBhcmFtcygpO1xuICBjb25zdCB7IHQgfSA9IHVzZUxhbmd1YWdlKCk7XG5cbiAgLy8gU3RhdGUgZm9yIGRvY3VtZW50IGludGVyYWN0aW9uc1xuICBjb25zdCBbaXNDcmVhdGVEaWFsb2dPcGVuLCBzZXRJc0NyZWF0ZURpYWxvZ09wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICBcbiAgLy8gU3RhdGUgZm9yIGZpbHRlcmluZyBhbmQgc2VhcmNoXG4gIGNvbnN0IFtzZWFyY2hUZXJtLCBzZXRTZWFyY2hUZXJtXSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW3NlbGVjdGVkQ2F0ZWdvcnksIHNldFNlbGVjdGVkQ2F0ZWdvcnldID0gdXNlU3RhdGUoJ2FsbCcpO1xuICBjb25zdCBbdmlld01vZGUsIHNldFZpZXdNb2RlXSA9IHVzZVN0YXRlPCdncmlkJyB8ICdsaXN0Jz4oJ2dyaWQnKTtcbiAgXG4gIC8vIFN0YXRlIGZvciBjb2xsYXBzaWJsZSBjYXRlZ29yaWVzIChzdGFydCB3aXRoIGFsbCBjYXRlZ29yaWVzIGV4cGFuZGVkKVxuICBjb25zdCBbZXhwYW5kZWRDYXRlZ29yaWVzLCBzZXRFeHBhbmRlZENhdGVnb3JpZXNdID0gdXNlU3RhdGU8U2V0PHN0cmluZz4+KCgpID0+IHtcbiAgICAvLyBJbml0aWFsaXplIHdpdGggYWxsIHBvc3NpYmxlIGNhdGVnb3JpZXMgZXhwYW5kZWRcbiAgICByZXR1cm4gbmV3IFNldChET0NVTUVOVF9DQVRFR09SSUVTLm1hcChjYXQgPT4gY2F0LnZhbHVlKS5maWx0ZXIodmFsID0+IHZhbCAhPT0gJ2FsbCcpKTtcbiAgfSk7XG5cbiAgLy8gVG9nZ2xlIGNhdGVnb3J5IGV4cGFuc2lvblxuICBjb25zdCB0b2dnbGVDYXRlZ29yeSA9IChjYXRlZ29yeTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgbmV3RXhwYW5kZWQgPSBuZXcgU2V0KGV4cGFuZGVkQ2F0ZWdvcmllcyk7XG4gICAgaWYgKG5ld0V4cGFuZGVkLmhhcyhjYXRlZ29yeSkpIHtcbiAgICAgIG5ld0V4cGFuZGVkLmRlbGV0ZShjYXRlZ29yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0V4cGFuZGVkLmFkZChjYXRlZ29yeSk7XG4gICAgfVxuICAgIHNldEV4cGFuZGVkQ2F0ZWdvcmllcyhuZXdFeHBhbmRlZCk7XG4gIH07XG5cbiAgLy8gR2V0IGVudGl0eUlkIGZyb20gVVJMIChib3RoIHBhdGggcGFyYW0gYW5kIHF1ZXJ5IHBhcmFtKVxuICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICBjb25zdCBlbnRpdHlJZCA9IChwYXJhbXMgYXMgYW55KVtlbnRpdHlJZFBhcmFtXSB8fCB1cmxQYXJhbXMuZ2V0KGVudGl0eUlkUGFyYW0pO1xuXG4gIC8vIEdldCBjdXJyZW50IHVzZXJcbiAgY29uc3QgeyBkYXRhOiB1c2VyIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9hdXRoL3VzZXInXSxcbiAgICBxdWVyeUZuOiAoKSA9PiBhcGlSZXF1ZXN0KCdHRVQnLCAnL2FwaS9hdXRoL3VzZXInKSBhcyBQcm9taXNlPGFueT4sXG4gIH0pO1xuXG4gIC8vIEdldCBlbnRpdHkgaW5mbyBiYXNlZCBvbiB0eXBlXG4gIGNvbnN0IGVudGl0eUFwaVBhdGggPSB0eXBlID09PSAnYnVpbGRpbmcnID8gJy9hcGkvbWFuYWdlci9idWlsZGluZ3MnIDogJy9hcGkvcmVzaWRlbmNlcyc7XG4gIGNvbnN0IHsgZGF0YTogZW50aXR5LCBpc0Vycm9yOiBlbnRpdHlFcnJvciwgZXJyb3IgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogW2VudGl0eUFwaVBhdGgsIGVudGl0eUlkXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodHlwZSA9PT0gJ3Jlc2lkZW5jZScpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9yZXNpZGVuY2VzLyR7ZW50aXR5SWR9YCwge1xuICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VOVElUWV9OT1RfRk9VTkQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggJHt0eXBlfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXBpUmVxdWVzdCgnR0VUJywgYCR7ZW50aXR5QXBpUGF0aH0vJHtlbnRpdHlJZH1gKSBhcyBQcm9taXNlPGFueT47XG4gICAgICB9XG4gICAgfSxcbiAgICBlbmFibGVkOiAhIWVudGl0eUlkLFxuICAgIHJldHJ5OiBmYWxzZSwgLy8gRG9uJ3QgcmV0cnkgb24gNDA0c1xuICB9KTtcblxuICAvLyBGZXRjaCBkb2N1bWVudHMgZm9yIHRoaXMgZW50aXR5XG4gIGNvbnN0IHsgZGF0YTogZG9jdW1lbnRSZXNwb25zZSwgaXNMb2FkaW5nLCBlcnJvcjogZG9jdW1lbnRzRXJyb3IgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cycsIHR5cGUsIGVudGl0eUlkXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXJhbSA9IHR5cGUgPT09ICdidWlsZGluZycgPyAnYnVpbGRpbmdJZCcgOiAncmVzaWRlbmNlSWQnO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCdHRVQnLCBgL2FwaS9kb2N1bWVudHM/JHtwYXJhbX09JHtlbnRpdHlJZH1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBlbmFibGVkOiAhIWVudGl0eUlkLFxuICAgIHN0YWxlVGltZTogMCwgLy8gQWx3YXlzIHJlZmV0Y2hcbiAgICBjYWNoZVRpbWU6IDAsIC8vIERvbid0IGNhY2hlXG4gIH0pO1xuXG4gIC8vIEV4dHJhY3QgZG9jdW1lbnRzIGFycmF5IGZyb20gQVBJIHJlc3BvbnNlXG4gIGNvbnN0IGRvY3VtZW50cyA9IEFycmF5LmlzQXJyYXkoZG9jdW1lbnRSZXNwb25zZT8uZG9jdW1lbnRzKSA/IGRvY3VtZW50UmVzcG9uc2UuZG9jdW1lbnRzIDogW107XG5cbiAgLy8gRGV0ZXJtaW5lIHBlcm1pc3Npb25zIGJhc2VkIG9uIHVzZXIgcm9sZSBhbmQgdHlwZVxuICBjb25zdCBpc1VzZXJUZW5hbnQgPSB1c2VyPy5yb2xlID09PSAndGVuYW50JztcbiAgY29uc3QgaXNNYW5hZ2VyID0gdXNlcj8ucm9sZSA9PT0gJ21hbmFnZXInIHx8IHVzZXI/LnJvbGUgPT09ICdhZG1pbic7XG4gIFxuICBjb25zdCB1c2VyUGVybWlzc2lvbnM6IERvY3VtZW50UGVybWlzc2lvbnMgPSB1c2VyUm9sZSA9PT0gJ21hbmFnZXInIFxuICAgID8ge1xuICAgICAgICBjYW5WaWV3OiB0cnVlLFxuICAgICAgICBjYW5Eb3dubG9hZDogdHJ1ZSxcbiAgICAgICAgY2FuRWRpdDogaXNNYW5hZ2VyLFxuICAgICAgICBjYW5EZWxldGU6IGlzTWFuYWdlcixcbiAgICAgICAgY2FuQ3JlYXRlOiBpc01hbmFnZXIsXG4gICAgICB9XG4gICAgOiB7XG4gICAgICAgIGNhblZpZXc6IHRydWUsXG4gICAgICAgIGNhbkRvd25sb2FkOiAhaXNVc2VyVGVuYW50LFxuICAgICAgICBjYW5FZGl0OiAhaXNVc2VyVGVuYW50LFxuICAgICAgICBjYW5EZWxldGU6ICFpc1VzZXJUZW5hbnQsXG4gICAgICAgIGNhbkNyZWF0ZTogIWlzVXNlclRlbmFudCxcbiAgICAgIH07XG5cbiAgLy8gRmlsdGVyIGFuZCBzZWFyY2ggZG9jdW1lbnRzXG4gIGNvbnN0IGZpbHRlcmVkRG9jdW1lbnRzID0gQXJyYXkuaXNBcnJheShkb2N1bWVudHMpID8gZG9jdW1lbnRzLmZpbHRlcihkb2MgPT4ge1xuICAgIGNvbnN0IG1hdGNoZXNTZWFyY2ggPSBkb2MubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuZGVzY3JpcHRpb24/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKTtcbiAgICBcbiAgICBjb25zdCBtYXRjaGVzQ2F0ZWdvcnkgPSBzZWxlY3RlZENhdGVnb3J5ID09PSAnYWxsJyB8fCBkb2MuY2F0ZWdvcnkgPT09IHNlbGVjdGVkQ2F0ZWdvcnkgfHwgZG9jLmRvY3VtZW50VHlwZSA9PT0gc2VsZWN0ZWRDYXRlZ29yeTtcblxuICAgIHJldHVybiBtYXRjaGVzU2VhcmNoICYmIG1hdGNoZXNDYXRlZ29yeTtcbiAgfSkgOiBbXTtcblxuICAvLyBHcm91cCBkb2N1bWVudHMgYnkgY2F0ZWdvcnlcbiAgY29uc3QgZ3JvdXBlZERvY3VtZW50cyA9IGZpbHRlcmVkRG9jdW1lbnRzLnJlZHVjZSgoZ3JvdXBzLCBkb2MpID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IGRvYy5jYXRlZ29yeSB8fCBkb2MuZG9jdW1lbnRUeXBlIHx8ICdvdGhlcic7XG4gICAgaWYgKCFncm91cHNbY2F0ZWdvcnldKSB7XG4gICAgICBncm91cHNbY2F0ZWdvcnldID0gW107XG4gICAgfVxuICAgIGdyb3Vwc1tjYXRlZ29yeV0ucHVzaChkb2MpO1xuICAgIHJldHVybiBncm91cHM7XG4gIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIHR5cGVvZiBmaWx0ZXJlZERvY3VtZW50cz4pO1xuXG4gIC8vIEdldCBjYXRlZ29yeSBkaXNwbGF5IG5hbWVcbiAgY29uc3QgZ2V0Q2F0ZWdvcnlEaXNwbGF5TmFtZSA9IChjYXRlZ29yeTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnlMYWJlbHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICBieWxhdzogJ0J5bGF3cycsXG4gICAgICBmaW5hbmNpYWw6ICdGaW5hbmNpYWwgRG9jdW1lbnRzJyxcbiAgICAgIG1haW50ZW5hbmNlOiAnTWFpbnRlbmFuY2UgUmVjb3JkcycsXG4gICAgICBsZWdhbDogJ0xlZ2FsIERvY3VtZW50cycsXG4gICAgICBtZWV0aW5nX21pbnV0ZXM6ICdNZWV0aW5nIE1pbnV0ZXMnLFxuICAgICAgaW5zdXJhbmNlOiAnSW5zdXJhbmNlIERvY3VtZW50cycsXG4gICAgICBjb250cmFjdHM6ICdDb250cmFjdHMnLFxuICAgICAgcGVybWl0czogJ1Blcm1pdHMnLFxuICAgICAgaW5zcGVjdGlvbjogJ0luc3BlY3Rpb24gUmVwb3J0cycsXG4gICAgICBvdGhlcjogJ090aGVyIERvY3VtZW50cycsXG4gICAgfTtcbiAgICByZXR1cm4gY2F0ZWdvcnlMYWJlbHNbY2F0ZWdvcnldIHx8IGNhdGVnb3J5LnJlcGxhY2UoJ18nLCAnICcpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSk7XG4gIH07XG5cblxuICAvLyBHZW5lcmF0ZSBlbnRpdHkgbmFtZSBiYXNlZCBvbiB0eXBlXG4gIGNvbnN0IGVudGl0eU5hbWUgPSB0eXBlID09PSAncmVzaWRlbmNlJyBcbiAgICA/IChlbnRpdHk/LnVuaXROdW1iZXIgfHwgZW50aXR5Py51bml0X251bWJlciA/IGBVbml0ICR7ZW50aXR5LnVuaXROdW1iZXIgfHwgZW50aXR5LnVuaXRfbnVtYmVyfWAgOiAnUmVzaWRlbmNlJylcbiAgICA6IGVudGl0eT8ubmFtZTtcblxuICBjb25zdCBkZWZhdWx0QmFja0xhYmVsID0gYmFja0xhYmVsIHx8ICh0eXBlID09PSAnYnVpbGRpbmcnID8gJ0JhY2sgdG8gQnVpbGRpbmdzJyA6IHQoJ2JhY2tUb1Jlc2lkZW5jZXMnKSk7XG5cbiAgLy8gU3RhdGUgZm9yIGRvY3VtZW50IHZpZXcgYW5kIGVkaXQgZGlhbG9nc1xuICBjb25zdCBbc2VsZWN0ZWREb2N1bWVudElkLCBzZXRTZWxlY3RlZERvY3VtZW50SWRdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc1ZpZXdEaWFsb2dPcGVuLCBzZXRJc1ZpZXdEaWFsb2dPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzRWRpdERpYWxvZ09wZW4sIHNldElzRWRpdERpYWxvZ09wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIEhhbmRsZSBkb2N1bWVudCBpbnRlcmFjdGlvbnNcbiAgY29uc3QgaGFuZGxlRG9jdW1lbnRWaWV3ID0gKGRvY3VtZW50SWQ6IHN0cmluZykgPT4ge1xuICAgIHNldFNlbGVjdGVkRG9jdW1lbnRJZChkb2N1bWVudElkKTtcbiAgICBzZXRJc1ZpZXdEaWFsb2dPcGVuKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURvY3VtZW50RWRpdCA9IChkb2N1bWVudElkOiBzdHJpbmcpID0+IHtcbiAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQoZG9jdW1lbnRJZCk7XG4gICAgc2V0SXNFZGl0RGlhbG9nT3Blbih0cnVlKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVDcmVhdGVEb2N1bWVudCA9ICgpID0+IHtcbiAgICBzZXRJc0NyZWF0ZURpYWxvZ09wZW4odHJ1ZSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRG9jdW1lbnRTdWNjZXNzID0gKGRvY3VtZW50SWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBEb2N1bWVudCBjcmVhdGVkOmAsIGRvY3VtZW50SWQpO1xuICAgIC8vIFJlZnJlc2ggZG9jdW1lbnRzIGxpc3Qgd2lsbCBiZSBoYW5kbGVkIGJ5IHRoZSBEb2N1bWVudENyZWF0ZUZvcm0ncyBjYWNoZSBpbnZhbGlkYXRpb25cbiAgfTtcblxuICBjb25zdCBjbGVhckZpbHRlcnMgPSAoKSA9PiB7XG4gICAgc2V0U2VhcmNoVGVybSgnJyk7XG4gICAgc2V0U2VsZWN0ZWRDYXRlZ29yeSgnYWxsJyk7XG4gIH07XG5cbiAgaWYgKCFlbnRpdHlJZCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDAgbWItNFwiPnt0eXBlfSBJRCBpcyByZXF1aXJlZDwvcD5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVcIlxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBuYXZpZ2F0ZShiYWNrUGF0aCl9XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWJhY2stdG8tbGlzdFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAge2RlZmF1bHRCYWNrTGFiZWx9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgLy8gSGFuZGxlIGVudGl0eSBub3QgZm91bmQgKHNwZWNpZmljIHRvIHJlc2lkZW5jZSBwYWdlcyB0aGF0IGhhZCB0aGlzIGxvZ2ljKVxuICBpZiAoZW50aXR5RXJyb3IgJiYgZXJyb3I/Lm1lc3NhZ2UgPT09ICdFTlRJVFlfTk9UX0ZPVU5EJyAmJiB0eXBlID09PSAncmVzaWRlbmNlJykge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgbWF4LXctbWRcIj5cbiAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgbWItNFwiPlJlc2lkZW5jZSBOb3QgRm91bmQ8L2gyPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMCBtYi00XCI+XG4gICAgICAgICAgICAgIFRoZSByZXNpZGVuY2UgSUQgXCJ7ZW50aXR5SWR9XCIgZG9lc24ndCBleGlzdCBpbiB0aGUgZGV2ZWxvcG1lbnQgZGF0YWJhc2UuXG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS00MDAgbWItNlwiPlxuICAgICAgICAgICAgICBUaGlzIG1pZ2h0IGJlIGEgcHJvZHVjdGlvbiBkYXRhYmFzZSBJRC4gUGxlYXNlIHVzZSBhIHZhbGlkIGRldmVsb3BtZW50IHJlc2lkZW5jZSBJRC5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PVwiZGVmYXVsdFwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gbmF2aWdhdGUoYmFja1BhdGgpfVxuICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWJhY2stdG8tbGlzdFwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICB7YmFja0xhYmVsIHx8ICdCYWNrIHRvIFJlc2lkZW5jZXMnfVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgbmF2aWdhdGUoJy9yZXNpZGVudHMvcmVzaWRlbmNlcy9lMjdhYzkyNC04MTIwLTQ5MDQtYTc5MS1kMWU5ZGI1NDRkNTgvZG9jdW1lbnRzJylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tZ28tdG8tdmFsaWQtcmVzaWRlbmNlXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGxcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgR28gdG8gVW5pdCAxMDEgKFRlc3QgUmVzaWRlbmNlKVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICA8SGVhZGVyIFxuICAgICAgICB0aXRsZT17ZW50aXR5TmFtZX1cbiAgICAgICAgc3VidGl0bGU9e3R5cGUgPT09ICdidWlsZGluZycgPyAnQnVpbGRpbmcgRG9jdW1lbnRzJyA6ICdSZXNpZGVuY2UgRG9jdW1lbnRzJ31cbiAgICAgIC8+XG5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIG92ZXJmbG93LWF1dG8gcC02XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWF4LXctN3hsIG14LWF1dG8gc3BhY2UteS02XCI+XG4gICAgICAgICAgey8qIEJhY2sgQnV0dG9uICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuXCI+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gbmF2aWdhdGUoYmFja1BhdGgpfVxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1iYWNrXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEFycm93TGVmdCBjbGFzc05hbWU9XCJ3LTQgaC00IG1yLTJcIiAvPlxuICAgICAgICAgICAgICB7ZGVmYXVsdEJhY2tMYWJlbH1cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPGRpdj48L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiBGaWx0ZXJzIGFuZCBTZWFyY2ggU2VjdGlvbiAqL31cbiAgICAgICAgICA8Q2FyZD5cbiAgICAgICAgICAgIDxDYXJkSGVhZGVyPlxuICAgICAgICAgICAgICA8Q2FyZFRpdGxlIGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgPEZpbHRlciBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cbiAgICAgICAgICAgICAgICBTZWFyY2ggJiBGaWx0ZXJzXG4gICAgICAgICAgICAgIDwvQ2FyZFRpdGxlPlxuICAgICAgICAgICAgPC9DYXJkSGVhZGVyPlxuICAgICAgICAgICAgPENhcmRDb250ZW50PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ3JpZC1jb2xzLTEgbWQ6Z3JpZC1jb2xzLTMgZ2FwLTRcIj5cbiAgICAgICAgICAgICAgICB7LyogU2VhcmNoICovfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlNlYXJjaDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxTZWFyY2ggY2xhc3NOYW1lPVwiYWJzb2x1dGUgbGVmdC0zIHRvcC0xLzIgdHJhbnNmb3JtIC10cmFuc2xhdGUteS0xLzIgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIHctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlYXJjaCBkb2N1bWVudHMuLi5cIlxuICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtzZWFyY2hUZXJtfVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0U2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicGwtMTBcIlxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtc2VhcmNoLWRvY3VtZW50c1wiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIHsvKiBDYXRlZ29yeSBGaWx0ZXIgKi99XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTJcIj5cbiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+Q2F0ZWdvcnk8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgPFNlbGVjdCB2YWx1ZT17c2VsZWN0ZWRDYXRlZ29yeX0gb25WYWx1ZUNoYW5nZT17c2V0U2VsZWN0ZWRDYXRlZ29yeX0+XG4gICAgICAgICAgICAgICAgICAgIDxTZWxlY3RUcmlnZ2VyIGRhdGEtdGVzdGlkPVwic2VsZWN0LWNhdGVnb3J5LWZpbHRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RWYWx1ZSBwbGFjZWhvbGRlcj1cIkFsbCBDYXRlZ29yaWVzXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RUcmlnZ2VyPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Q29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgICB7RE9DVU1FTlRfQ0FURUdPUklFUy5tYXAoKGNhdGVnb3J5KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSBrZXk9e2NhdGVnb3J5LnZhbHVlfSB2YWx1ZT17Y2F0ZWdvcnkudmFsdWV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnkubGFiZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdEl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Q29udGVudD5cbiAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgey8qIFZpZXcgTW9kZSAmIEFjdGlvbnMgKi99XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTJcIj5cbiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+VmlldyAmIEFjdGlvbnM8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMVwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9e3ZpZXdNb2RlID09PSAnZ3JpZCcgPyAnZGVmYXVsdCcgOiAnb3V0bGluZSd9XG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplPVwic21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0Vmlld01vZGUoJ2dyaWQnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWdyaWQtdmlld1wiXG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPEdyaWQgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD17dmlld01vZGUgPT09ICdsaXN0JyA/ICdkZWZhdWx0JyA6ICdvdXRsaW5lJ31cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRWaWV3TW9kZSgnbGlzdCcpfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tbGlzdC12aWV3XCJcbiAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8TGlzdCBjbGFzc05hbWU9XCJ3LTQgaC00XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIHt1c2VyUGVybWlzc2lvbnMuY2FuQ3JlYXRlICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ3JlYXRlRG9jdW1lbnR9IFxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWNyZWF0ZS1kb2N1bWVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBsdXMgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZVxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCIgXG4gICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtjbGVhckZpbHRlcnN9XG4gICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tY2xlYXItZmlsdGVyc1wiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICBDbGVhclxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgPC9DYXJkPlxuXG4gICAgICAgICAgey8qIERvY3VtZW50cyBEaXNwbGF5ICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCI+XG4gICAgICAgICAgICAgICAge2ZpbHRlcmVkRG9jdW1lbnRzLmxlbmd0aH0gZG9jdW1lbnR7ZmlsdGVyZWREb2N1bWVudHMubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9IGZvdW5kXG4gICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgeyhzZWFyY2hUZXJtIHx8IHNlbGVjdGVkQ2F0ZWdvcnkgIT09ICdhbGwnKSAmJiAoXG4gICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9XCJzZWNvbmRhcnlcIj5GaWx0ZXJlZDwvQmFkZ2U+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiBEb2N1bWVudHMgQ29udGVudCAqL31cbiAgICAgICAgICB7aXNMb2FkaW5nID8gKFxuICAgICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9XCJwLTggdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFuaW1hdGUtc3BpbiB3LTggaC04IGJvcmRlci00IGJvcmRlci1wcmltYXJ5IGJvcmRlci10LXRyYW5zcGFyZW50IHJvdW5kZWQtZnVsbCBteC1hdXRvIG1iLTRcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+TG9hZGluZyBkb2N1bWVudHMuLi48L3A+XG4gICAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgICA8L0NhcmQ+XG4gICAgICAgICAgKSA6IGZpbHRlcmVkRG9jdW1lbnRzLmxlbmd0aCA9PT0gMCA/IChcbiAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTE2IGgtMTYgbXgtYXV0byBtYi00IGJnLW11dGVkIHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8U2VhcmNoIGNsYXNzTmFtZT1cInctOCBoLTggdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktNjAwIG1iLTJcIj5ObyBEb2N1bWVudHMgRm91bmQ8L2gzPlxuICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMCBtYi00XCI+XG4gICAgICAgICAgICAgICAgICAgIHtzZWFyY2hUZXJtIHx8IHNlbGVjdGVkQ2F0ZWdvcnkgIT09ICdhbGwnXG4gICAgICAgICAgICAgICAgICAgICAgPyBcIk5vIGRvY3VtZW50cyBtYXRjaCB5b3VyIGN1cnJlbnQgZmlsdGVycy4gVHJ5IGFkanVzdGluZyB5b3VyIHNlYXJjaCBjcml0ZXJpYS5cIlxuICAgICAgICAgICAgICAgICAgICAgIDogYE5vIGRvY3VtZW50cyBoYXZlIGJlZW4gdXBsb2FkZWQgZm9yIHRoaXMgJHt0eXBlfSB5ZXQuIENyZWF0ZSB5b3VyIGZpcnN0IGRvY3VtZW50IHRvIGdldCBzdGFydGVkLmBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0yIGp1c3RpZnktY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIHsoc2VhcmNoVGVybSB8fCBzZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJykgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cIm91dGxpbmVcIiBvbkNsaWNrPXtjbGVhckZpbHRlcnN9PlxuICAgICAgICAgICAgICAgICAgICAgICAgQ2xlYXIgRmlsdGVyc1xuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICB7dXNlclBlcm1pc3Npb25zLmNhbkNyZWF0ZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVDcmVhdGVEb2N1bWVudH0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UGx1cyBjbGFzc05hbWU9XCJ3LTQgaC00IG1yLTJcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgQ3JlYXRlIERvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTZcIj5cbiAgICAgICAgICAgICAge09iamVjdC5lbnRyaWVzKGdyb3VwZWREb2N1bWVudHMpLm1hcCgoW2NhdGVnb3J5LCBjYXRlZ29yeURvY3VtZW50c10pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gZXhwYW5kZWRDYXRlZ29yaWVzLmhhcyhjYXRlZ29yeSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjYXRlZ29yeX0gY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XG4gICAgICAgICAgICAgICAgICAgIDxDb2xsYXBzaWJsZSBvcGVuPXtpc0V4cGFuZGVkfSBvbk9wZW5DaGFuZ2U9eygpID0+IHRvZ2dsZUNhdGVnb3J5KGNhdGVnb3J5KX0+XG4gICAgICAgICAgICAgICAgICAgICAgPENvbGxhcHNpYmxlVHJpZ2dlciBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwLTIgdy1mdWxsIHRleHQtbGVmdCBob3ZlcjpiZy1ncmF5LTUwIGRhcms6aG92ZXI6YmctZ3JheS04MDAgcm91bmRlZC1sZyB0cmFuc2l0aW9uLWNvbG9yc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAge2lzRXhwYW5kZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDaGV2cm9uRG93biBjbGFzc05hbWU9XCJoLTQgdy00XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDaGV2cm9uUmlnaHQgY2xhc3NOYW1lPVwiaC00IHctNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LXNlbWlib2xkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRDYXRlZ29yeURpc3BsYXlOYW1lKGNhdGVnb3J5KX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PVwic2Vjb25kYXJ5XCIgY2xhc3NOYW1lPVwibWwtMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnlEb2N1bWVudHMubGVuZ3RofVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAgICA8L0NvbGxhcHNpYmxlVHJpZ2dlcj5cbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICA8Q29sbGFwc2libGVDb250ZW50IGNsYXNzTmFtZT1cInNwYWNlLXktM1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9XCJwdC02XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BncmlkIGdhcC00ICR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3TW9kZSA9PT0gJ2dyaWQnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBsZzpncmlkLWNvbHMtMyB4bDpncmlkLWNvbHMtNCcgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ2dyaWQtY29scy0xJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1gfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjYXRlZ29yeURvY3VtZW50cy5tYXAoKGRvY3VtZW50KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEb2N1bWVudENhcmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2RvY3VtZW50LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50SWQ9e2RvY3VtZW50LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtkb2N1bWVudC5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50VHlwZT17ZG9jdW1lbnQuY2F0ZWdvcnkgfHwgZG9jdW1lbnQuZG9jdW1lbnRUeXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdD17ZG9jdW1lbnQuY3JlYXRlZEF0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmlld0NsaWNrPXtoYW5kbGVEb2N1bWVudFZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFjdD17dmlld01vZGUgPT09ICdsaXN0J31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9DYXJkPlxuICAgICAgICAgICAgICAgICAgICAgIDwvQ29sbGFwc2libGVDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L0NvbGxhcHNpYmxlPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuXG4gICAgICAgICAgey8qIERvY3VtZW50IENyZWF0aW9uIERpYWxvZyAqL31cbiAgICAgICAgICA8RG9jdW1lbnRDcmVhdGVGb3JtXG4gICAgICAgICAgICBpc09wZW49e2lzQ3JlYXRlRGlhbG9nT3Blbn1cbiAgICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHNldElzQ3JlYXRlRGlhbG9nT3BlbihmYWxzZSl9XG4gICAgICAgICAgICBvblN1Y2Nlc3M9e2hhbmRsZURvY3VtZW50U3VjY2Vzc31cbiAgICAgICAgICAgIGVudGl0eVR5cGU9e3R5cGV9XG4gICAgICAgICAgICBlbnRpdHlJZD17ZW50aXR5SWR9XG4gICAgICAgICAgICBlbnRpdHlOYW1lPXtlbnRpdHlOYW1lfVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICB7LyogRG9jdW1lbnQgVmlldyBEaWFsb2cgKi99XG4gICAgICAgICAge3NlbGVjdGVkRG9jdW1lbnRJZCAmJiAoXG4gICAgICAgICAgICA8RG9jdW1lbnRWaWV3RGlhbG9nXG4gICAgICAgICAgICAgIGRvY3VtZW50SWQ9e3NlbGVjdGVkRG9jdW1lbnRJZH1cbiAgICAgICAgICAgICAgaXNPcGVuPXtpc1ZpZXdEaWFsb2dPcGVufVxuICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SXNWaWV3RGlhbG9nT3BlbihmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWREb2N1bWVudElkKG51bGwpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBvbkVkaXQ9eygpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc1ZpZXdEaWFsb2dPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZXRJc0VkaXREaWFsb2dPcGVuKHRydWUpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBjYW5FZGl0PXt1c2VyUGVybWlzc2lvbnMuY2FuRWRpdH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBEb2N1bWVudCBFZGl0IERpYWxvZyAqL31cbiAgICAgICAgICB7c2VsZWN0ZWREb2N1bWVudElkICYmIChcbiAgICAgICAgICAgIDxEb2N1bWVudEVkaXREaWFsb2dcbiAgICAgICAgICAgICAgZG9jdW1lbnRJZD17c2VsZWN0ZWREb2N1bWVudElkfVxuICAgICAgICAgICAgICBpc09wZW49e2lzRWRpdERpYWxvZ09wZW59XG4gICAgICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc0VkaXREaWFsb2dPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQobnVsbCk7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldElzRWRpdERpYWxvZ09wZW4oZmFsc2UpO1xuICAgICAgICAgICAgICAgIHNldFNlbGVjdGVkRG9jdW1lbnRJZChudWxsKTtcbiAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIGRvY3VtZW50cyBsaXN0XG4gICAgICAgICAgICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoe1xuICAgICAgICAgICAgICAgICAgcXVlcnlLZXk6IFsnL2FwaS9kb2N1bWVudHMnLCB0eXBlLCBlbnRpdHlJZF0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59Il0sInZlcnNpb24iOjN9
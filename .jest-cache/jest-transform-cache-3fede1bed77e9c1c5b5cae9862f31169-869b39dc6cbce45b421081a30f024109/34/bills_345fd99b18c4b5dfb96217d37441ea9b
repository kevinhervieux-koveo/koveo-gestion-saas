9c9f1ff92625ce407fcfe86e09c16e98
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = Bills;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const header_1 = require("@/components/layout/header");
const card_1 = require("@/components/ui/card");
const badge_1 = require("@/components/ui/badge");
const button_1 = require("@/components/ui/button");
const select_1 = require("@/components/ui/select");
const input_1 = require("@/components/ui/input");
const label_1 = require("@/components/ui/label");
const dialog_1 = require("@/components/ui/dialog");
const checkbox_1 = require("@/components/ui/checkbox");
const popover_1 = require("@/components/ui/popover");
const lucide_react_1 = require("lucide-react");
const BuildingSelectionGrid_1 = require("@/components/BuildingSelectionGrid");
const ModularBillForm_1 = __importDefault(require("@/components/bill-management/ModularBillForm"));
const react_query_1 = require("@tanstack/react-query");
const queryClient_1 = require("@/lib/queryClient");
const utils_1 = require("@/lib/utils");
const use_language_1 = require("@/hooks/use-language");
const BILL_CATEGORIES = [
    'insurance',
    'maintenance',
    'salary',
    'utilities',
    'cleaning',
    'security',
    'landscaping',
    'professional_services',
    'administration',
    'repairs',
    'supplies',
    'taxes',
    'other',
];
const MONTHS = [
    { value: '1', label: 'January' },
    { value: '2', label: 'February' },
    { value: '3', label: 'March' },
    { value: '4', label: 'April' },
    { value: '5', label: 'May' },
    { value: '6', label: 'June' },
    { value: '7', label: 'July' },
    { value: '8', label: 'August' },
    { value: '9', label: 'September' },
    { value: '10', label: 'October' },
    { value: '11', label: 'November' },
    { value: '12', label: 'December' },
];
// Category labels using translation keys
const getCategoryLabel = (category, t) => {
    const categoryTranslationKeys = {
        insurance: 'insurance',
        maintenance: 'maintenance',
        salary: 'salary',
        utilities: 'utilities',
        cleaning: 'cleaning',
        security: 'security',
        landscaping: 'landscaping',
        professional_services: 'professionalServices',
        administration: 'administration',
        repairs: 'repairs',
        supplies: 'supplies',
        taxes: 'taxes',
        other: 'other'
    };
    return t(categoryTranslationKeys[category] || category);
};
/**
 *
 */
function Bills() {
    const { t } = (0, use_language_1.useLanguage)();
    const [filters, setFilters] = (0, react_1.useState)({
        buildingId: '',
        category: '',
        year: new Date().getFullYear().toString(),
        months: [],
    });
    const [showCreateDialog, setShowCreateDialog] = (0, react_1.useState)(false);
    const [showAllYears, setShowAllYears] = (0, react_1.useState)(false);
    const queryClient = (0, react_query_1.useQueryClient)();
    // Fetch buildings for filter dropdown
    const { data: buildings = [], isLoading: buildingsLoading, error: buildingsError, } = (0, react_query_1.useQuery)({
        queryKey: ['/api/buildings'],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', '/api/buildings');
            return await response.json();
        },
    });
    // Fetch bills based on filters
    const { data: bills = [], isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/bills', filters],
        queryFn: async () => {
            const params = new URLSearchParams(); /**
             * If function.
             * @param filters.buildingId - Filters.buildingId parameter.
             */ /**
            * If function.
            * @param filters.buildingId - Filters.buildingId parameter.
            */
            if (filters.buildingId) {
                params.set('buildingId', filters.buildingId);
            } /**
             * If function.
             * @param filters.category && filters.category !== 'all' - filters.category && filters.category !== 'all' parameter.
             */ /**
            * If function.
            * @param filters.category && filters.category !== 'all' - filters.category && filters.category !== 'all' parameter.
            */
            if (filters.category && filters.category !== 'all') {
                params.set('category', filters.category);
            } /**
             * If function.
             * @param filters.year - Filters.year parameter.
             */ /**
            * If function.
            * @param filters.year - Filters.year parameter.
            */
            if (filters.year) {
                params.set('year', filters.year);
            } /**
             * If function.
             * @param filters.months.length > 0 - filters.months.length > 0 parameter.
             */ /**
            * If function.
            * @param filters.months.length > 0 - filters.months.length > 0 parameter.
            */
            if (filters.months.length > 0) {
                params.set('months', filters.months.join(','));
            }
            const url = `/api/bills${params.toString() ? '?' + params.toString() : ''}`;
            const response = await fetch(url, { credentials: 'include' }); /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */ /**
            * If function.
            * @param !response.ok - !response.ok parameter.
            */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            /**
             * If function.
             * @param !response.ok - !response.ok parameter.
             */
            if (!response.ok) {
                throw new Error(`Failed to fetch bills: ${response.statusText}`);
            }
            return response.json();
        },
    });
    // Group bills by category
    const billsByCategory = bills.reduce((acc, bill) => {
        const category = bill.category || 'other'; /**
         * If function.
         * @param !acc[category] - !acc[category] parameter.
         */ /**
        * If function.
        * @param !acc[category] - !acc[category] parameter.
        */
        if (!acc[category]) {
            acc[category] = [];
        }
        acc[category].push(bill);
        return acc;
    }, {});
    const handleFilterChange = (key, value) => {
        setFilters((prev) => ({ ...prev, [key]: value }));
    };
    const handleMonthToggle = (monthValue) => {
        setFilters((prev) => ({
            ...prev,
            months: prev.months.includes(monthValue)
                ? prev.months.filter((m) => m !== monthValue)
                : [...prev.months, monthValue],
        }));
    };
    const handleAllMonthsToggle = () => {
        const allMonthValues = MONTHS.map((m) => m.value);
        setFilters((prev) => ({
            ...prev,
            months: prev.months.length === allMonthValues.length ? [] : allMonthValues,
        }));
    };
    const getMonthsDisplayText = () => {
        /**
         * If function.
         * @param filters.months.length === 0 - filters.months.length === 0 parameter.
         */ /**
        * If function.
        * @param filters.months.length === 0 - filters.months.length === 0 parameter.
        */
        if (filters.months.length === 0) {
            return 'All months';
        } /**
         * If function.
         * @param filters.months.length === MONTHS.length - filters.months.length === MONTHS.length parameter.
         */ /**
        * If function.
        * @param filters.months.length === MONTHS.length - filters.months.length === MONTHS.length parameter.
        */
        if (filters.months.length === MONTHS.length) {
            return 'All months';
        } /**
         * If function.
         * @param filters.months.length === 1 - filters.months.length === 1 parameter.
         */ /**
        * If function.
        * @param filters.months.length === 1 - filters.months.length === 1 parameter.
        */
        if (filters.months.length === 1) {
            const month = MONTHS.find((m) => m.value === filters.months[0]);
            return month?.label || 'All months';
        }
        return `${filters.months.length} months`;
    };
    // Get building construction year for minimum year calculation
    const selectedBuilding = Array.isArray(buildings)
        ? buildings.find((b) => b.id === filters.buildingId)
        : undefined;
    const buildingConstructionYear = selectedBuilding?.yearBuilt || new Date().getFullYear();
    const currentYear = new Date().getFullYear();
    // Generate year options based on show all years state
    const getYearOptions = () => {
        /**
         * If function.
         * @param showAllYears - ShowAllYears parameter.
         */ /**
        * If function.
        * @param showAllYears - ShowAllYears parameter.
        */
        if (showAllYears) {
            // Show all years from building construction year to 25 years forward
            const startYear = buildingConstructionYear;
            const endYear = currentYear + 25;
            const totalYears = endYear - startYear + 1;
            return Array.from({ length: totalYears }, (_, i) => startYear + i);
        }
        else {
            // Show current year ±3 years
            const startYear = currentYear - 3;
            const endYear = currentYear + 3;
            const totalYears = endYear - startYear + 1;
            return Array.from({ length: totalYears }, (_, i) => startYear + i);
        }
    };
    // Show loading state while buildings are loading
    if (buildingsLoading) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: t('billsManagement'), subtitle: t('billsSubtitle') }), (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex items-center justify-center', children: (0, jsx_runtime_1.jsxs)("div", { className: 'text-center', children: [(0, jsx_runtime_1.jsx)("div", { className: 'animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4' }), (0, jsx_runtime_1.jsx)("p", { className: 'text-gray-500', children: t('loadingBuildings') })] }) })] }));
    }
    // Show error state if buildings failed to load
    if (buildingsError) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: t('billsManagement'), subtitle: t('billsSubtitle') }), (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex items-center justify-center', children: (0, jsx_runtime_1.jsxs)("div", { className: 'text-center', children: [(0, jsx_runtime_1.jsx)("p", { className: 'text-red-500 mb-4', children: t('failedToLoadBuildings') }), (0, jsx_runtime_1.jsx)("button", { onClick: () => window.location.reload(), className: 'px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700', children: t('retry') })] }) })] }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: [(0, jsx_runtime_1.jsx)(header_1.Header, { title: t('billsManagement'), subtitle: t('billsSubtitle') }), (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 overflow-auto p-6', children: (0, jsx_runtime_1.jsxs)("div", { className: 'max-w-7xl mx-auto space-y-6', children: [(0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Filter, { className: 'w-5 h-5' }), t('filters')] }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsxs)("div", { className: 'grid grid-cols-1 md:grid-cols-5 gap-4', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)(label_1.Label, { htmlFor: 'building-filter', className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Building, { className: 'w-4 h-4' }), t('building')] }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.buildingId, onValueChange: (value) => handleFilterChange('buildingId', value), children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { id: 'building-filter', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: t('selectBuilding') }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: Array.isArray(buildings) &&
                                                                    buildings.map((building) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: building.id, children: building.name }, building.id))) })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)(label_1.Label, { htmlFor: 'category-filter', className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Tag, { className: 'w-4 h-4' }), t('category')] }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.category, onValueChange: (value) => handleFilterChange('category', value), children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { id: 'category-filter', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: t('allCategories') }) }), (0, jsx_runtime_1.jsxs)(select_1.SelectContent, { children: [(0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: 'all', children: t('allCategories') }), BILL_CATEGORIES.map((category) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: category, children: getCategoryLabel(category, t) }, category)))] })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)(label_1.Label, { htmlFor: 'year-filter', className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: 'w-4 h-4' }), t('year')] }), (0, jsx_runtime_1.jsx)("div", { className: 'space-y-2', children: (0, jsx_runtime_1.jsxs)(select_1.Select, { value: filters.year, onValueChange: (value) => handleFilterChange('year', value), children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { id: 'year-filter', children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, {}) }), (0, jsx_runtime_1.jsxs)(select_1.SelectContent, { className: 'max-h-[300px] overflow-y-auto', children: [getYearOptions().map((year) => ((0, jsx_runtime_1.jsxs)(select_1.SelectItem, { value: year.toString(), children: [year, year === currentYear && ((0, jsx_runtime_1.jsx)("span", { className: 'ml-2 text-xs text-blue-500', children: "(Current)" }))] }, year))), !showAllYears && ((0, jsx_runtime_1.jsx)("div", { className: 'border-t border-gray-200 mt-2 pt-2', children: (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'ghost', size: 'sm', className: 'w-full text-left justify-start text-xs', onClick: () => setShowAllYears(true), children: ["Show more years (", buildingConstructionYear, " - ", currentYear + 25, ")"] }) })), showAllYears && ((0, jsx_runtime_1.jsx)("div", { className: 'border-t border-gray-200 mt-2 pt-2', children: (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'ghost', size: 'sm', className: 'w-full text-left justify-start text-xs', onClick: () => setShowAllYears(false), children: ["Show fewer years (", currentYear - 3, " - ", currentYear + 3, ")"] }) }))] })] }) })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)(label_1.Label, { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: 'w-4 h-4' }), t('months')] }), (0, jsx_runtime_1.jsxs)(popover_1.Popover, { children: [(0, jsx_runtime_1.jsx)(popover_1.PopoverTrigger, { asChild: true, children: (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'outline', className: (0, utils_1.cn)('w-full justify-between', filters.months.length === 0 && 'text-muted-foreground'), children: [getMonthsDisplayText(), (0, jsx_runtime_1.jsx)(lucide_react_1.ChevronDown, { className: 'ml-2 h-4 w-4 shrink-0 opacity-50' })] }) }), (0, jsx_runtime_1.jsxs)(popover_1.PopoverContent, { className: 'w-64 p-0', align: 'start', children: [(0, jsx_runtime_1.jsx)("div", { className: 'border-b p-3', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center space-x-2', children: [(0, jsx_runtime_1.jsx)(checkbox_1.Checkbox, { id: 'all-months', checked: filters.months.length === MONTHS.length, onCheckedChange: handleAllMonthsToggle }), (0, jsx_runtime_1.jsx)(label_1.Label, { htmlFor: 'all-months', className: 'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70', children: "All Months" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: 'grid grid-cols-2 gap-2 p-3', children: MONTHS.map((month) => ((0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center space-x-2', children: [(0, jsx_runtime_1.jsx)(checkbox_1.Checkbox, { id: `month-${month.value}`, checked: filters.months.includes(month.value), onCheckedChange: () => handleMonthToggle(month.value) }), (0, jsx_runtime_1.jsx)(label_1.Label, { htmlFor: `month-${month.value}`, className: 'text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70', children: month.label })] }, month.value))) })] })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'invisible', children: "Actions" }), (0, jsx_runtime_1.jsxs)(dialog_1.Dialog, { open: showCreateDialog, onOpenChange: setShowCreateDialog, children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogTrigger, { asChild: true, children: (0, jsx_runtime_1.jsx)(button_1.Button, { className: 'w-full', disabled: !filters.buildingId, children: t('createBill') }) }), (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: 'max-w-4xl max-h-[90vh] overflow-y-auto', children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: t('createNewBill') }) }), (0, jsx_runtime_1.jsx)(ModularBillForm_1.default, { mode: "create", buildingId: filters.buildingId, onCancel: () => setShowCreateDialog(false), onSuccess: () => {
                                                                            setShowCreateDialog(false);
                                                                            queryClient.invalidateQueries({ queryKey: ['/api/bills'] });
                                                                        } })] })] })] })] }) })] }), !filters.buildingId ? ((0, jsx_runtime_1.jsx)(BuildingSelectionGrid_1.BuildingSelectionGrid, { buildings: Array.isArray(buildings) ? buildings : [], onBuildingSelect: (buildingId) => handleFilterChange('buildingId', buildingId) })) : isLoading ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: 'p-8 text-center', children: [(0, jsx_runtime_1.jsx)("div", { className: 'animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4' }), (0, jsx_runtime_1.jsx)("p", { className: 'text-gray-500', children: t('loadingBills') })] }) })) : Object.keys(billsByCategory).length === 0 ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: 'p-8 text-center', children: [(0, jsx_runtime_1.jsx)("h3", { className: 'text-lg font-semibold text-gray-600 mb-2', children: t('noBillsFound') }), (0, jsx_runtime_1.jsx)("p", { className: 'text-gray-500 mb-4', children: "No bills found for the selected filters. Create your first bill to get started." }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: () => setShowCreateDialog(true), children: "Create First Bill" })] }) })) : ((0, jsx_runtime_1.jsx)("div", { className: 'space-y-6', children: BILL_CATEGORIES.filter((category) => (!filters.category || filters.category === category) &&
                                billsByCategory[category]?.length > 0).map((category) => ((0, jsx_runtime_1.jsx)(BillCategorySection, { category: category, bills: billsByCategory[category] || [], onBillUpdate: () => queryClient.invalidateQueries({ queryKey: ['/api/bills'] }) }, category))) }))] }) })] }));
}
// Component for displaying bills in a category
/**
 *
 * @param root0
 * @param root0.category
 * @param root0.bills
 * @param root0.onBillUpdate
 */
/**
 * BillCategorySection function.
 * @param root0
 * @param root0.category
 * @param root0.bills
 * @param root0.onBillUpdate
 * @returns Function result.
 */
function BillCategorySection({ category, bills, onBillUpdate, }) {
    return ((0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsx)(card_1.CardTitle, { className: 'flex items-center justify-between', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Tag, { className: 'w-5 h-5' }), getCategoryLabel(category, t), (0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: 'secondary', children: bills.length })] }) }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsx)("div", { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4', children: bills.map((bill) => ((0, jsx_runtime_1.jsx)(BillCard, { bill: bill, onUpdate: onBillUpdate }, bill.id))) }) })] }));
}
// Component for individual bill cards
/**
 *
 * @param root0
 * @param root0.bill
 * @param root0.onUpdate
 */
/**
 * BillCard function.
 * @param root0
 * @param root0.bill
 * @param root0.onUpdate
 * @returns Function result.
 */
function BillCard({ bill, onUpdate }) {
    const [showDetailDialog, setShowDetailDialog] = (0, react_1.useState)(false);
    const [showEditDialog, setShowEditDialog] = (0, react_1.useState)(false);
    const statusColors = {
        draft: 'bg-gray-100 text-gray-800',
        sent: 'bg-blue-100 text-blue-800',
        overdue: 'bg-red-100 text-red-800',
        paid: 'bg-green-100 text-green-800',
        cancelled: 'bg-gray-100 text-gray-800',
    };
    return ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(card_1.Card, { className: 'hover:shadow-md transition-shadow cursor-pointer', onClick: () => setShowDetailDialog(true), children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: 'p-4', children: (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-3', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-start justify-between', children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("h4", { className: 'font-semibold text-sm', children: bill.title }), (0, jsx_runtime_1.jsxs)("p", { className: 'text-xs text-gray-500', children: ["#", bill.billNumber] })] }), (0, jsx_runtime_1.jsx)(badge_1.Badge, { className: statusColors[bill.status], children: bill.status })] }), bill.description && ((0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600 line-clamp-2', children: bill.description })), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between text-sm', children: [(0, jsx_runtime_1.jsxs)("span", { className: 'font-medium', children: ["$", Number(bill.totalAmount).toLocaleString()] }), (0, jsx_runtime_1.jsx)("span", { className: 'text-gray-500', children: bill.paymentType })] }), bill.vendor && (0, jsx_runtime_1.jsxs)("p", { className: 'text-xs text-gray-500', children: ["Vendor: ", bill.vendor] }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2 pt-2', children: [bill.filePath && ((0, jsx_runtime_1.jsxs)(badge_1.Badge, { variant: 'outline', className: 'text-xs', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.FileText, { className: 'w-3 h-3 mr-1' }), "Document"] })), bill.isAiAnalyzed && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: 'outline', className: 'text-xs', children: "AI Analyzed" })), bill.notes?.includes('Auto-generated from:') && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: 'outline', className: 'text-xs', children: "Auto-Generated" }))] })] }) }) }), (0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: showDetailDialog, onOpenChange: setShowDetailDialog, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: 'max-w-2xl max-h-[95vh] overflow-y-auto', "aria-describedby": "bill-details-description", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Bill Details" }) }), (0, jsx_runtime_1.jsx)(BillDetail, { bill: bill, onSuccess: () => {
                                setShowDetailDialog(false);
                                onUpdate();
                            }, onCancel: () => setShowDetailDialog(false), onEditBill: () => {
                                setShowDetailDialog(false);
                                setShowEditDialog(true);
                            } })] }) }), (0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: showEditDialog, onOpenChange: setShowEditDialog, children: (0, jsx_runtime_1.jsx)(dialog_1.DialogContent, { className: 'max-w-4xl max-h-[95vh] overflow-y-auto', "aria-describedby": "edit-bill-description", children: (0, jsx_runtime_1.jsx)(ModularBillForm_1.default, { mode: "edit", bill: bill, onSuccess: () => {
                            setShowEditDialog(false);
                            onUpdate();
                        }, onCancel: () => setShowEditDialog(false), buildingId: bill.buildingId }) }) })] }));
}
// Bill detail component
function BillDetail({ bill, onSuccess, onCancel, onEditBill, }) {
    const queryClient = (0, react_query_1.useQueryClient)();
    // Fetch fresh bill data to ensure we have updated document information
    const { data: freshBill, error: freshBillError, isLoading: freshBillLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/bills', bill.id],
        queryFn: async () => {
            const response = await fetch(`/api/bills/${bill.id}`, {
                credentials: 'include',
            });
            if (!response.ok) {
                throw new Error('Failed to fetch bill details');
            }
            return response.json();
        },
    });
    // Use fresh bill data if available, fallback to props bill data
    const currentBill = freshBill || bill;
    const [endDate, setEndDate] = (0, react_1.useState)(currentBill.endDate || '');
    const updateBillMutation = (0, react_query_1.useMutation)({
        mutationFn: async (updates) => {
            const response = await fetch(`/api/bills/${bill.id}`, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json',
                },
                credentials: 'include',
                body: JSON.stringify(updates),
            });
            if (!response.ok) {
                throw new Error('Failed to update bill');
            }
            return response.json();
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: ['/api/bills'] });
            onSuccess();
        },
    });
    const handleSetEndDate = () => {
        if (endDate) {
            updateBillMutation.mutate({ endDate });
        }
    };
    return ((0, jsx_runtime_1.jsxs)("div", { className: 'space-y-6', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'grid grid-cols-2 gap-4', children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Bill Number" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.billNumber })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Status" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600 capitalize', children: currentBill.status })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Category" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600 capitalize', children: currentBill.category })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Payment Type" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600 capitalize', children: currentBill.paymentType })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Total Amount" }), (0, jsx_runtime_1.jsxs)("p", { className: 'text-sm text-gray-600', children: ["$", Number(currentBill.totalAmount).toLocaleString()] })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Start Date" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.startDate })] })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Title" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.title })] }), currentBill.description && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Description" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.description })] })), currentBill.vendor && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Vendor" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.vendor })] })), currentBill.notes && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Notes" }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-600', children: currentBill.notes })] })), currentBill.paymentType === 'recurrent' && ((0, jsx_runtime_1.jsxs)("div", { className: 'border-t pt-4', children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Recurrence End Date" }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2 mt-2', children: [(0, jsx_runtime_1.jsx)(input_1.Input, { type: 'date', value: endDate, onChange: (e) => setEndDate(e.target.value), className: 'w-48' }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: handleSetEndDate, disabled: updateBillMutation.isPending, size: 'sm', children: updateBillMutation.isPending ? 'Setting...' : 'Set End Date' })] }), (0, jsx_runtime_1.jsx)("p", { className: 'text-xs text-gray-500 mt-1', children: "Setting an end date will stop auto-generation of future bills after this date." })] })), currentBill.costs && currentBill.costs.length > 1 && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Payment Breakdown" }), (0, jsx_runtime_1.jsx)("div", { className: 'space-y-1 mt-1', children: currentBill.costs.map((cost, index) => ((0, jsx_runtime_1.jsxs)("div", { className: 'flex justify-between text-sm', children: [(0, jsx_runtime_1.jsxs)("span", { children: ["Payment ", index + 1, ":"] }), (0, jsx_runtime_1.jsxs)("span", { children: ["$", Number(cost).toLocaleString()] })] }, index))) })] })), currentBill.filePath && ((0, jsx_runtime_1.jsxs)("div", { className: 'border-t pt-4', children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Uploaded Document" }), (0, jsx_runtime_1.jsx)("div", { className: 'mt-2', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between p-3 bg-gray-50 rounded-lg', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center gap-2', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.FileText, { className: 'w-4 h-4 text-blue-600' }), (0, jsx_runtime_1.jsx)("span", { className: 'text-sm', children: currentBill.fileName }), currentBill.isAiAnalyzed && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: 'outline', className: 'text-xs', children: "AI Analyzed" }))] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'outline', size: 'sm', onClick: () => {
                                        console.log('[DOWNLOAD] Starting download for bill:', currentBill.id);
                                        console.log('[DOWNLOAD] Document name:', currentBill.fileName);
                                        console.log('[DOWNLOAD] Document path:', currentBill.filePath);
                                        // Download the document
                                        const link = document.createElement('a');
                                        link.href = `/api/bills/${currentBill.id}/download-document`;
                                        link.download = currentBill.fileName || 'bill-document';
                                        document.body.appendChild(link);
                                        link.click();
                                        document.body.removeChild(link);
                                        console.log('[DOWNLOAD] Download link clicked');
                                    }, className: 'flex items-center gap-1', "data-testid": `button-download-document-${currentBill.id}`, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.FileText, { className: 'w-3 h-3' }), "Download"] })] }) })] })), (0, jsx_runtime_1.jsx)("div", { className: 'border-t pt-4', children: (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between', children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: 'text-sm font-medium', children: "Actions" }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: onEditBill, variant: 'outline', size: 'sm', children: "Edit Bill" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: 'flex justify-end gap-2 pt-4 border-t', children: (0, jsx_runtime_1.jsx)(button_1.Button, { variant: 'outline', onClick: onCancel, children: "Close" }) })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL21hbmFnZXIvYmlsbHMudHN4IiwibWFwcGluZ3MiOiI7Ozs7O0FBMEdBLHdCQXFmQzs7QUEvbEJELGlDQUE0QztBQUM1Qyx1REFBb0Q7QUFDcEQsK0NBQWdGO0FBQ2hGLGlEQUE4QztBQUM5QyxtREFBZ0Q7QUFDaEQsbURBTWdDO0FBQ2hDLGlEQUE4QztBQUM5QyxpREFBOEM7QUFDOUMsbURBTWdDO0FBRWhDLHVEQUFvRDtBQUNwRCxxREFBa0Y7QUFDbEYsK0NBU3NCO0FBQ3RCLDhFQUEyRTtBQUMzRSxtR0FBMkU7QUFDM0UsdURBQThFO0FBQzlFLG1EQUErQztBQUMvQyx1Q0FBaUM7QUFDakMsdURBQW1EO0FBR25ELE1BQU0sZUFBZSxHQUFHO0lBQ3RCLFdBQVc7SUFDWCxhQUFhO0lBQ2IsUUFBUTtJQUNSLFdBQVc7SUFDWCxVQUFVO0lBQ1YsVUFBVTtJQUNWLGFBQWE7SUFDYix1QkFBdUI7SUFDdkIsZ0JBQWdCO0lBQ2hCLFNBQVM7SUFDVCxVQUFVO0lBQ1YsT0FBTztJQUNQLE9BQU87Q0FDQyxDQUFDO0FBRVgsTUFBTSxNQUFNLEdBQUc7SUFDYixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRTtJQUNoQyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRTtJQUNqQyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRTtJQUM5QixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRTtJQUM5QixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRTtJQUM1QixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtJQUM3QixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTtJQUM3QixFQUFFLEtBQUssRUFBRSxH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QyxDQUFDO29DQUNsRCxDQUFDLEVBQ0QsU0FBUyxFQUFDLHlCQUF5QixpQkFDdEIsNEJBQTRCLFdBQVcsQ0FBQyxFQUFFLEVBQUUsYUFFekQsdUJBQUMsdUJBQVEsSUFBQyxTQUFTLEVBQUMsU0FBUyxHQUFHLGdCQUV6QixJQUNMLEdBQ0YsSUFDRixDQUNQLEVBR0QsZ0NBQUssU0FBUyxFQUFDLGVBQWUsWUFDNUIsaUNBQUssU0FBUyxFQUFDLG1DQUFtQyxhQUNoRCx1QkFBQyxhQUFLLElBQUMsU0FBUyxFQUFDLHFCQUFxQix3QkFBZ0IsRUFDdEQsdUJBQUMsZUFBTSxJQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFDLFNBQVMsRUFBQyxJQUFJLEVBQUMsSUFBSSwwQkFFL0MsSUFDTCxHQUNGLEVBR04sZ0NBQUssU0FBUyxFQUFDLHNDQUFzQyxZQUNuRCx1QkFBQyxlQUFNLElBQUMsT0FBTyxFQUFDLFNBQVMsRUFBQyxPQUFPLEVBQUUsUUFBUSxzQkFFbEMsR0FDTCxJQUNGLENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL21hbmFnZXIvYmlsbHMudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBIZWFkZXIgfSBmcm9tICdAL2NvbXBvbmVudHMvbGF5b3V0L2hlYWRlcic7XG5pbXBvcnQgeyBDYXJkLCBDYXJkQ29udGVudCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NhcmQnO1xuaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYmFkZ2UnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2J1dHRvbic7XG5pbXBvcnQge1xuICBTZWxlY3QsXG4gIFNlbGVjdENvbnRlbnQsXG4gIFNlbGVjdEl0ZW0sXG4gIFNlbGVjdFRyaWdnZXIsXG4gIFNlbGVjdFZhbHVlLFxufSBmcm9tICdAL2NvbXBvbmVudHMvdWkvc2VsZWN0JztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2lucHV0JztcbmltcG9ydCB7IExhYmVsIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2xhYmVsJztcbmltcG9ydCB7XG4gIERpYWxvZyxcbiAgRGlhbG9nQ29udGVudCxcbiAgRGlhbG9nSGVhZGVyLFxuICBEaWFsb2dUaXRsZSxcbiAgRGlhbG9nVHJpZ2dlcixcbn0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2RpYWxvZyc7XG5pbXBvcnQgeyBUYWJzLCBUYWJzQ29udGVudCwgVGFic0xpc3QsIFRhYnNUcmlnZ2VyIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3RhYnMnO1xuaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvY2hlY2tib3gnO1xuaW1wb3J0IHsgUG9wb3ZlciwgUG9wb3ZlckNvbnRlbnQsIFBvcG92ZXJUcmlnZ2VyIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3BvcG92ZXInO1xuaW1wb3J0IHtcbiAgRmlsZVRleHQsXG4gIFBsdXMsXG4gIFVwbG9hZCxcbiAgRmlsdGVyLFxuICBDYWxlbmRhcixcbiAgQnVpbGRpbmcgYXMgQnVpbGRpbmdJY29uLFxuICBUYWcsXG4gIENoZXZyb25Eb3duLFxufSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgQnVpbGRpbmdTZWxlY3Rpb25HcmlkIH0gZnJvbSAnQC9jb21wb25lbnRzL0J1aWxkaW5nU2VsZWN0aW9uR3JpZCc7XG5pbXBvcnQgTW9kdWxhckJpbGxGb3JtIGZyb20gJ0AvY29tcG9uZW50cy9iaWxsLW1hbmFnZW1lbnQvTW9kdWxhckJpbGxGb3JtJztcbmltcG9ydCB7IHVzZVF1ZXJ5LCB1c2VNdXRhdGlvbiwgdXNlUXVlcnlDbGllbnQgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xuaW1wb3J0IHsgYXBpUmVxdWVzdCB9IGZyb20gJ0AvbGliL3F1ZXJ5Q2xpZW50JztcbmltcG9ydCB7IGNuIH0gZnJvbSAnQC9saWIvdXRpbHMnO1xuaW1wb3J0IHsgdXNlTGFuZ3VhZ2UgfSBmcm9tICdAL2hvb2tzL3VzZS1sYW5ndWFnZSc7XG5pbXBvcnQgdHlwZSB7IEJ1aWxkaW5nLCBCaWxsIH0gZnJvbSAnQHNoYXJlZC9zY2hlbWEnO1xuXG5jb25zdCBCSUxMX0NBVEVHT1JJRVMgPSBbXG4gICdpbnN1cmFuY2UnLFxuICAnbWFpbnRlbmFuY2UnLFxuICAnc2FsYXJ5JyxcbiAgJ3V0aWxpdGllcycsXG4gICdjbGVhbmluZycsXG4gICdzZWN1cml0eScsXG4gICdsYW5kc2NhcGluZycsXG4gICdwcm9mZXNzaW9uYWxfc2VydmljZXMnLFxuICAnYWRtaW5pc3RyYXRpb24nLFxuICAncmVwYWlycycsXG4gICdzdXBwbGllcycsXG4gICd0YXhlcycsXG4gICdvdGhlcicsXG5dIGFzIGNvbnN0O1xuXG5jb25zdCBNT05USFMgPSBbXG4gIHsgdmFsdWU6ICcxJywgbGFiZWw6ICdKYW51YXJ5JyB9LFxuICB7IHZhbHVlOiAnMicsIGxhYmVsOiAnRmVicnVhcnknIH0sXG4gIHsgdmFsdWU6ICczJywgbGFiZWw6ICdNYXJjaCcgfSxcbiAgeyB2YWx1ZTogJzQnLCBsYWJlbDogJ0FwcmlsJyB9LFxuICB7IHZhbHVlOiAnNScsIGxhYmVsOiAnTWF5JyB9LFxuICB7IHZhbHVlOiAnNicsIGxhYmVsOiAnSnVuZScgfSxcbiAgeyB2YWx1ZTogJzcnLCBsYWJlbDogJ0p1bHknIH0sXG4gIHsgdmFsdWU6ICc4JywgbGFiZWw6ICdBdWd1c3QnIH0sXG4gIHsgdmFsdWU6ICc5JywgbGFiZWw6ICdTZXB0ZW1iZXInIH0sXG4gIHsgdmFsdWU6ICcxMCcsIGxhYmVsOiAnT2N0b2JlcicgfSxcbiAgeyB2YWx1ZTogJzExJywgbGFiZWw6ICdOb3ZlbWJlcicgfSxcbiAgeyB2YWx1ZTogJzEyJywgbGFiZWw6ICdEZWNlbWJlcicgfSxcbl07XG5cbi8vIENhdGVnb3J5IGxhYmVscyB1c2luZyB0cmFuc2xhdGlvbiBrZXlzXG5jb25zdCBnZXRDYXRlZ29yeUxhYmVsID0gKGNhdGVnb3J5OiBzdHJpbmcsIHQ6IChrZXk6IHN0cmluZykgPT4gc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGNhdGVnb3J5VHJhbnNsYXRpb25LZXlzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgIGluc3VyYW5jZTogJ2luc3VyYW5jZScsXG4gICAgbWFpbnRlbmFuY2U6ICdtYWludGVuYW5jZScsIFxuICAgIHNhbGFyeTogJ3NhbGFyeScsXG4gICAgdXRpbGl0aWVzOiAndXRpbGl0aWVzJyxcbiAgICBjbGVhbmluZzogJ2NsZWFuaW5nJyxcbiAgICBzZWN1cml0eTogJ3NlY3VyaXR5JyxcbiAgICBsYW5kc2NhcGluZzogJ2xhbmRzY2FwaW5nJyxcbiAgICBwcm9mZXNzaW9uYWxfc2VydmljZXM6ICdwcm9mZXNzaW9uYWxTZXJ2aWNlcycsXG4gICAgYWRtaW5pc3RyYXRpb246ICdhZG1pbmlzdHJhdGlvbicsXG4gICAgcmVwYWlyczogJ3JlcGFpcnMnLFxuICAgIHN1cHBsaWVzOiAnc3VwcGxpZXMnLFxuICAgIHRheGVzOiAndGF4ZXMnLFxuICAgIG90aGVyOiAnb3RoZXInXG4gIH07XG4gIHJldHVybiB0KGNhdGVnb3J5VHJhbnNsYXRpb25LZXlzW2NhdGVnb3J5XSB8fCBjYXRlZ29yeSk7XG59O1xuXG4vKipcbiAqXG4gKi9cbmludGVyZmFjZSBCaWxsRmlsdGVycyB7XG4gIGJ1aWxkaW5nSWQ6IHN0cmluZztcbiAgY2F0ZWdvcnk6IHN0cmluZztcbiAgeWVhcjogc3RyaW5nO1xuICBtb250aHM6IHN0cmluZ1tdO1xufVxuXG4vKipcbiAqXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIC8qKlxuICogQmlsbHMgZnVuY3Rpb24uXG4gKi8gLyoqXG4gKiBCaWxscyBmdW5jdGlvbi5cbiAqL1xuXG5CaWxscygpIHtcbiAgY29uc3QgeyB0IH0gPSB1c2VMYW5ndWFnZSgpO1xuICBjb25zdCBbZmlsdGVycywgc2V0RmlsdGVyc10gPSB1c2VTdGF0ZTxCaWxsRmlsdGVycz4oe1xuICAgIGJ1aWxkaW5nSWQ6ICcnLFxuICAgIGNhdGVnb3J5OiAnJyxcbiAgICB5ZWFyOiBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSxcbiAgICBtb250aHM6IFtdLFxuICB9KTtcbiAgY29uc3QgW3Nob3dDcmVhdGVEaWFsb2csIHNldFNob3dDcmVhdGVEaWFsb2ddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd0FsbFllYXJzLCBzZXRTaG93QWxsWWVhcnNdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBxdWVyeUNsaWVudCA9IHVzZVF1ZXJ5Q2xpZW50KCk7XG5cbiAgLy8gRmV0Y2ggYnVpbGRpbmdzIGZvciBmaWx0ZXIgZHJvcGRvd25cbiAgY29uc3Qge1xuICAgIGRhdGE6IGJ1aWxkaW5ncyA9IFtdLFxuICAgIGlzTG9hZGluZzogYnVpbGRpbmdzTG9hZGluZyxcbiAgICBlcnJvcjogYnVpbGRpbmdzRXJyb3IsXG4gIH0gPSB1c2VRdWVyeTxCdWlsZGluZ1tdPih7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9idWlsZGluZ3MnXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaVJlcXVlc3QoJ0dFVCcsICcvYXBpL2J1aWxkaW5ncycpO1xuICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICB9KTtcblxuICAvLyBGZXRjaCBiaWxscyBiYXNlZCBvbiBmaWx0ZXJzXG4gIGNvbnN0IHsgZGF0YTogYmlsbHMgPSBbXSwgaXNMb2FkaW5nIH0gPSB1c2VRdWVyeTxCaWxsW10+KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2JpbGxzJywgZmlsdGVyc10sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpOyAvKipcbiAgICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtIGZpbHRlcnMuYnVpbGRpbmdJZCAtIEZpbHRlcnMuYnVpbGRpbmdJZCBwYXJhbWV0ZXIuXG4gICAgICAgKi8gLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSBmaWx0ZXJzLmJ1aWxkaW5nSWQgLSBGaWx0ZXJzLmJ1aWxkaW5nSWQgcGFyYW1ldGVyLlxuICAgICAgICovXG5cbiAgICAgIGlmIChmaWx0ZXJzLmJ1aWxkaW5nSWQpIHtcbiAgICAgICAgcGFyYW1zLnNldCgnYnVpbGRpbmdJZCcsIGZpbHRlcnMuYnVpbGRpbmdJZCk7XG4gICAgICB9IC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gZmlsdGVycy5jYXRlZ29yeSAmJiBmaWx0ZXJzLmNhdGVnb3J5ICE9PSAnYWxsJyAtIGZpbHRlcnMuY2F0ZWdvcnkgJiYgZmlsdGVycy5jYXRlZ29yeSAhPT0gJ2FsbCcgcGFyYW1ldGVyLlxuICAgICAgICovIC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gZmlsdGVycy5jYXRlZ29yeSAmJiBmaWx0ZXJzLmNhdGVnb3J5ICE9PSAnYWxsJyAtIGZpbHRlcnMuY2F0ZWdvcnkgJiYgZmlsdGVycy5jYXRlZ29yeSAhPT0gJ2FsbCcgcGFyYW1ldGVyLlxuICAgICAgICovXG5cbiAgICAgIGlmIChmaWx0ZXJzLmNhdGVnb3J5ICYmIGZpbHRlcnMuY2F0ZWdvcnkgIT09ICdhbGwnKSB7XG4gICAgICAgIHBhcmFtcy5zZXQoJ2NhdGVnb3J5JywgZmlsdGVycy5jYXRlZ29yeSk7XG4gICAgICB9IC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gZmlsdGVycy55ZWFyIC0gRmlsdGVycy55ZWFyIHBhcmFtZXRlci5cbiAgICAgICAqLyAvKipcbiAgICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtIGZpbHRlcnMueWVhciAtIEZpbHRlcnMueWVhciBwYXJhbWV0ZXIuXG4gICAgICAgKi9cblxuICAgICAgaWYgKGZpbHRlcnMueWVhcikge1xuICAgICAgICBwYXJhbXMuc2V0KCd5ZWFyJywgZmlsdGVycy55ZWFyKTtcbiAgICAgIH0gLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPiAwIC0gZmlsdGVycy5tb250aHMubGVuZ3RoID4gMCBwYXJhbWV0ZXIuXG4gICAgICAgKi8gLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPiAwIC0gZmlsdGVycy5tb250aHMubGVuZ3RoID4gMCBwYXJhbWV0ZXIuXG4gICAgICAgKi9cblxuICAgICAgaWYgKGZpbHRlcnMubW9udGhzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGFyYW1zLnNldCgnbW9udGhzJywgZmlsdGVycy5tb250aHMuam9pbignLCcpKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXJsID0gYC9hcGkvYmlsbHMke3BhcmFtcy50b1N0cmluZygpID8gJz8nICsgcGFyYW1zLnRvU3RyaW5nKCkgOiAnJ31gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyB9KTsgLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSAhcmVzcG9uc2Uub2sgLSAhcmVzcG9uc2Uub2sgcGFyYW1ldGVyLlxuICAgICAgICovXG4gICAgICAvKipcbiAgICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtICFyZXNwb25zZS5vayAtICFyZXNwb25zZS5vayBwYXJhbWV0ZXIuXG4gICAgICAgKi9cbiAgICAgIC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gIXJlc3BvbnNlLm9rIC0gIXJlc3BvbnNlLm9rIHBhcmFtZXRlci5cbiAgICAgICAqL1xuICAgICAgLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSAhcmVzcG9uc2Uub2sgLSAhcmVzcG9uc2Uub2sgcGFyYW1ldGVyLlxuICAgICAgICovIC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gIXJlc3BvbnNlLm9rIC0gIXJlc3BvbnNlLm9rIHBhcmFtZXRlci5cbiAgICAgICAqL1xuXG4gICAgICAvKipcbiAgICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtICFyZXNwb25zZS5vayAtICFyZXNwb25zZS5vayBwYXJhbWV0ZXIuXG4gICAgICAgKi9cbiAgICAgIC8qKlxuICAgICAgICogSWYgZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0gIXJlc3BvbnNlLm9rIC0gIXJlc3BvbnNlLm9rIHBhcmFtZXRlci5cbiAgICAgICAqL1xuICAgICAgLyoqXG4gICAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSAhcmVzcG9uc2Uub2sgLSAhcmVzcG9uc2Uub2sgcGFyYW1ldGVyLlxuICAgICAgICovXG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggYmlsbHM6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICB9KTtcblxuICAvLyBHcm91cCBiaWxscyBieSBjYXRlZ29yeVxuICBjb25zdCBiaWxsc0J5Q2F0ZWdvcnkgPSBiaWxscy5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgQmlsbFtdPiwgYmlsbDogQmlsbCkgPT4ge1xuICAgIGNvbnN0IGNhdGVnb3J5ID0gYmlsbC5jYXRlZ29yeSB8fCAnb3RoZXInOyAvKipcbiAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gIWFjY1tjYXRlZ29yeV0gLSAhYWNjW2NhdGVnb3J5XSBwYXJhbWV0ZXIuXG4gICAgICovIC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSAhYWNjW2NhdGVnb3J5XSAtICFhY2NbY2F0ZWdvcnldIHBhcmFtZXRlci5cbiAgICAgKi9cblxuICAgIGlmICghYWNjW2NhdGVnb3J5XSkge1xuICAgICAgYWNjW2NhdGVnb3J5XSA9IFtdO1xuICAgIH1cbiAgICBhY2NbY2F0ZWdvcnldLnB1c2goYmlsbCk7XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuXG4gIGNvbnN0IGhhbmRsZUZpbHRlckNoYW5nZSA9IChrZXk6IGtleW9mIEJpbGxGaWx0ZXJzLCB2YWx1ZTogc3RyaW5nIHwgc3RyaW5nW10pID0+IHtcbiAgICBzZXRGaWx0ZXJzKChwcmV2KSA9PiAoeyAuLi5wcmV2LCBba2V5XTogdmFsdWUgfSkpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZU1vbnRoVG9nZ2xlID0gKG1vbnRoVmFsdWU6IHN0cmluZykgPT4ge1xuICAgIHNldEZpbHRlcnMoKHByZXYpID0+ICh7XG4gICAgICAuLi5wcmV2LFxuICAgICAgbW9udGhzOiBwcmV2Lm1vbnRocy5pbmNsdWRlcyhtb250aFZhbHVlKVxuICAgICAgICA/IHByZXYubW9udGhzLmZpbHRlcigobSkgPT4gbSAhPT0gbW9udGhWYWx1ZSlcbiAgICAgICAgOiBbLi4ucHJldi5tb250aHMsIG1vbnRoVmFsdWVdLFxuICAgIH0pKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVBbGxNb250aHNUb2dnbGUgPSAoKSA9PiB7XG4gICAgY29uc3QgYWxsTW9udGhWYWx1ZXMgPSBNT05USFMubWFwKChtKSA9PiBtLnZhbHVlKTtcbiAgICBzZXRGaWx0ZXJzKChwcmV2KSA9PiAoe1xuICAgICAgLi4ucHJldixcbiAgICAgIG1vbnRoczogcHJldi5tb250aHMubGVuZ3RoID09PSBhbGxNb250aFZhbHVlcy5sZW5ndGggPyBbXSA6IGFsbE1vbnRoVmFsdWVzLFxuICAgIH0pKTtcbiAgfTtcblxuICBjb25zdCBnZXRNb250aHNEaXNwbGF5VGV4dCA9ICgpID0+IHtcbiAgICAvKipcbiAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAwIC0gZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAwIHBhcmFtZXRlci5cbiAgICAgKi8gLyoqXG4gICAgICogSWYgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIGZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gMCAtIGZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gMCBwYXJhbWV0ZXIuXG4gICAgICovXG5cbiAgICBpZiAoZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJ0FsbCBtb250aHMnO1xuICAgIH0gLyoqXG4gICAgICogSWYgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIGZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gTU9OVEhTLmxlbmd0aCAtIGZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gTU9OVEhTLmxlbmd0aCBwYXJhbWV0ZXIuXG4gICAgICovIC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPT09IE1PTlRIUy5sZW5ndGggLSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPT09IE1PTlRIUy5sZW5ndGggcGFyYW1ldGVyLlxuICAgICAqL1xuXG4gICAgaWYgKGZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gTU9OVEhTLmxlbmd0aCkge1xuICAgICAgcmV0dXJuICdBbGwgbW9udGhzJztcbiAgICB9IC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPT09IDEgLSBmaWx0ZXJzLm1vbnRocy5sZW5ndGggPT09IDEgcGFyYW1ldGVyLlxuICAgICAqLyAvKipcbiAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAxIC0gZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAxIHBhcmFtZXRlci5cbiAgICAgKi9cblxuICAgIGlmIChmaWx0ZXJzLm1vbnRocy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnN0IG1vbnRoID0gTU9OVEhTLmZpbmQoKG0pID0+IG0udmFsdWUgPT09IGZpbHRlcnMubW9udGhzWzBdKTtcbiAgICAgIHJldHVybiBtb250aD8ubGFiZWwgfHwgJ0FsbCBtb250aHMnO1xuICAgIH1cbiAgICByZXR1cm4gYCR7ZmlsdGVycy5tb250aHMubGVuZ3RofSBtb250aHNgO1xuICB9O1xuXG4gIC8vIEdldCBidWlsZGluZyBjb25zdHJ1Y3Rpb24geWVhciBmb3IgbWluaW11bSB5ZWFyIGNhbGN1bGF0aW9uXG4gIGNvbnN0IHNlbGVjdGVkQnVpbGRpbmcgPSBBcnJheS5pc0FycmF5KGJ1aWxkaW5ncylcbiAgICA/IGJ1aWxkaW5ncy5maW5kKChiKSA9PiBiLmlkID09PSBmaWx0ZXJzLmJ1aWxkaW5nSWQpXG4gICAgOiB1bmRlZmluZWQ7XG4gIGNvbnN0IGJ1aWxkaW5nQ29uc3RydWN0aW9uWWVhciA9IHNlbGVjdGVkQnVpbGRpbmc/LnllYXJCdWlsdCB8fCBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XG4gIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpO1xuXG4gIC8vIEdlbmVyYXRlIHllYXIgb3B0aW9ucyBiYXNlZCBvbiBzaG93IGFsbCB5ZWFycyBzdGF0ZVxuICBjb25zdCBnZXRZZWFyT3B0aW9ucyA9ICgpID0+IHtcbiAgICAvKipcbiAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gc2hvd0FsbFllYXJzIC0gU2hvd0FsbFllYXJzIHBhcmFtZXRlci5cbiAgICAgKi8gLyoqXG4gICAgICogSWYgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHNob3dBbGxZZWFycyAtIFNob3dBbGxZZWFycyBwYXJhbWV0ZXIuXG4gICAgICovXG5cbiAgICBpZiAoc2hvd0FsbFllYXJzKSB7XG4gICAgICAvLyBTaG93IGFsbCB5ZWFycyBmcm9tIGJ1aWxkaW5nIGNvbnN0cnVjdGlvbiB5ZWFyIHRvIDI1IHllYXJzIGZvcndhcmRcbiAgICAgIGNvbnN0IHN0YXJ0WWVhciA9IGJ1aWxkaW5nQ29uc3RydWN0aW9uWWVhcjtcbiAgICAgIGNvbnN0IGVuZFllYXIgPSBjdXJyZW50WWVhciArIDI1O1xuICAgICAgY29uc3QgdG90YWxZZWFycyA9IGVuZFllYXIgLSBzdGFydFllYXIgKyAxO1xuICAgICAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGg6IHRvdGFsWWVhcnMgfSwgKF8sIGkpID0+IHN0YXJ0WWVhciArIGkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTaG93IGN1cnJlbnQgeWVhciDCsTMgeWVhcnNcbiAgICAgIGNvbnN0IHN0YXJ0WWVhciA9IGN1cnJlbnRZZWFyIC0gMztcbiAgICAgIGNvbnN0IGVuZFllYXIgPSBjdXJyZW50WWVhciArIDM7XG4gICAgICBjb25zdCB0b3RhbFllYXJzID0gZW5kWWVhciAtIHN0YXJ0WWVhciArIDE7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogdG90YWxZZWFycyB9LCAoXywgaSkgPT4gc3RhcnRZZWFyICsgaSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFNob3cgbG9hZGluZyBzdGF0ZSB3aGlsZSBidWlsZGluZ3MgYXJlIGxvYWRpbmdcbiAgaWYgKGJ1aWxkaW5nc0xvYWRpbmcpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlbic+XG4gICAgICAgIDxIZWFkZXIgdGl0bGU9e3QoJ2JpbGxzTWFuYWdlbWVudCcpfSBzdWJ0aXRsZT17dCgnYmlsbHNTdWJ0aXRsZScpfSAvPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleC0xIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyJz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC1jZW50ZXInPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2FuaW1hdGUtc3BpbiByb3VuZGVkLWZ1bGwgaC04IHctOCBib3JkZXItYi0yIGJvcmRlci1ibHVlLTYwMCBteC1hdXRvIG1iLTQnPjwvZGl2PlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LWdyYXktNTAwJz57dCgnbG9hZGluZ0J1aWxkaW5ncycpfTwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgLy8gU2hvdyBlcnJvciBzdGF0ZSBpZiBidWlsZGluZ3MgZmFpbGVkIHRvIGxvYWRcbiAgaWYgKGJ1aWxkaW5nc0Vycm9yKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW4nPlxuICAgICAgICA8SGVhZGVyIHRpdGxlPXt0KCdiaWxsc01hbmFnZW1lbnQnKX0gc3VidGl0bGU9e3QoJ2JpbGxzU3VidGl0bGUnKX0gLz5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlcic+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3RleHQtY2VudGVyJz5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1yZWQtNTAwIG1iLTQnPnt0KCdmYWlsZWRUb0xvYWRCdWlsZGluZ3MnKX08L3A+XG4gICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKX1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPSdweC00IHB5LTIgYmctYmx1ZS02MDAgdGV4dC13aGl0ZSByb3VuZGVkIGhvdmVyOmJnLWJsdWUtNzAwJ1xuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7dCgncmV0cnknKX1cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW4nPlxuICAgICAgPEhlYWRlciB0aXRsZT17dCgnYmlsbHNNYW5hZ2VtZW50Jyl9IHN1YnRpdGxlPXt0KCdiaWxsc1N1YnRpdGxlJyl9IC8+XG5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgb3ZlcmZsb3ctYXV0byBwLTYnPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbWF4LXctN3hsIG14LWF1dG8gc3BhY2UteS02Jz5cbiAgICAgICAgICB7LyogRmlsdGVycyBTZWN0aW9uICovfVxuICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICAgICAgPEZpbHRlciBjbGFzc05hbWU9J3ctNSBoLTUnIC8+XG4gICAgICAgICAgICAgICAge3QoJ2ZpbHRlcnMnKX1cbiAgICAgICAgICAgICAgPC9DYXJkVGl0bGU+XG4gICAgICAgICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICAgICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy01IGdhcC00Jz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0yJz5cbiAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPSdidWlsZGluZy1maWx0ZXInIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgICA8QnVpbGRpbmdJY29uIGNsYXNzTmFtZT0ndy00IGgtNCcgLz5cbiAgICAgICAgICAgICAgICAgICAge3QoJ2J1aWxkaW5nJyl9XG4gICAgICAgICAgICAgICAgICA8L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVycy5idWlsZGluZ0lkfVxuICAgICAgICAgICAgICAgICAgICBvblZhbHVlQ2hhbmdlPXsodmFsdWUpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnYnVpbGRpbmdJZCcsIHZhbHVlKX1cbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFRyaWdnZXIgaWQ9J2J1aWxkaW5nLWZpbHRlcic+XG4gICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFZhbHVlIHBsYWNlaG9sZGVyPXt0KCdzZWxlY3RCdWlsZGluZycpfSAvPlxuICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdFRyaWdnZXI+XG4gICAgICAgICAgICAgICAgICAgIDxTZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgIHtBcnJheS5pc0FycmF5KGJ1aWxkaW5ncykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkaW5ncy5tYXAoKGJ1aWxkaW5nOiBCdWlsZGluZykgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSBrZXk9e2J1aWxkaW5nLmlkfSB2YWx1ZT17YnVpbGRpbmcuaWR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtidWlsZGluZy5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdEl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0yJz5cbiAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPSdjYXRlZ29yeS1maWx0ZXInIGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTInPlxuICAgICAgICAgICAgICAgICAgICA8VGFnIGNsYXNzTmFtZT0ndy00IGgtNCcgLz5cbiAgICAgICAgICAgICAgICAgICAge3QoJ2NhdGVnb3J5Jyl9XG4gICAgICAgICAgICAgICAgICA8L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgPFNlbGVjdFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVycy5jYXRlZ29yeX1cbiAgICAgICAgICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17KHZhbHVlKSA9PiBoYW5kbGVGaWx0ZXJDaGFuZ2UoJ2NhdGVnb3J5JywgdmFsdWUpfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VHJpZ2dlciBpZD0nY2F0ZWdvcnktZmlsdGVyJz5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VmFsdWUgcGxhY2Vob2xkZXI9e3QoJ2FsbENhdGVnb3JpZXMnKX0gLz5cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RUcmlnZ2VyPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Q29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSB2YWx1ZT0nYWxsJz57dCgnYWxsQ2F0ZWdvcmllcycpfTwvU2VsZWN0SXRlbT5cbiAgICAgICAgICAgICAgICAgICAgICB7QklMTF9DQVRFR09SSUVTLm1hcCgoY2F0ZWdvcnkpID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RJdGVtIGtleT17Y2F0ZWdvcnl9IHZhbHVlPXtjYXRlZ29yeX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRDYXRlZ29yeUxhYmVsKGNhdGVnb3J5LCB0KX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0SXRlbT5cbiAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0yJz5cbiAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPSd5ZWFyLWZpbHRlcicgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICAgICAgICAgIDxDYWxlbmRhciBjbGFzc05hbWU9J3ctNCBoLTQnIC8+XG4gICAgICAgICAgICAgICAgICAgIHt0KCd5ZWFyJyl9XG4gICAgICAgICAgICAgICAgICA8L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktMic+XG4gICAgICAgICAgICAgICAgICAgIDxTZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVycy55ZWFyfVxuICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9eyh2YWx1ZSkgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKCd5ZWFyJywgdmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPFNlbGVjdFRyaWdnZXIgaWQ9J3llYXItZmlsdGVyJz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RWYWx1ZSAvPlxuICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0VHJpZ2dlcj5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Q29udGVudCBjbGFzc05hbWU9J21heC1oLVszMDBweF0gb3ZlcmZsb3cteS1hdXRvJz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRZZWFyT3B0aW9ucygpLm1hcCgoeWVhcikgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSBrZXk9e3llYXJ9IHZhbHVlPXt5ZWFyLnRvU3RyaW5nKCl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt5ZWFyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt5ZWFyID09PSBjdXJyZW50WWVhciAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J21sLTIgdGV4dC14cyB0ZXh0LWJsdWUtNTAwJz4oQ3VycmVudCk8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RJdGVtPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgICAgICB7IXNob3dBbGxZZWFycyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdib3JkZXItdCBib3JkZXItZ3JheS0yMDAgbXQtMiBwdC0yJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSdnaG9zdCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9J3NtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSd3LWZ1bGwgdGV4dC1sZWZ0IGp1c3RpZnktc3RhcnQgdGV4dC14cydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFNob3dBbGxZZWFycyh0cnVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93IG1vcmUgeWVhcnMgKHtidWlsZGluZ0NvbnN0cnVjdGlvblllYXJ9IC0ge2N1cnJlbnRZZWFyICsgMjV9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICB7c2hvd0FsbFllYXJzICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2JvcmRlci10IGJvcmRlci1ncmF5LTIwMCBtdC0yIHB0LTInPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9J2dob3N0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0nc20nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctZnVsbCB0ZXh0LWxlZnQganVzdGlmeS1zdGFydCB0ZXh0LXhzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd0FsbFllYXJzKGZhbHNlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93IGZld2VyIHllYXJzICh7Y3VycmVudFllYXIgLSAzfSAtIHtjdXJyZW50WWVhciArIDN9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktMic+XG4gICAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICAgICAgICAgIDxDYWxlbmRhciBjbGFzc05hbWU9J3ctNCBoLTQnIC8+XG4gICAgICAgICAgICAgICAgICAgIHt0KCdtb250aHMnKX1cbiAgICAgICAgICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICA8UG9wb3Zlcj5cbiAgICAgICAgICAgICAgICAgICAgPFBvcG92ZXJUcmlnZ2VyIGFzQ2hpbGQ+XG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD0nb3V0bGluZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICd3LWZ1bGwganVzdGlmeS1iZXR3ZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVycy5tb250aHMubGVuZ3RoID09PSAwICYmICd0ZXh0LW11dGVkLWZvcmVncm91bmQnXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRNb250aHNEaXNwbGF5VGV4dCgpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPENoZXZyb25Eb3duIGNsYXNzTmFtZT0nbWwtMiBoLTQgdy00IHNocmluay0wIG9wYWNpdHktNTAnIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvUG9wb3ZlclRyaWdnZXI+XG4gICAgICAgICAgICAgICAgICAgIDxQb3BvdmVyQ29udGVudCBjbGFzc05hbWU9J3ctNjQgcC0wJyBhbGlnbj0nc3RhcnQnPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdib3JkZXItYiBwLTMnPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMic+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDaGVja2JveFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSdhbGwtbW9udGhzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2ZpbHRlcnMubW9udGhzLmxlbmd0aCA9PT0gTU9OVEhTLmxlbmd0aH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoZWNrZWRDaGFuZ2U9e2hhbmRsZUFsbE1vbnRoc1RvZ2dsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPExhYmVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbEZvcj0nYWxsLW1vbnRocydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0gbGVhZGluZy1ub25lIHBlZXItZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIHBlZXItZGlzYWJsZWQ6b3BhY2l0eS03MCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFsbCBNb250aHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdncmlkIGdyaWQtY29scy0yIGdhcC0yIHAtMyc+XG4gICAgICAgICAgICAgICAgICAgICAgICB7TU9OVEhTLm1hcCgobW9udGgpID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e21vbnRoLnZhbHVlfSBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMic+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPENoZWNrYm94XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17YG1vbnRoLSR7bW9udGgudmFsdWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2ZpbHRlcnMubW9udGhzLmluY2x1ZGVzKG1vbnRoLnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hlY2tlZENoYW5nZT17KCkgPT4gaGFuZGxlTW9udGhUb2dnbGUobW9udGgudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExhYmVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sRm9yPXtgbW9udGgtJHttb250aC52YWx1ZX1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSd0ZXh0LXNtIGxlYWRpbmctbm9uZSBwZWVyLWRpc2FibGVkOmN1cnNvci1ub3QtYWxsb3dlZCBwZWVyLWRpc2FibGVkOm9wYWNpdHktNzAnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge21vbnRoLmxhYmVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvUG9wb3ZlckNvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICA8L1BvcG92ZXI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0yJz5cbiAgICAgICAgICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J2ludmlzaWJsZSc+QWN0aW9uczwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICA8RGlhbG9nIG9wZW49e3Nob3dDcmVhdGVEaWFsb2d9IG9uT3BlbkNoYW5nZT17c2V0U2hvd0NyZWF0ZURpYWxvZ30+XG4gICAgICAgICAgICAgICAgICAgIDxEaWFsb2dUcmlnZ2VyIGFzQ2hpbGQ+XG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBjbGFzc05hbWU9J3ctZnVsbCcgZGlzYWJsZWQ9eyFmaWx0ZXJzLmJ1aWxkaW5nSWR9PlxuICAgICAgICAgICAgICAgICAgICAgICAge3QoJ2NyZWF0ZUJpbGwnKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9EaWFsb2dUcmlnZ2VyPlxuICAgICAgICAgICAgICAgICAgICA8RGlhbG9nQ29udGVudCBjbGFzc05hbWU9J21heC13LTR4bCBtYXgtaC1bOTB2aF0gb3ZlcmZsb3cteS1hdXRvJz5cbiAgICAgICAgICAgICAgICAgICAgICA8RGlhbG9nSGVhZGVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPERpYWxvZ1RpdGxlPnt0KCdjcmVhdGVOZXdCaWxsJyl9PC9EaWFsb2dUaXRsZT5cbiAgICAgICAgICAgICAgICAgICAgICA8L0RpYWxvZ0hlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgICA8TW9kdWxhckJpbGxGb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlPVwiY3JlYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkaW5nSWQ9e2ZpbHRlcnMuYnVpbGRpbmdJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXsoKSA9PiBzZXRTaG93Q3JlYXRlRGlhbG9nKGZhbHNlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VjY2Vzcz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTaG93Q3JlYXRlRGlhbG9nKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2JpbGxzJ10gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvRGlhbG9nQ29udGVudD5cbiAgICAgICAgICAgICAgICAgIDwvRGlhbG9nPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgPC9DYXJkPlxuXG4gICAgICAgICAgey8qIEJpbGxzIERpc3BsYXkgKi99XG4gICAgICAgICAgeyFmaWx0ZXJzLmJ1aWxkaW5nSWQgPyAoXG4gICAgICAgICAgICA8QnVpbGRpbmdTZWxlY3Rpb25HcmlkXG4gICAgICAgICAgICAgIGJ1aWxkaW5ncz17QXJyYXkuaXNBcnJheShidWlsZGluZ3MpID8gYnVpbGRpbmdzIDogW119XG4gICAgICAgICAgICAgIG9uQnVpbGRpbmdTZWxlY3Q9eyhidWlsZGluZ0lkKSA9PiBoYW5kbGVGaWx0ZXJDaGFuZ2UoJ2J1aWxkaW5nSWQnLCBidWlsZGluZ0lkKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSA6IGlzTG9hZGluZyA/IChcbiAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPSdwLTggdGV4dC1jZW50ZXInPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00Jz48L2Rpdj5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS01MDAnPnt0KCdsb2FkaW5nQmlsbHMnKX08L3A+XG4gICAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgICA8L0NhcmQ+XG4gICAgICAgICAgKSA6IE9iamVjdC5rZXlzKGJpbGxzQnlDYXRlZ29yeSkubGVuZ3RoID09PSAwID8gKFxuICAgICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3AtOCB0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT0ndGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtZ3JheS02MDAgbWItMic+e3QoJ25vQmlsbHNGb3VuZCcpfTwvaDM+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LWdyYXktNTAwIG1iLTQnPlxuICAgICAgICAgICAgICAgICAgTm8gYmlsbHMgZm91bmQgZm9yIHRoZSBzZWxlY3RlZCBmaWx0ZXJzLiBDcmVhdGUgeW91ciBmaXJzdCBiaWxsIHRvIGdldCBzdGFydGVkLlxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldFNob3dDcmVhdGVEaWFsb2codHJ1ZSl9PlxuICAgICAgICAgICAgICAgICAgQ3JlYXRlIEZpcnN0IEJpbGxcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktNic+XG4gICAgICAgICAgICAgIHtCSUxMX0NBVEVHT1JJRVMuZmlsdGVyKFxuICAgICAgICAgICAgICAgIChjYXRlZ29yeSkgPT5cbiAgICAgICAgICAgICAgICAgICghZmlsdGVycy5jYXRlZ29yeSB8fCBmaWx0ZXJzLmNhdGVnb3J5ID09PSBjYXRlZ29yeSkgJiZcbiAgICAgICAgICAgICAgICAgIGJpbGxzQnlDYXRlZ29yeVtjYXRlZ29yeV0/Lmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgKS5tYXAoKGNhdGVnb3J5KSA9PiAoXG4gICAgICAgICAgICAgICAgPEJpbGxDYXRlZ29yeVNlY3Rpb25cbiAgICAgICAgICAgICAgICAgIGtleT17Y2F0ZWdvcnl9XG4gICAgICAgICAgICAgICAgICBjYXRlZ29yeT17Y2F0ZWdvcnl9XG4gICAgICAgICAgICAgICAgICBiaWxscz17YmlsbHNCeUNhdGVnb3J5W2NhdGVnb3J5XSB8fCBbXX1cbiAgICAgICAgICAgICAgICAgIG9uQmlsbFVwZGF0ZT17KCkgPT4gcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2JpbGxzJ10gfSl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuXG4vLyBDb21wb25lbnQgZm9yIGRpc3BsYXlpbmcgYmlsbHMgaW4gYSBjYXRlZ29yeVxuLyoqXG4gKlxuICogQHBhcmFtIHJvb3QwXG4gKiBAcGFyYW0gcm9vdDAuY2F0ZWdvcnlcbiAqIEBwYXJhbSByb290MC5iaWxsc1xuICogQHBhcmFtIHJvb3QwLm9uQmlsbFVwZGF0ZVxuICovXG4vKipcbiAqIEJpbGxDYXRlZ29yeVNlY3Rpb24gZnVuY3Rpb24uXG4gKiBAcGFyYW0gcm9vdDBcbiAqIEBwYXJhbSByb290MC5jYXRlZ29yeVxuICogQHBhcmFtIHJvb3QwLmJpbGxzXG4gKiBAcGFyYW0gcm9vdDAub25CaWxsVXBkYXRlXG4gKiBAcmV0dXJucyBGdW5jdGlvbiByZXN1bHQuXG4gKi9cbmZ1bmN0aW9uIEJpbGxDYXRlZ29yeVNlY3Rpb24oe1xuICBjYXRlZ29yeSxcbiAgYmlsbHMsXG4gIG9uQmlsbFVwZGF0ZSxcbn06IHtcbiAgY2F0ZWdvcnk6IHN0cmluZztcbiAgYmlsbHM6IEJpbGxbXTtcbiAgb25CaWxsVXBkYXRlOiAoKSA9PiB2b2lkO1xufSkge1xuICByZXR1cm4gKFxuICAgIDxDYXJkPlxuICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4nPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMic+XG4gICAgICAgICAgICA8VGFnIGNsYXNzTmFtZT0ndy01IGgtNScgLz5cbiAgICAgICAgICAgIHtnZXRDYXRlZ29yeUxhYmVsKGNhdGVnb3J5LCB0KX1cbiAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PSdzZWNvbmRhcnknPntiaWxscy5sZW5ndGh9PC9CYWRnZT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9DYXJkVGl0bGU+XG4gICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGxnOmdyaWQtY29scy0zIGdhcC00Jz5cbiAgICAgICAgICB7YmlsbHMubWFwKChiaWxsKSA9PiAoXG4gICAgICAgICAgICA8QmlsbENhcmQga2V5PXtiaWxsLmlkfSBiaWxsPXtiaWxsfSBvblVwZGF0ZT17b25CaWxsVXBkYXRlfSAvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgPC9DYXJkPlxuICApO1xufVxuXG4vLyBDb21wb25lbnQgZm9yIGluZGl2aWR1YWwgYmlsbCBjYXJkc1xuLyoqXG4gKlxuICogQHBhcmFtIHJvb3QwXG4gKiBAcGFyYW0gcm9vdDAuYmlsbFxuICogQHBhcmFtIHJvb3QwLm9uVXBkYXRlXG4gKi9cbi8qKlxuICogQmlsbENhcmQgZnVuY3Rpb24uXG4gKiBAcGFyYW0gcm9vdDBcbiAqIEBwYXJhbSByb290MC5iaWxsXG4gKiBAcGFyYW0gcm9vdDAub25VcGRhdGVcbiAqIEByZXR1cm5zIEZ1bmN0aW9uIHJlc3VsdC5cbiAqL1xuZnVuY3Rpb24gQmlsbENhcmQoeyBiaWxsLCBvblVwZGF0ZSB9OiB7IGJpbGw6IEJpbGw7IG9uVXBkYXRlOiAoKSA9PiB2b2lkIH0pIHtcbiAgY29uc3QgW3Nob3dEZXRhaWxEaWFsb2csIHNldFNob3dEZXRhaWxEaWFsb2ddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd0VkaXREaWFsb2csIHNldFNob3dFZGl0RGlhbG9nXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBzdGF0dXNDb2xvcnMgPSB7XG4gICAgZHJhZnQ6ICdiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwJyxcbiAgICBzZW50OiAnYmctYmx1ZS0xMDAgdGV4dC1ibHVlLTgwMCcsXG4gICAgb3ZlcmR1ZTogJ2JnLXJlZC0xMDAgdGV4dC1yZWQtODAwJyxcbiAgICBwYWlkOiAnYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwJyxcbiAgICBjYW5jZWxsZWQ6ICdiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwJyxcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDw+XG4gICAgICA8Q2FyZFxuICAgICAgICBjbGFzc05hbWU9J2hvdmVyOnNoYWRvdy1tZCB0cmFuc2l0aW9uLXNoYWRvdyBjdXJzb3ItcG9pbnRlcidcbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd0RldGFpbERpYWxvZyh0cnVlKX1cbiAgICAgID5cbiAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT0ncC00Jz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0zJz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLXN0YXJ0IGp1c3RpZnktYmV0d2Vlbic+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT0nZm9udC1zZW1pYm9sZCB0ZXh0LXNtJz57YmlsbC50aXRsZX08L2g0PlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC14cyB0ZXh0LWdyYXktNTAwJz4je2JpbGwuYmlsbE51bWJlcn08L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8QmFkZ2UgY2xhc3NOYW1lPXtzdGF0dXNDb2xvcnNbYmlsbC5zdGF0dXMgYXMga2V5b2YgdHlwZW9mIHN0YXR1c0NvbG9yc119PlxuICAgICAgICAgICAgICAgIHtiaWxsLnN0YXR1c31cbiAgICAgICAgICAgICAgPC9CYWRnZT5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICB7YmlsbC5kZXNjcmlwdGlvbiAmJiAoXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNjAwIGxpbmUtY2xhbXAtMic+e2JpbGwuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiB0ZXh0LXNtJz5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdmb250LW1lZGl1bSc+JHtOdW1iZXIoYmlsbC50b3RhbEFtb3VudCkudG9Mb2NhbGVTdHJpbmcoKX08L3NwYW4+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0ndGV4dC1ncmF5LTUwMCc+e2JpbGwucGF5bWVudFR5cGV9PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHtiaWxsLnZlbmRvciAmJiA8cCBjbGFzc05hbWU9J3RleHQteHMgdGV4dC1ncmF5LTUwMCc+VmVuZG9yOiB7YmlsbC52ZW5kb3J9PC9wPn1cblxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHB0LTInPlxuICAgICAgICAgICAgICB7YmlsbC5maWxlUGF0aCAmJiAoXG4gICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9J291dGxpbmUnIGNsYXNzTmFtZT0ndGV4dC14cyc+XG4gICAgICAgICAgICAgICAgICA8RmlsZVRleHQgY2xhc3NOYW1lPSd3LTMgaC0zIG1yLTEnIC8+XG4gICAgICAgICAgICAgICAgICBEb2N1bWVudFxuICAgICAgICAgICAgICAgIDwvQmFkZ2U+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtiaWxsLmlzQWlBbmFseXplZCAmJiAoXG4gICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9J291dGxpbmUnIGNsYXNzTmFtZT0ndGV4dC14cyc+XG4gICAgICAgICAgICAgICAgICBBSSBBbmFseXplZFxuICAgICAgICAgICAgICAgIDwvQmFkZ2U+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtiaWxsLm5vdGVzPy5pbmNsdWRlcygnQXV0by1nZW5lcmF0ZWQgZnJvbTonKSAmJiAoXG4gICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9J291dGxpbmUnIGNsYXNzTmFtZT0ndGV4dC14cyc+XG4gICAgICAgICAgICAgICAgICBBdXRvLUdlbmVyYXRlZFxuICAgICAgICAgICAgICAgIDwvQmFkZ2U+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgIDwvQ2FyZD5cblxuICAgICAgey8qIEJpbGwgRGV0YWlsIERpYWxvZyAqL31cbiAgICAgIDxEaWFsb2cgb3Blbj17c2hvd0RldGFpbERpYWxvZ30gb25PcGVuQ2hhbmdlPXtzZXRTaG93RGV0YWlsRGlhbG9nfT5cbiAgICAgICAgPERpYWxvZ0NvbnRlbnQgY2xhc3NOYW1lPSdtYXgtdy0yeGwgbWF4LWgtWzk1dmhdIG92ZXJmbG93LXktYXV0bycgYXJpYS1kZXNjcmliZWRieT1cImJpbGwtZGV0YWlscy1kZXNjcmlwdGlvblwiPlxuICAgICAgICAgIDxEaWFsb2dIZWFkZXI+XG4gICAgICAgICAgICA8RGlhbG9nVGl0bGU+QmlsbCBEZXRhaWxzPC9EaWFsb2dUaXRsZT5cbiAgICAgICAgICA8L0RpYWxvZ0hlYWRlcj5cbiAgICAgICAgICA8QmlsbERldGFpbFxuICAgICAgICAgICAgYmlsbD17YmlsbH1cbiAgICAgICAgICAgIG9uU3VjY2Vzcz17KCkgPT4ge1xuICAgICAgICAgICAgICBzZXRTaG93RGV0YWlsRGlhbG9nKGZhbHNlKTtcbiAgICAgICAgICAgICAgb25VcGRhdGUoKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvbkNhbmNlbD17KCkgPT4gc2V0U2hvd0RldGFpbERpYWxvZyhmYWxzZSl9XG4gICAgICAgICAgICBvbkVkaXRCaWxsPXsoKSA9PiB7XG4gICAgICAgICAgICAgIHNldFNob3dEZXRhaWxEaWFsb2coZmFsc2UpO1xuICAgICAgICAgICAgICBzZXRTaG93RWRpdERpYWxvZyh0cnVlKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgICAgPC9EaWFsb2c+XG5cbiAgICAgIHsvKiBCaWxsIEVkaXQgRGlhbG9nICovfVxuICAgICAgPERpYWxvZyBvcGVuPXtzaG93RWRpdERpYWxvZ30gb25PcGVuQ2hhbmdlPXtzZXRTaG93RWRpdERpYWxvZ30+XG4gICAgICAgIDxEaWFsb2dDb250ZW50IGNsYXNzTmFtZT0nbWF4LXctNHhsIG1heC1oLVs5NXZoXSBvdmVyZmxvdy15LWF1dG8nIGFyaWEtZGVzY3JpYmVkYnk9XCJlZGl0LWJpbGwtZGVzY3JpcHRpb25cIj5cbiAgICAgICAgICA8TW9kdWxhckJpbGxGb3JtXG4gICAgICAgICAgICBtb2RlPVwiZWRpdFwiXG4gICAgICAgICAgICBiaWxsPXtiaWxsfVxuICAgICAgICAgICAgb25TdWNjZXNzPXsoKSA9PiB7XG4gICAgICAgICAgICAgIHNldFNob3dFZGl0RGlhbG9nKGZhbHNlKTtcbiAgICAgICAgICAgICAgb25VcGRhdGUoKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvbkNhbmNlbD17KCkgPT4gc2V0U2hvd0VkaXREaWFsb2coZmFsc2UpfVxuICAgICAgICAgICAgYnVpbGRpbmdJZD17YmlsbC5idWlsZGluZ0lkfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvRGlhbG9nQ29udGVudD5cbiAgICAgIDwvRGlhbG9nPlxuICAgIDwvPlxuICApO1xufVxuXG4vLyBCaWxsIGRldGFpbCBjb21wb25lbnRcbmZ1bmN0aW9uIEJpbGxEZXRhaWwoe1xuICBiaWxsLFxuICBvblN1Y2Nlc3MsXG4gIG9uQ2FuY2VsLFxuICBvbkVkaXRCaWxsLFxufToge1xuICBiaWxsOiBCaWxsO1xuICBvblN1Y2Nlc3M6ICgpID0+IHZvaWQ7XG4gIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuICBvbkVkaXRCaWxsOiAoKSA9PiB2b2lkO1xufSkge1xuICBjb25zdCBxdWVyeUNsaWVudCA9IHVzZVF1ZXJ5Q2xpZW50KCk7XG5cbiAgLy8gRmV0Y2ggZnJlc2ggYmlsbCBkYXRhIHRvIGVuc3VyZSB3ZSBoYXZlIHVwZGF0ZWQgZG9jdW1lbnQgaW5mb3JtYXRpb25cbiAgY29uc3QgeyBkYXRhOiBmcmVzaEJpbGwsIGVycm9yOiBmcmVzaEJpbGxFcnJvciwgaXNMb2FkaW5nOiBmcmVzaEJpbGxMb2FkaW5nIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9iaWxscycsIGJpbGwuaWRdLFxuICAgIHF1ZXJ5Rm46IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvYmlsbHMvJHtiaWxsLmlkfWAsIHtcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAgIH0pO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBiaWxsIGRldGFpbHMnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgfSk7XG5cbiAgLy8gVXNlIGZyZXNoIGJpbGwgZGF0YSBpZiBhdmFpbGFibGUsIGZhbGxiYWNrIHRvIHByb3BzIGJpbGwgZGF0YVxuICBjb25zdCBjdXJyZW50QmlsbCA9IGZyZXNoQmlsbCB8fCBiaWxsO1xuICBcbiAgY29uc3QgW2VuZERhdGUsIHNldEVuZERhdGVdID0gdXNlU3RhdGUoY3VycmVudEJpbGwuZW5kRGF0ZSB8fCAnJyk7XG5cbiAgY29uc3QgdXBkYXRlQmlsbE11dGF0aW9uID0gdXNlTXV0YXRpb24oe1xuICAgIG11dGF0aW9uRm46IGFzeW5jICh1cGRhdGVzOiBQYXJ0aWFsPEJpbGw+KSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2JpbGxzLyR7YmlsbC5pZH1gLCB7XG4gICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVwZGF0ZXMpLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIGJpbGwnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICAgIG9uU3VjY2VzczogKCkgPT4ge1xuICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2JpbGxzJ10gfSk7XG4gICAgICBvblN1Y2Nlc3MoKTtcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBoYW5kbGVTZXRFbmREYXRlID0gKCkgPT4ge1xuICAgIGlmIChlbmREYXRlKSB7XG4gICAgICB1cGRhdGVCaWxsTXV0YXRpb24ubXV0YXRlKHsgZW5kRGF0ZSB9KTtcbiAgICB9XG4gIH07XG5cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPSdzcGFjZS15LTYnPlxuICAgICAgey8qIEJpbGwgSW5mb3JtYXRpb24gKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nZ3JpZCBncmlkLWNvbHMtMiBnYXAtNCc+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT0ndGV4dC1zbSBmb250LW1lZGl1bSc+QmlsbCBOdW1iZXI8L0xhYmVsPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNjAwJz57Y3VycmVudEJpbGwuYmlsbE51bWJlcn08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPlN0YXR1czwvTGFiZWw+XG4gICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAgY2FwaXRhbGl6ZSc+e2N1cnJlbnRCaWxsLnN0YXR1c308L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPkNhdGVnb3J5PC9MYWJlbD5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCBjYXBpdGFsaXplJz57Y3VycmVudEJpbGwuY2F0ZWdvcnl9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPSd0ZXh0LXNtIGZvbnQtbWVkaXVtJz5QYXltZW50IFR5cGU8L0xhYmVsPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNjAwIGNhcGl0YWxpemUnPntjdXJyZW50QmlsbC5wYXltZW50VHlwZX08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPlRvdGFsIEFtb3VudDwvTGFiZWw+XG4gICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAnPiR7TnVtYmVyKGN1cnJlbnRCaWxsLnRvdGFsQW1vdW50KS50b0xvY2FsZVN0cmluZygpfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT0ndGV4dC1zbSBmb250LW1lZGl1bSc+U3RhcnQgRGF0ZTwvTGFiZWw+XG4gICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAnPntjdXJyZW50QmlsbC5zdGFydERhdGV9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7LyogVGl0bGUgYW5kIERlc2NyaXB0aW9uICovfVxuICAgICAgPGRpdj5cbiAgICAgICAgPExhYmVsIGNsYXNzTmFtZT0ndGV4dC1zbSBmb250LW1lZGl1bSc+VGl0bGU8L0xhYmVsPlxuICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+e2N1cnJlbnRCaWxsLnRpdGxlfTwvcD5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7Y3VycmVudEJpbGwuZGVzY3JpcHRpb24gJiYgKFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPkRlc2NyaXB0aW9uPC9MYWJlbD5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+e2N1cnJlbnRCaWxsLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7Y3VycmVudEJpbGwudmVuZG9yICYmIChcbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPSd0ZXh0LXNtIGZvbnQtbWVkaXVtJz5WZW5kb3I8L0xhYmVsPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1zbSB0ZXh0LWdyYXktNjAwJz57Y3VycmVudEJpbGwudmVuZG9yfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7Y3VycmVudEJpbGwubm90ZXMgJiYgKFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPk5vdGVzPC9MYWJlbD5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtc20gdGV4dC1ncmF5LTYwMCc+e2N1cnJlbnRCaWxsLm5vdGVzfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7LyogRW5kIERhdGUgTWFuYWdlbWVudCBmb3IgUmVjdXJyZW50IEJpbGxzICovfVxuICAgICAge2N1cnJlbnRCaWxsLnBheW1lbnRUeXBlID09PSAncmVjdXJyZW50JyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdib3JkZXItdCBwdC00Jz5cbiAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPSd0ZXh0LXNtIGZvbnQtbWVkaXVtJz5SZWN1cnJlbmNlIEVuZCBEYXRlPC9MYWJlbD5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbXQtMic+XG4gICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgdHlwZT0nZGF0ZSdcbiAgICAgICAgICAgICAgdmFsdWU9e2VuZERhdGV9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0RW5kRGF0ZShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT0ndy00OCdcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVNldEVuZERhdGV9IGRpc2FibGVkPXt1cGRhdGVCaWxsTXV0YXRpb24uaXNQZW5kaW5nfSBzaXplPSdzbSc+XG4gICAgICAgICAgICAgIHt1cGRhdGVCaWxsTXV0YXRpb24uaXNQZW5kaW5nID8gJ1NldHRpbmcuLi4nIDogJ1NldCBFbmQgRGF0ZSd9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQteHMgdGV4dC1ncmF5LTUwMCBtdC0xJz5cbiAgICAgICAgICAgIFNldHRpbmcgYW4gZW5kIGRhdGUgd2lsbCBzdG9wIGF1dG8tZ2VuZXJhdGlvbiBvZiBmdXR1cmUgYmlsbHMgYWZ0ZXIgdGhpcyBkYXRlLlxuICAgICAgICAgIDwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7LyogQ29zdHMgQnJlYWtkb3duICovfVxuICAgICAge2N1cnJlbnRCaWxsLmNvc3RzICYmIGN1cnJlbnRCaWxsLmNvc3RzLmxlbmd0aCA+IDEgJiYgKFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPlBheW1lbnQgQnJlYWtkb3duPC9MYWJlbD5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3BhY2UteS0xIG10LTEnPlxuICAgICAgICAgICAge2N1cnJlbnRCaWxsLmNvc3RzLm1hcCgoY29zdCwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgPGRpdiBrZXk9e2luZGV4fSBjbGFzc05hbWU9J2ZsZXgganVzdGlmeS1iZXR3ZWVuIHRleHQtc20nPlxuICAgICAgICAgICAgICAgIDxzcGFuPlBheW1lbnQge2luZGV4ICsgMX06PC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuPiR7TnVtYmVyKGNvc3QpLnRvTG9jYWxlU3RyaW5nKCl9PC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG5cbiAgICAgIHsvKiBEb2N1bWVudCBTZWN0aW9uIC0gT25seSBzaG93IGlmIGRvY3VtZW50IGV4aXN0cyAqL31cbiAgICAgIHtjdXJyZW50QmlsbC5maWxlUGF0aCAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdib3JkZXItdCBwdC00Jz5cbiAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPSd0ZXh0LXNtIGZvbnQtbWVkaXVtJz5VcGxvYWRlZCBEb2N1bWVudDwvTGFiZWw+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9J210LTInPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBwLTMgYmctZ3JheS01MCByb3VuZGVkLWxnJz5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJz5cbiAgICAgICAgICAgICAgICA8RmlsZVRleHQgY2xhc3NOYW1lPSd3LTQgaC00IHRleHQtYmx1ZS02MDAnIC8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSd0ZXh0LXNtJz57Y3VycmVudEJpbGwuZmlsZU5hbWV9PC9zcGFuPlxuICAgICAgICAgICAgICAgIHtjdXJyZW50QmlsbC5pc0FpQW5hbHl6ZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9J291dGxpbmUnIGNsYXNzTmFtZT0ndGV4dC14cyc+XG4gICAgICAgICAgICAgICAgICAgIEFJIEFuYWx5emVkXG4gICAgICAgICAgICAgICAgICA8L0JhZGdlPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgdmFyaWFudD0nb3V0bGluZSdcbiAgICAgICAgICAgICAgICBzaXplPSdzbSdcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0RPV05MT0FEXSBTdGFydGluZyBkb3dubG9hZCBmb3IgYmlsbDonLCBjdXJyZW50QmlsbC5pZCk7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0RPV05MT0FEXSBEb2N1bWVudCBuYW1lOicsIGN1cnJlbnRCaWxsLmZpbGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbRE9XTkxPQURdIERvY3VtZW50IHBhdGg6JywgY3VycmVudEJpbGwuZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAvLyBEb3dubG9hZCB0aGUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBgL2FwaS9iaWxscy8ke2N1cnJlbnRCaWxsLmlkfS9kb3dubG9hZC1kb2N1bWVudGA7XG4gICAgICAgICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gY3VycmVudEJpbGwuZmlsZU5hbWUgfHwgJ2JpbGwtZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbRE9XTkxPQURdIERvd25sb2FkIGxpbmsgY2xpY2tlZCcpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSdcbiAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD17YGJ1dHRvbi1kb3dubG9hZC1kb2N1bWVudC0ke2N1cnJlbnRCaWxsLmlkfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8RmlsZVRleHQgY2xhc3NOYW1lPSd3LTMgaC0zJyAvPlxuICAgICAgICAgICAgICAgIERvd25sb2FkXG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgey8qIEVkaXQgTW9kZSBUb2dnbGUgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nYm9yZGVyLXQgcHQtNCc+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4nPlxuICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9J3RleHQtc20gZm9udC1tZWRpdW0nPkFjdGlvbnM8L0xhYmVsPlxuICAgICAgICAgIDxCdXR0b24gb25DbGljaz17b25FZGl0QmlsbH0gdmFyaWFudD0nb3V0bGluZScgc2l6ZT0nc20nPlxuICAgICAgICAgICAgRWRpdCBCaWxsXG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIHsvKiBBY3Rpb25zICovfVxuICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXgganVzdGlmeS1lbmQgZ2FwLTIgcHQtNCBib3JkZXItdCc+XG4gICAgICAgIDxCdXR0b24gdmFyaWFudD0nb3V0bGluZScgb25DbGljaz17b25DYW5jZWx9PlxuICAgICAgICAgIENsb3NlXG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXSwidmVyc2lvbiI6M30=
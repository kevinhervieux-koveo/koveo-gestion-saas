975b45241be1727d9864014224908e05
"use strict";
/**
 * Button Database Integration Tests
 * Tests that buttons actually persist data to the database correctly
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const db_1 = require("../../server/db");
const drizzle_orm_1 = require("drizzle-orm");
const schema = __importStar(require("../../shared/schema"));
const { users, organizations, userOrganizations, buildings, residences, userResidences, documents, demands, commonSpaces, bookings, userBookingRestrictions, userTimeLimits, invitations } = schema;
(0, globals_1.describe)('Button Database Integration Tests', () => {
    let testUser;
    let testOrganization;
    let testBuilding;
    let testResidence;
    (0, globals_1.beforeEach)(async () => {
        // Create test user
        const [user] = await db_1.db.insert(users).values({
            email: 'test-button@test.com',
            role: 'admin',
            firstName: 'Test',
            lastName: 'User',
            passwordHash: 'hash',
            isActive: true,
        }).returning();
        testUser = user;
        // Create test organization
        const [org] = await db_1.db.insert(organizations).values({
            name: 'Test Organization',
            isActive: true,
        }).returning();
        testOrganization = org;
        // Link user to organization
        await db_1.db.insert(userOrganizations).values({
            userId: testUser.id,
            organizationId: testOrganization.id,
            isActive: true,
        });
        // Create test building
        const [building] = await db_1.db.insert(buildings).values({
            name: 'Test Building',
            address: '123 Test St',
            organizationId: testOrganization.id,
            isActive: true,
        }).returning();
        testBuilding = building;
        // Create test residence
        const [residence] = await db_1.db.insert(residences).values({
            unitNumber: '101',
            buildingId: testBuilding.id,
            isActive: true,
        }).returning();
        testResidence = residence;
        // Link user to residence
        await db_1.db.insert(userResidences).values({
            userId: testUser.id,
            residenceId: testResidence.id,
            isActive: true,
        });
    });
    (0, globals_1.afterEach)(async () => {
        // Clean up test data
        if (testUser?.id) {
            await db_1.db.delete(userResidences).where((0, drizzle_orm_1.eq)(userResidences.userId, testUser.id));
            await db_1.db.delete(userOrganizations).where((0, drizzle_orm_1.eq)(userOrganizations.userId, testUser.id));
            await db_1.db.delete(demands).where((0, drizzle_orm_1.eq)(demands.userId, testUser.id));
            await db_1.db.delete(bookings).where((0, drizzle_orm_1.eq)(bookings.userId, testUser.id));
            await db_1.db.delete(userBookingRestrictions).where((0, drizzle_orm_1.eq)(userBookingRestrictions.userId, testUser.id));
            await db_1.db.delete(userTimeLimits).where((0, drizzle_orm_1.eq)(userTimeLimits.userId, testUser.id));
            await db_1.db.delete(invitations).where((0, drizzle_orm_1.eq)(invitations.email, testUser.email));
            await db_1.db.delete(users).where((0, drizzle_orm_1.eq)(users.id, testUser.id));
        }
        if (testResidence?.id) {
            await db_1.db.delete(residences).where((0, drizzle_orm_1.eq)(residences.id, testResidence.id));
        }
        if (testBuilding?.id) {
            await db_1.db.delete(commonSpaces).where((0, drizzle_orm_1.eq)(commonSpaces.buildingId, testBuilding.id));
            await db_1.db.delete(buildings).where((0, drizzle_orm_1.eq)(buildings.id, testBuilding.id));
        }
        if (testOrganization?.id) {
            await db_1.db.delete(organizations).where((0, drizzle_orm_1.eq)(organizations.id, testOrganization.id));
        }
    });
    (0, globals_1.describe)('Create Button Database Persistence', () => {
        (0, globals_1.it)('should persist new common space when create button is used', async () => {
            const spaceData = {
                name: 'Test Common Space',
                description: 'A space for testing',
                building_id: testBuilding.id,
                is_reservable: true,
                capacity: 50,
            };
            // Simulate button click creating a space
            const response = await fetch('/api/common-spaces', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(spaceData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify data was persisted to database
            const createdSpaces = await db_1.db
                .select()
                .from(commonSpaces)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(commonSpaces.name, spaceData.name), (0, drizzle_orm_1.eq)(commonSpaces.buildingId, testBuilding.id)));
            (0, globals_1.expect)(createdSpaces).toHaveLength(1);
            (0, globals_1.expect)(createdSpaces[0].name).toBe(spaceData.name);
            (0, globals_1.expect)(createdSpaces[0].description).toBe(spaceData.description);
            (0, globals_1.expect)(createdSpaces[0].capacity).toBe(spaceData.capacity);
        });
        (0, globals_1.it)('should persist new demand when create demand button is used', async () => {
            const demandData = {
                title: 'Test Demand',
                description: 'Test demand description',
                category: 'maintenance',
                priority: 'medium',
                residenceId: testResidence.id,
            };
            // Simulate button click creating a demand
            const response = await fetch('/api/demands', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(demandData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify data was persisted to database
            const createdDemands = await db_1.db
                .select()
                .from(demands)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(demands.title, demandData.title), (0, drizzle_orm_1.eq)(demands.userId, testUser.id)));
            (0, globals_1.expect)(createdDemands).toHaveLength(1);
            (0, globals_1.expect)(createdDemands[0].title).toBe(demandData.title);
            (0, globals_1.expect)(createdDemands[0].description).toBe(demandData.description);
            (0, globals_1.expect)(createdDemands[0].category).toBe(demandData.category);
            (0, globals_1.expect)(createdDemands[0].priority).toBe(demandData.priority);
        });
        (0, globals_1.it)('should persist new user invitation when invite button is used', async () => {
            const invitationData = {
                email: 'newuser@test.com',
                organizationId: testOrganization.id,
                role: 'resident',
            };
            // Simulate button click creating an invitation
            const response = await fetch('/api/users/invite', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(invitationData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify data was persisted to database
            const createdInvitations = await db_1.db
                .select()
                .from(invitations)
                .where((0, drizzle_orm_1.eq)(invitations.email, invitationData.email));
            (0, globals_1.expect)(createdInvitations).toHaveLength(1);
            (0, globals_1.expect)(createdInvitations[0].email).toBe(invitationData.email);
            (0, globals_1.expect)(createdInvitations[0].role).toBe(invitationData.role);
            (0, globals_1.expect)(createdInvitations[0].organizationId).toBe(testOrganization.id);
        });
    });
    (0, globals_1.describe)('Update Button Database Persistence', () => {
        (0, globals_1.it)('should update demand status when approve button is used', async () => {
            // Create a demand first
            const [demand] = await db_1.db.insert(demands).values({
                title: 'Test Demand for Approval',
                description: 'Test description',
                category: 'maintenance',
                priority: 'medium',
                status: 'pending',
                userId: testUser.id,
                residenceId: testResidence.id,
            }).returning();
            // Simulate approve button click
            const response = await fetch(`/api/demands/${demand.id}/approve`, {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json' },
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify status was updated in database
            const updatedDemands = await db_1.db
                .select()
                .from(demands)
                .where((0, drizzle_orm_1.eq)(demands.id, demand.id));
            (0, globals_1.expect)(updatedDemands).toHaveLength(1);
            (0, globals_1.expect)(updatedDemands[0].status).toBe('approved');
        });
        (0, globals_1.it)('should update user restriction when block button is used', async () => {
            // Create a common space first
            const [space] = await db_1.db.insert(commonSpaces).values({
                name: 'Test Space for Blocking',
                buildingId: testBuilding.id,
                isReservable: true,
            }).returning();
            const restrictionData = {
                common_space_id: space.id,
                is_blocked: true,
                reason: 'Test blocking',
            };
            // Simulate block button click
            const response = await fetch(`/api/common-spaces/users/${testUser.id}/restrictions`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(restrictionData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify restriction was created in database
            const restrictions = await db_1.db
                .select()
                .from(userBookingRestrictions)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(userBookingRestrictions.userId, testUser.id), (0, drizzle_orm_1.eq)(userBookingRestrictions.commonSpaceId, space.id)));
            (0, globals_1.expect)(restrictions).toHaveLength(1);
            (0, globals_1.expect)(restrictions[0].isBlocked).toBe(true);
            (0, globals_1.expect)(restrictions[0].reason).toBe('Test blocking');
        });
        (0, globals_1.it)('should update time limit when time limit button is used', async () => {
            const timeLimitData = {
                user_id: testUser.id,
                limit_type: 'monthly',
                limit_hours: 10,
            };
            // Simulate time limit button click
            const response = await fetch(`/api/common-spaces/users/${testUser.id}/time-limits`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(timeLimitData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify time limit was created in database
            const timeLimits = await db_1.db
                .select()
                .from(userTimeLimits)
                .where((0, drizzle_orm_1.eq)(userTimeLimits.userId, testUser.id));
            (0, globals_1.expect)(timeLimits).toHaveLength(1);
            (0, globals_1.expect)(timeLimits[0].limitType).toBe('monthly');
            (0, globals_1.expect)(timeLimits[0].limitHours).toBe(10);
        });
    });
    (0, globals_1.describe)('Delete Button Database Persistence', () => {
        (0, globals_1.it)('should remove data when delete button is used', async () => {
            // Create an invitation first
            const [invitation] = await db_1.db.insert(invitations).values({
                email: 'delete-test@test.com',
                organizationId: testOrganization.id,
                role: 'resident',
                token: 'delete-test-token',
                expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours from now
            }).returning();
            // Simulate delete button click
            const response = await fetch(`/api/users/invitations/${invitation.id}`, {
                method: 'DELETE',
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify data was removed from database
            const remainingInvitations = await db_1.db
                .select()
                .from(invitations)
                .where((0, drizzle_orm_1.eq)(invitations.id, invitation.id));
            (0, globals_1.expect)(remainingInvitations).toHaveLength(0);
        });
        (0, globals_1.it)('should soft delete demand when reject button is used', async () => {
            // Create a demand first
            const [demand] = await db_1.db.insert(demands).values({
                title: 'Test Demand for Rejection',
                description: 'Test description',
                category: 'maintenance',
                priority: 'medium',
                status: 'pending',
                userId: testUser.id,
                residenceId: testResidence.id,
            }).returning();
            // Simulate reject button click
            const response = await fetch(`/api/demands/${demand.id}/reject`, {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json' },
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify status was updated to rejected (soft delete)
            const updatedDemands = await db_1.db
                .select()
                .from(demands)
                .where((0, drizzle_orm_1.eq)(demands.id, demand.id));
            (0, globals_1.expect)(updatedDemands).toHaveLength(1);
            (0, globals_1.expect)(updatedDemands[0].status).toBe('rejected');
        });
    });
    (0, globals_1.describe)('Save Button Database Persistence', () => {
        (0, globals_1.it)('should persist user residence assignments when save button is used', async () => {
            // Create another residence for assignment
            const [newResidence] = await db_1.db.insert(residences).values({
                unitNumber: '102',
                buildingId: testBuilding.id,
                isActive: true,
            }).returning();
            const assignmentData = {
                residenceIds: [testResidence.id, newResidence.id],
            };
            // Simulate save button click for residence assignments
            const response = await fetch(`/api/users/${testUser.id}/residences`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(assignmentData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify assignments were persisted to database
            const assignments = await db_1.db
                .select()
                .from(userResidences)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(userResidences.userId, testUser.id), (0, drizzle_orm_1.eq)(userResidences.isActive, true)));
            (0, globals_1.expect)(assignments).toHaveLength(2);
            const residenceIds = assignments.map(a => a.residenceId);
            (0, globals_1.expect)(residenceIds).toContain(testResidence.id);
            (0, globals_1.expect)(residenceIds).toContain(newResidence.id);
        });
    });
    (0, globals_1.describe)('Complex Button Workflow Database Persistence', () => {
        (0, globals_1.it)('should handle complete CRUD workflow with database persistence', async () => {
            // 1. Create a common space
            const spaceData = {
                name: 'Workflow Test Space',
                description: 'Testing complete workflow',
                building_id: testBuilding.id,
                is_reservable: true,
                capacity: 25,
            };
            const createResponse = await fetch('/api/common-spaces', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(spaceData),
            });
            (0, globals_1.expect)(createResponse.ok).toBe(true);
            // Verify creation in database
            const [createdSpace] = await db_1.db
                .select()
                .from(commonSpaces)
                .where((0, drizzle_orm_1.eq)(commonSpaces.name, spaceData.name));
            (0, globals_1.expect)(createdSpace).toBeDefined();
            // 2. Update the space
            const updateData = {
                name: 'Updated Workflow Space',
                capacity: 30,
            };
            const updateResponse = await fetch(`/api/common-spaces/${createdSpace.id}`, {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(updateData),
            });
            (0, globals_1.expect)(updateResponse.ok).toBe(true);
            // Verify update in database
            const [updatedSpace] = await db_1.db
                .select()
                .from(commonSpaces)
                .where((0, drizzle_orm_1.eq)(commonSpaces.id, createdSpace.id));
            (0, globals_1.expect)(updatedSpace.name).toBe(updateData.name);
            (0, globals_1.expect)(updatedSpace.capacity).toBe(updateData.capacity);
            // 3. Create a booking for the space
            const bookingData = {
                start_time: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(), // Tomorrow
                end_time: new Date(Date.now() + 25 * 60 * 60 * 1000).toISOString(), // Tomorrow + 1 hour
            };
            const bookingResponse = await fetch(`/api/common-spaces/${createdSpace.id}/bookings`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(bookingData),
            });
            (0, globals_1.expect)(bookingResponse.ok).toBe(true);
            // Verify booking in database
            const createdBookings = await db_1.db
                .select()
                .from(bookings)
                .where((0, drizzle_orm_1.and)((0, drizzle_orm_1.eq)(bookings.commonSpaceId, createdSpace.id), (0, drizzle_orm_1.eq)(bookings.userId, testUser.id)));
            (0, globals_1.expect)(createdBookings).toHaveLength(1);
            (0, globals_1.expect)(createdBookings[0].status).toBe('confirmed');
            // 4. Cancel the booking (delete operation)
            const deleteResponse = await fetch(`/api/common-spaces/bookings/${createdBookings[0].id}`, {
                method: 'DELETE',
            });
            (0, globals_1.expect)(deleteResponse.ok).toBe(true);
            // Verify booking was cancelled in database
            const [cancelledBooking] = await db_1.db
                .select()
                .from(bookings)
                .where((0, drizzle_orm_1.eq)(bookings.id, createdBookings[0].id));
            (0, globals_1.expect)(cancelledBooking.status).toBe('cancelled');
        });
    });
    (0, globals_1.describe)('Data Integrity and Validation', () => {
        (0, globals_1.it)('should maintain foreign key relationships when buttons create related data', async () => {
            // Create a demand with proper relationships
            const demandData = {
                title: 'Relationship Test Demand',
                description: 'Testing foreign key relationships',
                category: 'maintenance',
                priority: 'high',
                residenceId: testResidence.id,
            };
            const response = await fetch('/api/demands', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(demandData),
            });
            (0, globals_1.expect)(response.ok).toBe(true);
            // Verify relationships are maintained
            const demandWithRelations = await db_1.db
                .select({
                demand: demands,
                user: users,
                residence: residences,
                building: buildings,
            })
                .from(demands)
                .innerJoin(users, (0, drizzle_orm_1.eq)(demands.userId, users.id))
                .innerJoin(residences, (0, drizzle_orm_1.eq)(demands.residenceId, residences.id))
                .innerJoin(buildings, (0, drizzle_orm_1.eq)(residences.buildingId, buildings.id))
                .where((0, drizzle_orm_1.eq)(demands.title, demandData.title));
            (0, globals_1.expect)(demandWithRelations).toHaveLength(1);
            (0, globals_1.expect)(demandWithRelations[0].user.id).toBe(testUser.id);
            (0, globals_1.expect)(demandWithRelations[0].residence.id).toBe(testResidence.id);
            (0, globals_1.expect)(demandWithRelations[0].building.id).toBe(testBuilding.id);
        });
        (0, globals_1.it)('should validate data constraints when buttons attempt invalid operations', async () => {
            // Try to create a common space with invalid building ID
            const invalidSpaceData = {
                name: 'Invalid Space',
                building_id: '00000000-0000-0000-0000-000000000000', // Non-existent building
                is_reservable: true,
            };
            const response = await fetch('/api/common-spaces', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(invalidSpaceData),
            });
            (0, globals_1.expect)(response.ok).toBe(false);
            // Verify no invalid data was created
            const invalidSpaces = await db_1.db
                .select()
                .from(commonSpaces)
                .where((0, drizzle_orm_1.eq)(commonSpaces.name, invalidSpaceData.name));
            (0, globals_1.expect)(invalidSpaces).toHaveLength(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9idXR0b24tZGF0YWJhc2UtaW50ZWdyYXRpb24udGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILDJDQUE0RTtBQUM1RSx3Q0FBcUM7QUFDckMsNkNBQXNDO0FBQ3RDLDREQUE4QztBQUc5QyxNQUFNLEVBQ0osS0FBSyxFQUNMLGFBQWEsRUFDYixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixjQUFjLEVBQ2QsU0FBUyxFQUNULE9BQU8sRUFDUCxZQUFZLEVBQ1osUUFBUSxFQUNSLHVCQUF1QixFQUN2QixjQUFjLEVBQ2QsV0FBVyxFQUNaLEdBQUcsTUFBTSxDQUFDO0FBRVgsSUFBQSxrQkFBUSxFQUFDLG1DQUFtQyxFQUFFLEdBQUcsRUFBRTtJQUNqRCxJQUFJLFFBQWEsQ0FBQztJQUNsQixJQUFJLGdCQUFxQixDQUFDO0lBQzFCLElBQUksWUFBaUIsQ0FBQztJQUN0QixJQUFJLGFBQWtCLENBQUM7SUFFdkIsSUFBQSxvQkFBVSxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3BCLG1CQUFtQjtRQUNuQixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxPQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUMzQyxLQUFLLEVBQUUsc0JBQXNCO1lBQzdCLElBQUksRUFBRSxPQUFPO1lBQ2IsU0FBUyxFQUFFLE1BQU07WUFDakIsUUFBUSxFQUFFLE1BQU07WUFDaEIsWUFBWSxFQUFFLE1BQU07WUFDcEIsUUFBUSxFQUFFLElBQUk7U0FDZixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDZixRQUFRLEdBQUcsSUFBSSxDQUFDO1FBRWhCLDJCQUEyQjtRQUMzQixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsTUFBTSxPQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE1BQU0sQ0FB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XSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL2ludGVncmF0aW9uL2J1dHRvbi1kYXRhYmFzZS1pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQnV0dG9uIERhdGFiYXNlIEludGVncmF0aW9uIFRlc3RzXG4gKiBUZXN0cyB0aGF0IGJ1dHRvbnMgYWN0dWFsbHkgcGVyc2lzdCBkYXRhIHRvIHRoZSBkYXRhYmFzZSBjb3JyZWN0bHlcbiAqL1xuXG5pbXBvcnQgeyBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uL3NlcnZlci9kYic7XG5pbXBvcnQgeyBlcSwgYW5kIH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuaW1wb3J0ICogYXMgc2NoZW1hIGZyb20gJy4uLy4uL3NoYXJlZC9zY2hlbWEnO1xuaW1wb3J0IHsgYXBpUmVxdWVzdCB9IGZyb20gJy4uLy4uL2NsaWVudC9zcmMvbGliL3F1ZXJ5Q2xpZW50JztcblxuY29uc3Qge1xuICB1c2VycyxcbiAgb3JnYW5pemF0aW9ucyxcbiAgdXNlck9yZ2FuaXphdGlvbnMsXG4gIGJ1aWxkaW5ncyxcbiAgcmVzaWRlbmNlcyxcbiAgdXNlclJlc2lkZW5jZXMsXG4gIGRvY3VtZW50cyxcbiAgZGVtYW5kcyxcbiAgY29tbW9uU3BhY2VzLFxuICBib29raW5ncyxcbiAgdXNlckJvb2tpbmdSZXN0cmljdGlvbnMsXG4gIHVzZXJUaW1lTGltaXRzLFxuICBpbnZpdGF0aW9uc1xufSA9IHNjaGVtYTtcblxuZGVzY3JpYmUoJ0J1dHRvbiBEYXRhYmFzZSBJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgbGV0IHRlc3RVc2VyOiBhbnk7XG4gIGxldCB0ZXN0T3JnYW5pemF0aW9uOiBhbnk7XG4gIGxldCB0ZXN0QnVpbGRpbmc6IGFueTtcbiAgbGV0IHRlc3RSZXNpZGVuY2U6IGFueTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDcmVhdGUgdGVzdCB1c2VyXG4gICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGIuaW5zZXJ0KHVzZXJzKS52YWx1ZXMoe1xuICAgICAgZW1haWw6ICd0ZXN0LWJ1dHRvbkB0ZXN0LmNvbScsXG4gICAgICByb2xlOiAnYWRtaW4nLFxuICAgICAgZmlyc3ROYW1lOiAnVGVzdCcsXG4gICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgcGFzc3dvcmRIYXNoOiAnaGFzaCcsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0VXNlciA9IHVzZXI7XG5cbiAgICAvLyBDcmVhdGUgdGVzdCBvcmdhbml6YXRpb25cbiAgICBjb25zdCBbb3JnXSA9IGF3YWl0IGRiLmluc2VydChvcmdhbml6YXRpb25zKS52YWx1ZXMoe1xuICAgICAgbmFtZTogJ1Rlc3QgT3JnYW5pemF0aW9uJyxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgIH0pLnJldHVybmluZygpO1xuICAgIHRlc3RPcmdhbml6YXRpb24gPSBvcmc7XG5cbiAgICAvLyBMaW5rIHVzZXIgdG8gb3JnYW5pemF0aW9uXG4gICAgYXdhaXQgZGIuaW5zZXJ0KHVzZXJPcmdhbml6YXRpb25zKS52YWx1ZXMoe1xuICAgICAgdXNlcklkOiB0ZXN0VXNlci5pZCxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiB0ZXN0T3JnYW5pemF0aW9uLmlkLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgdGVzdCBidWlsZGluZ1xuICAgIGNvbnN0IFtidWlsZGluZ10gPSBhd2FpdCBkYi5pbnNlcnQoYnVpbGRpbmdzKS52YWx1ZXMoe1xuICAgICAgbmFtZTogJ1Rlc3QgQnVpbGRpbmcnLFxuICAgICAgYWRkcmVzczogJzEyMyBUZXN0IFN0JyxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiB0ZXN0T3JnYW5pemF0aW9uLmlkLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gICAgdGVzdEJ1aWxkaW5nID0gYnVpbGRpbmc7XG5cbiAgICAvLyBDcmVhdGUgdGVzdCByZXNpZGVuY2VcbiAgICBjb25zdCBbcmVzaWRlbmNlXSA9IGF3YWl0IGRiLmluc2VydChyZXNpZGVuY2VzKS52YWx1ZXMoe1xuICAgICAgdW5pdE51bWJlcjogJzEwMScsXG4gICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0UmVzaWRlbmNlID0gcmVzaWRlbmNlO1xuXG4gICAgLy8gTGluayB1c2VyIHRvIHJlc2lkZW5jZVxuICAgIGF3YWl0IGRiLmluc2VydCh1c2VyUmVzaWRlbmNlcykudmFsdWVzKHtcbiAgICAgIHVzZXJJZDogdGVzdFVzZXIuaWQsXG4gICAgICByZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZCxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIENsZWFuIHVwIHRlc3QgZGF0YVxuICAgIGlmICh0ZXN0VXNlcj8uaWQpIHtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2VyUmVzaWRlbmNlcykud2hlcmUoZXEodXNlclJlc2lkZW5jZXMudXNlcklkLCB0ZXN0VXNlci5pZCkpO1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJPcmdhbml6YXRpb25zKS53aGVyZShlcSh1c2VyT3JnYW5pemF0aW9ucy51c2VySWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUoZGVtYW5kcykud2hlcmUoZXEoZGVtYW5kcy51c2VySWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUoYm9va2luZ3MpLndoZXJlKGVxKGJvb2tpbmdzLnVzZXJJZCwgdGVzdFVzZXIuaWQpKTtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2VyQm9va2luZ1Jlc3RyaWN0aW9ucykud2hlcmUoZXEodXNlckJvb2tpbmdSZXN0cmljdGlvbnMudXNlcklkLCB0ZXN0VXNlci5pZCkpO1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJUaW1lTGltaXRzKS53aGVyZShlcSh1c2VyVGltZUxpbWl0cy51c2VySWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUoaW52aXRhdGlvbnMpLndoZXJlKGVxKGludml0YXRpb25zLmVtYWlsLCB0ZXN0VXNlci5lbWFpbCkpO1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJzKS53aGVyZShlcSh1c2Vycy5pZCwgdGVzdFVzZXIuaWQpKTtcbiAgICB9XG4gICAgaWYgKHRlc3RSZXNpZGVuY2U/LmlkKSB7XG4gICAgICBhd2FpdCBkYi5kZWxldGUocmVzaWRlbmNlcykud2hlcmUoZXEocmVzaWRlbmNlcy5pZCwgdGVzdFJlc2lkZW5jZS5pZCkpO1xuICAgIH1cbiAgICBpZiAodGVzdEJ1aWxkaW5nPy5pZCkge1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKGNvbW1vblNwYWNlcykud2hlcmUoZXEoY29tbW9uU3BhY2VzLmJ1aWxkaW5nSWQsIHRlc3RCdWlsZGluZy5pZCkpO1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKGJ1aWxkaW5ncykud2hlcmUoZXEoYnVpbGRpbmdzLmlkLCB0ZXN0QnVpbGRpbmcuaWQpKTtcbiAgICB9XG4gICAgaWYgKHRlc3RPcmdhbml6YXRpb24/LmlkKSB7XG4gICAgICBhd2FpdCBkYi5kZWxldGUob3JnYW5pemF0aW9ucykud2hlcmUoZXEob3JnYW5pemF0aW9ucy5pZCwgdGVzdE9yZ2FuaXphdGlvbi5pZCkpO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NyZWF0ZSBCdXR0b24gRGF0YWJhc2UgUGVyc2lzdGVuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwZXJzaXN0IG5ldyBjb21tb24gc3BhY2Ugd2hlbiBjcmVhdGUgYnV0dG9uIGlzIHVzZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzcGFjZURhdGEgPSB7XG4gICAgICAgIG5hbWU6ICdUZXN0IENvbW1vbiBTcGFjZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQSBzcGFjZSBmb3IgdGVzdGluZycsXG4gICAgICAgIGJ1aWxkaW5nX2lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIGlzX3Jlc2VydmFibGU6IHRydWUsXG4gICAgICAgIGNhcGFjaXR5OiA1MCxcbiAgICAgIH07XG5cbiAgICAgIC8vIFNpbXVsYXRlIGJ1dHRvbiBjbGljayBjcmVhdGluZyBhIHNwYWNlXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2NvbW1vbi1zcGFjZXMnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc3BhY2VEYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBkYXRhIHdhcyBwZXJzaXN0ZWQgdG8gZGF0YWJhc2VcbiAgICAgIGNvbnN0IGNyZWF0ZWRTcGFjZXMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20oY29tbW9uU3BhY2VzKVxuICAgICAgICAud2hlcmUoYW5kKFxuICAgICAgICAgIGVxKGNvbW1vblNwYWNlcy5uYW1lLCBzcGFjZURhdGEubmFtZSksXG4gICAgICAgICAgZXEoY29tbW9uU3BhY2VzLmJ1aWxkaW5nSWQsIHRlc3RCdWlsZGluZy5pZClcbiAgICAgICAgKSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVkU3BhY2VzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoY3JlYXRlZFNwYWNlc1swXS5uYW1lKS50b0JlKHNwYWNlRGF0YS5uYW1lKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkU3BhY2VzWzBdLmRlc2NyaXB0aW9uKS50b0JlKHNwYWNlRGF0YS5kZXNjcmlwdGlvbik7XG4gICAgICBleHBlY3QoY3JlYXRlZFNwYWNlc1swXS5jYXBhY2l0eSkudG9CZShzcGFjZURhdGEuY2FwYWNpdHkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwZXJzaXN0IG5ldyBkZW1hbmQgd2hlbiBjcmVhdGUgZGVtYW5kIGJ1dHRvbiBpcyB1c2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVtYW5kRGF0YSA9IHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IERlbWFuZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBkZW1hbmQgZGVzY3JpcHRpb24nLFxuICAgICAgICBjYXRlZ29yeTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdtZWRpdW0nLFxuICAgICAgICByZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZCxcbiAgICAgIH07XG5cbiAgICAgIC8vIFNpbXVsYXRlIGJ1dHRvbiBjbGljayBjcmVhdGluZyBhIGRlbWFuZFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9kZW1hbmRzJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRlbWFuZERhdGEpLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IGRhdGEgd2FzIHBlcnNpc3RlZCB0byBkYXRhYmFzZVxuICAgICAgY29uc3QgY3JlYXRlZERlbWFuZHMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20oZGVtYW5kcylcbiAgICAgICAgLndoZXJlKGFuZChcbiAgICAgICAgICBlcShkZW1hbmRzLnRpdGxlLCBkZW1hbmREYXRhLnRpdGxlKSxcbiAgICAgICAgICBlcShkZW1hbmRzLnVzZXJJZCwgdGVzdFVzZXIuaWQpXG4gICAgICAgICkpO1xuXG4gICAgICBleHBlY3QoY3JlYXRlZERlbWFuZHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkRGVtYW5kc1swXS50aXRsZSkudG9CZShkZW1hbmREYXRhLnRpdGxlKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkRGVtYW5kc1swXS5kZXNjcmlwdGlvbikudG9CZShkZW1hbmREYXRhLmRlc2NyaXB0aW9uKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkRGVtYW5kc1swXS5jYXRlZ29yeSkudG9CZShkZW1hbmREYXRhLmNhdGVnb3J5KTtcbiAgICAgIGV4cGVjdChjcmVhdGVkRGVtYW5kc1swXS5wcmlvcml0eSkudG9CZShkZW1hbmREYXRhLnByaW9yaXR5KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcGVyc2lzdCBuZXcgdXNlciBpbnZpdGF0aW9uIHdoZW4gaW52aXRlIGJ1dHRvbiBpcyB1c2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52aXRhdGlvbkRhdGEgPSB7XG4gICAgICAgIGVtYWlsOiAnbmV3dXNlckB0ZXN0LmNvbScsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiB0ZXN0T3JnYW5pemF0aW9uLmlkLFxuICAgICAgICByb2xlOiAncmVzaWRlbnQnLFxuICAgICAgfTtcblxuICAgICAgLy8gU2ltdWxhdGUgYnV0dG9uIGNsaWNrIGNyZWF0aW5nIGFuIGludml0YXRpb25cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvdXNlcnMvaW52aXRlJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGludml0YXRpb25EYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBkYXRhIHdhcyBwZXJzaXN0ZWQgdG8gZGF0YWJhc2VcbiAgICAgIGNvbnN0IGNyZWF0ZWRJbnZpdGF0aW9ucyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShpbnZpdGF0aW9ucylcbiAgICAgICAgLndoZXJlKGVxKGludml0YXRpb25zLmVtYWlsLCBpbnZpdGF0aW9uRGF0YS5lbWFpbCkpO1xuXG4gICAgICBleHBlY3QoY3JlYXRlZEludml0YXRpb25zKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoY3JlYXRlZEludml0YXRpb25zWzBdLmVtYWlsKS50b0JlKGludml0YXRpb25EYXRhLmVtYWlsKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkSW52aXRhdGlvbnNbMF0ucm9sZSkudG9CZShpbnZpdGF0aW9uRGF0YS5yb2xlKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkSW52aXRhdGlvbnNbMF0ub3JnYW5pemF0aW9uSWQpLnRvQmUodGVzdE9yZ2FuaXphdGlvbi5pZCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVcGRhdGUgQnV0dG9uIERhdGFiYXNlIFBlcnNpc3RlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGRlbWFuZCBzdGF0dXMgd2hlbiBhcHByb3ZlIGJ1dHRvbiBpcyB1c2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGEgZGVtYW5kIGZpcnN0XG4gICAgICBjb25zdCBbZGVtYW5kXSA9IGF3YWl0IGRiLmluc2VydChkZW1hbmRzKS52YWx1ZXMoe1xuICAgICAgICB0aXRsZTogJ1Rlc3QgRGVtYW5kIGZvciBBcHByb3ZhbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBkZXNjcmlwdGlvbicsXG4gICAgICAgIGNhdGVnb3J5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICB1c2VySWQ6IHRlc3RVc2VyLmlkLFxuICAgICAgICByZXNpZGVuY2VJZDogdGVzdFJlc2lkZW5jZS5pZCxcbiAgICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgICAvLyBTaW11bGF0ZSBhcHByb3ZlIGJ1dHRvbiBjbGlja1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9kZW1hbmRzLyR7ZGVtYW5kLmlkfS9hcHByb3ZlYCwge1xuICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IHN0YXR1cyB3YXMgdXBkYXRlZCBpbiBkYXRhYmFzZVxuICAgICAgY29uc3QgdXBkYXRlZERlbWFuZHMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20oZGVtYW5kcylcbiAgICAgICAgLndoZXJlKGVxKGRlbWFuZHMuaWQsIGRlbWFuZC5pZCkpO1xuXG4gICAgICBleHBlY3QodXBkYXRlZERlbWFuZHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdCh1cGRhdGVkRGVtYW5kc1swXS5zdGF0dXMpLnRvQmUoJ2FwcHJvdmVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSB1c2VyIHJlc3RyaWN0aW9uIHdoZW4gYmxvY2sgYnV0dG9uIGlzIHVzZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYSBjb21tb24gc3BhY2UgZmlyc3RcbiAgICAgIGNvbnN0IFtzcGFjZV0gPSBhd2FpdCBkYi5pbnNlcnQoY29tbW9uU3BhY2VzKS52YWx1ZXMoe1xuICAgICAgICBuYW1lOiAnVGVzdCBTcGFjZSBmb3IgQmxvY2tpbmcnLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIGlzUmVzZXJ2YWJsZTogdHJ1ZSxcbiAgICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgICBjb25zdCByZXN0cmljdGlvbkRhdGEgPSB7XG4gICAgICAgIGNvbW1vbl9zcGFjZV9pZDogc3BhY2UuaWQsXG4gICAgICAgIGlzX2Jsb2NrZWQ6IHRydWUsXG4gICAgICAgIHJlYXNvbjogJ1Rlc3QgYmxvY2tpbmcnLFxuICAgICAgfTtcblxuICAgICAgLy8gU2ltdWxhdGUgYmxvY2sgYnV0dG9uIGNsaWNrXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2NvbW1vbi1zcGFjZXMvdXNlcnMvJHt0ZXN0VXNlci5pZH0vcmVzdHJpY3Rpb25zYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlc3RyaWN0aW9uRGF0YSksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLm9rKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBWZXJpZnkgcmVzdHJpY3Rpb24gd2FzIGNyZWF0ZWQgaW4gZGF0YWJhc2VcbiAgICAgIGNvbnN0IHJlc3RyaWN0aW9ucyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyQm9va2luZ1Jlc3RyaWN0aW9ucylcbiAgICAgICAgLndoZXJlKGFuZChcbiAgICAgICAgICBlcSh1c2VyQm9va2luZ1Jlc3RyaWN0aW9ucy51c2VySWQsIHRlc3RVc2VyLmlkKSxcbiAgICAgICAgICBlcSh1c2VyQm9va2luZ1Jlc3RyaWN0aW9ucy5jb21tb25TcGFjZUlkLCBzcGFjZS5pZClcbiAgICAgICAgKSk7XG5cbiAgICAgIGV4cGVjdChyZXN0cmljdGlvbnMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN0cmljdGlvbnNbMF0uaXNCbG9ja2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3RyaWN0aW9uc1swXS5yZWFzb24pLnRvQmUoJ1Rlc3QgYmxvY2tpbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHRpbWUgbGltaXQgd2hlbiB0aW1lIGxpbWl0IGJ1dHRvbiBpcyB1c2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdGltZUxpbWl0RGF0YSA9IHtcbiAgICAgICAgdXNlcl9pZDogdGVzdFVzZXIuaWQsXG4gICAgICAgIGxpbWl0X3R5cGU6ICdtb250aGx5JyxcbiAgICAgICAgbGltaXRfaG91cnM6IDEwLFxuICAgICAgfTtcblxuICAgICAgLy8gU2ltdWxhdGUgdGltZSBsaW1pdCBidXR0b24gY2xpY2tcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvY29tbW9uLXNwYWNlcy91c2Vycy8ke3Rlc3RVc2VyLmlkfS90aW1lLWxpbWl0c2AsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aW1lTGltaXREYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSB0aW1lIGxpbWl0IHdhcyBjcmVhdGVkIGluIGRhdGFiYXNlXG4gICAgICBjb25zdCB0aW1lTGltaXRzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHVzZXJUaW1lTGltaXRzKVxuICAgICAgICAud2hlcmUoZXEodXNlclRpbWVMaW1pdHMudXNlcklkLCB0ZXN0VXNlci5pZCkpO1xuXG4gICAgICBleHBlY3QodGltZUxpbWl0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHRpbWVMaW1pdHNbMF0ubGltaXRUeXBlKS50b0JlKCdtb250aGx5Jyk7XG4gICAgICBleHBlY3QodGltZUxpbWl0c1swXS5saW1pdEhvdXJzKS50b0JlKDEwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RlbGV0ZSBCdXR0b24gRGF0YWJhc2UgUGVyc2lzdGVuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgZGF0YSB3aGVuIGRlbGV0ZSBidXR0b24gaXMgdXNlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhbiBpbnZpdGF0aW9uIGZpcnN0XG4gICAgICBjb25zdCBbaW52aXRhdGlvbl0gPSBhd2FpdCBkYi5pbnNlcnQoaW52aXRhdGlvbnMpLnZhbHVlcyh7XG4gICAgICAgIGVtYWlsOiAnZGVsZXRlLXRlc3RAdGVzdC5jb20nLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogdGVzdE9yZ2FuaXphdGlvbi5pZCxcbiAgICAgICAgcm9sZTogJ3Jlc2lkZW50JyxcbiAgICAgICAgdG9rZW46ICdkZWxldGUtdGVzdC10b2tlbicsXG4gICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyAyNCBob3VycyBmcm9tIG5vd1xuICAgICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIGRlbGV0ZSBidXR0b24gY2xpY2tcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvdXNlcnMvaW52aXRhdGlvbnMvJHtpbnZpdGF0aW9uLmlkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBkYXRhIHdhcyByZW1vdmVkIGZyb20gZGF0YWJhc2VcbiAgICAgIGNvbnN0IHJlbWFpbmluZ0ludml0YXRpb25zID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGludml0YXRpb25zKVxuICAgICAgICAud2hlcmUoZXEoaW52aXRhdGlvbnMuaWQsIGludml0YXRpb24uaWQpKTtcblxuICAgICAgZXhwZWN0KHJlbWFpbmluZ0ludml0YXRpb25zKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvZnQgZGVsZXRlIGRlbWFuZCB3aGVuIHJlamVjdCBidXR0b24gaXMgdXNlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhIGRlbWFuZCBmaXJzdFxuICAgICAgY29uc3QgW2RlbWFuZF0gPSBhd2FpdCBkYi5pbnNlcnQoZGVtYW5kcykudmFsdWVzKHtcbiAgICAgICAgdGl0bGU6ICdUZXN0IERlbWFuZCBmb3IgUmVqZWN0aW9uJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUZXN0IGRlc2NyaXB0aW9uJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgICAgc3RhdHVzOiAncGVuZGluZycsXG4gICAgICAgIHVzZXJJZDogdGVzdFVzZXIuaWQsXG4gICAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkLFxuICAgICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHJlamVjdCBidXR0b24gY2xpY2tcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvZGVtYW5kcy8ke2RlbWFuZC5pZH0vcmVqZWN0YCwge1xuICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IHN0YXR1cyB3YXMgdXBkYXRlZCB0byByZWplY3RlZCAoc29mdCBkZWxldGUpXG4gICAgICBjb25zdCB1cGRhdGVkRGVtYW5kcyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShkZW1hbmRzKVxuICAgICAgICAud2hlcmUoZXEoZGVtYW5kcy5pZCwgZGVtYW5kLmlkKSk7XG5cbiAgICAgIGV4cGVjdCh1cGRhdGVkRGVtYW5kcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWREZW1hbmRzWzBdLnN0YXR1cykudG9CZSgncmVqZWN0ZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NhdmUgQnV0dG9uIERhdGFiYXNlIFBlcnNpc3RlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGVyc2lzdCB1c2VyIHJlc2lkZW5jZSBhc3NpZ25tZW50cyB3aGVuIHNhdmUgYnV0dG9uIGlzIHVzZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYW5vdGhlciByZXNpZGVuY2UgZm9yIGFzc2lnbm1lbnRcbiAgICAgIGNvbnN0IFtuZXdSZXNpZGVuY2VdID0gYXdhaXQgZGIuaW5zZXJ0KHJlc2lkZW5jZXMpLnZhbHVlcyh7XG4gICAgICAgIHVuaXROdW1iZXI6ICcxMDInLFxuICAgICAgICBidWlsZGluZ0lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICAgIGNvbnN0IGFzc2lnbm1lbnREYXRhID0ge1xuICAgICAgICByZXNpZGVuY2VJZHM6IFt0ZXN0UmVzaWRlbmNlLmlkLCBuZXdSZXNpZGVuY2UuaWRdLFxuICAgICAgfTtcblxuICAgICAgLy8gU2ltdWxhdGUgc2F2ZSBidXR0b24gY2xpY2sgZm9yIHJlc2lkZW5jZSBhc3NpZ25tZW50c1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS91c2Vycy8ke3Rlc3RVc2VyLmlkfS9yZXNpZGVuY2VzYCwge1xuICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYXNzaWdubWVudERhdGEpLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IGFzc2lnbm1lbnRzIHdlcmUgcGVyc2lzdGVkIHRvIGRhdGFiYXNlXG4gICAgICBjb25zdCBhc3NpZ25tZW50cyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyUmVzaWRlbmNlcylcbiAgICAgICAgLndoZXJlKGFuZChcbiAgICAgICAgICBlcSh1c2VyUmVzaWRlbmNlcy51c2VySWQsIHRlc3RVc2VyLmlkKSxcbiAgICAgICAgICBlcSh1c2VyUmVzaWRlbmNlcy5pc0FjdGl2ZSwgdHJ1ZSlcbiAgICAgICAgKSk7XG5cbiAgICAgIGV4cGVjdChhc3NpZ25tZW50cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgY29uc3QgcmVzaWRlbmNlSWRzID0gYXNzaWdubWVudHMubWFwKGEgPT4gYS5yZXNpZGVuY2VJZCk7XG4gICAgICBleHBlY3QocmVzaWRlbmNlSWRzKS50b0NvbnRhaW4odGVzdFJlc2lkZW5jZS5pZCk7XG4gICAgICBleHBlY3QocmVzaWRlbmNlSWRzKS50b0NvbnRhaW4obmV3UmVzaWRlbmNlLmlkKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbXBsZXggQnV0dG9uIFdvcmtmbG93IERhdGFiYXNlIFBlcnNpc3RlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIENSVUQgd29ya2Zsb3cgd2l0aCBkYXRhYmFzZSBwZXJzaXN0ZW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIDEuIENyZWF0ZSBhIGNvbW1vbiBzcGFjZVxuICAgICAgY29uc3Qgc3BhY2VEYXRhID0ge1xuICAgICAgICBuYW1lOiAnV29ya2Zsb3cgVGVzdCBTcGFjZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdGluZyBjb21wbGV0ZSB3b3JrZmxvdycsXG4gICAgICAgIGJ1aWxkaW5nX2lkOiB0ZXN0QnVpbGRpbmcuaWQsXG4gICAgICAgIGlzX3Jlc2VydmFibGU6IHRydWUsXG4gICAgICAgIGNhcGFjaXR5OiAyNSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvY29tbW9uLXNwYWNlcycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShzcGFjZURhdGEpLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IGNyZWF0aW9uIGluIGRhdGFiYXNlXG4gICAgICBjb25zdCBbY3JlYXRlZFNwYWNlXSA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShjb21tb25TcGFjZXMpXG4gICAgICAgIC53aGVyZShlcShjb21tb25TcGFjZXMubmFtZSwgc3BhY2VEYXRhLm5hbWUpKTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZWRTcGFjZSkudG9CZURlZmluZWQoKTtcblxuICAgICAgLy8gMi4gVXBkYXRlIHRoZSBzcGFjZVxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgbmFtZTogJ1VwZGF0ZWQgV29ya2Zsb3cgU3BhY2UnLFxuICAgICAgICBjYXBhY2l0eTogMzAsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB1cGRhdGVSZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2NvbW1vbi1zcGFjZXMvJHtjcmVhdGVkU3BhY2UuaWR9YCwge1xuICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1cGRhdGVEYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QodXBkYXRlUmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSB1cGRhdGUgaW4gZGF0YWJhc2VcbiAgICAgIGNvbnN0IFt1cGRhdGVkU3BhY2VdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGNvbW1vblNwYWNlcylcbiAgICAgICAgLndoZXJlKGVxKGNvbW1vblNwYWNlcy5pZCwgY3JlYXRlZFNwYWNlLmlkKSk7XG5cbiAgICAgIGV4cGVjdCh1cGRhdGVkU3BhY2UubmFtZSkudG9CZSh1cGRhdGVEYXRhLm5hbWUpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRTcGFjZS5jYXBhY2l0eSkudG9CZSh1cGRhdGVEYXRhLmNhcGFjaXR5KTtcblxuICAgICAgLy8gMy4gQ3JlYXRlIGEgYm9va2luZyBmb3IgdGhlIHNwYWNlXG4gICAgICBjb25zdCBib29raW5nRGF0YSA9IHtcbiAgICAgICAgc3RhcnRfdGltZTogbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCksIC8vIFRvbW9ycm93XG4gICAgICAgIGVuZF90aW1lOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMjUgKiA2MCAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKSwgLy8gVG9tb3Jyb3cgKyAxIGhvdXJcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGJvb2tpbmdSZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2NvbW1vbi1zcGFjZXMvJHtjcmVhdGVkU3BhY2UuaWR9L2Jvb2tpbmdzYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvb2tpbmdEYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoYm9va2luZ1Jlc3BvbnNlLm9rKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBWZXJpZnkgYm9va2luZyBpbiBkYXRhYmFzZVxuICAgICAgY29uc3QgY3JlYXRlZEJvb2tpbmdzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGJvb2tpbmdzKVxuICAgICAgICAud2hlcmUoYW5kKFxuICAgICAgICAgIGVxKGJvb2tpbmdzLmNvbW1vblNwYWNlSWQsIGNyZWF0ZWRTcGFjZS5pZCksXG4gICAgICAgICAgZXEoYm9va2luZ3MudXNlcklkLCB0ZXN0VXNlci5pZClcbiAgICAgICAgKSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVkQm9va2luZ3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkQm9va2luZ3NbMF0uc3RhdHVzKS50b0JlKCdjb25maXJtZWQnKTtcblxuICAgICAgLy8gNC4gQ2FuY2VsIHRoZSBib29raW5nIChkZWxldGUgb3BlcmF0aW9uKVxuICAgICAgY29uc3QgZGVsZXRlUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9jb21tb24tc3BhY2VzL2Jvb2tpbmdzLyR7Y3JlYXRlZEJvb2tpbmdzWzBdLmlkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoZGVsZXRlUmVzcG9uc2Uub2spLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBib29raW5nIHdhcyBjYW5jZWxsZWQgaW4gZGF0YWJhc2VcbiAgICAgIGNvbnN0IFtjYW5jZWxsZWRCb29raW5nXSA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShib29raW5ncylcbiAgICAgICAgLndoZXJlKGVxKGJvb2tpbmdzLmlkLCBjcmVhdGVkQm9va2luZ3NbMF0uaWQpKTtcblxuICAgICAgZXhwZWN0KGNhbmNlbGxlZEJvb2tpbmcuc3RhdHVzKS50b0JlKCdjYW5jZWxsZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgSW50ZWdyaXR5IGFuZCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gZm9yZWlnbiBrZXkgcmVsYXRpb25zaGlwcyB3aGVuIGJ1dHRvbnMgY3JlYXRlIHJlbGF0ZWQgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhIGRlbWFuZCB3aXRoIHByb3BlciByZWxhdGlvbnNoaXBzXG4gICAgICBjb25zdCBkZW1hbmREYXRhID0ge1xuICAgICAgICB0aXRsZTogJ1JlbGF0aW9uc2hpcCBUZXN0IERlbWFuZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdGluZyBmb3JlaWduIGtleSByZWxhdGlvbnNoaXBzJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdtYWludGVuYW5jZScsXG4gICAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9kZW1hbmRzJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRlbWFuZERhdGEpLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5vaykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IHJlbGF0aW9uc2hpcHMgYXJlIG1haW50YWluZWRcbiAgICAgIGNvbnN0IGRlbWFuZFdpdGhSZWxhdGlvbnMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHtcbiAgICAgICAgICBkZW1hbmQ6IGRlbWFuZHMsXG4gICAgICAgICAgdXNlcjogdXNlcnMsXG4gICAgICAgICAgcmVzaWRlbmNlOiByZXNpZGVuY2VzLFxuICAgICAgICAgIGJ1aWxkaW5nOiBidWlsZGluZ3MsXG4gICAgICAgIH0pXG4gICAgICAgIC5mcm9tKGRlbWFuZHMpXG4gICAgICAgIC5pbm5lckpvaW4odXNlcnMsIGVxKGRlbWFuZHMudXNlcklkLCB1c2Vycy5pZCkpXG4gICAgICAgIC5pbm5lckpvaW4ocmVzaWRlbmNlcywgZXEoZGVtYW5kcy5yZXNpZGVuY2VJZCwgcmVzaWRlbmNlcy5pZCkpXG4gICAgICAgIC5pbm5lckpvaW4oYnVpbGRpbmdzLCBlcShyZXNpZGVuY2VzLmJ1aWxkaW5nSWQsIGJ1aWxkaW5ncy5pZCkpXG4gICAgICAgIC53aGVyZShlcShkZW1hbmRzLnRpdGxlLCBkZW1hbmREYXRhLnRpdGxlKSk7XG5cbiAgICAgIGV4cGVjdChkZW1hbmRXaXRoUmVsYXRpb25zKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoZGVtYW5kV2l0aFJlbGF0aW9uc1swXS51c2VyLmlkKS50b0JlKHRlc3RVc2VyLmlkKTtcbiAgICAgIGV4cGVjdChkZW1hbmRXaXRoUmVsYXRpb25zWzBdLnJlc2lkZW5jZS5pZCkudG9CZSh0ZXN0UmVzaWRlbmNlLmlkKTtcbiAgICAgIGV4cGVjdChkZW1hbmRXaXRoUmVsYXRpb25zWzBdLmJ1aWxkaW5nLmlkKS50b0JlKHRlc3RCdWlsZGluZy5pZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGRhdGEgY29uc3RyYWludHMgd2hlbiBidXR0b25zIGF0dGVtcHQgaW52YWxpZCBvcGVyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVHJ5IHRvIGNyZWF0ZSBhIGNvbW1vbiBzcGFjZSB3aXRoIGludmFsaWQgYnVpbGRpbmcgSURcbiAgICAgIGNvbnN0IGludmFsaWRTcGFjZURhdGEgPSB7XG4gICAgICAgIG5hbWU6ICdJbnZhbGlkIFNwYWNlJyxcbiAgICAgICAgYnVpbGRpbmdfaWQ6ICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnLCAvLyBOb24tZXhpc3RlbnQgYnVpbGRpbmdcbiAgICAgICAgaXNfcmVzZXJ2YWJsZTogdHJ1ZSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvY29tbW9uLXNwYWNlcycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbnZhbGlkU3BhY2VEYXRhKSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uub2spLnRvQmUoZmFsc2UpO1xuXG4gICAgICAvLyBWZXJpZnkgbm8gaW52YWxpZCBkYXRhIHdhcyBjcmVhdGVkXG4gICAgICBjb25zdCBpbnZhbGlkU3BhY2VzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGNvbW1vblNwYWNlcylcbiAgICAgICAgLndoZXJlKGVxKGNvbW1vblNwYWNlcy5uYW1lLCBpbnZhbGlkU3BhY2VEYXRhLm5hbWUpKTtcblxuICAgICAgZXhwZWN0KGludmFsaWRTcGFjZXMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=
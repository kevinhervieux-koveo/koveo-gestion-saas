ceee9089dcc1a546fbccccaae2dbbc02
'use strict';
var UI = require('../../document/UI.js');
require('../../utils/dataTransfer/Clipboard.js');
var cursor = require('../../utils/focus/cursor.js');
var selection = require('../../utils/focus/selection.js');
var setSelection = require('./setSelection.js');
/**
 * Move the selection
 */ function moveSelection(node, direction) {
    // TODO: implement shift
    if (selection.hasOwnSelection(node)) {
        const selection = UI.getUISelection(node);
        setSelection.setSelection({
            focusNode: node,
            focusOffset: selection.startOffset === selection.endOffset ? selection.focusOffset + direction : direction < 0 ? selection.startOffset : selection.endOffset
        });
    }
    else {
        const selection = node.ownerDocument.getSelection();
        if (!(selection === null || selection === undefined ? undefined : selection.focusNode)) {
            return;
        }
        if (selection.isCollapsed) {
            const nextPosition = cursor.getNextCursorPosition(selection.focusNode, selection.focusOffset, direction);
            if (nextPosition) {
                setSelection.setSelection({
                    focusNode: nextPosition.node,
                    focusOffset: nextPosition.offset
                });
            }
        }
        else {
            selection[direction < 0 ? 'collapseToStart' : 'collapseToEnd']();
        }
    }
}
exports.moveSelection = moveSelection;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50L2Rpc3QvY2pzL2V2ZW50L3NlbGVjdGlvbi9tb3ZlU2VsZWN0aW9uLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLElBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ3pDLE9BQU8sQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO0FBQ2pELElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0FBQ3BELElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO0FBQzFELElBQUksWUFBWSxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBRWhEOztHQUVHLENBQUMsU0FBUyxhQUFhLENBQUMsSUFBSSxFQUFFLFNBQVM7SUFDdEMsd0JBQXdCO0lBQ3hCLElBQUksU0FBUyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ2xDLE1BQU0sU0FBUyxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsWUFBWSxDQUFDLFlBQVksQ0FBQztZQUN0QixTQUFTLEVBQUUsSUFBSTtZQUNmLFdBQVcsRUFBRSxTQUFTLENBQUMsV0FBVyxLQUFLLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxXQUFXLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsU0FBUztTQUMvSixDQUFDLENBQUM7SUFDUCxDQUFDO1NBQU0sQ0FBQztRQUNKLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDcEQsSUFBSSxDQUFDLENBQUMsU0FBUyxLQUFLLElBQUksSUFBSSxTQUFTLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1lBQ3JGLE9BQU87UUFDWCxDQUFDO1FBQ0QsSUFBSSxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDeEIsTUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUN6RyxJQUFJLFlBQVksRUFBRSxDQUFDO2dCQUNmLFlBQVksQ0FBQyxZQUFZLENBQUM7b0JBQ3RCLFNBQVMsRUFBRSxZQUFZLENBQUMsSUFBSTtvQkFDNUIsV0FBVyxFQUFFLFlBQVksQ0FBQyxNQUFNO2lCQUNuQyxDQUFDLENBQUM7WUFDUCxDQUFDO1FBQ0wsQ0FBQzthQUFNLENBQUM7WUFDSixTQUFTLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUM7UUFDckUsQ0FBQztJQUNMLENBQUM7QUFDTCxDQUFDO0FBRUQsT0FBTyxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50L2Rpc3QvY2pzL2V2ZW50L3NlbGVjdGlvbi9tb3ZlU2VsZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIFVJID0gcmVxdWlyZSgnLi4vLi4vZG9jdW1lbnQvVUkuanMnKTtcbnJlcXVpcmUoJy4uLy4uL3V0aWxzL2RhdGFUcmFuc2Zlci9DbGlwYm9hcmQuanMnKTtcbnZhciBjdXJzb3IgPSByZXF1aXJlKCcuLi8uLi91dGlscy9mb2N1cy9jdXJzb3IuanMnKTtcbnZhciBzZWxlY3Rpb24gPSByZXF1aXJlKCcuLi8uLi91dGlscy9mb2N1cy9zZWxlY3Rpb24uanMnKTtcbnZhciBzZXRTZWxlY3Rpb24gPSByZXF1aXJlKCcuL3NldFNlbGVjdGlvbi5qcycpO1xuXG4vKipcbiAqIE1vdmUgdGhlIHNlbGVjdGlvblxuICovIGZ1bmN0aW9uIG1vdmVTZWxlY3Rpb24obm9kZSwgZGlyZWN0aW9uKSB7XG4gICAgLy8gVE9ETzogaW1wbGVtZW50IHNoaWZ0XG4gICAgaWYgKHNlbGVjdGlvbi5oYXNPd25TZWxlY3Rpb24obm9kZSkpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gVUkuZ2V0VUlTZWxlY3Rpb24obm9kZSk7XG4gICAgICAgIHNldFNlbGVjdGlvbi5zZXRTZWxlY3Rpb24oe1xuICAgICAgICAgICAgZm9jdXNOb2RlOiBub2RlLFxuICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IHNlbGVjdGlvbi5zdGFydE9mZnNldCA9PT0gc2VsZWN0aW9uLmVuZE9mZnNldCA/IHNlbGVjdGlvbi5mb2N1c09mZnNldCArIGRpcmVjdGlvbiA6IGRpcmVjdGlvbiA8IDAgPyBzZWxlY3Rpb24uc3RhcnRPZmZzZXQgOiBzZWxlY3Rpb24uZW5kT2Zmc2V0XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vZGUub3duZXJEb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgaWYgKCEoc2VsZWN0aW9uID09PSBudWxsIHx8IHNlbGVjdGlvbiA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc2VsZWN0aW9uLmZvY3VzTm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0UG9zaXRpb24gPSBjdXJzb3IuZ2V0TmV4dEN1cnNvclBvc2l0aW9uKHNlbGVjdGlvbi5mb2N1c05vZGUsIHNlbGVjdGlvbi5mb2N1c09mZnNldCwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIGlmIChuZXh0UG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3Rpb24uc2V0U2VsZWN0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNOb2RlOiBuZXh0UG9zaXRpb24ubm9kZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IG5leHRQb3NpdGlvbi5vZmZzZXRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbltkaXJlY3Rpb24gPCAwID8gJ2NvbGxhcHNlVG9TdGFydCcgOiAnY29sbGFwc2VUb0VuZCddKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydHMubW92ZVNlbGVjdGlvbiA9IG1vdmVTZWxlY3Rpb247XG4iXSwidmVyc2lvbiI6M30=
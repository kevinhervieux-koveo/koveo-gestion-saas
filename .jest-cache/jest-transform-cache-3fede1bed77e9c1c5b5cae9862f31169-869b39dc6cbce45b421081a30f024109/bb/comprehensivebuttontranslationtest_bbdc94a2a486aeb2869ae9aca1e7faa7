b120b7e55bf16c6bc3f68141446213ad
"use strict";
/**
 * Comprehensive Button Translation Test Suite
 * Validates that all buttons in the application are properly translated
 * and conform to Quebec Law 25 bilingual requirements
 */
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const i18n_ts_1 = require("../../client/src/lib/i18n.ts");
(0, globals_1.describe)('Comprehensive Button Translation Coverage', () => {
    const languages = ['en', 'fr'];
    (0, globals_1.describe)('Fullscreen Button Translations', () => {
        (0, globals_1.it)('should have fullscreen translations in both languages', () => {
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                (0, globals_1.expect)(t.fullscreen).toBeDefined();
                (0, globals_1.expect)(typeof t.fullscreen).toBe('string');
                (0, globals_1.expect)(t.fullscreen.length).toBeGreaterThan(0);
                (0, globals_1.expect)(t.exitFullscreen).toBeDefined();
                (0, globals_1.expect)(typeof t.exitFullscreen).toBe('string');
                (0, globals_1.expect)(t.exitFullscreen.length).toBeGreaterThan(0);
            });
        });
        (0, globals_1.it)('should have French fullscreen translations with proper accent characters', () => {
            const fr = i18n_ts_1.translations.fr;
            (0, globals_1.expect)(fr.fullscreen).toBe('Plein écran');
            (0, globals_1.expect)(fr.exitFullscreen).toBe('Quitter le plein écran');
        });
        (0, globals_1.it)('should have English fullscreen translations', () => {
            const en = i18n_ts_1.translations.en;
            (0, globals_1.expect)(en.fullscreen).toBe('Fullscreen');
            (0, globals_1.expect)(en.exitFullscreen).toBe('Exit Fullscreen');
        });
    });
    (0, globals_1.describe)('Critical Button Translation Coverage', () => {
        const criticalButtonKeys = [
            'login',
            'logout',
            'getStarted',
            'cancel',
            'confirm',
            'save',
            'delete',
            'edit',
            'create',
            'update',
            'submit',
            'close',
            'back',
            'next',
            'finish',
            'continue',
            'fullscreen',
            'exitFullscreen'
        ];
        (0, globals_1.it)('should have all critical button translations in both languages', () => {
            criticalButtonKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    if (t[key]) {
                        (0, globals_1.expect)(typeof t[key]).toBe('string');
                        (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                    }
                });
            });
        });
    });
    (0, globals_1.describe)('Navigation Button Translation Coverage', () => {
        const navigationKeys = [
            'home',
            'dashboard',
            'buildings',
            'residents',
            'documents',
            'settings',
            'organizations',
            'calendar',
            'demands',
            'bills',
            'budget'
        ];
        (0, globals_1.it)('should have all navigation translations in both languages', () => {
            navigationKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                    (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                });
            });
        });
    });
    (0, globals_1.describe)('Action Button Translation Validation', () => {
        (0, globals_1.it)('should have consistent action button patterns', () => {
            const actionKeys = Object.keys(i18n_ts_1.translations.en).filter(key => key.includes('button') || key.includes('action') || key.includes('click'));
            actionKeys.forEach(key => {
                languages.forEach(lang => {
                    const t = i18n_ts_1.translations[lang];
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                });
            });
        });
    });
    (0, globals_1.describe)('Quebec Law 25 Compliance for Buttons', () => {
        (0, globals_1.it)('should have French translations for all critical user interface elements', () => {
            const fr = i18n_ts_1.translations.fr;
            // Critical UI elements must be translated to French
            (0, globals_1.expect)(fr.login).toBeDefined();
            (0, globals_1.expect)(fr.logout).toBeDefined();
            (0, globals_1.expect)(fr.privacyPolicy).toBeDefined();
            (0, globals_1.expect)(fr.settings).toBeDefined();
            (0, globals_1.expect)(fr.language).toBeDefined();
            (0, globals_1.expect)(fr.fullscreen).toBeDefined();
            (0, globals_1.expect)(fr.exitFullscreen).toBeDefined();
        });
        (0, globals_1.it)('should use proper Quebec French terminology', () => {
            const fr = i18n_ts_1.translations.fr;
            // Validate Quebec-specific French terms
            (0, globals_1.expect)(fr.fullscreen).toContain('écran'); // "écran" not "screen"
            (0, globals_1.expect)(fr.exitFullscreen).toContain('Quitter'); // Proper Quebec French verb
            (0, globals_1.expect)(fr.language).toBe('Langue'); // Standard Quebec French
            (0, globals_1.expect)(fr.settings).toBe('Paramètres'); // Standard Quebec French
        });
    });
    (0, globals_1.describe)('Translation Consistency Validation', () => {
        (0, globals_1.it)('should have no missing translations between languages', () => {
            const enKeys = Object.keys(i18n_ts_1.translations.en);
            const frKeys = Object.keys(i18n_ts_1.translations.fr);
            (0, globals_1.expect)(enKeys.sort()).toEqual(frKeys.sort());
        });
        (0, globals_1.it)('should have no empty or undefined translations', () => {
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                Object.keys(t).forEach(key => {
                    (0, globals_1.expect)(t[key]).toBeDefined();
                    (0, globals_1.expect)(typeof t[key]).toBe('string');
                    (0, globals_1.expect)(t[key].length).toBeGreaterThan(0);
                });
            });
        });
    });
    (0, globals_1.describe)('Translation Quality Standards', () => {
        (0, globals_1.it)('should have proper capitalization for button text', () => {
            const buttonKeys = ['fullscreen', 'exitFullscreen', 'login', 'logout', 'getStarted'];
            buttonKeys.forEach(key => {
                const en = i18n_ts_1.translations.en[key];
                const fr = i18n_ts_1.translations.fr[key];
                if (en) {
                    // English buttons should start with capital letter
                    (0, globals_1.expect)(en.charAt(0)).toEqual(en.charAt(0).toUpperCase());
                }
                if (fr) {
                    // French buttons should start with capital letter
                    (0, globals_1.expect)(fr.charAt(0)).toEqual(fr.charAt(0).toUpperCase());
                }
            });
        });
        (0, globals_1.it)('should have reasonable length limits for button text', () => {
            const buttonKeys = Object.keys(i18n_ts_1.translations.en).filter(key => 
            // Filter for likely button text (exclude descriptions)
            !key.includes('Desc') && !key.includes('Description') &&
                !key.includes('Overview') && !key.includes('Subtitle') &&
                (key.includes('button') || key.includes('action') || key.includes('click') ||
                    ['login', 'logout', 'save', 'cancel', 'confirm', 'delete', 'edit', 'create',
                        'fullscreen', 'exitFullscreen', 'getStarted', 'submit', 'close'].includes(key)));
            languages.forEach(lang => {
                const t = i18n_ts_1.translations[lang];
                buttonKeys.forEach(key => {
                    if (typeof t[key] === 'string') {
                        (0, globals_1.expect)(t[key].length).toBeLessThan(50); // Button text should be concise
                    }
                });
            });
        });
    });
});
/**
 * Button Usage Pattern Validation
 * Tests that verify proper usage patterns for translated buttons
 */
(0, globals_1.describe)('Button Translation Usage Patterns', () => {
    (0, globals_1.it)('should validate translation key naming conventions', () => {
        const buttonLikeKeys = Object.keys(i18n_ts_1.translations.en).filter(key => 
        // Keys that are likely buttons or actions
        ['button', 'action', 'click', 'toggle', 'open', 'close', 'exit', 'enter', 'fullscreen'].some(pattern => key.toLowerCase().includes(pattern)));
        buttonLikeKeys.forEach(key => {
            // Button keys should follow camelCase convention
            (0, globals_1.expect)(key).toMatch(/^[a-z][a-zA-Z0-9]*$/);
        });
    });
    (0, globals_1.it)('should ensure all fullscreen functionality is properly translated', () => {
        const fullscreenKeys = ['fullscreen', 'exitFullscreen'];
        const languages = ['en', 'fr'];
        fullscreenKeys.forEach(key => {
            languages.forEach(lang => {
                const translation = i18n_ts_1.translations[lang][key];
                (0, globals_1.expect)(translation).toBeDefined();
                (0, globals_1.expect)(translation).not.toContain('{'); // No untranslated placeholders
                (0, globals_1.expect)(translation).not.toContain('}');
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2NvbXByZWhlbnNpdmUtYnV0dG9uLXRyYW5zbGF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7O0dBSUc7O0FBRUgsMkNBQXFEO0FBQ3JELDBEQUEyRTtBQUUzRSxJQUFBLGtCQUFRLEVBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO0lBQ3pELE1BQU0sU0FBUyxHQUFlLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBRTNDLElBQUEsa0JBQVEsRUFBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsSUFBQSxZQUFFLEVBQUMsdURBQXVELEVBQUUsR0FBRyxFQUFFO1lBQy9ELFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3ZCLE1BQU0sQ0FBQyxHQUFHLHNCQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBRTdCLElBQUEsZ0JBQU0sRUFBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ25DLElBQUEsZ0JBQU0sRUFBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQzNDLElBQUEsZ0JBQU0sRUFBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFL0MsSUFBQSxnQkFBTSxFQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDdkMsSUFBQSxnQkFBTSxFQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDL0MsSUFBQSxnQkFBTSxFQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JELENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFF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QUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsK0JBQStCO2dCQUN2RSxJQUFBLGdCQUFNLEVBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN6QyxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3VuaXQvY29tcHJlaGVuc2l2ZS1idXR0b24tdHJhbnNsYXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbXByZWhlbnNpdmUgQnV0dG9uIFRyYW5zbGF0aW9uIFRlc3QgU3VpdGVcbiAqIFZhbGlkYXRlcyB0aGF0IGFsbCBidXR0b25zIGluIHRoZSBhcHBsaWNhdGlvbiBhcmUgcHJvcGVybHkgdHJhbnNsYXRlZFxuICogYW5kIGNvbmZvcm0gdG8gUXVlYmVjIExhdyAyNSBiaWxpbmd1YWwgcmVxdWlyZW1lbnRzXG4gKi9cblxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IHRyYW5zbGF0aW9ucywgdHlwZSBMYW5ndWFnZSB9IGZyb20gJy4uLy4uL2NsaWVudC9zcmMvbGliL2kxOG4udHMnO1xuXG5kZXNjcmliZSgnQ29tcHJlaGVuc2l2ZSBCdXR0b24gVHJhbnNsYXRpb24gQ292ZXJhZ2UnLCAoKSA9PiB7XG4gIGNvbnN0IGxhbmd1YWdlczogTGFuZ3VhZ2VbXSA9IFsnZW4nLCAnZnInXTtcbiAgXG4gIGRlc2NyaWJlKCdGdWxsc2NyZWVuIEJ1dHRvbiBUcmFuc2xhdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIGZ1bGxzY3JlZW4gdHJhbnNsYXRpb25zIGluIGJvdGggbGFuZ3VhZ2VzJywgKCkgPT4ge1xuICAgICAgbGFuZ3VhZ2VzLmZvckVhY2gobGFuZyA9PiB7XG4gICAgICAgIGNvbnN0IHQgPSB0cmFuc2xhdGlvbnNbbGFuZ107XG4gICAgICAgIFxuICAgICAgICBleHBlY3QodC5mdWxsc2NyZWVuKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QodHlwZW9mIHQuZnVsbHNjcmVlbikudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgIGV4cGVjdCh0LmZ1bGxzY3JlZW4ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QodC5leGl0RnVsbHNjcmVlbikudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiB0LmV4aXRGdWxsc2NyZWVuKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgICAgZXhwZWN0KHQuZXhpdEZ1bGxzY3JlZW4ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBGcmVuY2ggZnVsbHNjcmVlbiB0cmFuc2xhdGlvbnMgd2l0aCBwcm9wZXIgYWNjZW50IGNoYXJhY3RlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmciA9IHRyYW5zbGF0aW9ucy5mcjtcbiAgICAgIGV4cGVjdChmci5mdWxsc2NyZWVuKS50b0JlKCdQbGVpbiDDqWNyYW4nKTtcbiAgICAgIGV4cGVjdChmci5leGl0RnVsbHNjcmVlbikudG9CZSgnUXVpdHRlciBsZSBwbGVpbiDDqWNyYW4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBFbmdsaXNoIGZ1bGxzY3JlZW4gdHJhbnNsYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgZW4gPSB0cmFuc2xhdGlvbnMuZW47XG4gICAgICBleHBlY3QoZW4uZnVsbHNjcmVlbikudG9CZSgnRnVsbHNjcmVlbicpO1xuICAgICAgZXhwZWN0KGVuLmV4aXRGdWxsc2NyZWVuKS50b0JlKCdFeGl0IEZ1bGxzY3JlZW4nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NyaXRpY2FsIEJ1dHRvbiBUcmFuc2xhdGlvbiBDb3ZlcmFnZScsICgpID0+IHtcbiAgICBjb25zdCBjcml0aWNhbEJ1dHRvbktleXMgPSBbXG4gICAgICAnbG9naW4nLFxuICAgICAgJ2xvZ291dCcsIFxuICAgICAgJ2dldFN0YXJ0ZWQnLFxuICAgICAgJ2NhbmNlbCcsXG4gICAgICAnY29uZmlybScsXG4gICAgICAnc2F2ZScsXG4gICAgICAnZGVsZXRlJyxcbiAgICAgICdlZGl0JyxcbiAgICAgICdjcmVhdGUnLFxuICAgICAgJ3VwZGF0ZScsXG4gICAgICAnc3VibWl0JyxcbiAgICAgICdjbG9zZScsXG4gICAgICAnYmFjaycsXG4gICAgICAnbmV4dCcsXG4gICAgICAnZmluaXNoJyxcbiAgICAgICdjb250aW51ZScsXG4gICAgICAnZnVsbHNjcmVlbicsXG4gICAgICAnZXhpdEZ1bGxzY3JlZW4nXG4gICAgXTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBhbGwgY3JpdGljYWwgYnV0dG9uIHRyYW5zbGF0aW9ucyBpbiBib3RoIGxhbmd1YWdlcycsICgpID0+IHtcbiAgICAgIGNyaXRpY2FsQnV0dG9uS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICAgIGNvbnN0IHQgPSB0cmFuc2xhdGlvbnNbbGFuZ10gYXMgYW55O1xuICAgICAgICAgIGlmICh0W2tleV0pIHtcbiAgICAgICAgICAgIGV4cGVjdCh0eXBlb2YgdFtrZXldKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgICAgICAgIGV4cGVjdCh0W2tleV0ubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTmF2aWdhdGlvbiBCdXR0b24gVHJhbnNsYXRpb24gQ292ZXJhZ2UnLCAoKSA9PiB7XG4gICAgY29uc3QgbmF2aWdhdGlvbktleXMgPSBbXG4gICAgICAnaG9tZScsXG4gICAgICAnZGFzaGJvYXJkJywgXG4gICAgICAnYnVpbGRpbmdzJyxcbiAgICAgICdyZXNpZGVudHMnLFxuICAgICAgJ2RvY3VtZW50cycsXG4gICAgICAnc2V0dGluZ3MnLFxuICAgICAgJ29yZ2FuaXphdGlvbnMnLFxuICAgICAgJ2NhbGVuZGFyJyxcbiAgICAgICdkZW1hbmRzJyxcbiAgICAgICdiaWxscycsXG4gICAgICAnYnVkZ2V0J1xuICAgIF07XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgYWxsIG5hdmlnYXRpb24gdHJhbnNsYXRpb25zIGluIGJvdGggbGFuZ3VhZ2VzJywgKCkgPT4ge1xuICAgICAgbmF2aWdhdGlvbktleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBsYW5ndWFnZXMuZm9yRWFjaChsYW5nID0+IHtcbiAgICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddIGFzIGFueTtcbiAgICAgICAgICBleHBlY3QodFtrZXldKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgIGV4cGVjdCh0eXBlb2YgdFtrZXldKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgICAgICBleHBlY3QodFtrZXldLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWN0aW9uIEJ1dHRvbiBUcmFuc2xhdGlvbiBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBjb25zaXN0ZW50IGFjdGlvbiBidXR0b24gcGF0dGVybnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhY3Rpb25LZXlzID0gT2JqZWN0LmtleXModHJhbnNsYXRpb25zLmVuKS5maWx0ZXIoa2V5ID0+IFxuICAgICAgICBrZXkuaW5jbHVkZXMoJ2J1dHRvbicpIHx8IGtleS5pbmNsdWRlcygnYWN0aW9uJykgfHwga2V5LmluY2x1ZGVzKCdjbGljaycpXG4gICAgICApO1xuXG4gICAgICBhY3Rpb25LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgbGFuZ3VhZ2VzLmZvckVhY2gobGFuZyA9PiB7XG4gICAgICAgICAgY29uc3QgdCA9IHRyYW5zbGF0aW9uc1tsYW5nXSBhcyBhbnk7XG4gICAgICAgICAgZXhwZWN0KHRba2V5XSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICBleHBlY3QodHlwZW9mIHRba2V5XSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdRdWViZWMgTGF3IDI1IENvbXBsaWFuY2UgZm9yIEJ1dHRvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIEZyZW5jaCB0cmFuc2xhdGlvbnMgZm9yIGFsbCBjcml0aWNhbCB1c2VyIGludGVyZmFjZSBlbGVtZW50cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZyID0gdHJhbnNsYXRpb25zLmZyO1xuICAgICAgXG4gICAgICAvLyBDcml0aWNhbCBVSSBlbGVtZW50cyBtdXN0IGJlIHRyYW5zbGF0ZWQgdG8gRnJlbmNoXG4gICAgICBleHBlY3QoZnIubG9naW4pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZnIubG9nb3V0KS50b0JlRGVmaW5lZCgpOyBcbiAgICAgIGV4cGVjdChmci5wcml2YWN5UG9saWN5KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyLnNldHRpbmdzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyLmxhbmd1YWdlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyLmZ1bGxzY3JlZW4pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZnIuZXhpdEZ1bGxzY3JlZW4pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBwcm9wZXIgUXVlYmVjIEZyZW5jaCB0ZXJtaW5vbG9neScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZyID0gdHJhbnNsYXRpb25zLmZyO1xuICAgICAgXG4gICAgICAvLyBWYWxpZGF0ZSBRdWViZWMtc3BlY2lmaWMgRnJlbmNoIHRlcm1zXG4gICAgICBleHBlY3QoZnIuZnVsbHNjcmVlbikudG9Db250YWluKCfDqWNyYW4nKTsgLy8gXCLDqWNyYW5cIiBub3QgXCJzY3JlZW5cIlxuICAgICAgZXhwZWN0KGZyLmV4aXRGdWxsc2NyZWVuKS50b0NvbnRhaW4oJ1F1aXR0ZXInKTsgLy8gUHJvcGVyIFF1ZWJlYyBGcmVuY2ggdmVyYlxuICAgICAgZXhwZWN0KGZyLmxhbmd1YWdlKS50b0JlKCdMYW5ndWUnKTsgLy8gU3RhbmRhcmQgUXVlYmVjIEZyZW5jaFxuICAgICAgZXhwZWN0KGZyLnNldHRpbmdzKS50b0JlKCdQYXJhbcOodHJlcycpOyAvLyBTdGFuZGFyZCBRdWViZWMgRnJlbmNoXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdUcmFuc2xhdGlvbiBDb25zaXN0ZW5jeSBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBubyBtaXNzaW5nIHRyYW5zbGF0aW9ucyBiZXR3ZWVuIGxhbmd1YWdlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVuS2V5cyA9IE9iamVjdC5rZXlzKHRyYW5zbGF0aW9ucy5lbik7XG4gICAgICBjb25zdCBmcktleXMgPSBPYmplY3Qua2V5cyh0cmFuc2xhdGlvbnMuZnIpO1xuICAgICAgXG4gICAgICBleHBlY3QoZW5LZXlzLnNvcnQoKSkudG9FcXVhbChmcktleXMuc29ydCgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBubyBlbXB0eSBvciB1bmRlZmluZWQgdHJhbnNsYXRpb25zJywgKCkgPT4ge1xuICAgICAgbGFuZ3VhZ2VzLmZvckVhY2gobGFuZyA9PiB7XG4gICAgICAgIGNvbnN0IHQgPSB0cmFuc2xhdGlvbnNbbGFuZ10gYXMgYW55O1xuICAgICAgICBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHRba2V5XSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICBleHBlY3QodHlwZW9mIHRba2V5XSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgICAgZXhwZWN0KHRba2V5XS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1RyYW5zbGF0aW9uIFF1YWxpdHkgU3RhbmRhcmRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wZXIgY2FwaXRhbGl6YXRpb24gZm9yIGJ1dHRvbiB0ZXh0JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uS2V5cyA9IFsnZnVsbHNjcmVlbicsICdleGl0RnVsbHNjcmVlbicsICdsb2dpbicsICdsb2dvdXQnLCAnZ2V0U3RhcnRlZCddO1xuICAgICAgXG4gICAgICBidXR0b25LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgY29uc3QgZW4gPSAodHJhbnNsYXRpb25zLmVuIGFzIGFueSlba2V5XTtcbiAgICAgICAgY29uc3QgZnIgPSAodHJhbnNsYXRpb25zLmZyIGFzIGFueSlba2V5XTtcbiAgICAgICAgXG4gICAgICAgIGlmIChlbikge1xuICAgICAgICAgIC8vIEVuZ2xpc2ggYnV0dG9ucyBzaG91bGQgc3RhcnQgd2l0aCBjYXBpdGFsIGxldHRlclxuICAgICAgICAgIGV4cGVjdChlbi5jaGFyQXQoMCkpLnRvRXF1YWwoZW4uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoZnIpIHtcbiAgICAgICAgICAvLyBGcmVuY2ggYnV0dG9ucyBzaG91bGQgc3RhcnQgd2l0aCBjYXBpdGFsIGxldHRlclxuICAgICAgICAgIGV4cGVjdChmci5jaGFyQXQoMCkpLnRvRXF1YWwoZnIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSByZWFzb25hYmxlIGxlbmd0aCBsaW1pdHMgZm9yIGJ1dHRvbiB0ZXh0JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uS2V5cyA9IE9iamVjdC5rZXlzKHRyYW5zbGF0aW9ucy5lbikuZmlsdGVyKGtleSA9PiBcbiAgICAgICAgLy8gRmlsdGVyIGZvciBsaWtlbHkgYnV0dG9uIHRleHQgKGV4Y2x1ZGUgZGVzY3JpcHRpb25zKVxuICAgICAgICAha2V5LmluY2x1ZGVzKCdEZXNjJykgJiYgIWtleS5pbmNsdWRlcygnRGVzY3JpcHRpb24nKSAmJiBcbiAgICAgICAgIWtleS5pbmNsdWRlcygnT3ZlcnZpZXcnKSAmJiAha2V5LmluY2x1ZGVzKCdTdWJ0aXRsZScpICYmXG4gICAgICAgIChrZXkuaW5jbHVkZXMoJ2J1dHRvbicpIHx8IGtleS5pbmNsdWRlcygnYWN0aW9uJykgfHwga2V5LmluY2x1ZGVzKCdjbGljaycpIHx8XG4gICAgICAgICBbJ2xvZ2luJywgJ2xvZ291dCcsICdzYXZlJywgJ2NhbmNlbCcsICdjb25maXJtJywgJ2RlbGV0ZScsICdlZGl0JywgJ2NyZWF0ZScsIFxuICAgICAgICAgICdmdWxsc2NyZWVuJywgJ2V4aXRGdWxsc2NyZWVuJywgJ2dldFN0YXJ0ZWQnLCAnc3VibWl0JywgJ2Nsb3NlJ10uaW5jbHVkZXMoa2V5KSlcbiAgICAgICk7XG5cbiAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKGxhbmcgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHJhbnNsYXRpb25zW2xhbmddIGFzIGFueTtcbiAgICAgICAgYnV0dG9uS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0W2tleV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBleHBlY3QodFtrZXldLmxlbmd0aCkudG9CZUxlc3NUaGFuKDUwKTsgLy8gQnV0dG9uIHRleHQgc2hvdWxkIGJlIGNvbmNpc2VcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbi8qKlxuICogQnV0dG9uIFVzYWdlIFBhdHRlcm4gVmFsaWRhdGlvblxuICogVGVzdHMgdGhhdCB2ZXJpZnkgcHJvcGVyIHVzYWdlIHBhdHRlcm5zIGZvciB0cmFuc2xhdGVkIGJ1dHRvbnNcbiAqL1xuZGVzY3JpYmUoJ0J1dHRvbiBUcmFuc2xhdGlvbiBVc2FnZSBQYXR0ZXJucycsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0cmFuc2xhdGlvbiBrZXkgbmFtaW5nIGNvbnZlbnRpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGJ1dHRvbkxpa2VLZXlzID0gT2JqZWN0LmtleXModHJhbnNsYXRpb25zLmVuKS5maWx0ZXIoa2V5ID0+IFxuICAgICAgLy8gS2V5cyB0aGF0IGFyZSBsaWtlbHkgYnV0dG9ucyBvciBhY3Rpb25zXG4gICAgICBbJ2J1dHRvbicsICdhY3Rpb24nLCAnY2xpY2snLCAndG9nZ2xlJywgJ29wZW4nLCAnY2xvc2UnLCAnZXhpdCcsICdlbnRlcicsICdmdWxsc2NyZWVuJ10uc29tZShwYXR0ZXJuID0+IFxuICAgICAgICBrZXkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhwYXR0ZXJuKVxuICAgICAgKVxuICAgICk7XG5cbiAgICBidXR0b25MaWtlS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAvLyBCdXR0b24ga2V5cyBzaG91bGQgZm9sbG93IGNhbWVsQ2FzZSBjb252ZW50aW9uXG4gICAgICBleHBlY3Qoa2V5KS50b01hdGNoKC9eW2Etel1bYS16QS1aMC05XSokLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZW5zdXJlIGFsbCBmdWxsc2NyZWVuIGZ1bmN0aW9uYWxpdHkgaXMgcHJvcGVybHkgdHJhbnNsYXRlZCcsICgpID0+IHtcbiAgICBjb25zdCBmdWxsc2NyZWVuS2V5cyA9IFsnZnVsbHNjcmVlbicsICdleGl0RnVsbHNjcmVlbiddO1xuICAgIFxuICAgIGNvbnN0IGxhbmd1YWdlczogTGFuZ3VhZ2VbXSA9IFsnZW4nLCAnZnInXTtcbiAgICBcbiAgICBmdWxsc2NyZWVuS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBsYW5ndWFnZXMuZm9yRWFjaChsYW5nID0+IHtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRpb24gPSAodHJhbnNsYXRpb25zW2xhbmddIGFzIGFueSlba2V5XTtcbiAgICAgICAgZXhwZWN0KHRyYW5zbGF0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QodHJhbnNsYXRpb24pLm5vdC50b0NvbnRhaW4oJ3snKTsgLy8gTm8gdW50cmFuc2xhdGVkIHBsYWNlaG9sZGVyc1xuICAgICAgICBleHBlY3QodHJhbnNsYXRpb24pLm5vdC50b0NvbnRhaW4oJ30nKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==
0da9caacca6e5db64be8d299b179f6bc
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
/**
 * Comprehensive Form Submission Test Suite
 *
 * This test suite validates that ALL forms in the Koveo Gestion application
 * submit correctly with proper data handling, error management, and API integration.
 *
 * Forms tested for actual submission behavior:
 * 1. Authentication Forms (login, password reset)
 * 2. User Management Forms (invitations, profile updates)
 * 3. Property Management Forms (buildings, residences)
 * 4. Financial Forms (bills, payments)
 * 5. Document Forms (upload, categorization)
 * 6. Maintenance Forms (demands, bug reports)
 */
/// <reference path="../types/jest-dom.d.ts" />
const globals_1 = require("@jest/globals");
globals_1.jest.mock('@/lib/queryClient', () => ({
    apiRequest: mockApiRequest,
}));
globals_1.jest.mock('@/hooks/use-auth', () => ({
    useAuth: () => mockAuth,
}));
globals_1.jest.mock('@/hooks/use-toast', () => ({
    useToast: () => ({ toast: mockToast }),
}));
// Mock useLocation hook
globals_1.jest.mock('wouter', () => ({
    useLocation: () => ['/', globals_1.jest.fn()],
    Link: ({ children, href }) => ((0, jsx_runtime_1.jsx)("a", { href: href, children: children })),
}));
// Mock language hook
globals_1.jest.mock('@/hooks/use-language', () => ({
    useLanguage: () => ({
        language: 'en',
        t: (key) => key,
        changeLanguage: globals_1.jest.fn(),
    }),
}));
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const react_query_1 = require("@tanstack/react-query");
const react_2 = __importDefault(require("react"));
// Test utilities
const createTestQueryClient = () => {
    return new react_query_1.QueryClient({
        defaultOptions: {
            queries: {
                retry: false,
            },
            mutations: {
                retry: false,
            },
        },
    });
};
const TestWrapper = ({ children }) => {
    const queryClient = createTestQueryClient();
    return ((0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: children }));
};
// Mock API request function
const mockApiRequest = globals_1.jest.fn();
// Mock authentication hook
const mockAuth = {
    user: {
        id: '123e4567-e89b-12d3-a456-426614174000',
        email: 'test@example.com',
        role: 'admin',
        organizationId: '123e4567-e89b-12d3-a456-426614174001'
    },
    login: globals_1.jest.fn(),
    logout: globals_1.jest.fn(),
};
// Mock toast hook
const mockToast = globals_1.jest.fn();
(0, globals_1.describe)('Comprehensive Form Submission Tests', () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        mockApiRequest.mockResolvedValue({ success: true });
    });
    (0, globals_1.describe)('Authentication Form Submissions', () => {
        (0, globals_1.it)('should submit login form with correct credentials', async () => {
            // Mock login component
            const LoginForm = () => {
                const [email, setEmail] = react_2.default.useState('');
                const [password, setPassword] = react_2.default.useState('');
                const [isSubmitting, setIsSubmitting] = react_2.default.useState(false);
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    setIsSubmitting(true);
                    try {
                        await mockApiRequest('POST', '/api/auth/login', { email, password });
                        mockAuth.login({ email, password });
                    }
                    finally {
                        setIsSubmitting(false);
                    }
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "login-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "email-input", type: "email", value: email, onChange: (e) => setEmail(e.target.value), placeholder: "Email" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "password-input", type: "password", value: password, onChange: (e) => setPassword(e.target.value), placeholder: "Password" }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "login-submit", type: "submit", disabled: isSubmitting, children: isSubmitting ? 'Logging in...' : 'Login' })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(LoginForm, {}), { wrapper: TestWrapper });
            const emailInput = react_1.screen.getByTestId('email-input');
            const passwordInput = react_1.screen.getByTestId('password-input');
            const submitButton = react_1.screen.getByTestId('login-submit');
            await user_event_1.default.type(emailInput, 'test@example.com');
            await user_event_1.default.type(passwordInput, 'validPassword123');
            await user_event_1.default.click(submitButton);
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/auth/login', {
                    email: 'test@example.com',
                    password: 'validPassword123'
                });
            });
            (0, globals_1.expect)(mockAuth.login).toHaveBeenCalledWith({
                email: 'test@example.com',
                password: 'validPassword123'
            });
        });
        (0, globals_1.it)('should handle login form validation errors', async () => {
            mockApiRequest.mockRejectedValue(new Error('Invalid credentials'));
            const LoginForm = () => {
                const [email, setEmail] = react_2.default.useState('');
                const [password, setPassword] = react_2.default.useState('');
                const [error, setError] = react_2.default.useState('');
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    try {
                        await mockApiRequest('POST', '/api/auth/login', { email, password });
                    }
                    catch (err) {
                        setError(err.message);
                    }
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "login-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "email-input", type: "email", value: email, onChange: (e) => setEmail(e.target.value) }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "password-input", type: "password", value: password, onChange: (e) => setPassword(e.target.value) }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "login-submit", type: "submit", children: "Login" }), error && (0, jsx_runtime_1.jsx)("div", { "data-testid": "error-message", children: error })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(LoginForm, {}), { wrapper: TestWrapper });
            const emailInput = react_1.screen.getByTestId('email-input');
            const passwordInput = react_1.screen.getByTestId('password-input');
            const submitButton = react_1.screen.getByTestId('login-submit');
            await user_event_1.default.type(emailInput, 'wrong@example.com');
            await user_event_1.default.type(passwordInput, 'wrongpassword');
            await user_event_1.default.click(submitButton);
            await (0, react_1.waitFor)(() => {
                const errorElement = react_1.screen.getByTestId('error-message');
                (0, globals_1.expect)(errorElement.textContent).toBe('Invalid credentials');
            });
        });
    });
    (0, globals_1.describe)('Property Management Form Submissions', () => {
        (0, globals_1.it)('should submit building creation form with valid data', async () => {
            const BuildingForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    name: '',
                    organizationId: '',
                    address: '',
                    city: '',
                    province: 'QC',
                    postalCode: '',
                    buildingType: 'condo',
                    totalUnits: 0
                });
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    await mockApiRequest('POST', '/api/buildings', formData);
                    mockToast({ title: 'Building created successfully' });
                };
                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "building-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "building-name", value: formData.name, onChange: (e) => handleChange('name', e.target.value), placeholder: "Building Name" }), (0, jsx_runtime_1.jsxs)("select", { "data-testid": "organization-select", value: formData.organizationId, onChange: (e) => handleChange('organizationId', e.target.value), children: [(0, jsx_runtime_1.jsx)("option", { value: "", children: "Select Organization" }), (0, jsx_runtime_1.jsx)("option", { value: "123e4567-e89b-12d3-a456-426614174001", children: "Test Org" })] }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "building-address", value: formData.address, onChange: (e) => handleChange('address', e.target.value), placeholder: "Address" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "building-city", value: formData.city, onChange: (e) => handleChange('city', e.target.value), placeholder: "City" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "building-postalcode", value: formData.postalCode, onChange: (e) => handleChange('postalCode', e.target.value), placeholder: "Postal Code" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "building-units", type: "number", value: formData.totalUnits, onChange: (e) => handleChange('totalUnits', parseInt(e.target.value) || 0), placeholder: "Total Units" }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "building-submit", type: "submit", children: "Create Building" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(BuildingForm, {}), { wrapper: TestWrapper });
            // Fill out the form
            await user_event_1.default.type(react_1.screen.getByTestId('building-name'), 'Sunset Towers');
            await user_event_1.default.selectOptions(react_1.screen.getByTestId('organization-select'), '123e4567-e89b-12d3-a456-426614174001');
            await user_event_1.default.type(react_1.screen.getByTestId('building-address'), '456 Main Street');
            await user_event_1.default.type(react_1.screen.getByTestId('building-city'), 'Montreal');
            await user_event_1.default.type(react_1.screen.getByTestId('building-postalcode'), 'H3A 1B1');
            await user_event_1.default.clear(react_1.screen.getByTestId('building-units'));
            await user_event_1.default.type(react_1.screen.getByTestId('building-units'), '50');
            await user_event_1.default.click(react_1.screen.getByTestId('building-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/buildings', {
                    name: 'Sunset Towers',
                    organizationId: '123e4567-e89b-12d3-a456-426614174001',
                    address: '456 Main Street',
                    city: 'Montreal',
                    province: 'QC',
                    postalCode: 'H3A 1B1',
                    buildingType: 'condo',
                    totalUnits: 50
                });
            });
            (0, globals_1.expect)(mockToast).toHaveBeenCalledWith({ title: 'Building created successfully' });
        });
    });
    (0, globals_1.describe)('Financial Form Submissions', () => {
        (0, globals_1.it)('should submit bill creation form with proper amount validation', async () => {
            const BillForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    title: '',
                    category: 'utilities',
                    paymentType: 'unique',
                    totalAmount: '',
                    startDate: '',
                    status: 'draft'
                });
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    // Validate amount
                    const amount = parseFloat(formData.totalAmount);
                    if (isNaN(amount) || amount <= 0) {
                        mockToast({ title: 'Invalid amount', variant: 'destructive' });
                        return;
                    }
                    await mockApiRequest('POST', '/api/bills', formData);
                    mockToast({ title: 'Bill created successfully' });
                };
                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "bill-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "bill-title", value: formData.title, onChange: (e) => handleChange('title', e.target.value), placeholder: "Bill Title" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "bill-amount", value: formData.totalAmount, onChange: (e) => handleChange('totalAmount', e.target.value), placeholder: "Amount" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "bill-date", type: "date", value: formData.startDate, onChange: (e) => handleChange('startDate', e.target.value) }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "bill-submit", type: "submit", children: "Create Bill" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(BillForm, {}), { wrapper: TestWrapper });
            // Test valid submission
            await user_event_1.default.type(react_1.screen.getByTestId('bill-title'), 'Monthly Electricity');
            await user_event_1.default.type(react_1.screen.getByTestId('bill-amount'), '150.75');
            await user_event_1.default.type(react_1.screen.getByTestId('bill-date'), '2025-01-01');
            await user_event_1.default.click(react_1.screen.getByTestId('bill-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/bills', {
                    title: 'Monthly Electricity',
                    category: 'utilities',
                    paymentType: 'unique',
                    totalAmount: '150.75',
                    startDate: '2025-01-01',
                    status: 'draft'
                });
            });
            (0, globals_1.expect)(mockToast).toHaveBeenCalledWith({ title: 'Bill created successfully' });
        });
        (0, globals_1.it)('should handle invalid bill amount submission', async () => {
            const BillForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    title: 'Test Bill',
                    totalAmount: ''
                });
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    const amount = parseFloat(formData.totalAmount);
                    if (isNaN(amount) || amount <= 0) {
                        mockToast({ title: 'Invalid amount', variant: 'destructive' });
                        return;
                    }
                    await mockApiRequest('POST', '/api/bills', formData);
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "bill-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "bill-amount", value: formData.totalAmount, onChange: (e) => setFormData(prev => ({ ...prev, totalAmount: e.target.value })), placeholder: "Amount" }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "bill-submit", type: "submit", children: "Create Bill" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(BillForm, {}), { wrapper: TestWrapper });
            // Test invalid amount
            await user_event_1.default.type(react_1.screen.getByTestId('bill-amount'), '-50');
            await user_event_1.default.click(react_1.screen.getByTestId('bill-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockToast).toHaveBeenCalledWith({
                    title: 'Invalid amount',
                    variant: 'destructive'
                });
            });
            (0, globals_1.expect)(mockApiRequest).not.toHaveBeenCalled();
        });
    });
    (0, globals_1.describe)('Maintenance Form Submissions', () => {
        (0, globals_1.it)('should submit demand creation form with UUID handling', async () => {
            const DemandForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    type: 'maintenance',
                    description: '',
                    buildingId: '',
                    residenceId: ''
                });
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    // Convert empty strings to undefined for optional UUID fields
                    const submissionData = {
                        ...formData,
                        buildingId: formData.buildingId || undefined,
                        residenceId: formData.residenceId || undefined
                    };
                    await mockApiRequest('POST', '/api/demands', submissionData);
                    mockToast({ title: 'Demand created successfully' });
                };
                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "demand-form", children: [(0, jsx_runtime_1.jsxs)("select", { "data-testid": "demand-type", value: formData.type, onChange: (e) => handleChange('type', e.target.value), children: [(0, jsx_runtime_1.jsx)("option", { value: "maintenance", children: "Maintenance" }), (0, jsx_runtime_1.jsx)("option", { value: "complaint", children: "Complaint" }), (0, jsx_runtime_1.jsx)("option", { value: "information", children: "Information" }), (0, jsx_runtime_1.jsx)("option", { value: "other", children: "Other" })] }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "demand-description", value: formData.description, onChange: (e) => handleChange('description', e.target.value), placeholder: "Description" }), (0, jsx_runtime_1.jsxs)("select", { "data-testid": "demand-building", value: formData.buildingId, onChange: (e) => handleChange('buildingId', e.target.value), children: [(0, jsx_runtime_1.jsx)("option", { value: "", children: "Select Building (Optional)" }), (0, jsx_runtime_1.jsx)("option", { value: "123e4567-e89b-12d3-a456-426614174000", children: "Building A" })] }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "demand-submit", type: "submit", children: "Submit Demand" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(DemandForm, {}), { wrapper: TestWrapper });
            // Fill out form with optional building ID
            await user_event_1.default.selectOptions(react_1.screen.getByTestId('demand-type'), 'maintenance');
            await user_event_1.default.type(react_1.screen.getByTestId('demand-description'), 'The heating system needs repair urgently.');
            await user_event_1.default.selectOptions(react_1.screen.getByTestId('demand-building'), '123e4567-e89b-12d3-a456-426614174000');
            await user_event_1.default.click(react_1.screen.getByTestId('demand-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/demands', {
                    type: 'maintenance',
                    description: 'The heating system needs repair urgently.',
                    buildingId: '123e4567-e89b-12d3-a456-426614174000',
                    residenceId: undefined
                });
            });
            (0, globals_1.expect)(mockToast).toHaveBeenCalledWith({ title: 'Demand created successfully' });
        });
        (0, globals_1.it)('should submit demand without optional UUID fields', async () => {
            const DemandForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    type: 'information',
                    description: 'General inquiry about building policies.'
                });
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    await mockApiRequest('POST', '/api/demands', formData);
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "demand-form", children: [(0, jsx_runtime_1.jsx)("textarea", { "data-testid": "demand-description", value: formData.description, readOnly: true }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "demand-submit", type: "submit", children: "Submit" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(DemandForm, {}), { wrapper: TestWrapper });
            await user_event_1.default.click(react_1.screen.getByTestId('demand-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/demands', {
                    type: 'information',
                    description: 'General inquiry about building policies.'
                });
            });
        });
    });
    (0, globals_1.describe)('Document Management Form Submissions', () => {
        (0, globals_1.it)('should submit document upload form with file handling', async () => {
            const DocumentForm = () => {
                const [formData, setFormData] = react_2.default.useState({
                    name: '',
                    type: 'financial',
                    dateReference: '',
                    isVisibleToTenants: true
                });
                const [file, setFile] = react_2.default.useState(null);
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    if (!file) {
                        mockToast({ title: 'Please select a file', variant: 'destructive' });
                        return;
                    }
                    const formDataWithFile = new FormData();
                    Object.entries(formData).forEach(([key, value]) => {
                        formDataWithFile.append(key, value.toString());
                    });
                    formDataWithFile.append('file', file);
                    await mockApiRequest('POST', '/api/documents', formDataWithFile);
                    mockToast({ title: 'Document uploaded successfully' });
                };
                const handleFileChange = (e) => {
                    const selectedFile = e.target.files?.[0] || null;
                    setFile(selectedFile);
                };
                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "document-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "document-name", value: formData.name, onChange: (e) => handleChange('name', e.target.value), placeholder: "Document Name" }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "document-date", type: "date", value: formData.dateReference, onChange: (e) => handleChange('dateReference', e.target.value) }), (0, jsx_runtime_1.jsx)("input", { "data-testid": "document-file", type: "file", onChange: handleFileChange, accept: ".pdf,.doc,.docx,.jpg,.png" }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "document-submit", type: "submit", children: "Upload Document" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(DocumentForm, {}), { wrapper: TestWrapper });
            const file = new File(['dummy content'], 'test-document.pdf', { type: 'application/pdf' });
            await user_event_1.default.type(react_1.screen.getByTestId('document-name'), 'Annual Financial Report');
            await user_event_1.default.type(react_1.screen.getByTestId('document-date'), '2024-12-31');
            await user_event_1.default.upload(react_1.screen.getByTestId('document-file'), file);
            await user_event_1.default.click(react_1.screen.getByTestId('document-submit'));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockApiRequest).toHaveBeenCalledWith('POST', '/api/documents', globals_1.expect.any(FormData));
            });
            (0, globals_1.expect)(mockToast).toHaveBeenCalledWith({ title: 'Document uploaded successfully' });
        });
    });
    (0, globals_1.describe)('Edge Cases and Error Handling', () => {
        (0, globals_1.it)('should handle network errors gracefully', async () => {
            mockApiRequest.mockRejectedValue(new Error('Network error'));
            const TestForm = () => {
                const [error, setError] = react_2.default.useState('');
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    try {
                        await mockApiRequest('POST', '/api/test', { data: 'test' });
                    }
                    catch (err) {
                        setError(err.message);
                    }
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "test-form", children: [(0, jsx_runtime_1.jsx)("button", { "data-testid": "submit-button", type: "submit", children: "Submit" }), error && (0, jsx_runtime_1.jsx)("div", { "data-testid": "error-display", children: error })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestForm, {}), { wrapper: TestWrapper });
            await user_event_1.default.click(react_1.screen.getByTestId('submit-button'));
            await (0, react_1.waitFor)(() => {
                const errorElement = react_1.screen.getByTestId('error-display');
                (0, globals_1.expect)(errorElement.textContent).toBe('Network error');
            });
        });
        (0, globals_1.it)('should prevent multiple submissions', async () => {
            let submitCount = 0;
            mockApiRequest.mockImplementation(() => {
                submitCount++;
                return new Promise(resolve => setTimeout(resolve, 100));
            });
            const TestForm = () => {
                const [isSubmitting, setIsSubmitting] = react_2.default.useState(false);
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    if (isSubmitting)
                        return;
                    setIsSubmitting(true);
                    try {
                        await mockApiRequest('POST', '/api/test', { data: 'test' });
                    }
                    finally {
                        setIsSubmitting(false);
                    }
                };
                return ((0, jsx_runtime_1.jsx)("form", { onSubmit: handleSubmit, "data-testid": "test-form", children: (0, jsx_runtime_1.jsx)("button", { "data-testid": "submit-button", type: "submit", disabled: isSubmitting, children: isSubmitting ? 'Submitting...' : 'Submit' }) }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestForm, {}), { wrapper: TestWrapper });
            const submitButton = react_1.screen.getByTestId('submit-button');
            // Click multiple times rapidly
            await user_event_1.default.click(submitButton);
            await user_event_1.default.click(submitButton);
            await user_event_1.default.click(submitButton);
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(submitCount).toBe(1);
            });
        });
        (0, globals_1.it)('should handle form reset after successful submission', async () => {
            const TestForm = () => {
                const [value, setValue] = react_2.default.useState('');
                const [submitted, setSubmitted] = react_2.default.useState(false);
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    await mockApiRequest('POST', '/api/test', { value });
                    setValue(''); // Reset form
                    setSubmitted(true);
                };
                return ((0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, "data-testid": "test-form", children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "test-input", value: value, onChange: (e) => setValue(e.target.value) }), (0, jsx_runtime_1.jsx)("button", { "data-testid": "submit-button", type: "submit", children: "Submit" }), submitted && (0, jsx_runtime_1.jsx)("div", { "data-testid": "success-message", children: "Form submitted!" })] }));
            };
            (0, react_1.render)((0, jsx_runtime_1.jsx)(TestForm, {}), { wrapper: TestWrapper });
            const input = react_1.screen.getByTestId('test-input');
            const submitButton = react_1.screen.getByTestId('submit-button');
            await user_event_1.default.type(input, 'test value');
            (0, globals_1.expect)(input.value).toBe('test value');
            await user_event_1.default.click(submitButton);
            await (0, react_1.waitFor)(() => {
                const successElement = react_1.screen.getByTestId('success-message');
                (0, globals_1.expect)(successElement).toBeTruthy();
                (0, globals_1.expect)(input.value).toBe(''); // Form should be reset
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2NvbXByZWhlbnNpdmUtZm9ybS1zdWJtaXNzaW9uLXRlc3RzLnRlc3QudHN4IiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7O0dBYUc7QUFFSCwrQ0FBK0M7QUFDL0MsMkNBQXVFO0FBZ0N2RSxjQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEMsVUFBVSxFQUFFLGNBQWM7Q0FDM0IsQ0FBQyxDQUFDLENBQUM7QUFjSixjQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDbkMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLFFBQVE7Q0FDeEIsQ0FBQyxDQUFDLENBQUM7QUFJSixjQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUM7Q0FDdkMsQ0FBQyxDQUFDLENBQUM7QUFFSix3QkFBd0I7QUFDeEIsY0FBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN6QixXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0lBQ25DLElBQUksRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBK0MsRUFBRSxFQUFFLENBQUMsQ0FDekUsOEJBQUcsSUFBSSxFQUFFLElBQUksWUFBRyxRQUFRLEdBQUssQ0FDOUI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLHFCQUFxQjtBQUNyQixjQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdkMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDbEIsUUFBUSxF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Q0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQ3pDLEVBQ0Ysa0RBQW9CLGVBQWUsRUFBQyxJQUFJLEVBQUMsUUFBUSx1QkFFeEMsRUFDUixTQUFTLElBQUksK0NBQWlCLGlCQUFpQixnQ0FBc0IsSUFDakUsQ0FDUixDQUFDO1lBQ0osQ0FBQyxDQUFDO1lBRUYsSUFBQSxjQUFNLEVBQUMsdUJBQUMsUUFBUSxLQUFHLEVBQUUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUUvQyxNQUFNLEtBQUssR0FBRyxjQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQy9DLE1BQU0sWUFBWSxHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFekQsTUFBTSxvQkFBUyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFDMUMsSUFBQSxnQkFBTSxFQUFFLEtBQTBCLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRTdELE1BQU0sb0JBQVMsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFcEMsTUFBTSxJQUFBLGVBQU8sRUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLE1BQU0sY0FBYyxHQUFHLGNBQU0sQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsQ0FBQztnQkFDN0QsSUFBQSxnQkFBTSxFQUFDLGNBQWMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO2dCQUNwQyxJQUFBLGdCQUFNLEVBQUUsS0FBMEIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyx1QkFBdUI7WUFDN0UsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2NvbXByZWhlbnNpdmUtZm9ybS1zdWJtaXNzaW9uLXRlc3RzLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29tcHJlaGVuc2l2ZSBGb3JtIFN1Ym1pc3Npb24gVGVzdCBTdWl0ZVxuICogXG4gKiBUaGlzIHRlc3Qgc3VpdGUgdmFsaWRhdGVzIHRoYXQgQUxMIGZvcm1zIGluIHRoZSBLb3ZlbyBHZXN0aW9uIGFwcGxpY2F0aW9uXG4gKiBzdWJtaXQgY29ycmVjdGx5IHdpdGggcHJvcGVyIGRhdGEgaGFuZGxpbmcsIGVycm9yIG1hbmFnZW1lbnQsIGFuZCBBUEkgaW50ZWdyYXRpb24uXG4gKiBcbiAqIEZvcm1zIHRlc3RlZCBmb3IgYWN0dWFsIHN1Ym1pc3Npb24gYmVoYXZpb3I6XG4gKiAxLiBBdXRoZW50aWNhdGlvbiBGb3JtcyAobG9naW4sIHBhc3N3b3JkIHJlc2V0KVxuICogMi4gVXNlciBNYW5hZ2VtZW50IEZvcm1zIChpbnZpdGF0aW9ucywgcHJvZmlsZSB1cGRhdGVzKVxuICogMy4gUHJvcGVydHkgTWFuYWdlbWVudCBGb3JtcyAoYnVpbGRpbmdzLCByZXNpZGVuY2VzKVxuICogNC4gRmluYW5jaWFsIEZvcm1zIChiaWxscywgcGF5bWVudHMpXG4gKiA1LiBEb2N1bWVudCBGb3JtcyAodXBsb2FkLCBjYXRlZ29yaXphdGlvbilcbiAqIDYuIE1haW50ZW5hbmNlIEZvcm1zIChkZW1hbmRzLCBidWcgcmVwb3J0cylcbiAqL1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwZXMvamVzdC1kb20uZC50c1wiIC8+XG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgamVzdCwgYmVmb3JlRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIGZpcmVFdmVudCwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUNsaWVudFByb3ZpZGVyIH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbi8vIFRlc3QgdXRpbGl0aWVzXG5jb25zdCBjcmVhdGVUZXN0UXVlcnlDbGllbnQgPSAoKSA9PiB7XG4gIHJldHVybiBuZXcgUXVlcnlDbGllbnQoe1xuICAgIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgICBxdWVyaWVzOiB7XG4gICAgICAgIHJldHJ5OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICBtdXRhdGlvbnM6IHtcbiAgICAgICAgcmV0cnk6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbn07XG5cbmNvbnN0IFRlc3RXcmFwcGVyOiBSZWFjdC5GQzx7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfT4gPSAoeyBjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gY3JlYXRlVGVzdFF1ZXJ5Q2xpZW50KCk7XG4gIHJldHVybiAoXG4gICAgPFF1ZXJ5Q2xpZW50UHJvdmlkZXIgY2xpZW50PXtxdWVyeUNsaWVudH0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9RdWVyeUNsaWVudFByb3ZpZGVyPlxuICApO1xufTtcblxuLy8gTW9jayBBUEkgcmVxdWVzdCBmdW5jdGlvblxuY29uc3QgbW9ja0FwaVJlcXVlc3QgPSBqZXN0LmZuKCk7XG5qZXN0Lm1vY2soJ0AvbGliL3F1ZXJ5Q2xpZW50JywgKCkgPT4gKHtcbiAgYXBpUmVxdWVzdDogbW9ja0FwaVJlcXVlc3QsXG59KSk7XG5cbi8vIE1vY2sgYXV0aGVudGljYXRpb24gaG9va1xuY29uc3QgbW9ja0F1dGggPSB7XG4gIHVzZXI6IHtcbiAgICBpZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICByb2xlOiAnYWRtaW4nLFxuICAgIG9yZ2FuaXphdGlvbklkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJ1xuICB9LFxuICBsb2dpbjogamVzdC5mbigpLFxuICBsb2dvdXQ6IGplc3QuZm4oKSxcbn07XG5cbmplc3QubW9jaygnQC9ob29rcy91c2UtYXV0aCcsICgpID0+ICh7XG4gIHVzZUF1dGg6ICgpID0+IG1vY2tBdXRoLFxufSkpO1xuXG4vLyBNb2NrIHRvYXN0IGhvb2tcbmNvbnN0IG1vY2tUb2FzdCA9IGplc3QuZm4oKTtcbmplc3QubW9jaygnQC9ob29rcy91c2UtdG9hc3QnLCAoKSA9PiAoe1xuICB1c2VUb2FzdDogKCkgPT4gKHsgdG9hc3Q6IG1vY2tUb2FzdCB9KSxcbn0pKTtcblxuLy8gTW9jayB1c2VMb2NhdGlvbiBob29rXG5qZXN0Lm1vY2soJ3dvdXRlcicsICgpID0+ICh7XG4gIHVzZUxvY2F0aW9uOiAoKSA9PiBbJy8nLCBqZXN0LmZuKCldLFxuICBMaW5rOiAoeyBjaGlsZHJlbiwgaHJlZiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7IGhyZWY6IHN0cmluZyB9KSA9PiAoXG4gICAgPGEgaHJlZj17aHJlZn0+e2NoaWxkcmVufTwvYT5cbiAgKSxcbn0pKTtcblxuLy8gTW9jayBsYW5ndWFnZSBob29rXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLWxhbmd1YWdlJywgKCkgPT4gKHtcbiAgdXNlTGFuZ3VhZ2U6ICgpID0+ICh7XG4gICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgdDogKGtleTogc3RyaW5nKSA9PiBrZXksXG4gICAgY2hhbmdlTGFuZ3VhZ2U6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbmRlc2NyaWJlKCdDb21wcmVoZW5zaXZlIEZvcm0gU3VibWlzc2lvbiBUZXN0cycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgKG1vY2tBcGlSZXF1ZXN0IGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PikubW9ja1Jlc29sdmVkVmFsdWUoeyBzdWNjZXNzOiB0cnVlIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQXV0aGVudGljYXRpb24gRm9ybSBTdWJtaXNzaW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1Ym1pdCBsb2dpbiBmb3JtIHdpdGggY29ycmVjdCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgbG9naW4gY29tcG9uZW50XG4gICAgICBjb25zdCBMb2dpbkZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtlbWFpbCwgc2V0RW1haWxdID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICAgICAgICBjb25zdCBbcGFzc3dvcmQsIHNldFBhc3N3b3JkXSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgICAgICAgY29uc3QgW2lzU3VibWl0dGluZywgc2V0SXNTdWJtaXR0aW5nXSA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAoZTogUmVhY3QuRm9ybUV2ZW50KSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHNldElzU3VibWl0dGluZyh0cnVlKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbW9ja0FwaVJlcXVlc3QoJ1BPU1QnLCAnL2FwaS9hdXRoL2xvZ2luJywgeyBlbWFpbCwgcGFzc3dvcmQgfSk7XG4gICAgICAgICAgICBtb2NrQXV0aC5sb2dpbih7IGVtYWlsLCBwYXNzd29yZCB9KTtcbiAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgc2V0SXNTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0fSBkYXRhLXRlc3RpZD1cImxvZ2luLWZvcm1cIj5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImVtYWlsLWlucHV0XCJcbiAgICAgICAgICAgICAgdHlwZT1cImVtYWlsXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2VtYWlsfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEVtYWlsKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbWFpbFwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwicGFzc3dvcmQtaW5wdXRcIlxuICAgICAgICAgICAgICB0eXBlPVwicGFzc3dvcmRcIlxuICAgICAgICAgICAgICB2YWx1ZT17cGFzc3dvcmR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0UGFzc3dvcmQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwibG9naW4tc3VibWl0XCJcbiAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc1N1Ym1pdHRpbmd9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpc1N1Ym1pdHRpbmcgPyAnTG9nZ2luZyBpbi4uLicgOiAnTG9naW4nfVxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgcmVuZGVyKDxMb2dpbkZvcm0gLz4sIHsgd3JhcHBlcjogVGVzdFdyYXBwZXIgfSk7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2VtYWlsLWlucHV0Jyk7XG4gICAgICBjb25zdCBwYXNzd29yZElucHV0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdwYXNzd29yZC1pbnB1dCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdsb2dpbi1zdWJtaXQnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoZW1haWxJbnB1dCwgJ3Rlc3RAZXhhbXBsZS5jb20nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHBhc3N3b3JkSW5wdXQsICd2YWxpZFBhc3N3b3JkMTIzJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1BPU1QnLCAnL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICd2YWxpZFBhc3N3b3JkMTIzJ1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja0F1dGgubG9naW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICd2YWxpZFBhc3N3b3JkMTIzJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsb2dpbiBmb3JtIHZhbGlkYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKG1vY2tBcGlSZXF1ZXN0IGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PikubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdJbnZhbGlkIGNyZWRlbnRpYWxzJykpO1xuXG4gICAgICBjb25zdCBMb2dpbkZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtlbWFpbCwgc2V0RW1haWxdID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICAgICAgICBjb25zdCBbcGFzc3dvcmQsIHNldFBhc3N3b3JkXSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgICAgICAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbW9ja0FwaVJlcXVlc3QoJ1BPU1QnLCAnL2FwaS9hdXRoL2xvZ2luJywgeyBlbWFpbCwgcGFzc3dvcmQgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgICAgIHNldEVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0fSBkYXRhLXRlc3RpZD1cImxvZ2luLWZvcm1cIj5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImVtYWlsLWlucHV0XCJcbiAgICAgICAgICAgICAgdHlwZT1cImVtYWlsXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2VtYWlsfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEVtYWlsKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJwYXNzd29yZC1pbnB1dFwiXG4gICAgICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiXG4gICAgICAgICAgICAgIHZhbHVlPXtwYXNzd29yZH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRQYXNzd29yZChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLXRlc3RpZD1cImxvZ2luLXN1Ym1pdFwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgTG9naW5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAge2Vycm9yICYmIDxkaXYgZGF0YS10ZXN0aWQ9XCJlcnJvci1tZXNzYWdlXCI+e2Vycm9yfTwvZGl2Pn1cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPExvZ2luRm9ybSAvPiwgeyB3cmFwcGVyOiBUZXN0V3JhcHBlciB9KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZW1haWwtaW5wdXQnKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3Bhc3N3b3JkLWlucHV0Jyk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2xvZ2luLXN1Ym1pdCcpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShlbWFpbElucHV0LCAnd3JvbmdAZXhhbXBsZS5jb20nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHBhc3N3b3JkSW5wdXQsICd3cm9uZ3Bhc3N3b3JkJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnZXJyb3ItbWVzc2FnZScpO1xuICAgICAgICBleHBlY3QoZXJyb3JFbGVtZW50LnRleHRDb250ZW50KS50b0JlKCdJbnZhbGlkIGNyZWRlbnRpYWxzJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Byb3BlcnR5IE1hbmFnZW1lbnQgRm9ybSBTdWJtaXNzaW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1Ym1pdCBidWlsZGluZyBjcmVhdGlvbiBmb3JtIHdpdGggdmFsaWQgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IEJ1aWxkaW5nRm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6ICcnLFxuICAgICAgICAgIGFkZHJlc3M6ICcnLFxuICAgICAgICAgIGNpdHk6ICcnLFxuICAgICAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgICAgIHBvc3RhbENvZGU6ICcnLFxuICAgICAgICAgIGJ1aWxkaW5nVHlwZTogJ2NvbmRvJyxcbiAgICAgICAgICB0b3RhbFVuaXRzOiAwXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jIChlOiBSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYXdhaXQgbW9ja0FwaVJlcXVlc3QoJ1BPU1QnLCAnL2FwaS9idWlsZGluZ3MnLCBmb3JtRGF0YSk7XG4gICAgICAgICAgbW9ja1RvYXN0KHsgdGl0bGU6ICdCdWlsZGluZyBjcmVhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gKGZpZWxkOiBzdHJpbmcsIHZhbHVlOiBhbnkpID0+IHtcbiAgICAgICAgICBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIFtmaWVsZF06IHZhbHVlIH0pKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9IGRhdGEtdGVzdGlkPVwiYnVpbGRpbmctZm9ybVwiPlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnVpbGRpbmctbmFtZVwiXG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS5uYW1lfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgnbmFtZScsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJCdWlsZGluZyBOYW1lXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwib3JnYW5pemF0aW9uLXNlbGVjdFwiXG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS5vcmdhbml6YXRpb25JZH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoJ29yZ2FuaXphdGlvbklkJywgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+U2VsZWN0IE9yZ2FuaXphdGlvbjwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxXCI+VGVzdCBPcmc8L29wdGlvbj5cbiAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnVpbGRpbmctYWRkcmVzc1wiXG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS5hZGRyZXNzfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgnYWRkcmVzcycsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBZGRyZXNzXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidWlsZGluZy1jaXR5XCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLmNpdHl9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlQ2hhbmdlKCdjaXR5JywgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkNpdHlcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1aWxkaW5nLXBvc3RhbGNvZGVcIlxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEucG9zdGFsQ29kZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoJ3Bvc3RhbENvZGUnLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiUG9zdGFsIENvZGVcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1aWxkaW5nLXVuaXRzXCJcbiAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS50b3RhbFVuaXRzfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgndG90YWxVbml0cycsIHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKSB8fCAwKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJUb3RhbCBVbml0c1wiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLXRlc3RpZD1cImJ1aWxkaW5nLXN1Ym1pdFwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgQ3JlYXRlIEJ1aWxkaW5nXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPEJ1aWxkaW5nRm9ybSAvPiwgeyB3cmFwcGVyOiBUZXN0V3JhcHBlciB9KTtcblxuICAgICAgLy8gRmlsbCBvdXQgdGhlIGZvcm1cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVpbGRpbmctbmFtZScpLCAnU3Vuc2V0IFRvd2VycycpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnNlbGVjdE9wdGlvbnMoc2NyZWVuLmdldEJ5VGVzdElkKCdvcmdhbml6YXRpb24tc2VsZWN0JyksICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVpbGRpbmctYWRkcmVzcycpLCAnNDU2IE1haW4gU3RyZWV0Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1aWxkaW5nLWNpdHknKSwgJ01vbnRyZWFsJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1aWxkaW5nLXBvc3RhbGNvZGUnKSwgJ0gzQSAxQjEnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGVhcihzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1aWxkaW5nLXVuaXRzJykpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoc2NyZWVuLmdldEJ5VGVzdElkKCdidWlsZGluZy11bml0cycpLCAnNTAnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVpbGRpbmctc3VibWl0JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnUE9TVCcsICcvYXBpL2J1aWxkaW5ncycsIHtcbiAgICAgICAgICBuYW1lOiAnU3Vuc2V0IFRvd2VycycsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnLFxuICAgICAgICAgIGFkZHJlc3M6ICc0NTYgTWFpbiBTdHJlZXQnLFxuICAgICAgICAgIGNpdHk6ICdNb250cmVhbCcsXG4gICAgICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICAgICAgcG9zdGFsQ29kZTogJ0gzQSAxQjEnLFxuICAgICAgICAgIGJ1aWxkaW5nVHlwZTogJ2NvbmRvJyxcbiAgICAgICAgICB0b3RhbFVuaXRzOiA1MFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1RvYXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHRpdGxlOiAnQnVpbGRpbmcgY3JlYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRmluYW5jaWFsIEZvcm0gU3VibWlzc2lvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgYmlsbCBjcmVhdGlvbiBmb3JtIHdpdGggcHJvcGVyIGFtb3VudCB2YWxpZGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgQmlsbEZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgICAgICAgIHRpdGxlOiAnJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ3V0aWxpdGllcycsXG4gICAgICAgICAgcGF5bWVudFR5cGU6ICd1bmlxdWUnLFxuICAgICAgICAgIHRvdGFsQW1vdW50OiAnJyxcbiAgICAgICAgICBzdGFydERhdGU6ICcnLFxuICAgICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAoZTogUmVhY3QuRm9ybUV2ZW50KSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFZhbGlkYXRlIGFtb3VudFxuICAgICAgICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlRmxvYXQoZm9ybURhdGEudG90YWxBbW91bnQpO1xuICAgICAgICAgIGlmIChpc05hTihhbW91bnQpIHx8IGFtb3VudCA8PSAwKSB7XG4gICAgICAgICAgICBtb2NrVG9hc3QoeyB0aXRsZTogJ0ludmFsaWQgYW1vdW50JywgdmFyaWFudDogJ2Rlc3RydWN0aXZlJyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL2JpbGxzJywgZm9ybURhdGEpO1xuICAgICAgICAgIG1vY2tUb2FzdCh7IHRpdGxlOiAnQmlsbCBjcmVhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gKGZpZWxkOiBzdHJpbmcsIHZhbHVlOiBhbnkpID0+IHtcbiAgICAgICAgICBzZXRGb3JtRGF0YShwcmV2ID0+ICh7IC4uLnByZXYsIFtmaWVsZF06IHZhbHVlIH0pKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9IGRhdGEtdGVzdGlkPVwiYmlsbC1mb3JtXCI+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJiaWxsLXRpdGxlXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnRpdGxlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgndGl0bGUnLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQmlsbCBUaXRsZVwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYmlsbC1hbW91bnRcIlxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEudG90YWxBbW91bnR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlQ2hhbmdlKCd0b3RhbEFtb3VudCcsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBbW91bnRcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJpbGwtZGF0ZVwiXG4gICAgICAgICAgICAgIHR5cGU9XCJkYXRlXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnN0YXJ0RGF0ZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoJ3N0YXJ0RGF0ZScsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwiYmlsbC1zdWJtaXRcIiB0eXBlPVwic3VibWl0XCI+XG4gICAgICAgICAgICAgIENyZWF0ZSBCaWxsXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPEJpbGxGb3JtIC8+LCB7IHdyYXBwZXI6IFRlc3RXcmFwcGVyIH0pO1xuXG4gICAgICAvLyBUZXN0IHZhbGlkIHN1Ym1pc3Npb25cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHNjcmVlbi5nZXRCeVRlc3RJZCgnYmlsbC10aXRsZScpLCAnTW9udGhseSBFbGVjdHJpY2l0eScpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUoc2NyZWVuLmdldEJ5VGVzdElkKCdiaWxsLWFtb3VudCcpLCAnMTUwLjc1Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2JpbGwtZGF0ZScpLCAnMjAyNS0wMS0wMScpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGVzdElkKCdiaWxsLXN1Ym1pdCcpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1BPU1QnLCAnL2FwaS9iaWxscycsIHtcbiAgICAgICAgICB0aXRsZTogJ01vbnRobHkgRWxlY3RyaWNpdHknLFxuICAgICAgICAgIGNhdGVnb3J5OiAndXRpbGl0aWVzJyxcbiAgICAgICAgICBwYXltZW50VHlwZTogJ3VuaXF1ZScsXG4gICAgICAgICAgdG90YWxBbW91bnQ6ICcxNTAuNzUnLFxuICAgICAgICAgIHN0YXJ0RGF0ZTogJzIwMjUtMDEtMDEnLFxuICAgICAgICAgIHN0YXR1czogJ2RyYWZ0J1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1RvYXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHRpdGxlOiAnQmlsbCBjcmVhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIGJpbGwgYW1vdW50IHN1Ym1pc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBCaWxsRm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0IEJpbGwnLFxuICAgICAgICAgIHRvdGFsQW1vdW50OiAnJ1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAoZTogUmVhY3QuRm9ybUV2ZW50KSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlRmxvYXQoZm9ybURhdGEudG90YWxBbW91bnQpO1xuICAgICAgICAgIGlmIChpc05hTihhbW91bnQpIHx8IGFtb3VudCA8PSAwKSB7XG4gICAgICAgICAgICBtb2NrVG9hc3QoeyB0aXRsZTogJ0ludmFsaWQgYW1vdW50JywgdmFyaWFudDogJ2Rlc3RydWN0aXZlJyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL2JpbGxzJywgZm9ybURhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gZGF0YS10ZXN0aWQ9XCJiaWxsLWZvcm1cIj5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJpbGwtYW1vdW50XCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnRvdGFsQW1vdW50fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgdG90YWxBbW91bnQ6IGUudGFyZ2V0LnZhbHVlIH0pKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBbW91bnRcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxidXR0b24gZGF0YS10ZXN0aWQ9XCJiaWxsLXN1Ym1pdFwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgQ3JlYXRlIEJpbGxcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgIHJlbmRlcig8QmlsbEZvcm0gLz4sIHsgd3JhcHBlcjogVGVzdFdyYXBwZXIgfSk7XG5cbiAgICAgIC8vIFRlc3QgaW52YWxpZCBhbW91bnRcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHNjcmVlbi5nZXRCeVRlc3RJZCgnYmlsbC1hbW91bnQnKSwgJy01MCcpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRlc3RJZCgnYmlsbC1zdWJtaXQnKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja1RvYXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IFxuICAgICAgICAgIHRpdGxlOiAnSW52YWxpZCBhbW91bnQnLCBcbiAgICAgICAgICB2YXJpYW50OiAnZGVzdHJ1Y3RpdmUnIFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja0FwaVJlcXVlc3QpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNYWludGVuYW5jZSBGb3JtIFN1Ym1pc3Npb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3VibWl0IGRlbWFuZCBjcmVhdGlvbiBmb3JtIHdpdGggVVVJRCBoYW5kbGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IERlbWFuZEZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgICAgICAgIHR5cGU6ICdtYWludGVuYW5jZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICAgIGJ1aWxkaW5nSWQ6ICcnLFxuICAgICAgICAgIHJlc2lkZW5jZUlkOiAnJ1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAoZTogUmVhY3QuRm9ybUV2ZW50KSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIENvbnZlcnQgZW1wdHkgc3RyaW5ncyB0byB1bmRlZmluZWQgZm9yIG9wdGlvbmFsIFVVSUQgZmllbGRzXG4gICAgICAgICAgY29uc3Qgc3VibWlzc2lvbkRhdGEgPSB7XG4gICAgICAgICAgICAuLi5mb3JtRGF0YSxcbiAgICAgICAgICAgIGJ1aWxkaW5nSWQ6IGZvcm1EYXRhLmJ1aWxkaW5nSWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgcmVzaWRlbmNlSWQ6IGZvcm1EYXRhLnJlc2lkZW5jZUlkIHx8IHVuZGVmaW5lZFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL2RlbWFuZHMnLCBzdWJtaXNzaW9uRGF0YSk7XG4gICAgICAgICAgbW9ja1RvYXN0KHsgdGl0bGU6ICdEZW1hbmQgY3JlYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9IChmaWVsZDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgICAgICAgc2V0Rm9ybURhdGEocHJldiA9PiAoeyAuLi5wcmV2LCBbZmllbGRdOiB2YWx1ZSB9KSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0fSBkYXRhLXRlc3RpZD1cImRlbWFuZC1mb3JtXCI+XG4gICAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiZGVtYW5kLXR5cGVcIlxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEudHlwZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoJ3R5cGUnLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJtYWludGVuYW5jZVwiPk1haW50ZW5hbmNlPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJjb21wbGFpbnRcIj5Db21wbGFpbnQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cImluZm9ybWF0aW9uXCI+SW5mb3JtYXRpb248L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIm90aGVyXCI+T3RoZXI8L29wdGlvbj5cbiAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiZGVtYW5kLWRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgnZGVzY3JpcHRpb24nLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRGVzY3JpcHRpb25cIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxzZWxlY3RcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJkZW1hbmQtYnVpbGRpbmdcIlxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEuYnVpbGRpbmdJZH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBoYW5kbGVDaGFuZ2UoJ2J1aWxkaW5nSWQnLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj5TZWxlY3QgQnVpbGRpbmcgKE9wdGlvbmFsKTwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwXCI+QnVpbGRpbmcgQTwvb3B0aW9uPlxuICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwiZGVtYW5kLXN1Ym1pdFwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgU3VibWl0IERlbWFuZFxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgcmVuZGVyKDxEZW1hbmRGb3JtIC8+LCB7IHdyYXBwZXI6IFRlc3RXcmFwcGVyIH0pO1xuXG4gICAgICAvLyBGaWxsIG91dCBmb3JtIHdpdGggb3B0aW9uYWwgYnVpbGRpbmcgSURcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5zZWxlY3RPcHRpb25zKHNjcmVlbi5nZXRCeVRlc3RJZCgnZGVtYW5kLXR5cGUnKSwgJ21haW50ZW5hbmNlJyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2RlbWFuZC1kZXNjcmlwdGlvbicpLCAnVGhlIGhlYXRpbmcgc3lzdGVtIG5lZWRzIHJlcGFpciB1cmdlbnRseS4nKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5zZWxlY3RPcHRpb25zKHNjcmVlbi5nZXRCeVRlc3RJZCgnZGVtYW5kLWJ1aWxkaW5nJyksICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRlc3RJZCgnZGVtYW5kLXN1Ym1pdCcpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1BPU1QnLCAnL2FwaS9kZW1hbmRzJywge1xuICAgICAgICAgIHR5cGU6ICdtYWludGVuYW5jZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdUaGUgaGVhdGluZyBzeXN0ZW0gbmVlZHMgcmVwYWlyIHVyZ2VudGx5LicsXG4gICAgICAgICAgYnVpbGRpbmdJZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gICAgICAgICAgcmVzaWRlbmNlSWQ6IHVuZGVmaW5lZFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1RvYXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHRpdGxlOiAnRGVtYW5kIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VibWl0IGRlbWFuZCB3aXRob3V0IG9wdGlvbmFsIFVVSUQgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgRGVtYW5kRm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICAgICAgdHlwZTogJ2luZm9ybWF0aW9uJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0dlbmVyYWwgaW5xdWlyeSBhYm91dCBidWlsZGluZyBwb2xpY2llcy4nXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jIChlOiBSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYXdhaXQgbW9ja0FwaVJlcXVlc3QoJ1BPU1QnLCAnL2FwaS9kZW1hbmRzJywgZm9ybURhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gZGF0YS10ZXN0aWQ9XCJkZW1hbmQtZm9ybVwiPlxuICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiZGVtYW5kLWRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICByZWFkT25seVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxidXR0b24gZGF0YS10ZXN0aWQ9XCJkZW1hbmQtc3VibWl0XCIgdHlwZT1cInN1Ym1pdFwiPlxuICAgICAgICAgICAgICBTdWJtaXRcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICAgIHJlbmRlcig8RGVtYW5kRm9ybSAvPiwgeyB3cmFwcGVyOiBUZXN0V3JhcHBlciB9KTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRlc3RJZCgnZGVtYW5kLXN1Ym1pdCcpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1BPU1QnLCAnL2FwaS9kZW1hbmRzJywge1xuICAgICAgICAgIHR5cGU6ICdpbmZvcm1hdGlvbicsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdHZW5lcmFsIGlucXVpcnkgYWJvdXQgYnVpbGRpbmcgcG9saWNpZXMuJ1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRG9jdW1lbnQgTWFuYWdlbWVudCBGb3JtIFN1Ym1pc3Npb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3VibWl0IGRvY3VtZW50IHVwbG9hZCBmb3JtIHdpdGggZmlsZSBoYW5kbGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IERvY3VtZW50Rm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgdHlwZTogJ2ZpbmFuY2lhbCcsXG4gICAgICAgICAgZGF0ZVJlZmVyZW5jZTogJycsXG4gICAgICAgICAgaXNWaXNpYmxlVG9UZW5hbnRzOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBbZmlsZSwgc2V0RmlsZV0gPSBSZWFjdC51c2VTdGF0ZTxGaWxlIHwgbnVsbD4obnVsbCk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIG1vY2tUb2FzdCh7IHRpdGxlOiAnUGxlYXNlIHNlbGVjdCBhIGZpbGUnLCB2YXJpYW50OiAnZGVzdHJ1Y3RpdmUnIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGZvcm1EYXRhV2l0aEZpbGUgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgICBPYmplY3QuZW50cmllcyhmb3JtRGF0YSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICBmb3JtRGF0YVdpdGhGaWxlLmFwcGVuZChrZXksIHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGZvcm1EYXRhV2l0aEZpbGUuYXBwZW5kKCdmaWxlJywgZmlsZSk7XG5cbiAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL2RvY3VtZW50cycsIGZvcm1EYXRhV2l0aEZpbGUpO1xuICAgICAgICAgIG1vY2tUb2FzdCh7IHRpdGxlOiAnRG9jdW1lbnQgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGaWxlID0gZS50YXJnZXQuZmlsZXM/LlswXSB8fCBudWxsO1xuICAgICAgICAgIHNldEZpbGUoc2VsZWN0ZWRGaWxlKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSAoZmllbGQ6IHN0cmluZywgdmFsdWU6IGFueSkgPT4ge1xuICAgICAgICAgIHNldEZvcm1EYXRhKHByZXYgPT4gKHsgLi4ucHJldiwgW2ZpZWxkXTogdmFsdWUgfSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gZGF0YS10ZXN0aWQ9XCJkb2N1bWVudC1mb3JtXCI+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJkb2N1bWVudC1uYW1lXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLm5hbWV9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlQ2hhbmdlKCduYW1lJywgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkRvY3VtZW50IE5hbWVcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImRvY3VtZW50LWRhdGVcIlxuICAgICAgICAgICAgICB0eXBlPVwiZGF0ZVwiXG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS5kYXRlUmVmZXJlbmNlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNoYW5nZSgnZGF0ZVJlZmVyZW5jZScsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJkb2N1bWVudC1maWxlXCJcbiAgICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlRmlsZUNoYW5nZX1cbiAgICAgICAgICAgICAgYWNjZXB0PVwiLnBkZiwuZG9jLC5kb2N4LC5qcGcsLnBuZ1wiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLXRlc3RpZD1cImRvY3VtZW50LXN1Ym1pdFwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgVXBsb2FkIERvY3VtZW50XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPERvY3VtZW50Rm9ybSAvPiwgeyB3cmFwcGVyOiBUZXN0V3JhcHBlciB9KTtcblxuICAgICAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFsnZHVtbXkgY29udGVudCddLCAndGVzdC1kb2N1bWVudC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2RvY3VtZW50LW5hbWUnKSwgJ0FubnVhbCBGaW5hbmNpYWwgUmVwb3J0Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZShzY3JlZW4uZ2V0QnlUZXN0SWQoJ2RvY3VtZW50LWRhdGUnKSwgJzIwMjQtMTItMzEnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC51cGxvYWQoc2NyZWVuLmdldEJ5VGVzdElkKCdkb2N1bWVudC1maWxlJyksIGZpbGUpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGVzdElkKCdkb2N1bWVudC1zdWJtaXQnKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0FwaVJlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdQT1NUJywgJy9hcGkvZG9jdW1lbnRzJywgZXhwZWN0LmFueShGb3JtRGF0YSkpO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrVG9hc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgdGl0bGU6ICdEb2N1bWVudCB1cGxvYWRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRWRnZSBDYXNlcyBhbmQgRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrQXBpUmVxdWVzdCBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT4pLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKTtcblxuICAgICAgY29uc3QgVGVzdEZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gUmVhY3QudXNlU3RhdGUoJycpO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jIChlOiBSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG1vY2tBcGlSZXF1ZXN0KCdQT1NUJywgJy9hcGkvdGVzdCcsIHsgZGF0YTogJ3Rlc3QnIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgICBzZXRFcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gZGF0YS10ZXN0aWQ9XCJ0ZXN0LWZvcm1cIj5cbiAgICAgICAgICAgIDxidXR0b24gZGF0YS10ZXN0aWQ9XCJzdWJtaXQtYnV0dG9uXCIgdHlwZT1cInN1Ym1pdFwiPlxuICAgICAgICAgICAgICBTdWJtaXRcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAge2Vycm9yICYmIDxkaXYgZGF0YS10ZXN0aWQ9XCJlcnJvci1kaXNwbGF5XCI+e2Vycm9yfTwvZGl2Pn1cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPFRlc3RGb3JtIC8+LCB7IHdyYXBwZXI6IFRlc3RXcmFwcGVyIH0pO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGVzdElkKCdzdWJtaXQtYnV0dG9uJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdlcnJvci1kaXNwbGF5Jyk7XG4gICAgICAgIGV4cGVjdChlcnJvckVsZW1lbnQudGV4dENvbnRlbnQpLnRvQmUoJ05ldHdvcmsgZXJyb3InKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IG11bHRpcGxlIHN1Ym1pc3Npb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHN1Ym1pdENvdW50ID0gMDtcbiAgICAgIChtb2NrQXBpUmVxdWVzdCBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPGFueT4pLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHN1Ym1pdENvdW50Kys7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgVGVzdEZvcm0gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IFtpc1N1Ym1pdHRpbmcsIHNldElzU3VibWl0dGluZ10gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBpZiAoaXNTdWJtaXR0aW5nKSByZXR1cm47XG4gICAgICAgICAgXG4gICAgICAgICAgc2V0SXNTdWJtaXR0aW5nKHRydWUpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL3Rlc3QnLCB7IGRhdGE6ICd0ZXN0JyB9KTtcbiAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgc2V0SXNTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0fSBkYXRhLXRlc3RpZD1cInRlc3QtZm9ybVwiPlxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cInN1Ym1pdC1idXR0b25cIlxuICAgICAgICAgICAgICB0eXBlPVwic3VibWl0XCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzU3VibWl0dGluZ31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2lzU3VibWl0dGluZyA/ICdTdWJtaXR0aW5nLi4uJyA6ICdTdWJtaXQnfVxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgcmVuZGVyKDxUZXN0Rm9ybSAvPiwgeyB3cmFwcGVyOiBUZXN0V3JhcHBlciB9KTtcblxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdzdWJtaXQtYnV0dG9uJyk7XG4gICAgICBcbiAgICAgIC8vIENsaWNrIG11bHRpcGxlIHRpbWVzIHJhcGlkbHlcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzdWJtaXRDb3VudCkudG9CZSgxKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZm9ybSByZXNldCBhZnRlciBzdWNjZXNzZnVsIHN1Ym1pc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBUZXN0Rm9ybSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW3ZhbHVlLCBzZXRWYWx1ZV0gPSBSZWFjdC51c2VTdGF0ZSgnJyk7XG4gICAgICAgIGNvbnN0IFtzdWJtaXR0ZWQsIHNldFN1Ym1pdHRlZF0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBhd2FpdCBtb2NrQXBpUmVxdWVzdCgnUE9TVCcsICcvYXBpL3Rlc3QnLCB7IHZhbHVlIH0pO1xuICAgICAgICAgIHNldFZhbHVlKCcnKTsgLy8gUmVzZXQgZm9ybVxuICAgICAgICAgIHNldFN1Ym1pdHRlZCh0cnVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9IGRhdGEtdGVzdGlkPVwidGVzdC1mb3JtXCI+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJ0ZXN0LWlucHV0XCJcbiAgICAgICAgICAgICAgdmFsdWU9e3ZhbHVlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFZhbHVlKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwic3VibWl0LWJ1dHRvblwiIHR5cGU9XCJzdWJtaXRcIj5cbiAgICAgICAgICAgICAgU3VibWl0XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIHtzdWJtaXR0ZWQgJiYgPGRpdiBkYXRhLXRlc3RpZD1cInN1Y2Nlc3MtbWVzc2FnZVwiPkZvcm0gc3VibWl0dGVkITwvZGl2Pn1cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoPFRlc3RGb3JtIC8+LCB7IHdyYXBwZXI6IFRlc3RXcmFwcGVyIH0pO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgndGVzdC1pbnB1dCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdzdWJtaXQtYnV0dG9uJyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKGlucHV0LCAndGVzdCB2YWx1ZScpO1xuICAgICAgZXhwZWN0KChpbnB1dCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSkudG9CZSgndGVzdCB2YWx1ZScpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1Y2Nlc3NFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdzdWNjZXNzLW1lc3NhZ2UnKTtcbiAgICAgICAgZXhwZWN0KHN1Y2Nlc3NFbGVtZW50KS50b0JlVHJ1dGh5KCk7XG4gICAgICAgIGV4cGVjdCgoaW5wdXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUpLnRvQmUoJycpOyAvLyBGb3JtIHNob3VsZCBiZSByZXNldFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=
3ba442045361e0c5e5a4737de6286b5f
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = ModularDocumentPageWrapper;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const react_query_1 = require("@tanstack/react-query");
const wouter_1 = require("wouter");
const lucide_react_1 = require("lucide-react");
const button_1 = require("@/components/ui/button");
const input_1 = require("@/components/ui/input");
const card_1 = require("@/components/ui/card");
const badge_1 = require("@/components/ui/badge");
const select_1 = require("@/components/ui/select");
const dialog_1 = require("@/components/ui/dialog");
const label_1 = require("@/components/ui/label");
const queryClient_1 = require("@/lib/queryClient");
const use_language_1 = require("@/hooks/use-language");
const document_management_1 = require("@/components/document-management");
const DocumentCreateForm_1 = require("@/components/document-management/DocumentCreateForm");
const lucide_react_2 = require("lucide-react");
function DocumentViewDialog({ documentId, isOpen, onClose, onEdit, canEdit }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleDownload = async () => {
        console.log('[DOWNLOAD] Starting download for document:', documentId);
        try {
            // Use fetch with credentials to ensure authentication
            const response = await fetch(`/api/documents/${documentId}/file?download=true`, {
                method: 'GET',
                credentials: 'include', // Include authentication cookies
            });
            if (!response.ok) {
                throw new Error(`Download failed: ${response.status} ${response.statusText}`);
            }
            // Get the filename from Content-Disposition header or use document name
            const contentDisposition = response.headers.get('Content-Disposition');
            let fileName = document?.name || 'document';
            if (contentDisposition) {
                const fileNameMatch = contentDisposition.match(/filename="([^"]+)"/);
                if (fileNameMatch) {
                    fileName = fileNameMatch[1];
                }
            }
            // Convert response to blob and create download
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            // Clean up
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            console.log('[DOWNLOAD] Download completed successfully');
        }
        catch (error) {
            console.error('[DOWNLOAD] Download failed:', error);
            // You might want to show a toast notification here
        }
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-2xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Document Details" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-2 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Document Name" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.name })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600 capitalize", children: document.category || document.documentType || 'Other' })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Upload Date" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: new Date(document.createdAt).toLocaleDateString() })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Visible to Tenants" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.isVisibleToTenants ? 'Yes' : 'No' })] })] }), document.description && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(label_1.Label, { className: "text-sm font-medium", children: "Description" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-600", children: document.description })] })), document.filePath && ((0, jsx_runtime_1.jsx)("div", { className: "border rounded-lg p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.FileText, { className: "w-5 h-5 text-gray-500" }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium", children: document.fileName || document.name }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500", children: "Document attachment" })] })] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", size: "sm", onClick: handleDownload, className: "flex items-center gap-1", children: [(0, jsx_runtime_1.jsx)(lucide_react_2.Download, { className: "w-3 h-3" }), "Download"] })] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-end pt-4 border-t", children: [canEdit && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onEdit, children: "Edit Document" })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "default", onClick: onClose, children: "Close" })] })] })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
function DocumentEditDialog({ documentId, isOpen, onClose, onSuccess }) {
    const { data: document, isLoading } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', documentId],
        queryFn: async () => {
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents/${documentId}`);
            return response.json();
        },
        enabled: isOpen && !!documentId,
    });
    const handleSuccess = () => {
        onSuccess();
        onClose();
    };
    return ((0, jsx_runtime_1.jsx)(dialog_1.Dialog, { open: isOpen, onOpenChange: onClose, children: (0, jsx_runtime_1.jsxs)(dialog_1.DialogContent, { className: "max-w-4xl max-h-[95vh] overflow-y-auto", children: [(0, jsx_runtime_1.jsx)(dialog_1.DialogHeader, { children: (0, jsx_runtime_1.jsx)(dialog_1.DialogTitle, { children: "Edit Document" }) }), isLoading ? ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading document..." })] })) : document ? ((0, jsx_runtime_1.jsx)("div", { className: "p-6", children: (0, jsx_runtime_1.jsx)(document_management_1.DocumentEditForm, { document: document, onSuccess: handleSuccess, onCancel: onClose }) })) : ((0, jsx_runtime_1.jsxs)("div", { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Document not found" }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: onClose, className: "mt-4", children: "Close" })] }))] }) }));
}
// Document categories for filtering
const DOCUMENT_CATEGORIES = [
    { value: 'all', label: 'All Categories' },
    { value: 'bylaw', label: 'Bylaws' },
    { value: 'financial', label: 'Financial' },
    { value: 'maintenance', label: 'Maintenance' },
    { value: 'legal', label: 'Legal' },
    { value: 'meeting_minutes', label: 'Meeting Minutes' },
    { value: 'insurance', label: 'Insurance' },
    { value: 'contracts', label: 'Contracts' },
    { value: 'permits', label: 'Permits' },
    { value: 'inspection', label: 'Inspection' },
    { value: 'other', label: 'Other' },
];
function ModularDocumentPageWrapper({ type, userRole, backPath, backLabel, entityIdParam, }) {
    const [, navigate] = (0, wouter_1.useLocation)();
    const params = (0, wouter_1.useParams)();
    const { t } = (0, use_language_1.useLanguage)();
    // State for document interactions
    const [isCreateDialogOpen, setIsCreateDialogOpen] = (0, react_1.useState)(false);
    // State for filtering and search
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [selectedCategory, setSelectedCategory] = (0, react_1.useState)('all');
    const [viewMode, setViewMode] = (0, react_1.useState)('grid');
    // Get entityId from URL (both path param and query param)
    const urlParams = new URLSearchParams(window.location.search);
    const entityId = params[entityIdParam] || urlParams.get(entityIdParam);
    // Get current user
    const { data: user } = (0, react_query_1.useQuery)({
        queryKey: ['/api/auth/user'],
        queryFn: () => (0, queryClient_1.apiRequest)('GET', '/api/auth/user'),
    });
    // Get entity info based on type
    const entityApiPath = type === 'building' ? '/api/manager/buildings' : '/api/residences';
    const { data: entity, isError: entityError, error } = (0, react_query_1.useQuery)({
        queryKey: [entityApiPath, entityId],
        queryFn: async () => {
            if (type === 'residence') {
                const response = await fetch(`/api/residences/${entityId}`, {
                    credentials: 'include',
                });
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('ENTITY_NOT_FOUND');
                    }
                    throw new Error(`Failed to fetch ${type}`);
                }
                return response.json();
            }
            else {
                return (0, queryClient_1.apiRequest)('GET', `${entityApiPath}/${entityId}`);
            }
        },
        enabled: !!entityId,
        retry: false, // Don't retry on 404s
    });
    // Fetch documents for this entity
    const { data: documentResponse, isLoading, error: documentsError } = (0, react_query_1.useQuery)({
        queryKey: ['/api/documents', type, entityId],
        queryFn: async () => {
            const param = type === 'building' ? 'buildingId' : 'residenceId';
            const response = await (0, queryClient_1.apiRequest)('GET', `/api/documents?${param}=${entityId}`);
            return response.json();
        },
        enabled: !!entityId,
        staleTime: 0, // Always refetch
        cacheTime: 0, // Don't cache
    });
    // Extract documents array from API response
    const documents = Array.isArray(documentResponse?.documents) ? documentResponse.documents : [];
    // Determine permissions based on user role and type
    const isUserTenant = user?.role === 'tenant';
    const isManager = user?.role === 'manager' || user?.role === 'admin';
    const userPermissions = userRole === 'manager'
        ? {
            canView: true,
            canDownload: true,
            canEdit: isManager,
            canDelete: isManager,
            canCreate: isManager,
        }
        : {
            canView: true,
            canDownload: !isUserTenant,
            canEdit: !isUserTenant,
            canDelete: !isUserTenant,
            canCreate: !isUserTenant,
        };
    // Filter and search documents
    const filteredDocuments = Array.isArray(documents) ? documents.filter(doc => {
        const matchesSearch = doc.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            doc.description?.toLowerCase().includes(searchTerm.toLowerCase());
        const matchesCategory = selectedCategory === 'all' || doc.category === selectedCategory || doc.documentType === selectedCategory;
        return matchesSearch && matchesCategory;
    }) : [];
    // Group documents by category
    const groupedDocuments = filteredDocuments.reduce((groups, doc) => {
        const category = doc.category || doc.documentType || 'other';
        if (!groups[category]) {
            groups[category] = [];
        }
        groups[category].push(doc);
        return groups;
    }, {});
    // Get category display name
    const getCategoryDisplayName = (category) => {
        const categoryLabels = {
            bylaw: 'Bylaws',
            financial: 'Financial Documents',
            maintenance: 'Maintenance Records',
            legal: 'Legal Documents',
            meeting_minutes: 'Meeting Minutes',
            insurance: 'Insurance Documents',
            contracts: 'Contracts',
            permits: 'Permits',
            inspection: 'Inspection Reports',
            other: 'Other Documents',
        };
        return categoryLabels[category] || category.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
    };
    // Generate entity name based on type
    const entityName = type === 'residence'
        ? (entity?.unitNumber || entity?.unit_number ? `Unit ${entity.unitNumber || entity.unit_number}` : 'Residence')
        : entity?.name;
    const defaultBackLabel = backLabel || (type === 'building' ? 'Back to Buildings' : t('backToResidences'));
    // State for document view and edit dialogs
    const [selectedDocumentId, setSelectedDocumentId] = (0, react_1.useState)(null);
    const [isViewDialogOpen, setIsViewDialogOpen] = (0, react_1.useState)(false);
    const [isEditDialogOpen, setIsEditDialogOpen] = (0, react_1.useState)(false);
    // Handle document interactions
    const handleDocumentView = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsViewDialogOpen(true);
    };
    const handleDocumentEdit = (documentId) => {
        setSelectedDocumentId(documentId);
        setIsEditDialogOpen(true);
    };
    const handleCreateDocument = () => {
        setIsCreateDialogOpen(true);
    };
    const handleDocumentSuccess = (documentId) => {
        console.log(`Document created:`, documentId);
        // Refresh documents list will be handled by the DocumentCreateForm's cache invalidation
    };
    const clearFilters = () => {
        setSearchTerm('');
        setSelectedCategory('all');
    };
    if (!entityId) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: [type, " ID is required"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] })] }) }) }));
    }
    // Handle entity not found (specific to residence pages that had this logic)
    if (entityError && error?.message === 'ENTITY_NOT_FOUND' && type === 'residence') {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex flex-col overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "flex-1 flex items-center justify-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center max-w-md", children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-semibold mb-4", children: "Residence Not Found" }), (0, jsx_runtime_1.jsxs)("p", { className: "text-gray-500 mb-4", children: ["The residence ID \"", entityId, "\" doesn't exist in the development database."] }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-gray-400 mb-6", children: "This might be a production database ID. Please use a valid development residence ID." }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "default", onClick: () => navigate(backPath), "data-testid": "button-back-to-list", className: "w-full", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), backLabel || 'Back to Residences'] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: () => navigate('/residents/residences/e27ac924-8120-4904-a791-d1e9db544d58/documents'), "data-testid": "button-go-to-valid-residence", className: "w-full", children: "Go to Unit 101 (Test Residence)" })] })] }) }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "flex-1 flex flex-col overflow-hidden", children: [(0, jsx_runtime_1.jsx)("div", { className: "p-6 pb-0", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between mb-6", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: () => navigate(backPath), "data-testid": "button-back", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-4 h-4 mr-2" }), defaultBackLabel] }), (0, jsx_runtime_1.jsxs)("div", { className: "text-right", children: [(0, jsx_runtime_1.jsxs)("h1", { className: "text-2xl font-semibold", children: [type === 'building' ? (0, jsx_runtime_1.jsx)(lucide_react_1.Building, { className: "w-6 h-6 inline mr-2" }) : (0, jsx_runtime_1.jsx)(lucide_react_1.Home, { className: "w-6 h-6 inline mr-2" }), entityName] }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-muted-foreground", children: type === 'building' ? 'Building Documents' : 'Residence Documents' })] })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 overflow-auto px-6 pb-6", children: (0, jsx_runtime_1.jsxs)("div", { className: "max-w-7xl mx-auto space-y-6", children: [(0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Filter, { className: "w-5 h-5" }), "Search & Filters"] }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Search" }), (0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4" }), (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: "Search documents...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "pl-10", "data-testid": "input-search-documents" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "Category" }), (0, jsx_runtime_1.jsxs)(select_1.Select, { value: selectedCategory, onValueChange: setSelectedCategory, children: [(0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { "data-testid": "select-category-filter", children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, {}) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: DOCUMENT_CATEGORIES.map((category) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: category.value, children: category.label }, category.value))) })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium", children: "View" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'grid' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('grid'), className: "flex-1", "data-testid": "button-grid-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Grid, { className: "w-4 h-4" }) }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: viewMode === 'list' ? 'default' : 'outline', size: "sm", onClick: () => setViewMode('list'), className: "flex-1", "data-testid": "button-list-view", children: (0, jsx_runtime_1.jsx)(lucide_react_1.List, { className: "w-4 h-4" }) })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsx)("label", { className: "text-sm font-medium invisible", children: "Actions" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, className: "flex-1", "data-testid": "button-create-document", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create"] })), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: clearFilters, "data-testid": "button-clear-filters", children: "Clear" })] })] })] }) })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex justify-between items-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-muted-foreground", children: [filteredDocuments.length, " document", filteredDocuments.length !== 1 ? 's' : '', " found"] }), (searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", children: "Filtered" }))] }) }), isLoading ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: "p-8 text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500", children: "Loading documents..." })] }) })) : filteredDocuments.length === 0 ? ((0, jsx_runtime_1.jsx)(card_1.Card, { children: (0, jsx_runtime_1.jsx)(card_1.CardContent, { className: "p-8 text-center", children: (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-16 h-16 mx-auto mb-4 bg-muted rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "w-8 h-8 text-muted-foreground" }) }), (0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-semibold text-gray-600 mb-2", children: "No Documents Found" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-500 mb-4", children: searchTerm || selectedCategory !== 'all'
                                                ? "No documents match your current filters. Try adjusting your search criteria."
                                                : `No documents have been uploaded for this ${type} yet. Create your first document to get started.` }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2 justify-center", children: [(searchTerm || selectedCategory !== 'all') && ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: clearFilters, children: "Clear Filters" })), userPermissions.canCreate && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleCreateDocument, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Plus, { className: "w-4 h-4 mr-2" }), "Create Document"] }))] })] }) }) })) : ((0, jsx_runtime_1.jsx)("div", { className: "space-y-6", children: Object.entries(groupedDocuments).map(([category, categoryDocuments]) => ((0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsxs)(card_1.CardTitle, { className: "text-lg flex items-center justify-between", children: [getCategoryDisplayName(category), (0, jsx_runtime_1.jsx)(badge_1.Badge, { variant: "secondary", children: categoryDocuments.length })] }) }), (0, jsx_runtime_1.jsx)(card_1.CardContent, { children: (0, jsx_runtime_1.jsx)("div", { className: `grid gap-4 ${viewMode === 'grid'
                                                ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4'
                                                : 'grid-cols-1'}`, children: categoryDocuments.map((document) => ((0, jsx_runtime_1.jsx)(document_management_1.DocumentCard, { documentId: document.id, title: document.name, documentType: document.category || document.documentType, createdAt: document.createdAt, onViewClick: handleDocumentView, compact: viewMode === 'list' }, document.id))) }) })] }, category))) })), (0, jsx_runtime_1.jsx)(DocumentCreateForm_1.DocumentCreateForm, { isOpen: isCreateDialogOpen, onClose: () => setIsCreateDialogOpen(false), onSuccess: handleDocumentSuccess, entityType: type, entityId: entityId, entityName: entityName }), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentViewDialog, { documentId: selectedDocumentId, isOpen: isViewDialogOpen, onClose: () => {
                                setIsViewDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onEdit: () => {
                                setIsViewDialogOpen(false);
                                setIsEditDialogOpen(true);
                            }, canEdit: userPermissions.canEdit })), selectedDocumentId && ((0, jsx_runtime_1.jsx)(DocumentEditDialog, { documentId: selectedDocumentId, isOpen: isEditDialogOpen, onClose: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                            }, onSuccess: () => {
                                setIsEditDialogOpen(false);
                                setSelectedDocumentId(null);
                                // Refresh documents list
                                queryClient_1.queryClient.invalidateQueries({
                                    queryKey: ['/api/documents', type, entityId],
                                });
                            } }))] }) })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvY29tbW9uL01vZHVsYXJEb2N1bWVudFBhZ2VXcmFwcGVyLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWdRQSw2Q0FnZUM7O0FBaHVCRCwrQ0FBd0M7QUFDeEMsdURBQWlEO0FBQ2pELG1DQUFnRDtBQUNoRCwrQ0FBMkY7QUFDM0YsbURBQWdEO0FBQ2hELGlEQUE4QztBQUM5QywrQ0FBZ0Y7QUFDaEYsaURBQThDO0FBQzlDLG1EQUF1RztBQUN2RyxtREFBMEY7QUFDMUYsaURBQThDO0FBQzlDLG1EQUE0RDtBQUM1RCx1REFBbUQ7QUFDbkQsMEVBSTBDO0FBQzFDLDRGQUF5RjtBQUN6RiwrQ0FBa0Q7QUFZbEQsU0FBUyxrQkFBa0IsQ0FBQyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQTJCO0lBQ25HLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxHQUFHLElBQUEsc0JBQVEsRUFBQztRQUM3QyxRQUFRLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxVQUFVLENBQUM7UUFDeEMsT0FBTyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xCLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBQSx3QkFBVSxFQUFDLEtBQUssRUFBRSxrQkFBa0IsVUFBVSxFQUFFLENBQUMsQ0FBQztZQUN6RSxPQUFPLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN6QixDQUFDO1FBQ0QsT0FBTyxFQUFFLE1BQU0sSUFBSSxDQUFDLENBQUMsVUFBVTtLQUNoQyxDQUFDLENBQUM7SUFFSCxNQUFNLGNBQWMsR0FBRyxLQUFLLElBQUksRUFBRTtRQUNoQyxPQUFPLENBQUMsR0FBRyxDQUFDLDRDQUE0QyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQ3RFLElBQUksQ0FBQztZQUNILHNEQUFzRDtZQUN0RCxNQUFNLFFBQVEsR0FB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QUMzQixxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQzs0QkFDOUIsQ0FBQyxFQUNELFNBQVMsRUFBRSxHQUFHLEVBQUU7Z0NBQ2QsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7Z0NBQzNCLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO2dDQUM1Qix5QkFBeUI7Z0NBQ3pCLHlCQUFXLENBQUMsaUJBQWlCLENBQUM7b0NBQzVCLFFBQVEsRUFBRSxDQUFDLGdCQUFnQixFQUFFLElBQUksRUFBRSxRQUFRLENBQUM7aUNBQzdDLENBQUMsQ0FBQzs0QkFDTCxDQUFDLEdBQ0QsQ0FDSCxJQUNHLEdBQ0YsSUFDRixDQUNQLENBQUM7QUFDSixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvY2xpZW50L3NyYy9jb21wb25lbnRzL2NvbW1vbi9Nb2R1bGFyRG9jdW1lbnRQYWdlV3JhcHBlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlUXVlcnkgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xuaW1wb3J0IHsgdXNlTG9jYXRpb24sIHVzZVBhcmFtcyB9IGZyb20gJ3dvdXRlcic7XG5pbXBvcnQgeyBHcmlkLCBMaXN0LCBBcnJvd0xlZnQsIFBsdXMsIFNlYXJjaCwgRmlsdGVyLCBCdWlsZGluZywgSG9tZSB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYnV0dG9uJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2lucHV0JztcbmltcG9ydCB7IENhcmQsIENhcmRDb250ZW50LCBDYXJkSGVhZGVyLCBDYXJkVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvY2FyZCc7XG5pbXBvcnQgeyBCYWRnZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9iYWRnZSc7XG5pbXBvcnQgeyBTZWxlY3QsIFNlbGVjdENvbnRlbnQsIFNlbGVjdEl0ZW0sIFNlbGVjdFRyaWdnZXIsIFNlbGVjdFZhbHVlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3NlbGVjdCc7XG5pbXBvcnQgeyBEaWFsb2csIERpYWxvZ0NvbnRlbnQsIERpYWxvZ0hlYWRlciwgRGlhbG9nVGl0bGUgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvZGlhbG9nJztcbmltcG9ydCB7IExhYmVsIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2xhYmVsJztcbmltcG9ydCB7IGFwaVJlcXVlc3QsIHF1ZXJ5Q2xpZW50IH0gZnJvbSAnQC9saWIvcXVlcnlDbGllbnQnO1xuaW1wb3J0IHsgdXNlTGFuZ3VhZ2UgfSBmcm9tICdAL2hvb2tzL3VzZS1sYW5ndWFnZSc7XG5pbXBvcnQge1xuICBTaGFyZWRVcGxvYWRlcixcbiAgRG9jdW1lbnRDYXJkLFxuICBEb2N1bWVudEVkaXRGb3JtXG59IGZyb20gJ0AvY29tcG9uZW50cy9kb2N1bWVudC1tYW5hZ2VtZW50JztcbmltcG9ydCB7IERvY3VtZW50Q3JlYXRlRm9ybSB9IGZyb20gJ0AvY29tcG9uZW50cy9kb2N1bWVudC1tYW5hZ2VtZW50L0RvY3VtZW50Q3JlYXRlRm9ybSc7XG5pbXBvcnQgeyBGaWxlVGV4dCwgRG93bmxvYWQgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHR5cGUgeyBEb2N1bWVudFdpdGhNZXRhZGF0YSwgRG9jdW1lbnRQZXJtaXNzaW9ucyB9IGZyb20gJ0BzaGFyZWQvc2NoZW1hcy9kb2N1bWVudHMnO1xuXG4vLyBEb2N1bWVudCBWaWV3IERpYWxvZyBDb21wb25lbnRcbmludGVyZmFjZSBEb2N1bWVudFZpZXdEaWFsb2dQcm9wcyB7XG4gIGRvY3VtZW50SWQ6IHN0cmluZztcbiAgaXNPcGVuOiBib29sZWFuO1xuICBvbkNsb3NlOiAoKSA9PiB2b2lkO1xuICBvbkVkaXQ6ICgpID0+IHZvaWQ7XG4gIGNhbkVkaXQ6IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIERvY3VtZW50Vmlld0RpYWxvZyh7IGRvY3VtZW50SWQsIGlzT3Blbiwgb25DbG9zZSwgb25FZGl0LCBjYW5FZGl0IH06IERvY3VtZW50Vmlld0RpYWxvZ1Byb3BzKSB7XG4gIGNvbnN0IHsgZGF0YTogZG9jdW1lbnQsIGlzTG9hZGluZyB9ID0gdXNlUXVlcnkoe1xuICAgIHF1ZXJ5S2V5OiBbJy9hcGkvZG9jdW1lbnRzJywgZG9jdW1lbnRJZF0sXG4gICAgcXVlcnlGbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCdHRVQnLCBgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudElkfWApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9LFxuICAgIGVuYWJsZWQ6IGlzT3BlbiAmJiAhIWRvY3VtZW50SWQsXG4gIH0pO1xuXG4gIGNvbnN0IGhhbmRsZURvd25sb2FkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdbRE9XTkxPQURdIFN0YXJ0aW5nIGRvd25sb2FkIGZvciBkb2N1bWVudDonLCBkb2N1bWVudElkKTtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIGZldGNoIHdpdGggY3JlZGVudGlhbHMgdG8gZW5zdXJlIGF1dGhlbnRpY2F0aW9uXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2RvY3VtZW50cy8ke2RvY3VtZW50SWR9L2ZpbGU/ZG93bmxvYWQ9dHJ1ZWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJywgLy8gSW5jbHVkZSBhdXRoZW50aWNhdGlvbiBjb29raWVzXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYERvd25sb2FkIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHRoZSBmaWxlbmFtZSBmcm9tIENvbnRlbnQtRGlzcG9zaXRpb24gaGVhZGVyIG9yIHVzZSBkb2N1bWVudCBuYW1lXG4gICAgICBjb25zdCBjb250ZW50RGlzcG9zaXRpb24gPSByZXNwb25zZS5oZWFkZXJzLmdldCgnQ29udGVudC1EaXNwb3NpdGlvbicpO1xuICAgICAgbGV0IGZpbGVOYW1lID0gZG9jdW1lbnQ/Lm5hbWUgfHwgJ2RvY3VtZW50JztcbiAgICAgIFxuICAgICAgaWYgKGNvbnRlbnREaXNwb3NpdGlvbikge1xuICAgICAgICBjb25zdCBmaWxlTmFtZU1hdGNoID0gY29udGVudERpc3Bvc2l0aW9uLm1hdGNoKC9maWxlbmFtZT1cIihbXlwiXSspXCIvKTtcbiAgICAgICAgaWYgKGZpbGVOYW1lTWF0Y2gpIHtcbiAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lTWF0Y2hbMV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ29udmVydCByZXNwb25zZSB0byBibG9iIGFuZCBjcmVhdGUgZG93bmxvYWRcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgIFxuICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIGxpbmsuaHJlZiA9IHVybDtcbiAgICAgIGxpbmsuZG93bmxvYWQgPSBmaWxlTmFtZTtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XG4gICAgICBsaW5rLmNsaWNrKCk7XG4gICAgICBcbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xuICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1tET1dOTE9BRF0gRG93bmxvYWQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbRE9XTkxPQURdIERvd25sb2FkIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAvLyBZb3UgbWlnaHQgd2FudCB0byBzaG93IGEgdG9hc3Qgbm90aWZpY2F0aW9uIGhlcmVcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8RGlhbG9nIG9wZW49e2lzT3Blbn0gb25PcGVuQ2hhbmdlPXtvbkNsb3NlfT5cbiAgICAgIDxEaWFsb2dDb250ZW50IGNsYXNzTmFtZT1cIm1heC13LTJ4bCBtYXgtaC1bOTV2aF0gb3ZlcmZsb3cteS1hdXRvXCI+XG4gICAgICAgIDxEaWFsb2dIZWFkZXI+XG4gICAgICAgICAgPERpYWxvZ1RpdGxlPkRvY3VtZW50IERldGFpbHM8L0RpYWxvZ1RpdGxlPlxuICAgICAgICA8L0RpYWxvZ0hlYWRlcj5cbiAgICAgICAgXG4gICAgICAgIHtpc0xvYWRpbmcgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTggdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1zcGluIHctOCBoLTggYm9yZGVyLTQgYm9yZGVyLXByaW1hcnkgYm9yZGVyLXQtdHJhbnNwYXJlbnQgcm91bmRlZC1mdWxsIG14LWF1dG8gbWItNFwiPjwvZGl2PlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMFwiPkxvYWRpbmcgZG9jdW1lbnQuLi48L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiBkb2N1bWVudCA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNlwiPlxuICAgICAgICAgICAgey8qIERvY3VtZW50IEluZm9ybWF0aW9uICovfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0yIGdhcC00XCI+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5Eb2N1bWVudCBOYW1lPC9MYWJlbD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDBcIj57ZG9jdW1lbnQubmFtZX08L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxMYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+Q2F0ZWdvcnk8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTYwMCBjYXBpdGFsaXplXCI+e2RvY3VtZW50LmNhdGVnb3J5IHx8IGRvY3VtZW50LmRvY3VtZW50VHlwZSB8fCAnT3RoZXInfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5VcGxvYWQgRGF0ZTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e25ldyBEYXRlKGRvY3VtZW50LmNyZWF0ZWRBdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8TGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPlZpc2libGUgdG8gVGVuYW50czwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e2RvY3VtZW50LmlzVmlzaWJsZVRvVGVuYW50cyA/ICdZZXMnIDogJ05vJ308L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHsvKiBEZXNjcmlwdGlvbiAqL31cbiAgICAgICAgICAgIHtkb2N1bWVudC5kZXNjcmlwdGlvbiAmJiAoXG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPExhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5EZXNjcmlwdGlvbjwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNjAwXCI+e2RvY3VtZW50LmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7LyogRG9jdW1lbnQgQWN0aW9ucyAqL31cbiAgICAgICAgICAgIHtkb2N1bWVudC5maWxlUGF0aCAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYm9yZGVyIHJvdW5kZWQtbGcgcC00XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTNcIj5cbiAgICAgICAgICAgICAgICAgICAgPEZpbGVUZXh0IGNsYXNzTmFtZT1cInctNSBoLTUgdGV4dC1ncmF5LTUwMFwiIC8+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPntkb2N1bWVudC5maWxlTmFtZSB8fCBkb2N1bWVudC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JheS01MDBcIj5Eb2N1bWVudCBhdHRhY2htZW50PC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZURvd25sb2FkfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMVwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxEb3dubG9hZCBjbGFzc05hbWU9XCJ3LTMgaC0zXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgRG93bmxvYWRcbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIHsvKiBBY3Rpb24gQnV0dG9ucyAqL31cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMiBqdXN0aWZ5LWVuZCBwdC00IGJvcmRlci10XCI+XG4gICAgICAgICAgICAgIHtjYW5FZGl0ICYmIChcbiAgICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17b25FZGl0fT5cbiAgICAgICAgICAgICAgICAgIEVkaXQgRG9jdW1lbnRcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwiZGVmYXVsdFwiIG9uQ2xpY2s9e29uQ2xvc2V9PlxuICAgICAgICAgICAgICAgIENsb3NlXG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTggdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDBcIj5Eb2N1bWVudCBub3QgZm91bmQ8L3A+XG4gICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17b25DbG9zZX0gY2xhc3NOYW1lPVwibXQtNFwiPlxuICAgICAgICAgICAgICBDbG9zZVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgICA8L0RpYWxvZ0NvbnRlbnQ+XG4gICAgPC9EaWFsb2c+XG4gICk7XG59XG5cbi8vIERvY3VtZW50IEVkaXQgRGlhbG9nIENvbXBvbmVudCAgXG5pbnRlcmZhY2UgRG9jdW1lbnRFZGl0RGlhbG9nUHJvcHMge1xuICBkb2N1bWVudElkOiBzdHJpbmc7XG4gIGlzT3BlbjogYm9vbGVhbjtcbiAgb25DbG9zZTogKCkgPT4gdm9pZDtcbiAgb25TdWNjZXNzOiAoKSA9PiB2b2lkO1xufVxuXG5mdW5jdGlvbiBEb2N1bWVudEVkaXREaWFsb2coeyBkb2N1bWVudElkLCBpc09wZW4sIG9uQ2xvc2UsIG9uU3VjY2VzcyB9OiBEb2N1bWVudEVkaXREaWFsb2dQcm9wcykge1xuICBjb25zdCB7IGRhdGE6IGRvY3VtZW50LCBpc0xvYWRpbmcgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cycsIGRvY3VtZW50SWRdLFxuICAgIHF1ZXJ5Rm46IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpUmVxdWVzdCgnR0VUJywgYC9hcGkvZG9jdW1lbnRzLyR7ZG9jdW1lbnRJZH1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBlbmFibGVkOiBpc09wZW4gJiYgISFkb2N1bWVudElkLFxuICB9KTtcblxuICBjb25zdCBoYW5kbGVTdWNjZXNzID0gKCkgPT4ge1xuICAgIG9uU3VjY2VzcygpO1xuICAgIG9uQ2xvc2UoKTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxEaWFsb2cgb3Blbj17aXNPcGVufSBvbk9wZW5DaGFuZ2U9e29uQ2xvc2V9PlxuICAgICAgPERpYWxvZ0NvbnRlbnQgY2xhc3NOYW1lPVwibWF4LXctNHhsIG1heC1oLVs5NXZoXSBvdmVyZmxvdy15LWF1dG9cIj5cbiAgICAgICAgPERpYWxvZ0hlYWRlcj5cbiAgICAgICAgICA8RGlhbG9nVGl0bGU+RWRpdCBEb2N1bWVudDwvRGlhbG9nVGl0bGU+XG4gICAgICAgIDwvRGlhbG9nSGVhZGVyPlxuICAgICAgICBcbiAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+TG9hZGluZyBkb2N1bWVudC4uLjwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGRvY3VtZW50ID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC02XCI+XG4gICAgICAgICAgICA8RG9jdW1lbnRFZGl0Rm9ybVxuICAgICAgICAgICAgICBkb2N1bWVudD17ZG9jdW1lbnR9XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17aGFuZGxlU3VjY2Vzc31cbiAgICAgICAgICAgICAgb25DYW5jZWw9e29uQ2xvc2V9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+RG9jdW1lbnQgbm90IGZvdW5kPC9wPlxuICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwib3V0bGluZVwiIG9uQ2xpY2s9e29uQ2xvc2V9IGNsYXNzTmFtZT1cIm10LTRcIj5cbiAgICAgICAgICAgICAgQ2xvc2VcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgIDwvRGlhbG9nPlxuICApO1xufVxuXG4vLyBEb2N1bWVudCBjYXRlZ29yaWVzIGZvciBmaWx0ZXJpbmdcbmNvbnN0IERPQ1VNRU5UX0NBVEVHT1JJRVMgPSBbXG4gIHsgdmFsdWU6ICdhbGwnLCBsYWJlbDogJ0FsbCBDYXRlZ29yaWVzJyB9LFxuICB7IHZhbHVlOiAnYnlsYXcnLCBsYWJlbDogJ0J5bGF3cycgfSxcbiAgeyB2YWx1ZTogJ2ZpbmFuY2lhbCcsIGxhYmVsOiAnRmluYW5jaWFsJyB9LFxuICB7IHZhbHVlOiAnbWFpbnRlbmFuY2UnLCBsYWJlbDogJ01haW50ZW5hbmNlJyB9LFxuICB7IHZhbHVlOiAnbGVnYWwnLCBsYWJlbDogJ0xlZ2FsJyB9LFxuICB7IHZhbHVlOiAnbWVldGluZ19taW51dGVzJywgbGFiZWw6ICdNZWV0aW5nIE1pbnV0ZXMnIH0sXG4gIHsgdmFsdWU6ICdpbnN1cmFuY2UnLCBsYWJlbDogJ0luc3VyYW5jZScgfSxcbiAgeyB2YWx1ZTogJ2NvbnRyYWN0cycsIGxhYmVsOiAnQ29udHJhY3RzJyB9LFxuICB7IHZhbHVlOiAncGVybWl0cycsIGxhYmVsOiAnUGVybWl0cycgfSxcbiAgeyB2YWx1ZTogJ2luc3BlY3Rpb24nLCBsYWJlbDogJ0luc3BlY3Rpb24nIH0sXG4gIHsgdmFsdWU6ICdvdGhlcicsIGxhYmVsOiAnT3RoZXInIH0sXG5dIGFzIGNvbnN0O1xuXG5pbnRlcmZhY2UgTW9kdWxhckRvY3VtZW50UGFnZVdyYXBwZXJQcm9wcyB7XG4gIHR5cGU6ICdidWlsZGluZycgfCAncmVzaWRlbmNlJztcbiAgdXNlclJvbGU6ICdtYW5hZ2VyJyB8ICdyZXNpZGVudCc7XG4gIGJhY2tQYXRoOiBzdHJpbmc7XG4gIGJhY2tMYWJlbD86IHN0cmluZztcbiAgZW50aXR5SWRQYXJhbTogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNb2R1bGFyRG9jdW1lbnRQYWdlV3JhcHBlcih7XG4gIHR5cGUsXG4gIHVzZXJSb2xlLFxuICBiYWNrUGF0aCxcbiAgYmFja0xhYmVsLFxuICBlbnRpdHlJZFBhcmFtLFxufTogTW9kdWxhckRvY3VtZW50UGFnZVdyYXBwZXJQcm9wcykge1xuICBjb25zdCBbLCBuYXZpZ2F0ZV0gPSB1c2VMb2NhdGlvbigpO1xuICBjb25zdCBwYXJhbXMgPSB1c2VQYXJhbXMoKTtcbiAgY29uc3QgeyB0IH0gPSB1c2VMYW5ndWFnZSgpO1xuXG4gIC8vIFN0YXRlIGZvciBkb2N1bWVudCBpbnRlcmFjdGlvbnNcbiAgY29uc3QgW2lzQ3JlYXRlRGlhbG9nT3Blbiwgc2V0SXNDcmVhdGVEaWFsb2dPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgXG4gIC8vIFN0YXRlIGZvciBmaWx0ZXJpbmcgYW5kIHNlYXJjaFxuICBjb25zdCBbc2VhcmNoVGVybSwgc2V0U2VhcmNoVGVybV0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtzZWxlY3RlZENhdGVnb3J5LCBzZXRTZWxlY3RlZENhdGVnb3J5XSA9IHVzZVN0YXRlKCdhbGwnKTtcbiAgY29uc3QgW3ZpZXdNb2RlLCBzZXRWaWV3TW9kZV0gPSB1c2VTdGF0ZTwnZ3JpZCcgfCAnbGlzdCc+KCdncmlkJyk7XG5cbiAgLy8gR2V0IGVudGl0eUlkIGZyb20gVVJMIChib3RoIHBhdGggcGFyYW0gYW5kIHF1ZXJ5IHBhcmFtKVxuICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICBjb25zdCBlbnRpdHlJZCA9IChwYXJhbXMgYXMgYW55KVtlbnRpdHlJZFBhcmFtXSB8fCB1cmxQYXJhbXMuZ2V0KGVudGl0eUlkUGFyYW0pO1xuXG4gIC8vIEdldCBjdXJyZW50IHVzZXJcbiAgY29uc3QgeyBkYXRhOiB1c2VyIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9hdXRoL3VzZXInXSxcbiAgICBxdWVyeUZuOiAoKSA9PiBhcGlSZXF1ZXN0KCdHRVQnLCAnL2FwaS9hdXRoL3VzZXInKSBhcyBQcm9taXNlPGFueT4sXG4gIH0pO1xuXG4gIC8vIEdldCBlbnRpdHkgaW5mbyBiYXNlZCBvbiB0eXBlXG4gIGNvbnN0IGVudGl0eUFwaVBhdGggPSB0eXBlID09PSAnYnVpbGRpbmcnID8gJy9hcGkvbWFuYWdlci9idWlsZGluZ3MnIDogJy9hcGkvcmVzaWRlbmNlcyc7XG4gIGNvbnN0IHsgZGF0YTogZW50aXR5LCBpc0Vycm9yOiBlbnRpdHlFcnJvciwgZXJyb3IgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogW2VudGl0eUFwaVBhdGgsIGVudGl0eUlkXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodHlwZSA9PT0gJ3Jlc2lkZW5jZScpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9yZXNpZGVuY2VzLyR7ZW50aXR5SWR9YCwge1xuICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VOVElUWV9OT1RfRk9VTkQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggJHt0eXBlfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXBpUmVxdWVzdCgnR0VUJywgYCR7ZW50aXR5QXBpUGF0aH0vJHtlbnRpdHlJZH1gKSBhcyBQcm9taXNlPGFueT47XG4gICAgICB9XG4gICAgfSxcbiAgICBlbmFibGVkOiAhIWVudGl0eUlkLFxuICAgIHJldHJ5OiBmYWxzZSwgLy8gRG9uJ3QgcmV0cnkgb24gNDA0c1xuICB9KTtcblxuICAvLyBGZXRjaCBkb2N1bWVudHMgZm9yIHRoaXMgZW50aXR5XG4gIGNvbnN0IHsgZGF0YTogZG9jdW1lbnRSZXNwb25zZSwgaXNMb2FkaW5nLCBlcnJvcjogZG9jdW1lbnRzRXJyb3IgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cycsIHR5cGUsIGVudGl0eUlkXSxcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXJhbSA9IHR5cGUgPT09ICdidWlsZGluZycgPyAnYnVpbGRpbmdJZCcgOiAncmVzaWRlbmNlSWQnO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlSZXF1ZXN0KCdHRVQnLCBgL2FwaS9kb2N1bWVudHM/JHtwYXJhbX09JHtlbnRpdHlJZH1gKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBlbmFibGVkOiAhIWVudGl0eUlkLFxuICAgIHN0YWxlVGltZTogMCwgLy8gQWx3YXlzIHJlZmV0Y2hcbiAgICBjYWNoZVRpbWU6IDAsIC8vIERvbid0IGNhY2hlXG4gIH0pO1xuXG4gIC8vIEV4dHJhY3QgZG9jdW1lbnRzIGFycmF5IGZyb20gQVBJIHJlc3BvbnNlXG4gIGNvbnN0IGRvY3VtZW50cyA9IEFycmF5LmlzQXJyYXkoZG9jdW1lbnRSZXNwb25zZT8uZG9jdW1lbnRzKSA/IGRvY3VtZW50UmVzcG9uc2UuZG9jdW1lbnRzIDogW107XG5cbiAgLy8gRGV0ZXJtaW5lIHBlcm1pc3Npb25zIGJhc2VkIG9uIHVzZXIgcm9sZSBhbmQgdHlwZVxuICBjb25zdCBpc1VzZXJUZW5hbnQgPSB1c2VyPy5yb2xlID09PSAndGVuYW50JztcbiAgY29uc3QgaXNNYW5hZ2VyID0gdXNlcj8ucm9sZSA9PT0gJ21hbmFnZXInIHx8IHVzZXI/LnJvbGUgPT09ICdhZG1pbic7XG4gIFxuICBjb25zdCB1c2VyUGVybWlzc2lvbnM6IERvY3VtZW50UGVybWlzc2lvbnMgPSB1c2VyUm9sZSA9PT0gJ21hbmFnZXInIFxuICAgID8ge1xuICAgICAgICBjYW5WaWV3OiB0cnVlLFxuICAgICAgICBjYW5Eb3dubG9hZDogdHJ1ZSxcbiAgICAgICAgY2FuRWRpdDogaXNNYW5hZ2VyLFxuICAgICAgICBjYW5EZWxldGU6IGlzTWFuYWdlcixcbiAgICAgICAgY2FuQ3JlYXRlOiBpc01hbmFnZXIsXG4gICAgICB9XG4gICAgOiB7XG4gICAgICAgIGNhblZpZXc6IHRydWUsXG4gICAgICAgIGNhbkRvd25sb2FkOiAhaXNVc2VyVGVuYW50LFxuICAgICAgICBjYW5FZGl0OiAhaXNVc2VyVGVuYW50LFxuICAgICAgICBjYW5EZWxldGU6ICFpc1VzZXJUZW5hbnQsXG4gICAgICAgIGNhbkNyZWF0ZTogIWlzVXNlclRlbmFudCxcbiAgICAgIH07XG5cbiAgLy8gRmlsdGVyIGFuZCBzZWFyY2ggZG9jdW1lbnRzXG4gIGNvbnN0IGZpbHRlcmVkRG9jdW1lbnRzID0gQXJyYXkuaXNBcnJheShkb2N1bWVudHMpID8gZG9jdW1lbnRzLmZpbHRlcihkb2MgPT4ge1xuICAgIGNvbnN0IG1hdGNoZXNTZWFyY2ggPSBkb2MubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuZGVzY3JpcHRpb24/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKTtcbiAgICBcbiAgICBjb25zdCBtYXRjaGVzQ2F0ZWdvcnkgPSBzZWxlY3RlZENhdGVnb3J5ID09PSAnYWxsJyB8fCBkb2MuY2F0ZWdvcnkgPT09IHNlbGVjdGVkQ2F0ZWdvcnkgfHwgZG9jLmRvY3VtZW50VHlwZSA9PT0gc2VsZWN0ZWRDYXRlZ29yeTtcblxuICAgIHJldHVybiBtYXRjaGVzU2VhcmNoICYmIG1hdGNoZXNDYXRlZ29yeTtcbiAgfSkgOiBbXTtcblxuICAvLyBHcm91cCBkb2N1bWVudHMgYnkgY2F0ZWdvcnlcbiAgY29uc3QgZ3JvdXBlZERvY3VtZW50cyA9IGZpbHRlcmVkRG9jdW1lbnRzLnJlZHVjZSgoZ3JvdXBzLCBkb2MpID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IGRvYy5jYXRlZ29yeSB8fCBkb2MuZG9jdW1lbnRUeXBlIHx8ICdvdGhlcic7XG4gICAgaWYgKCFncm91cHNbY2F0ZWdvcnldKSB7XG4gICAgICBncm91cHNbY2F0ZWdvcnldID0gW107XG4gICAgfVxuICAgIGdyb3Vwc1tjYXRlZ29yeV0ucHVzaChkb2MpO1xuICAgIHJldHVybiBncm91cHM7XG4gIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIHR5cGVvZiBmaWx0ZXJlZERvY3VtZW50cz4pO1xuXG4gIC8vIEdldCBjYXRlZ29yeSBkaXNwbGF5IG5hbWVcbiAgY29uc3QgZ2V0Q2F0ZWdvcnlEaXNwbGF5TmFtZSA9IChjYXRlZ29yeTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnlMYWJlbHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICBieWxhdzogJ0J5bGF3cycsXG4gICAgICBmaW5hbmNpYWw6ICdGaW5hbmNpYWwgRG9jdW1lbnRzJyxcbiAgICAgIG1haW50ZW5hbmNlOiAnTWFpbnRlbmFuY2UgUmVjb3JkcycsXG4gICAgICBsZWdhbDogJ0xlZ2FsIERvY3VtZW50cycsXG4gICAgICBtZWV0aW5nX21pbnV0ZXM6ICdNZWV0aW5nIE1pbnV0ZXMnLFxuICAgICAgaW5zdXJhbmNlOiAnSW5zdXJhbmNlIERvY3VtZW50cycsXG4gICAgICBjb250cmFjdHM6ICdDb250cmFjdHMnLFxuICAgICAgcGVybWl0czogJ1Blcm1pdHMnLFxuICAgICAgaW5zcGVjdGlvbjogJ0luc3BlY3Rpb24gUmVwb3J0cycsXG4gICAgICBvdGhlcjogJ090aGVyIERvY3VtZW50cycsXG4gICAgfTtcbiAgICByZXR1cm4gY2F0ZWdvcnlMYWJlbHNbY2F0ZWdvcnldIHx8IGNhdGVnb3J5LnJlcGxhY2UoJ18nLCAnICcpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSk7XG4gIH07XG5cblxuICAvLyBHZW5lcmF0ZSBlbnRpdHkgbmFtZSBiYXNlZCBvbiB0eXBlXG4gIGNvbnN0IGVudGl0eU5hbWUgPSB0eXBlID09PSAncmVzaWRlbmNlJyBcbiAgICA/IChlbnRpdHk/LnVuaXROdW1iZXIgfHwgZW50aXR5Py51bml0X251bWJlciA/IGBVbml0ICR7ZW50aXR5LnVuaXROdW1iZXIgfHwgZW50aXR5LnVuaXRfbnVtYmVyfWAgOiAnUmVzaWRlbmNlJylcbiAgICA6IGVudGl0eT8ubmFtZTtcblxuICBjb25zdCBkZWZhdWx0QmFja0xhYmVsID0gYmFja0xhYmVsIHx8ICh0eXBlID09PSAnYnVpbGRpbmcnID8gJ0JhY2sgdG8gQnVpbGRpbmdzJyA6IHQoJ2JhY2tUb1Jlc2lkZW5jZXMnKSk7XG5cbiAgLy8gU3RhdGUgZm9yIGRvY3VtZW50IHZpZXcgYW5kIGVkaXQgZGlhbG9nc1xuICBjb25zdCBbc2VsZWN0ZWREb2N1bWVudElkLCBzZXRTZWxlY3RlZERvY3VtZW50SWRdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc1ZpZXdEaWFsb2dPcGVuLCBzZXRJc1ZpZXdEaWFsb2dPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzRWRpdERpYWxvZ09wZW4sIHNldElzRWRpdERpYWxvZ09wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIEhhbmRsZSBkb2N1bWVudCBpbnRlcmFjdGlvbnNcbiAgY29uc3QgaGFuZGxlRG9jdW1lbnRWaWV3ID0gKGRvY3VtZW50SWQ6IHN0cmluZykgPT4ge1xuICAgIHNldFNlbGVjdGVkRG9jdW1lbnRJZChkb2N1bWVudElkKTtcbiAgICBzZXRJc1ZpZXdEaWFsb2dPcGVuKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURvY3VtZW50RWRpdCA9IChkb2N1bWVudElkOiBzdHJpbmcpID0+IHtcbiAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQoZG9jdW1lbnRJZCk7XG4gICAgc2V0SXNFZGl0RGlhbG9nT3Blbih0cnVlKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVDcmVhdGVEb2N1bWVudCA9ICgpID0+IHtcbiAgICBzZXRJc0NyZWF0ZURpYWxvZ09wZW4odHJ1ZSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRG9jdW1lbnRTdWNjZXNzID0gKGRvY3VtZW50SWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBEb2N1bWVudCBjcmVhdGVkOmAsIGRvY3VtZW50SWQpO1xuICAgIC8vIFJlZnJlc2ggZG9jdW1lbnRzIGxpc3Qgd2lsbCBiZSBoYW5kbGVkIGJ5IHRoZSBEb2N1bWVudENyZWF0ZUZvcm0ncyBjYWNoZSBpbnZhbGlkYXRpb25cbiAgfTtcblxuICBjb25zdCBjbGVhckZpbHRlcnMgPSAoKSA9PiB7XG4gICAgc2V0U2VhcmNoVGVybSgnJyk7XG4gICAgc2V0U2VsZWN0ZWRDYXRlZ29yeSgnYWxsJyk7XG4gIH07XG5cbiAgaWYgKCFlbnRpdHlJZCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDAgbWItNFwiPnt0eXBlfSBJRCBpcyByZXF1aXJlZDwvcD5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVcIlxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBuYXZpZ2F0ZShiYWNrUGF0aCl9XG4gICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWJhY2stdG8tbGlzdFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAge2RlZmF1bHRCYWNrTGFiZWx9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgLy8gSGFuZGxlIGVudGl0eSBub3QgZm91bmQgKHNwZWNpZmljIHRvIHJlc2lkZW5jZSBwYWdlcyB0aGF0IGhhZCB0aGlzIGxvZ2ljKVxuICBpZiAoZW50aXR5RXJyb3IgJiYgZXJyb3I/Lm1lc3NhZ2UgPT09ICdFTlRJVFlfTk9UX0ZPVU5EJyAmJiB0eXBlID09PSAncmVzaWRlbmNlJykge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgbWF4LXctbWRcIj5cbiAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgbWItNFwiPlJlc2lkZW5jZSBOb3QgRm91bmQ8L2gyPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMCBtYi00XCI+XG4gICAgICAgICAgICAgIFRoZSByZXNpZGVuY2UgSUQgXCJ7ZW50aXR5SWR9XCIgZG9lc24ndCBleGlzdCBpbiB0aGUgZGV2ZWxvcG1lbnQgZGF0YWJhc2UuXG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS00MDAgbWItNlwiPlxuICAgICAgICAgICAgICBUaGlzIG1pZ2h0IGJlIGEgcHJvZHVjdGlvbiBkYXRhYmFzZSBJRC4gUGxlYXNlIHVzZSBhIHZhbGlkIGRldmVsb3BtZW50IHJlc2lkZW5jZSBJRC5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PVwiZGVmYXVsdFwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gbmF2aWdhdGUoYmFja1BhdGgpfVxuICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWJhY2stdG8tbGlzdFwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICB7YmFja0xhYmVsIHx8ICdCYWNrIHRvIFJlc2lkZW5jZXMnfVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgbmF2aWdhdGUoJy9yZXNpZGVudHMvcmVzaWRlbmNlcy9lMjdhYzkyNC04MTIwLTQ5MDQtYTc5MS1kMWU5ZGI1NDRkNTgvZG9jdW1lbnRzJylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tZ28tdG8tdmFsaWQtcmVzaWRlbmNlXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGxcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgR28gdG8gVW5pdCAxMDEgKFRlc3QgUmVzaWRlbmNlKVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICB7LyogSGVhZGVyIHdpdGggQmFjayBCdXR0b24gKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtNiBwYi0wXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTZcIj5cbiAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZVwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBuYXZpZ2F0ZShiYWNrUGF0aCl9XG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1iYWNrXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT1cInctNCBoLTQgbXItMlwiIC8+XG4gICAgICAgICAgICB7ZGVmYXVsdEJhY2tMYWJlbH1cbiAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICBcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtcmlnaHRcIj5cbiAgICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJ0ZXh0LTJ4bCBmb250LXNlbWlib2xkXCI+XG4gICAgICAgICAgICAgIHt0eXBlID09PSAnYnVpbGRpbmcnID8gPEJ1aWxkaW5nIGNsYXNzTmFtZT1cInctNiBoLTYgaW5saW5lIG1yLTJcIiAvPiA6IDxIb21lIGNsYXNzTmFtZT1cInctNiBoLTYgaW5saW5lIG1yLTJcIiAvPn1cbiAgICAgICAgICAgICAge2VudGl0eU5hbWV9XG4gICAgICAgICAgICA8L2gxPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cbiAgICAgICAgICAgICAge3R5cGUgPT09ICdidWlsZGluZycgPyAnQnVpbGRpbmcgRG9jdW1lbnRzJyA6ICdSZXNpZGVuY2UgRG9jdW1lbnRzJ31cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgb3ZlcmZsb3ctYXV0byBweC02IHBiLTZcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYXgtdy03eGwgbXgtYXV0byBzcGFjZS15LTZcIj5cbiAgICAgICAgICB7LyogRmlsdGVycyBhbmQgU2VhcmNoIFNlY3Rpb24gKi99XG4gICAgICAgICAgPENhcmQ+XG4gICAgICAgICAgICA8Q2FyZEhlYWRlcj5cbiAgICAgICAgICAgICAgPENhcmRUaXRsZSBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgICAgICAgIDxGaWx0ZXIgY2xhc3NOYW1lPVwidy01IGgtNVwiIC8+XG4gICAgICAgICAgICAgICAgU2VhcmNoICYgRmlsdGVyc1xuICAgICAgICAgICAgICA8L0NhcmRUaXRsZT5cbiAgICAgICAgICAgIDwvQ2FyZEhlYWRlcj5cbiAgICAgICAgICAgIDxDYXJkQ29udGVudD5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy00IGdhcC00XCI+XG4gICAgICAgICAgICAgICAgey8qIFNlYXJjaCAqL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5TZWFyY2g8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxuICAgICAgICAgICAgICAgICAgICA8U2VhcmNoIGNsYXNzTmFtZT1cImFic29sdXRlIGxlZnQtMyB0b3AtMS8yIHRyYW5zZm9ybSAtdHJhbnNsYXRlLXktMS8yIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCB3LTQgaC00XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggZG9jdW1lbnRzLi4uXCJcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17c2VhcmNoVGVybX1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFNlYXJjaFRlcm0oZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInBsLTEwXCJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LXNlYXJjaC1kb2N1bWVudHNcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICB7LyogQ2F0ZWdvcnkgRmlsdGVyICovfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bVwiPkNhdGVnb3J5PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgIDxTZWxlY3QgdmFsdWU9e3NlbGVjdGVkQ2F0ZWdvcnl9IG9uVmFsdWVDaGFuZ2U9e3NldFNlbGVjdGVkQ2F0ZWdvcnl9PlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VHJpZ2dlciBkYXRhLXRlc3RpZD1cInNlbGVjdC1jYXRlZ29yeS1maWx0ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0VmFsdWUgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RUcmlnZ2VyPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0Q29udGVudD5cbiAgICAgICAgICAgICAgICAgICAgICB7RE9DVU1FTlRfQ0FURUdPUklFUy5tYXAoKGNhdGVnb3J5KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSBrZXk9e2NhdGVnb3J5LnZhbHVlfSB2YWx1ZT17Y2F0ZWdvcnkudmFsdWV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnkubGFiZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdEl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0Q29udGVudD5cbiAgICAgICAgICAgICAgICAgIDwvU2VsZWN0PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgey8qIFZpZXcgTW9kZSBUb2dnbGUgKi99XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTJcIj5cbiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+VmlldzwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9e3ZpZXdNb2RlID09PSAnZ3JpZCcgPyAnZGVmYXVsdCcgOiAnb3V0bGluZSd9XG4gICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRWaWV3TW9kZSgnZ3JpZCcpfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMVwiXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tZ3JpZC12aWV3XCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxHcmlkIGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9e3ZpZXdNb2RlID09PSAnbGlzdCcgPyAnZGVmYXVsdCcgOiAnb3V0bGluZSd9XG4gICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRWaWV3TW9kZSgnbGlzdCcpfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMVwiXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tbGlzdC12aWV3XCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxMaXN0IGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgey8qIEFjdGlvbnMgKi99XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTJcIj5cbiAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIGludmlzaWJsZVwiPkFjdGlvbnM8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgIHt1c2VyUGVybWlzc2lvbnMuY2FuQ3JlYXRlICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ3JlYXRlRG9jdW1lbnR9IFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleC0xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWNyZWF0ZS1kb2N1bWVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBsdXMgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZVxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCIgXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17Y2xlYXJGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLWNsZWFyLWZpbHRlcnNcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgQ2xlYXJcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgIDwvQ2FyZD5cblxuICAgICAgICAgIHsvKiBEb2N1bWVudHMgRGlzcGxheSAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiPlxuICAgICAgICAgICAgICAgIHtmaWx0ZXJlZERvY3VtZW50cy5sZW5ndGh9IGRvY3VtZW50e2ZpbHRlcmVkRG9jdW1lbnRzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBmb3VuZFxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgIHsoc2VhcmNoVGVybSB8fCBzZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJykgJiYgKFxuICAgICAgICAgICAgICAgIDxCYWRnZSB2YXJpYW50PVwic2Vjb25kYXJ5XCI+RmlsdGVyZWQ8L0JhZGdlPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogRG9jdW1lbnRzIENvbnRlbnQgKi99XG4gICAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPVwicC04IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gdy04IGgtOCBib3JkZXItNCBib3JkZXItcHJpbWFyeSBib3JkZXItdC10cmFuc3BhcmVudCByb3VuZGVkLWZ1bGwgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTUwMFwiPkxvYWRpbmcgZG9jdW1lbnRzLi4uPC9wPlxuICAgICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgICAgPC9DYXJkPlxuICAgICAgICAgICkgOiBmaWx0ZXJlZERvY3VtZW50cy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICA8Q2FyZD5cbiAgICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT1cInAtOCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xNiBoLTE2IG14LWF1dG8gbWItNCBiZy1tdXRlZCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9XCJ3LTggaC04IHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiIC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTYwMCBtYi0yXCI+Tm8gRG9jdW1lbnRzIEZvdW5kPC9oMz5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDAgbWItNFwiPlxuICAgICAgICAgICAgICAgICAgICB7c2VhcmNoVGVybSB8fCBzZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJ1xuICAgICAgICAgICAgICAgICAgICAgID8gXCJObyBkb2N1bWVudHMgbWF0Y2ggeW91ciBjdXJyZW50IGZpbHRlcnMuIFRyeSBhZGp1c3RpbmcgeW91ciBzZWFyY2ggY3JpdGVyaWEuXCJcbiAgICAgICAgICAgICAgICAgICAgICA6IGBObyBkb2N1bWVudHMgaGF2ZSBiZWVuIHVwbG9hZGVkIGZvciB0aGlzICR7dHlwZX0geWV0LiBDcmVhdGUgeW91ciBmaXJzdCBkb2N1bWVudCB0byBnZXQgc3RhcnRlZC5gXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMiBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICB7KHNlYXJjaFRlcm0gfHwgc2VsZWN0ZWRDYXRlZ29yeSAhPT0gJ2FsbCcpICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17Y2xlYXJGaWx0ZXJzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIENsZWFyIEZpbHRlcnNcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAge3VzZXJQZXJtaXNzaW9ucy5jYW5DcmVhdGUgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17aGFuZGxlQ3JlYXRlRG9jdW1lbnR9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBsdXMgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZSBEb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgICA8L0NhcmQ+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS02XCI+XG4gICAgICAgICAgICAgIHtPYmplY3QuZW50cmllcyhncm91cGVkRG9jdW1lbnRzKS5tYXAoKFtjYXRlZ29yeSwgY2F0ZWdvcnlEb2N1bWVudHNdKSA9PiAoXG4gICAgICAgICAgICAgICAgPENhcmQga2V5PXtjYXRlZ29yeX0+XG4gICAgICAgICAgICAgICAgICA8Q2FyZEhlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgPENhcmRUaXRsZSBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtnZXRDYXRlZ29yeURpc3BsYXlOYW1lKGNhdGVnb3J5KX1cbiAgICAgICAgICAgICAgICAgICAgICA8QmFkZ2UgdmFyaWFudD1cInNlY29uZGFyeVwiPntjYXRlZ29yeURvY3VtZW50cy5sZW5ndGh9PC9CYWRnZT5cbiAgICAgICAgICAgICAgICAgICAgPC9DYXJkVGl0bGU+XG4gICAgICAgICAgICAgICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICAgICAgICAgICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgZ3JpZCBnYXAtNCAke1xuICAgICAgICAgICAgICAgICAgICAgIHZpZXdNb2RlID09PSAnZ3JpZCcgXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICdncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBsZzpncmlkLWNvbHMtMyB4bDpncmlkLWNvbHMtNCcgXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdncmlkLWNvbHMtMSdcbiAgICAgICAgICAgICAgICAgICAgfWB9PlxuICAgICAgICAgICAgICAgICAgICAgIHtjYXRlZ29yeURvY3VtZW50cy5tYXAoKGRvY3VtZW50KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8RG9jdW1lbnRDYXJkXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17ZG9jdW1lbnQuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50SWQ9e2RvY3VtZW50LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17ZG9jdW1lbnQubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRUeXBlPXtkb2N1bWVudC5jYXRlZ29yeSB8fCBkb2N1bWVudC5kb2N1bWVudFR5cGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdD17ZG9jdW1lbnQuY3JlYXRlZEF0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICBvblZpZXdDbGljaz17aGFuZGxlRG9jdW1lbnRWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYWN0PXt2aWV3TW9kZSA9PT0gJ2xpc3QnfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuXG4gICAgICAgICAgey8qIERvY3VtZW50IENyZWF0aW9uIERpYWxvZyAqL31cbiAgICAgICAgICA8RG9jdW1lbnRDcmVhdGVGb3JtXG4gICAgICAgICAgICBpc09wZW49e2lzQ3JlYXRlRGlhbG9nT3Blbn1cbiAgICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHNldElzQ3JlYXRlRGlhbG9nT3BlbihmYWxzZSl9XG4gICAgICAgICAgICBvblN1Y2Nlc3M9e2hhbmRsZURvY3VtZW50U3VjY2Vzc31cbiAgICAgICAgICAgIGVudGl0eVR5cGU9e3R5cGV9XG4gICAgICAgICAgICBlbnRpdHlJZD17ZW50aXR5SWR9XG4gICAgICAgICAgICBlbnRpdHlOYW1lPXtlbnRpdHlOYW1lfVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICB7LyogRG9jdW1lbnQgVmlldyBEaWFsb2cgKi99XG4gICAgICAgICAge3NlbGVjdGVkRG9jdW1lbnRJZCAmJiAoXG4gICAgICAgICAgICA8RG9jdW1lbnRWaWV3RGlhbG9nXG4gICAgICAgICAgICAgIGRvY3VtZW50SWQ9e3NlbGVjdGVkRG9jdW1lbnRJZH1cbiAgICAgICAgICAgICAgaXNPcGVuPXtpc1ZpZXdEaWFsb2dPcGVufVxuICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SXNWaWV3RGlhbG9nT3BlbihmYWxzZSk7XG4gICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWREb2N1bWVudElkKG51bGwpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBvbkVkaXQ9eygpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc1ZpZXdEaWFsb2dPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZXRJc0VkaXREaWFsb2dPcGVuKHRydWUpO1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBjYW5FZGl0PXt1c2VyUGVybWlzc2lvbnMuY2FuRWRpdH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBEb2N1bWVudCBFZGl0IERpYWxvZyAqL31cbiAgICAgICAgICB7c2VsZWN0ZWREb2N1bWVudElkICYmIChcbiAgICAgICAgICAgIDxEb2N1bWVudEVkaXREaWFsb2dcbiAgICAgICAgICAgICAgZG9jdW1lbnRJZD17c2VsZWN0ZWREb2N1bWVudElkfVxuICAgICAgICAgICAgICBpc09wZW49e2lzRWRpdERpYWxvZ09wZW59XG4gICAgICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc0VkaXREaWFsb2dPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3RlZERvY3VtZW50SWQobnVsbCk7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldElzRWRpdERpYWxvZ09wZW4oZmFsc2UpO1xuICAgICAgICAgICAgICAgIHNldFNlbGVjdGVkRG9jdW1lbnRJZChudWxsKTtcbiAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIGRvY3VtZW50cyBsaXN0XG4gICAgICAgICAgICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoe1xuICAgICAgICAgICAgICAgICAgcXVlcnlLZXk6IFsnL2FwaS9kb2N1bWVudHMnLCB0eXBlLCBlbnRpdHlJZF0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59Il0sInZlcnNpb24iOjN9
640ff8f0c6a664b8eac38ebc585feee5
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const globals_1 = require("@jest/globals");
// Mock the hooks and utils
globals_1.jest.mock('@/hooks/use-language', () => ({
    useLanguage: () => ({
        t: (key) => key,
    }),
}));
globals_1.jest.mock('@/hooks/use-toast', () => ({
    useToast: () => ({
        toast: globals_1.jest.fn(),
    }),
}));
/**
 * @file Demand Comment Form Frontend Tests
 * @description Tests for comment submission form components and validation
 */
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const react_query_1 = require("@tanstack/react-query");
require("@testing-library/jest-dom");
// Mock fetch with proper typing
const mockFetch = globals_1.jest.fn();
global.fetch = mockFetch;
// Mock queryClient
const createMockQueryClient = () => new react_query_1.QueryClient({
    defaultOptions: {
        queries: {
            retry: false,
        },
    },
});
// Mock data
const mockDemand = {
    id: 'demand-123',
    type: 'maintenance',
    description: 'Test demand',
    status: 'submitted',
    submitterId: 'user-123',
};
const mockUser = {
    id: 'user-123',
    role: 'resident',
    email: 'test@example.com',
    firstName: 'Test',
    lastName: 'User',
};
const mockExistingComments = [
    {
        id: 'comment-1',
        demandId: 'demand-123',
        commentText: 'First comment on this demand',
        commenterId: 'user-123',
        isInternal: false,
        createdAt: '2023-01-01T10:00:00Z',
        author: {
            id: 'user-123',
            firstName: 'Test',
            lastName: 'User',
            email: 'test@example.com',
        },
    },
    {
        id: 'comment-2',
        demandId: 'demand-123',
        commentText: 'Second comment with more details',
        commenterId: 'user-456',
        isInternal: false,
        createdAt: '2023-01-01T11:00:00Z',
        author: {
            id: 'user-456',
            firstName: 'Other',
            lastName: 'User',
            email: 'other@example.com',
        },
    },
];
// Test component that includes comment functionality
const TestCommentForm = ({ demandId, onCommentAdded }) => {
    const [isSubmitting, setIsSubmitting] = react_1.default.useState(false);
    const [comments, setComments] = react_1.default.useState(mockExistingComments);
    const [commentText, setCommentText] = react_1.default.useState('');
    const [commentType, setCommentType] = react_1.default.useState('');
    const [isInternal, setIsInternal] = react_1.default.useState(false);
    const handleSubmit = async (e) => {
        e.preventDefault();
        setIsSubmitting(true);
        try {
            const response = await fetch(`/api/demands/${demandId}/comments`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: commentText.trim(),
                    commentType: commentType || undefined,
                    isInternal,
                }),
            });
            if (!response.ok) {
                throw new Error('Failed to create comment');
            }
            const newComment = await response.json();
            setComments(prev => [...prev, newComment]);
            setCommentText('');
            setCommentType('');
            setIsInternal(false);
            onCommentAdded?.();
        }
        catch (error) {
            console.error('Comment submission error:', error);
        }
        finally {
            setIsSubmitting(false);
        }
    };
    return ((0, jsx_runtime_1.jsxs)("div", { "data-testid": "comment-section", children: [(0, jsx_runtime_1.jsx)("div", { "data-testid": "comments-list", children: comments.map((comment) => ((0, jsx_runtime_1.jsxs)("div", { "data-testid": `comment-${comment.id}`, className: "comment", children: [(0, jsx_runtime_1.jsxs)("div", { "data-testid": `comment-author-${comment.id}`, children: [comment.author?.firstName || 'Unknown', " ", comment.author?.lastName || 'User'] }), (0, jsx_runtime_1.jsx)("div", { "data-testid": `comment-text-${comment.id}`, children: comment.commentText }), (0, jsx_runtime_1.jsx)("div", { "data-testid": `comment-date-${comment.id}`, children: comment.createdAt }), comment.isInternal && (0, jsx_runtime_1.jsx)("div", { "data-testid": `comment-internal-${comment.id}`, children: "Internal" })] }, comment.id))) }), (0, jsx_runtime_1.jsxs)("form", { "data-testid": "comment-form", onSubmit: handleSubmit, children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { htmlFor: "commentText", children: "Comment" }), (0, jsx_runtime_1.jsx)("textarea", { "data-testid": "input-comment-text", id: "commentText", value: commentText, onChange: (e) => setCommentText(e.target.value), placeholder: "Add your comment here...", required: true, minLength: 1, maxLength: 1000, rows: 4 })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { htmlFor: "commentType", children: "Comment Type (Optional)" }), (0, jsx_runtime_1.jsxs)("select", { "data-testid": "input-comment-type", id: "commentType", value: commentType, onChange: (e) => setCommentType(e.target.value), children: [(0, jsx_runtime_1.jsx)("option", { value: "", children: "Select Type" }), (0, jsx_runtime_1.jsx)("option", { value: "update", children: "Update" }), (0, jsx_runtime_1.jsx)("option", { value: "question", children: "Question" }), (0, jsx_runtime_1.jsx)("option", { value: "answer", children: "Answer" }), (0, jsx_runtime_1.jsx)("option", { value: "status_change", children: "Status Change" }), (0, jsx_runtime_1.jsx)("option", { value: "internal_note", children: "Internal Note" })] })] }), (0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsxs)("label", { children: [(0, jsx_runtime_1.jsx)("input", { "data-testid": "input-is-internal", type: "checkbox", checked: isInternal, onChange: (e) => setIsInternal(e.target.checked) }), "Internal Comment (visible to staff only)"] }) }), (0, jsx_runtime_1.jsx)("button", { type: "submit", "data-testid": "button-submit-comment", disabled: isSubmitting || commentText.trim().length === 0, children: isSubmitting ? 'Adding Comment...' : 'Add Comment' })] })] }));
};
const TestWrapper = ({ children }) => {
    const queryClient = createMockQueryClient();
    return (0, jsx_runtime_1.jsx)(react_query_1.QueryClientProvider, { client: queryClient, children: children });
};
(0, globals_1.describe)('Demand Comment Form Tests', () => {
    // Mock console.error to avoid test output pollution
    const originalConsoleError = console.error;
    (0, globals_1.beforeEach)(() => {
        mockFetch.mockClear();
        // Suppress console.error during tests
        console.error = globals_1.jest.fn();
    });
    afterAll(() => {
        // Restore console.error after tests
        console.error = originalConsoleError;
    });
    (0, globals_1.describe)('Comment Display', () => {
        (0, globals_1.it)('should display existing comments', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            (0, globals_1.expect)(react_2.screen.getByTestId('comments-list')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-comment-1')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-comment-2')).toBeInTheDocument();
            // Check comment content
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-text-comment-1')).toHaveTextContent('First comment on this demand');
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-text-comment-2')).toHaveTextContent('Second comment with more details');
            // Check author information
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-author-comment-1')).toHaveTextContent('Test User');
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-author-comment-2')).toHaveTextContent('Other User');
        });
        (0, globals_1.it)('should display comment timestamps', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-date-comment-1')).toHaveTextContent('2023-01-01T10:00:00Z');
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-date-comment-2')).toHaveTextContent('2023-01-01T11:00:00Z');
        });
    });
    (0, globals_1.describe)('Comment Form Rendering', () => {
        (0, globals_1.it)('should render all form fields', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            (0, globals_1.expect)(react_2.screen.getByTestId('comment-form')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('input-comment-text')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('input-comment-type')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('input-is-internal')).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.getByTestId('button-submit-comment')).toBeInTheDocument();
        });
        (0, globals_1.it)('should render comment type options', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const typeSelect = react_2.screen.getByTestId('input-comment-type');
            (0, globals_1.expect)(typeSelect).toHaveTextContent('Update');
            (0, globals_1.expect)(typeSelect).toHaveTextContent('Question');
            (0, globals_1.expect)(typeSelect).toHaveTextContent('Answer');
            (0, globals_1.expect)(typeSelect).toHaveTextContent('Status Change');
            (0, globals_1.expect)(typeSelect).toHaveTextContent('Internal Note');
        });
        (0, globals_1.it)('should have proper form field attributes', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            (0, globals_1.expect)(textArea).toHaveAttribute('required');
            (0, globals_1.expect)(textArea).toHaveAttribute('minLength', '1');
            (0, globals_1.expect)(textArea).toHaveAttribute('maxLength', '1000');
            (0, globals_1.expect)(textArea).toHaveAttribute('rows', '4');
        });
    });
    (0, globals_1.describe)('Form Validation', () => {
        (0, globals_1.it)('should disable submit button when comment text is empty', () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            (0, globals_1.expect)(submitButton).toBeDisabled();
        });
        (0, globals_1.it)('should enable submit button when comment text is provided', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'This is a valid comment');
            (0, globals_1.expect)(submitButton).not.toBeDisabled();
        });
        (0, globals_1.it)('should require comment text field', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            // Try to submit without text
            await user_event_1.default.click(submitButton);
            // Form validation should prevent submission
            (0, globals_1.expect)(mockFetch).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('should handle minimum and maximum text length', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            // Test single character (minimum)
            await user_event_1.default.clear(textArea);
            await user_event_1.default.type(textArea, 'A');
            (0, globals_1.expect)(textArea).toHaveValue('A');
            // Test maximum length (1000 characters)
            const maxText = 'A'.repeat(1000);
            await user_event_1.default.clear(textArea);
            await user_event_1.default.type(textArea, maxText);
            (0, globals_1.expect)(textArea).toHaveValue(maxText);
        });
    });
    (0, globals_1.describe)('Form Submission', () => {
        (0, globals_1.it)('should submit comment successfully', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'New test comment',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            const onCommentAdded = globals_1.jest.fn();
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123", onCommentAdded: onCommentAdded }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'New test comment');
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: 'New test comment',
                    commentType: undefined,
                    isInternal: false,
                }),
            });
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(onCommentAdded).toHaveBeenCalled();
            });
        });
        (0, globals_1.it)('should submit comment with optional fields', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'Internal update comment',
                    commentType: 'status_change',
                    commenterId: 'user-123',
                    isInternal: true,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const typeSelect = react_2.screen.getByTestId('input-comment-type');
            const internalCheckbox = react_2.screen.getByTestId('input-is-internal');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Internal update comment');
            await user_event_1.default.selectOptions(typeSelect, 'status_change');
            await user_event_1.default.click(internalCheckbox);
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: 'Internal update comment',
                    commentType: 'status_change',
                    isInternal: true,
                }),
            });
        });
        (0, globals_1.it)('should show loading state during submission', async () => {
            mockFetch.mockImplementation(() => new Promise((resolve) => setTimeout(() => resolve({
                ok: true,
                json: async () => ({
                    id: 'comment-loading',
                    demandId: 'demand-123',
                    commentText: 'Loading test comment',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                })
            }), 100)));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Loading test comment');
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(submitButton).toHaveTextContent('Adding Comment...');
            (0, globals_1.expect)(submitButton).toBeDisabled();
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(submitButton).toHaveTextContent('Add Comment');
                (0, globals_1.expect)(submitButton).toBeDisabled(); // Should be disabled because textarea is now empty
            });
        });
        (0, globals_1.it)('should clear form after successful submission', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'Test comment for clearing',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const typeSelect = react_2.screen.getByTestId('input-comment-type');
            const internalCheckbox = react_2.screen.getByTestId('input-is-internal');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            // Fill form
            await user_event_1.default.type(textArea, 'Test comment for clearing');
            await user_event_1.default.selectOptions(typeSelect, 'update');
            await user_event_1.default.click(internalCheckbox);
            await user_event_1.default.click(submitButton);
            // Wait for form to clear
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(textArea).toHaveValue('');
                (0, globals_1.expect)(typeSelect).toHaveValue('');
                (0, globals_1.expect)(internalCheckbox).not.toBeChecked();
            });
        });
        (0, globals_1.it)('should handle submission errors gracefully', async () => {
            mockFetch.mockRejectedValueOnce(new Error('Network error'));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Error test comment');
            await user_event_1.default.click(submitButton);
            await (0, react_2.waitFor)(() => {
                // Form should still be visible with the text after error
                (0, globals_1.expect)(textArea).toHaveValue('Error test comment');
                (0, globals_1.expect)(submitButton).toHaveTextContent('Add Comment');
                (0, globals_1.expect)(submitButton).not.toBeDisabled();
            });
        });
        (0, globals_1.it)('should handle server validation errors', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: false,
                status: 400,
                json: async () => ({ message: 'Comment text too long' }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Server error test comment');
            await user_event_1.default.click(submitButton);
            await (0, react_2.waitFor)(() => {
                // Form should remain with the text after server error
                (0, globals_1.expect)(textArea).toHaveValue('Server error test comment');
                (0, globals_1.expect)(submitButton).not.toBeDisabled();
            });
        });
    });
    (0, globals_1.describe)('Special Characters and Internationalization', () => {
        (0, globals_1.it)('should handle French characters in comments', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'Commentaire en français avec caractères spéciaux: éàùç!',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Commentaire en français avec caractères spéciaux: éàùç!');
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: 'Commentaire en français avec caractères spéciaux: éàùç!',
                    commentType: undefined,
                    isInternal: false,
                }),
            });
        });
        (0, globals_1.it)('should handle emojis and special symbols', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'Great work! 👍 Thanks @#$%^&*()',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, 'Great work! 👍 Thanks @#$%^&*()');
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: 'Great work! 👍 Thanks @#$%^&*()',
                    commentType: undefined,
                    isInternal: false,
                }),
            });
        });
        (0, globals_1.it)('should handle multiline comments', async () => {
            const multilineText = `This is a multiline comment.

It has multiple paragraphs.

End of comment.`;
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: multilineText,
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, multilineText);
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: multilineText,
                    commentType: undefined,
                    isInternal: false,
                }),
            });
        });
    });
    (0, globals_1.describe)('Form Behavior and UX', () => {
        (0, globals_1.it)('should trim whitespace from comment text before submission', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    id: 'comment-3',
                    demandId: 'demand-123',
                    commentText: 'Trimmed comment',
                    commenterId: 'user-123',
                    isInternal: false,
                    createdAt: '2023-01-01T12:00:00Z',
                    author: {
                        id: 'user-123',
                        firstName: 'Test',
                        lastName: 'User',
                        email: 'test@example.com',
                    },
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const textArea = react_2.screen.getByTestId('input-comment-text');
            const submitButton = react_2.screen.getByTestId('button-submit-comment');
            await user_event_1.default.type(textArea, '   Trimmed comment   ');
            await user_event_1.default.click(submitButton);
            (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    commentText: 'Trimmed comment',
                    commentType: undefined,
                    isInternal: false,
                }),
            });
        });
        (0, globals_1.it)('should handle all comment types correctly', async () => {
            const commentTypes = ['update', 'question', 'answer', 'status_change', 'internal_note'];
            for (const type of commentTypes) {
                mockFetch.mockResolvedValueOnce({
                    ok: true,
                    json: async () => ({
                        id: `comment-${type}`,
                        demandId: 'demand-123',
                        commentText: `Comment of type ${type}`,
                        commentType: type,
                        commenterId: 'user-123',
                        isInternal: false,
                        createdAt: '2023-01-01T12:00:00Z',
                        author: {
                            id: 'user-123',
                            firstName: 'Test',
                            lastName: 'User',
                            email: 'test@example.com',
                        },
                    }),
                });
                const { unmount } = (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
                const textArea = react_2.screen.getByTestId('input-comment-text');
                const typeSelect = react_2.screen.getByTestId('input-comment-type');
                const submitButton = react_2.screen.getByTestId('button-submit-comment');
                await user_event_1.default.type(textArea, `Comment of type ${type}`);
                await user_event_1.default.selectOptions(typeSelect, type);
                await user_event_1.default.click(submitButton);
                (0, globals_1.expect)(mockFetch).toHaveBeenCalledWith('/api/demands/demand-123/comments', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        commentText: `Comment of type ${type}`,
                        commentType: type,
                        isInternal: false,
                    }),
                });
                mockFetch.mockClear();
                unmount(); // Clean up between iterations
            }
        });
        (0, globals_1.it)('should handle internal comment toggle correctly', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(TestWrapper, { children: (0, jsx_runtime_1.jsx)(TestCommentForm, { demandId: "demand-123" }) }));
            const internalCheckbox = react_2.screen.getByTestId('input-is-internal');
            // Initially unchecked
            (0, globals_1.expect)(internalCheckbox).not.toBeChecked();
            // Click to check
            await user_event_1.default.click(internalCheckbox);
            (0, globals_1.expect)(internalCheckbox).toBeChecked();
            // Click to uncheck
            await user_event_1.default.click(internalCheckbox);
            (0, globals_1.expect)(internalCheckbox).not.toBeChecked();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2Zvcm1zL2RlbWFuZC1jb21tZW50LWZvcm0udGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBU0EsMkNBQXVFO0FBR3ZFLDJCQUEyQjtBQUMzQixjQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdkMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDbEIsQ0FBQyxFQUFFLENBQUMsR0FBVyxFQUFFLEVBQUUsQ0FBQyxHQUFHO0tBQ3hCLENBQUM7Q0FDSCxDQUFDLENBQUMsQ0FBQztBQUVKLGNBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNwQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNmLEtBQUssRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2pCLENBQUM7Q0FDSCxDQUFDLENBQUMsQ0FBQztBQXZCSjs7O0dBR0c7QUFFSCxrREFBMEI7QUFDMUIsa0RBQTRFO0FBQzVFLDZFQUFvRDtBQUNwRCx1REFBeUU7QUFFekUscUNBQW1DO0FBZW5DLGdDQUFnQztBQUNoQyxNQUFNLFNBQVMsR0FBRyxjQUFJLENBQUMsRUFBRSxFQUF1QyxDQUFDO0FBQ2pFLE1BQU0sQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDO0FBRXpCLG1CQUFtQjtBQUNuQixNQUFNLHFCQUFxQixHQUFHLEdBQUcsRUFBRSxDQUNqQyxJQUFJLHlCQUFXLENBQUM7SUFDZCxjQUFjLEVBQUU7UUFDZCxPQUFPLEVBQUU7WUFDUCxLQUFLLEVBQUUsS0FBSztTQUNiO0tBQ0Y7Q0FDRixDQUFDLENBQUM7QUFFTCxZQUFZO0FBQ1osTUFBTSxVQUFVLEdBQUc7SUFDakIsRUFBRSxFQUFFLFlBQVk7SUFDaEIsSUFBSSxFQUFFLGFBQWE7SUFDbkIsV0FBVyxFQUFFLGFBQWE7SUFDMUIsTUFBTSxFQUFFLFdBQVc7SUFDbkIsV0FBVyxFQUFFLFVB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LENBQUMsV0FBVyxDQUFDLG1CQUFtQixDQUFDLENBQUM7WUFFakUsc0JBQXNCO1lBQ3RCLElBQUEsZ0JBQU0sRUFBQyxnQkFBZ0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUUzQyxpQkFBaUI7WUFDakIsTUFBTSxvQkFBUyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3hDLElBQUEsZ0JBQU0sRUFBQyxnQkFBZ0IsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBRXZDLG1CQUFtQjtZQUNuQixNQUFNLG9CQUFTLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDeEMsSUFBQSxnQkFBTSxFQUFDLGdCQUFnQixDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3VuaXQvZm9ybXMvZGVtYW5kLWNvbW1lbnQtZm9ybS50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIERlbWFuZCBDb21tZW50IEZvcm0gRnJvbnRlbmQgVGVzdHNcbiAqIEBkZXNjcmlwdGlvbiBUZXN0cyBmb3IgY29tbWVudCBzdWJtaXNzaW9uIGZvcm0gY29tcG9uZW50cyBhbmQgdmFsaWRhdGlvblxuICovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgdXNlckV2ZW50IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvdXNlci1ldmVudCc7XG5pbXBvcnQgeyBRdWVyeUNsaWVudCwgUXVlcnlDbGllbnRQcm92aWRlciB9IGZyb20gJ0B0YW5zdGFjay9yZWFjdC1xdWVyeSc7XG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCwgamVzdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcblxuLy8gTW9jayB0aGUgaG9va3MgYW5kIHV0aWxzXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLWxhbmd1YWdlJywgKCkgPT4gKHtcbiAgdXNlTGFuZ3VhZ2U6ICgpID0+ICh7XG4gICAgdDogKGtleTogc3RyaW5nKSA9PiBrZXksXG4gIH0pLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLXRvYXN0JywgKCkgPT4gKHtcbiAgdXNlVG9hc3Q6ICgpID0+ICh7XG4gICAgdG9hc3Q6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2ggd2l0aCBwcm9wZXIgdHlwaW5nXG5jb25zdCBtb2NrRmV0Y2ggPSBqZXN0LmZuKCkgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZmV0Y2g+O1xuZ2xvYmFsLmZldGNoID0gbW9ja0ZldGNoO1xuXG4vLyBNb2NrIHF1ZXJ5Q2xpZW50XG5jb25zdCBjcmVhdGVNb2NrUXVlcnlDbGllbnQgPSAoKSA9PlxuICBuZXcgUXVlcnlDbGllbnQoe1xuICAgIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgICBxdWVyaWVzOiB7XG4gICAgICAgIHJldHJ5OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG5cbi8vIE1vY2sgZGF0YVxuY29uc3QgbW9ja0RlbWFuZCA9IHtcbiAgaWQ6ICdkZW1hbmQtMTIzJyxcbiAgdHlwZTogJ21haW50ZW5hbmNlJyxcbiAgZGVzY3JpcHRpb246ICdUZXN0IGRlbWFuZCcsXG4gIHN0YXR1czogJ3N1Ym1pdHRlZCcsXG4gIHN1Ym1pdHRlcklkOiAndXNlci0xMjMnLFxufTtcblxuY29uc3QgbW9ja1VzZXIgPSB7XG4gIGlkOiAndXNlci0xMjMnLFxuICByb2xlOiAncmVzaWRlbnQnLFxuICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgbGFzdE5hbWU6ICdVc2VyJyxcbn07XG5cbmNvbnN0IG1vY2tFeGlzdGluZ0NvbW1lbnRzID0gW1xuICB7XG4gICAgaWQ6ICdjb21tZW50LTEnLFxuICAgIGRlbWFuZElkOiAnZGVtYW5kLTEyMycsXG4gICAgY29tbWVudFRleHQ6ICdGaXJzdCBjb21tZW50IG9uIHRoaXMgZGVtYW5kJyxcbiAgICBjb21tZW50ZXJJZDogJ3VzZXItMTIzJyxcbiAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDEwOjAwOjAwWicsXG4gICAgYXV0aG9yOiB7XG4gICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIGlkOiAnY29tbWVudC0yJyxcbiAgICBkZW1hbmRJZDogJ2RlbWFuZC0xMjMnLFxuICAgIGNvbW1lbnRUZXh0OiAnU2Vjb25kIGNvbW1lbnQgd2l0aCBtb3JlIGRldGFpbHMnLFxuICAgIGNvbW1lbnRlcklkOiAndXNlci00NTYnLFxuICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMDFUMTE6MDA6MDBaJyxcbiAgICBhdXRob3I6IHtcbiAgICAgIGlkOiAndXNlci00NTYnLFxuICAgICAgZmlyc3ROYW1lOiAnT3RoZXInLFxuICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgIGVtYWlsOiAnb3RoZXJAZXhhbXBsZS5jb20nLFxuICAgIH0sXG4gIH0sXG5dO1xuXG4vLyBUZXN0IGNvbXBvbmVudCB0aGF0IGluY2x1ZGVzIGNvbW1lbnQgZnVuY3Rpb25hbGl0eVxuY29uc3QgVGVzdENvbW1lbnRGb3JtID0gKHsgZGVtYW5kSWQsIG9uQ29tbWVudEFkZGVkIH06IHsgZGVtYW5kSWQ6IHN0cmluZzsgb25Db21tZW50QWRkZWQ/OiAoKSA9PiB2b2lkIH0pID0+IHtcbiAgY29uc3QgW2lzU3VibWl0dGluZywgc2V0SXNTdWJtaXR0aW5nXSA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NvbW1lbnRzLCBzZXRDb21tZW50c10gPSBSZWFjdC51c2VTdGF0ZShtb2NrRXhpc3RpbmdDb21tZW50cyk7XG4gIGNvbnN0IFtjb21tZW50VGV4dCwgc2V0Q29tbWVudFRleHRdID0gUmVhY3QudXNlU3RhdGUoJycpO1xuICBjb25zdCBbY29tbWVudFR5cGUsIHNldENvbW1lbnRUeXBlXSA9IFJlYWN0LnVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW2lzSW50ZXJuYWwsIHNldElzSW50ZXJuYWxdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuXG4gIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jIChlOiBSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgc2V0SXNTdWJtaXR0aW5nKHRydWUpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvZGVtYW5kcy8ke2RlbWFuZElkfS9jb21tZW50c2AsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY29tbWVudFRleHQ6IGNvbW1lbnRUZXh0LnRyaW0oKSxcbiAgICAgICAgICBjb21tZW50VHlwZTogY29tbWVudFR5cGUgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIGlzSW50ZXJuYWwsXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBjb21tZW50Jyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG5ld0NvbW1lbnQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBzZXRDb21tZW50cyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdDb21tZW50XSk7XG4gICAgICBzZXRDb21tZW50VGV4dCgnJyk7XG4gICAgICBzZXRDb21tZW50VHlwZSgnJyk7XG4gICAgICBzZXRJc0ludGVybmFsKGZhbHNlKTtcbiAgICAgIG9uQ29tbWVudEFkZGVkPy4oKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQ29tbWVudCBzdWJtaXNzaW9uIGVycm9yOicsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNTdWJtaXR0aW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiY29tbWVudC1zZWN0aW9uXCI+XG4gICAgICB7LyogRGlzcGxheSBleGlzdGluZyBjb21tZW50cyAqL31cbiAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJjb21tZW50cy1saXN0XCI+XG4gICAgICAgIHtjb21tZW50cy5tYXAoKGNvbW1lbnQpID0+IChcbiAgICAgICAgICA8ZGl2IGtleT17Y29tbWVudC5pZH0gZGF0YS10ZXN0aWQ9e2Bjb21tZW50LSR7Y29tbWVudC5pZH1gfSBjbGFzc05hbWU9XCJjb21tZW50XCI+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPXtgY29tbWVudC1hdXRob3ItJHtjb21tZW50LmlkfWB9PlxuICAgICAgICAgICAgICB7Y29tbWVudC5hdXRob3I/LmZpcnN0TmFtZSB8fCAnVW5rbm93bid9IHtjb21tZW50LmF1dGhvcj8ubGFzdE5hbWUgfHwgJ1VzZXInfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdGlkPXtgY29tbWVudC10ZXh0LSR7Y29tbWVudC5pZH1gfT57Y29tbWVudC5jb21tZW50VGV4dH08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9e2Bjb21tZW50LWRhdGUtJHtjb21tZW50LmlkfWB9Pntjb21tZW50LmNyZWF0ZWRBdH08L2Rpdj5cbiAgICAgICAgICAgIHtjb21tZW50LmlzSW50ZXJuYWwgJiYgPGRpdiBkYXRhLXRlc3RpZD17YGNvbW1lbnQtaW50ZXJuYWwtJHtjb21tZW50LmlkfWB9PkludGVybmFsPC9kaXY+fVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7LyogQ29tbWVudCBzdWJtaXNzaW9uIGZvcm0gKi99XG4gICAgICA8Zm9ybSBkYXRhLXRlc3RpZD1cImNvbW1lbnQtZm9ybVwiIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiY29tbWVudFRleHRcIj5Db21tZW50PC9sYWJlbD5cbiAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtY29tbWVudC10ZXh0XCJcbiAgICAgICAgICAgIGlkPVwiY29tbWVudFRleHRcIlxuICAgICAgICAgICAgdmFsdWU9e2NvbW1lbnRUZXh0fVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRDb21tZW50VGV4dChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkFkZCB5b3VyIGNvbW1lbnQgaGVyZS4uLlwiXG4gICAgICAgICAgICByZXF1aXJlZFxuICAgICAgICAgICAgbWluTGVuZ3RoPXsxfVxuICAgICAgICAgICAgbWF4TGVuZ3RoPXsxMDAwfVxuICAgICAgICAgICAgcm93cz17NH1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiY29tbWVudFR5cGVcIj5Db21tZW50IFR5cGUgKE9wdGlvbmFsKTwvbGFiZWw+XG4gICAgICAgICAgPHNlbGVjdFxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJpbnB1dC1jb21tZW50LXR5cGVcIlxuICAgICAgICAgICAgaWQ9XCJjb21tZW50VHlwZVwiXG4gICAgICAgICAgICB2YWx1ZT17Y29tbWVudFR5cGV9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldENvbW1lbnRUeXBlKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+U2VsZWN0IFR5cGU8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJ1cGRhdGVcIj5VcGRhdGU8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJxdWVzdGlvblwiPlF1ZXN0aW9uPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiYW5zd2VyXCI+QW5zd2VyPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwic3RhdHVzX2NoYW5nZVwiPlN0YXR1cyBDaGFuZ2U8L29wdGlvbj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJpbnRlcm5hbF9ub3RlXCI+SW50ZXJuYWwgTm90ZTwvb3B0aW9uPlxuICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LWlzLWludGVybmFsXCJcbiAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgY2hlY2tlZD17aXNJbnRlcm5hbH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRJc0ludGVybmFsKGUudGFyZ2V0LmNoZWNrZWQpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIEludGVybmFsIENvbW1lbnQgKHZpc2libGUgdG8gc3RhZmYgb25seSlcbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgZGF0YS10ZXN0aWQ9XCJidXR0b24tc3VibWl0LWNvbW1lbnRcIlxuICAgICAgICAgIGRpc2FibGVkPXtpc1N1Ym1pdHRpbmcgfHwgY29tbWVudFRleHQudHJpbSgpLmxlbmd0aCA9PT0gMH1cbiAgICAgICAgPlxuICAgICAgICAgIHtpc1N1Ym1pdHRpbmcgPyAnQWRkaW5nIENvbW1lbnQuLi4nIDogJ0FkZCBDb21tZW50J31cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Zvcm0+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5jb25zdCBUZXN0V3JhcHBlciA9ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5Q2xpZW50ID0gY3JlYXRlTW9ja1F1ZXJ5Q2xpZW50KCk7XG4gIHJldHVybiA8UXVlcnlDbGllbnRQcm92aWRlciBjbGllbnQ9e3F1ZXJ5Q2xpZW50fT57Y2hpbGRyZW59PC9RdWVyeUNsaWVudFByb3ZpZGVyPjtcbn07XG5cbmRlc2NyaWJlKCdEZW1hbmQgQ29tbWVudCBGb3JtIFRlc3RzJywgKCkgPT4ge1xuICAvLyBNb2NrIGNvbnNvbGUuZXJyb3IgdG8gYXZvaWQgdGVzdCBvdXRwdXQgcG9sbHV0aW9uXG4gIGNvbnN0IG9yaWdpbmFsQ29uc29sZUVycm9yID0gY29uc29sZS5lcnJvcjtcbiAgXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tGZXRjaC5tb2NrQ2xlYXIoKTtcbiAgICAvLyBTdXBwcmVzcyBjb25zb2xlLmVycm9yIGR1cmluZyB0ZXN0c1xuICAgIGNvbnNvbGUuZXJyb3IgPSBqZXN0LmZuKCk7XG4gIH0pO1xuICBcbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIC8vIFJlc3RvcmUgY29uc29sZS5lcnJvciBhZnRlciB0ZXN0c1xuICAgIGNvbnNvbGUuZXJyb3IgPSBvcmlnaW5hbENvbnNvbGVFcnJvcjtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbW1lbnQgRGlzcGxheScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZXhpc3RpbmcgY29tbWVudHMnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50cy1saXN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50LWNvbW1lbnQtMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY29tbWVudC1jb21tZW50LTInKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgLy8gQ2hlY2sgY29tbWVudCBjb250ZW50XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50LXRleHQtY29tbWVudC0xJykpLnRvSGF2ZVRleHRDb250ZW50KCdGaXJzdCBjb21tZW50IG9uIHRoaXMgZGVtYW5kJyk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50LXRleHQtY29tbWVudC0yJykpLnRvSGF2ZVRleHRDb250ZW50KCdTZWNvbmQgY29tbWVudCB3aXRoIG1vcmUgZGV0YWlscycpO1xuXG4gICAgICAvLyBDaGVjayBhdXRob3IgaW5mb3JtYXRpb25cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2NvbW1lbnQtYXV0aG9yLWNvbW1lbnQtMScpKS50b0hhdmVUZXh0Q29udGVudCgnVGVzdCBVc2VyJyk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50LWF1dGhvci1jb21tZW50LTInKSkudG9IYXZlVGV4dENvbnRlbnQoJ090aGVyIFVzZXInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBjb21tZW50IHRpbWVzdGFtcHMnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdjb21tZW50LWRhdGUtY29tbWVudC0xJykpLnRvSGF2ZVRleHRDb250ZW50KCcyMDIzLTAxLTAxVDEwOjAwOjAwWicpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY29tbWVudC1kYXRlLWNvbW1lbnQtMicpKS50b0hhdmVUZXh0Q29udGVudCgnMjAyMy0wMS0wMVQxMTowMDowMFonKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbW1lbnQgRm9ybSBSZW5kZXJpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgYWxsIGZvcm0gZmllbGRzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY29tbWVudC1mb3JtJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXRleHQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdHlwZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtaXMtaW50ZXJuYWwnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtY29tbWVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgY29tbWVudCB0eXBlIG9wdGlvbnMnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCB0eXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXR5cGUnKTtcbiAgICAgIGV4cGVjdCh0eXBlU2VsZWN0KS50b0hhdmVUZXh0Q29udGVudCgnVXBkYXRlJyk7XG4gICAgICBleHBlY3QodHlwZVNlbGVjdCkudG9IYXZlVGV4dENvbnRlbnQoJ1F1ZXN0aW9uJyk7XG4gICAgICBleHBlY3QodHlwZVNlbGVjdCkudG9IYXZlVGV4dENvbnRlbnQoJ0Fuc3dlcicpO1xuICAgICAgZXhwZWN0KHR5cGVTZWxlY3QpLnRvSGF2ZVRleHRDb250ZW50KCdTdGF0dXMgQ2hhbmdlJyk7XG4gICAgICBleHBlY3QodHlwZVNlbGVjdCkudG9IYXZlVGV4dENvbnRlbnQoJ0ludGVybmFsIE5vdGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wZXIgZm9ybSBmaWVsZCBhdHRyaWJ1dGVzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuICAgICAgZXhwZWN0KHRleHRBcmVhKS50b0hhdmVBdHRyaWJ1dGUoJ3JlcXVpcmVkJyk7XG4gICAgICBleHBlY3QodGV4dEFyZWEpLnRvSGF2ZUF0dHJpYnV0ZSgnbWluTGVuZ3RoJywgJzEnKTtcbiAgICAgIGV4cGVjdCh0ZXh0QXJlYSkudG9IYXZlQXR0cmlidXRlKCdtYXhMZW5ndGgnLCAnMTAwMCcpO1xuICAgICAgZXhwZWN0KHRleHRBcmVhKS50b0hhdmVBdHRyaWJ1dGUoJ3Jvd3MnLCAnNCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRm9ybSBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzYWJsZSBzdWJtaXQgYnV0dG9uIHdoZW4gY29tbWVudCB0ZXh0IGlzIGVtcHR5JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3VibWl0LWNvbW1lbnQnKTtcbiAgICAgIGV4cGVjdChzdWJtaXRCdXR0b24pLnRvQmVEaXNhYmxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmFibGUgc3VibWl0IGJ1dHRvbiB3aGVuIGNvbW1lbnQgdGV4dCBpcyBwcm92aWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0Q29tbWVudEZvcm0gZGVtYW5kSWQ9XCJkZW1hbmQtMTIzXCIgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHRleHRBcmVhID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXRleHQnKTtcbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1jb21tZW50Jyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRleHRBcmVhLCAnVGhpcyBpcyBhIHZhbGlkIGNvbW1lbnQnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikubm90LnRvQmVEaXNhYmxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIGNvbW1lbnQgdGV4dCBmaWVsZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0Q29tbWVudEZvcm0gZGVtYW5kSWQ9XCJkZW1hbmQtMTIzXCIgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1jb21tZW50Jyk7XG4gICAgICBcbiAgICAgIC8vIFRyeSB0byBzdWJtaXQgd2l0aG91dCB0ZXh0XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcbiAgICAgIFxuICAgICAgLy8gRm9ybSB2YWxpZGF0aW9uIHNob3VsZCBwcmV2ZW50IHN1Ym1pc3Npb25cbiAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaW5pbXVtIGFuZCBtYXhpbXVtIHRleHQgbGVuZ3RoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuXG4gICAgICAvLyBUZXN0IHNpbmdsZSBjaGFyYWN0ZXIgKG1pbmltdW0pXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xlYXIodGV4dEFyZWEpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGV4dEFyZWEsICdBJyk7XG4gICAgICBleHBlY3QodGV4dEFyZWEpLnRvSGF2ZVZhbHVlKCdBJyk7XG5cbiAgICAgIC8vIFRlc3QgbWF4aW11bSBsZW5ndGggKDEwMDAgY2hhcmFjdGVycylcbiAgICAgIGNvbnN0IG1heFRleHQgPSAnQScucmVwZWF0KDEwMDApO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsZWFyKHRleHRBcmVhKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRleHRBcmVhLCBtYXhUZXh0KTtcbiAgICAgIGV4cGVjdCh0ZXh0QXJlYSkudG9IYXZlVmFsdWUobWF4VGV4dCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGb3JtIFN1Ym1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgY29tbWVudCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgaWQ6ICdjb21tZW50LTMnLFxuICAgICAgICAgIGRlbWFuZElkOiAnZGVtYW5kLTEyMycsXG4gICAgICAgICAgY29tbWVudFRleHQ6ICdOZXcgdGVzdCBjb21tZW50JyxcbiAgICAgICAgICBjb21tZW50ZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDEyOjAwOjAwWicsXG4gICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IG9uQ29tbWVudEFkZGVkID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiBvbkNvbW1lbnRBZGRlZD17b25Db21tZW50QWRkZWR9IC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCB0ZXh0QXJlYSA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10ZXh0Jyk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtY29tbWVudCcpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0ZXh0QXJlYSwgJ05ldyB0ZXN0IGNvbW1lbnQnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9kZW1hbmRzL2RlbWFuZC0xMjMvY29tbWVudHMnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbW1lbnRUZXh0OiAnTmV3IHRlc3QgY29tbWVudCcsXG4gICAgICAgICAgY29tbWVudFR5cGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qob25Db21tZW50QWRkZWQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgY29tbWVudCB3aXRoIG9wdGlvbmFsIGZpZWxkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBpZDogJ2NvbW1lbnQtMycsXG4gICAgICAgICAgZGVtYW5kSWQ6ICdkZW1hbmQtMTIzJyxcbiAgICAgICAgICBjb21tZW50VGV4dDogJ0ludGVybmFsIHVwZGF0ZSBjb21tZW50JyxcbiAgICAgICAgICBjb21tZW50VHlwZTogJ3N0YXR1c19jaGFuZ2UnLFxuICAgICAgICAgIGNvbW1lbnRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiAnMjAyMy0wMS0wMVQxMjowMDowMFonLFxuICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCB0ZXh0QXJlYSA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10ZXh0Jyk7XG4gICAgICBjb25zdCB0eXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXR5cGUnKTtcbiAgICAgIGNvbnN0IGludGVybmFsQ2hlY2tib3ggPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWlzLWludGVybmFsJyk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtY29tbWVudCcpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0ZXh0QXJlYSwgJ0ludGVybmFsIHVwZGF0ZSBjb21tZW50Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuc2VsZWN0T3B0aW9ucyh0eXBlU2VsZWN0LCAnc3RhdHVzX2NoYW5nZScpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGludGVybmFsQ2hlY2tib3gpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXBpL2RlbWFuZHMvZGVtYW5kLTEyMy9jb21tZW50cycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY29tbWVudFRleHQ6ICdJbnRlcm5hbCB1cGRhdGUgY29tbWVudCcsXG4gICAgICAgICAgY29tbWVudFR5cGU6ICdzdGF0dXNfY2hhbmdlJyxcbiAgICAgICAgICBpc0ludGVybmFsOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBsb2FkaW5nIHN0YXRlIGR1cmluZyBzdWJtaXNzaW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgKCkgPT5cbiAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSh7IFxuICAgICAgICAgICAgICBvazogdHJ1ZSwgXG4gICAgICAgICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgICAgICAgaWQ6ICdjb21tZW50LWxvYWRpbmcnLFxuICAgICAgICAgICAgICAgIGRlbWFuZElkOiAnZGVtYW5kLTEyMycsXG4gICAgICAgICAgICAgICAgY29tbWVudFRleHQ6ICdMb2FkaW5nIHRlc3QgY29tbWVudCcsXG4gICAgICAgICAgICAgICAgY29tbWVudGVySWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiAnMjAyMy0wMS0wMVQxMjowMDowMFonLFxuICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICAgICAgICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgICAgICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KSwgMTAwKVxuICAgICAgICAgIClcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0Q29tbWVudEZvcm0gZGVtYW5kSWQ9XCJkZW1hbmQtMTIzXCIgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHRleHRBcmVhID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXRleHQnKTtcbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1jb21tZW50Jyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRleHRBcmVhLCAnTG9hZGluZyB0ZXN0IGNvbW1lbnQnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICBleHBlY3Qoc3VibWl0QnV0dG9uKS50b0hhdmVUZXh0Q29udGVudCgnQWRkaW5nIENvbW1lbnQuLi4nKTtcbiAgICAgIGV4cGVjdChzdWJtaXRCdXR0b24pLnRvQmVEaXNhYmxlZCgpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikudG9IYXZlVGV4dENvbnRlbnQoJ0FkZCBDb21tZW50Jyk7XG4gICAgICAgIGV4cGVjdChzdWJtaXRCdXR0b24pLnRvQmVEaXNhYmxlZCgpOyAvLyBTaG91bGQgYmUgZGlzYWJsZWQgYmVjYXVzZSB0ZXh0YXJlYSBpcyBub3cgZW1wdHlcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjbGVhciBmb3JtIGFmdGVyIHN1Y2Nlc3NmdWwgc3VibWlzc2lvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBpZDogJ2NvbW1lbnQtMycsXG4gICAgICAgICAgZGVtYW5kSWQ6ICdkZW1hbmQtMTIzJyxcbiAgICAgICAgICBjb21tZW50VGV4dDogJ1Rlc3QgY29tbWVudCBmb3IgY2xlYXJpbmcnLFxuICAgICAgICAgIGNvbW1lbnRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMDFUMTI6MDA6MDBaJyxcbiAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiAnVGVzdCcsXG4gICAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuICAgICAgY29uc3QgdHlwZVNlbGVjdCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10eXBlJyk7XG4gICAgICBjb25zdCBpbnRlcm5hbENoZWNrYm94ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1pcy1pbnRlcm5hbCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3VibWl0LWNvbW1lbnQnKTtcblxuICAgICAgLy8gRmlsbCBmb3JtXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0ZXh0QXJlYSwgJ1Rlc3QgY29tbWVudCBmb3IgY2xlYXJpbmcnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5zZWxlY3RPcHRpb25zKHR5cGVTZWxlY3QsICd1cGRhdGUnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhpbnRlcm5hbENoZWNrYm94KTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAvLyBXYWl0IGZvciBmb3JtIHRvIGNsZWFyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHRleHRBcmVhKS50b0hhdmVWYWx1ZSgnJyk7XG4gICAgICAgIGV4cGVjdCh0eXBlU2VsZWN0KS50b0hhdmVWYWx1ZSgnJyk7XG4gICAgICAgIGV4cGVjdChpbnRlcm5hbENoZWNrYm94KS5ub3QudG9CZUNoZWNrZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3VibWlzc2lvbiBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCB0ZXh0QXJlYSA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10ZXh0Jyk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtY29tbWVudCcpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0ZXh0QXJlYSwgJ0Vycm9yIHRlc3QgY29tbWVudCcpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAvLyBGb3JtIHNob3VsZCBzdGlsbCBiZSB2aXNpYmxlIHdpdGggdGhlIHRleHQgYWZ0ZXIgZXJyb3JcbiAgICAgICAgZXhwZWN0KHRleHRBcmVhKS50b0hhdmVWYWx1ZSgnRXJyb3IgdGVzdCBjb21tZW50Jyk7XG4gICAgICAgIGV4cGVjdChzdWJtaXRCdXR0b24pLnRvSGF2ZVRleHRDb250ZW50KCdBZGQgQ29tbWVudCcpO1xuICAgICAgICBleHBlY3Qoc3VibWl0QnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZlciB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogZmFsc2UsXG4gICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBtZXNzYWdlOiAnQ29tbWVudCB0ZXh0IHRvbyBsb25nJyB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3VibWl0LWNvbW1lbnQnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGV4dEFyZWEsICdTZXJ2ZXIgZXJyb3IgdGVzdCBjb21tZW50Jyk7XG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIEZvcm0gc2hvdWxkIHJlbWFpbiB3aXRoIHRoZSB0ZXh0IGFmdGVyIHNlcnZlciBlcnJvclxuICAgICAgICBleHBlY3QodGV4dEFyZWEpLnRvSGF2ZVZhbHVlKCdTZXJ2ZXIgZXJyb3IgdGVzdCBjb21tZW50Jyk7XG4gICAgICAgIGV4cGVjdChzdWJtaXRCdXR0b24pLm5vdC50b0JlRGlzYWJsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3BlY2lhbCBDaGFyYWN0ZXJzIGFuZCBJbnRlcm5hdGlvbmFsaXphdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBGcmVuY2ggY2hhcmFjdGVycyBpbiBjb21tZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBpZDogJ2NvbW1lbnQtMycsXG4gICAgICAgICAgZGVtYW5kSWQ6ICdkZW1hbmQtMTIzJyxcbiAgICAgICAgICBjb21tZW50VGV4dDogJ0NvbW1lbnRhaXJlIGVuIGZyYW7Dp2FpcyBhdmVjIGNhcmFjdMOocmVzIHNww6ljaWF1eDogw6nDoMO5w6chJyxcbiAgICAgICAgICBjb21tZW50ZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDEyOjAwOjAwWicsXG4gICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRlc3RXcmFwcGVyPlxuICAgICAgICAgIDxUZXN0Q29tbWVudEZvcm0gZGVtYW5kSWQ9XCJkZW1hbmQtMTIzXCIgLz5cbiAgICAgICAgPC9UZXN0V3JhcHBlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHRleHRBcmVhID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXRleHQnKTtcbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1jb21tZW50Jyk7XG5cbiAgICAgIGF3YWl0IHVzZXJFdmVudC50eXBlKHRleHRBcmVhLCAnQ29tbWVudGFpcmUgZW4gZnJhbsOnYWlzIGF2ZWMgY2FyYWN0w6hyZXMgc3DDqWNpYXV4OiDDqcOgw7nDpyEnKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9kZW1hbmRzL2RlbWFuZC0xMjMvY29tbWVudHMnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbW1lbnRUZXh0OiAnQ29tbWVudGFpcmUgZW4gZnJhbsOnYWlzIGF2ZWMgY2FyYWN0w6hyZXMgc3DDqWNpYXV4OiDDqcOgw7nDpyEnLFxuICAgICAgICAgIGNvbW1lbnRUeXBlOiB1bmRlZmluZWQsXG4gICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1vamlzIGFuZCBzcGVjaWFsIHN5bWJvbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgaWQ6ICdjb21tZW50LTMnLFxuICAgICAgICAgIGRlbWFuZElkOiAnZGVtYW5kLTEyMycsXG4gICAgICAgICAgY29tbWVudFRleHQ6ICdHcmVhdCB3b3JrISDwn5GNIFRoYW5rcyBAIyQlXiYqKCknLFxuICAgICAgICAgIGNvbW1lbnRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMDFUMTI6MDA6MDBaJyxcbiAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiAnVGVzdCcsXG4gICAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3VibWl0LWNvbW1lbnQnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGV4dEFyZWEsICdHcmVhdCB3b3JrISDwn5GNIFRoYW5rcyBAIyQlXiYqKCknKTtcbiAgICAgIGF3YWl0IHVzZXJFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9kZW1hbmRzL2RlbWFuZC0xMjMvY29tbWVudHMnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbW1lbnRUZXh0OiAnR3JlYXQgd29yayEg8J+RjSBUaGFua3MgQCMkJV4mKigpJyxcbiAgICAgICAgICBjb21tZW50VHlwZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpbGluZSBjb21tZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG11bHRpbGluZVRleHQgPSBgVGhpcyBpcyBhIG11bHRpbGluZSBjb21tZW50LlxuXG5JdCBoYXMgbXVsdGlwbGUgcGFyYWdyYXBocy5cblxuRW5kIG9mIGNvbW1lbnQuYDtcblxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIGlkOiAnY29tbWVudC0zJyxcbiAgICAgICAgICBkZW1hbmRJZDogJ2RlbWFuZC0xMjMnLFxuICAgICAgICAgIGNvbW1lbnRUZXh0OiBtdWx0aWxpbmVUZXh0LFxuICAgICAgICAgIGNvbW1lbnRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMDFUMTI6MDA6MDBaJyxcbiAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZmlyc3ROYW1lOiAnVGVzdCcsXG4gICAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8VGVzdFdyYXBwZXI+XG4gICAgICAgICAgPFRlc3RDb21tZW50Rm9ybSBkZW1hbmRJZD1cImRlbWFuZC0xMjNcIiAvPlxuICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgdGV4dEFyZWEgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lucHV0LWNvbW1lbnQtdGV4dCcpO1xuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXR0b24tc3VibWl0LWNvbW1lbnQnKTtcblxuICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGV4dEFyZWEsIG11bHRpbGluZVRleHQpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXBpL2RlbWFuZHMvZGVtYW5kLTEyMy9jb21tZW50cycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY29tbWVudFRleHQ6IG11bHRpbGluZVRleHQsXG4gICAgICAgICAgY29tbWVudFR5cGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGb3JtIEJlaGF2aW9yIGFuZCBVWCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRyaW0gd2hpdGVzcGFjZSBmcm9tIGNvbW1lbnQgdGV4dCBiZWZvcmUgc3VibWlzc2lvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBpZDogJ2NvbW1lbnQtMycsXG4gICAgICAgICAgZGVtYW5kSWQ6ICdkZW1hbmQtMTIzJyxcbiAgICAgICAgICBjb21tZW50VGV4dDogJ1RyaW1tZWQgY29tbWVudCcsXG4gICAgICAgICAgY29tbWVudGVySWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgICAgY3JlYXRlZEF0OiAnMjAyMy0wMS0wMVQxMjowMDowMFonLFxuICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCB0ZXh0QXJlYSA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10ZXh0Jyk7XG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1dHRvbi1zdWJtaXQtY29tbWVudCcpO1xuXG4gICAgICBhd2FpdCB1c2VyRXZlbnQudHlwZSh0ZXh0QXJlYSwgJyAgIFRyaW1tZWQgY29tbWVudCAgICcpO1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXBpL2RlbWFuZHMvZGVtYW5kLTEyMy9jb21tZW50cycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY29tbWVudFRleHQ6ICdUcmltbWVkIGNvbW1lbnQnLFxuICAgICAgICAgIGNvbW1lbnRUeXBlOiB1bmRlZmluZWQsXG4gICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxsIGNvbW1lbnQgdHlwZXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbWVudFR5cGVzID0gWyd1cGRhdGUnLCAncXVlc3Rpb24nLCAnYW5zd2VyJywgJ3N0YXR1c19jaGFuZ2UnLCAnaW50ZXJuYWxfbm90ZSddO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHR5cGUgb2YgY29tbWVudFR5cGVzKSB7XG4gICAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgICBpZDogYGNvbW1lbnQtJHt0eXBlfWAsXG4gICAgICAgICAgICBkZW1hbmRJZDogJ2RlbWFuZC0xMjMnLFxuICAgICAgICAgICAgY29tbWVudFRleHQ6IGBDb21tZW50IG9mIHR5cGUgJHt0eXBlfWAsXG4gICAgICAgICAgICBjb21tZW50VHlwZTogdHlwZSxcbiAgICAgICAgICAgIGNvbW1lbnRlcklkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDEyOjAwOjAwWicsXG4gICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHsgdW5tb3VudCB9ID0gcmVuZGVyKFxuICAgICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICAgIDxUZXN0Q29tbWVudEZvcm0gZGVtYW5kSWQ9XCJkZW1hbmQtMTIzXCIgLz5cbiAgICAgICAgICA8L1Rlc3RXcmFwcGVyPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHRleHRBcmVhID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1jb21tZW50LXRleHQnKTtcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5wdXQtY29tbWVudC10eXBlJyk7XG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnV0dG9uLXN1Ym1pdC1jb21tZW50Jyk7XG5cbiAgICAgICAgYXdhaXQgdXNlckV2ZW50LnR5cGUodGV4dEFyZWEsIGBDb21tZW50IG9mIHR5cGUgJHt0eXBlfWApO1xuICAgICAgICBhd2FpdCB1c2VyRXZlbnQuc2VsZWN0T3B0aW9ucyh0eXBlU2VsZWN0LCB0eXBlKTtcbiAgICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvZGVtYW5kcy9kZW1hbmQtMTIzL2NvbW1lbnRzJywge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tZW50VGV4dDogYENvbW1lbnQgb2YgdHlwZSAke3R5cGV9YCxcbiAgICAgICAgICAgIGNvbW1lbnRUeXBlOiB0eXBlLFxuICAgICAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0gYXMgYW55KTtcblxuICAgICAgICBtb2NrRmV0Y2gubW9ja0NsZWFyKCk7XG4gICAgICAgIHVubW91bnQoKTsgLy8gQ2xlYW4gdXAgYmV0d2VlbiBpdGVyYXRpb25zXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnRlcm5hbCBjb21tZW50IHRvZ2dsZSBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUZXN0V3JhcHBlcj5cbiAgICAgICAgICA8VGVzdENvbW1lbnRGb3JtIGRlbWFuZElkPVwiZGVtYW5kLTEyM1wiIC8+XG4gICAgICAgIDwvVGVzdFdyYXBwZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBpbnRlcm5hbENoZWNrYm94ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdpbnB1dC1pcy1pbnRlcm5hbCcpO1xuXG4gICAgICAvLyBJbml0aWFsbHkgdW5jaGVja2VkXG4gICAgICBleHBlY3QoaW50ZXJuYWxDaGVja2JveCkubm90LnRvQmVDaGVja2VkKCk7XG5cbiAgICAgIC8vIENsaWNrIHRvIGNoZWNrXG4gICAgICBhd2FpdCB1c2VyRXZlbnQuY2xpY2soaW50ZXJuYWxDaGVja2JveCk7XG4gICAgICBleHBlY3QoaW50ZXJuYWxDaGVja2JveCkudG9CZUNoZWNrZWQoKTtcblxuICAgICAgLy8gQ2xpY2sgdG8gdW5jaGVja1xuICAgICAgYXdhaXQgdXNlckV2ZW50LmNsaWNrKGludGVybmFsQ2hlY2tib3gpO1xuICAgICAgZXhwZWN0KGludGVybmFsQ2hlY2tib3gpLm5vdC50b0JlQ2hlY2tlZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==
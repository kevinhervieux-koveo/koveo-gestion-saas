3ddcbf6be87d2250b395f326019ec262
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthProvider = AuthProvider;
exports.useAuth = useAuth;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_query_1 = require("@tanstack/react-query");
const wouter_1 = require("wouter");
/**
 * Authentication context for managing user state across the application.
 */
const AuthContext = (0, react_1.createContext)(undefined);
/**
 * Authentication provider component that wraps the application.
 * Manages user authentication state and provides authentication actions.
 * @param props - Component props.
 * @param props.children - Child components to wrap with authentication context.
 * @returns JSX element providing authentication context.
 */
function AuthProvider({ children }) {
    const queryClient = (0, react_query_1.useQueryClient)();
    const [, setLocation] = (0, wouter_1.useLocation)();
    const [user, setUser] = (0, react_1.useState)(null);
    // Check if we're on a public page that doesn't need auth
    const isPublicPage = window.location.pathname.includes('/register') ||
        window.location.pathname.includes('/login') ||
        window.location.pathname.includes('/forgot-password') ||
        window.location.pathname.includes('/reset-password') ||
        window.location.pathname.includes('/accept-invitation') ||
        window.location.pathname === '/' ||
        window.location.pathname === '/features' ||
        window.location.pathname === '/pricing' ||
        window.location.pathname === '/security' ||
        window.location.pathname === '/story' ||
        window.location.pathname === '/privacy-policy' ||
        window.location.pathname === '/terms-of-service';
    // Query to get current user (always enabled, but we handle public pages differently)
    const { data: userData, isLoading, isError, } = (0, react_query_1.useQuery)({
        queryKey: ['/api/auth/user'],
        enabled: true, // Always run auth query to prevent reload redirects
        queryFn: async () => {
            try {
                const response = await fetch('/api/auth/user', {
                    credentials: 'include',
                });
                if (response.status === 401) {
                    return null; // Not authenticated
                }
                if (!response.ok) {
                    throw new Error(`${response.status}: ${response.statusText}`);
                }
                return (await response.json());
            }
            catch (error) {
                // Silently handle auth failures on public pages
                if (!isPublicPage) {
                    console.error('Auth error:', error);
                }
                return null;
            }
        },
        retry: false,
        staleTime: 60 * 60 * 1000, // 1 hour - reduced frequency to prevent session issues
        gcTime: 2 * 60 * 60 * 1000, // 2 hours
        refetchOnWindowFocus: false, // Disable frequent focus checks to prevent session issues
        refetchOnMount: true, // Always check on mount to handle page refreshes
        refetchInterval: false, // Disable automatic refetch to prevent frequent session validation
    });
    (0, react_1.useEffect)(() => {
        setUser(userData || null);
        // Only redirect if we've completed the auth check AND user is null AND not on public page
        // Important: Wait for both !isLoading AND !isError to avoid race conditions
        if (userData === null && !isPublicPage && !isLoading && !isError) {
            setLocation('/login');
        }
    }, [userData, isPublicPage, isLoading, isError, setLocation]);
    // Login mutation
    const loginMutation = (0, react_query_1.useMutation)({
        mutationFn: async ({ email, password }) => {
            const response = await fetch('/api/auth/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email, password }),
                credentials: 'include',
            });
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Login failed');
            }
            return response.json();
        },
        onSuccess: (data) => {
            setUser(data.user);
            queryClient.setQueryData(['/api/auth/user'], data.user);
            queryClient.invalidateQueries({ queryKey: ['/api/auth/user'] });
            // Redirect to dashboard after successful login
            setLocation('/dashboard/quick-actions');
        },
    });
    // Logout mutation
    const logoutMutation = (0, react_query_1.useMutation)({
        mutationFn: async () => {
            const response = await fetch('/api/auth/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                credentials: 'include',
            });
            if (!response.ok) {
                throw new Error('Logout failed');
            }
            return response.json();
        },
        onSuccess: () => {
            setUser(null);
            queryClient.setQueryData(['/api/auth/user'], null);
            queryClient.clear();
            // Redirect to login page after logout
            setLocation('/login');
        },
    });
    /**
     * Login function that authenticates a user with email and password.
     *
     * @param email - User's email address.
     * @param password - User's password.
     * @returns Promise resolving to user data.
     */
    const login = 
    /**
     * Async function.
     * @param email - Email parameter.
     * @param password - Password parameter.
     * @returns Promise resolving to .
     */ /**
    * Async function.
    * @param email - Email parameter.
    * @param password - Password parameter.
    * @returns Promise resolving to .
    */
    async (email, password) => {
        const result = await loginMutation.mutateAsync({ email, password });
        return result;
    };
    /**
     * Logout function that ends the user session.
     */
    const logout = 
    /**
     * Async function.
     * @returns Promise resolving to void=.
     */ /**
    * Async function.
    * @returns Promise resolving to void=.
    */
    async () => {
        await logoutMutation.mutateAsync();
    };
    /**
     * Check if the current user has a specific role or any of the provided roles.
     *
     * @param role - Single role string or array of roles to check.
     * @returns True if user has the required role(s).
     */
    const hasRole = (role) => {
        /**
         * If function.
         * @param !user - !user parameter.
         */
        /**
         * If function.
         * @param !user - !user parameter.
         */ /**
        * If function.
        * @param !user - !user parameter.
        */
        /**
         * If function.
         * @param !user - !user parameter.
         */
        if (!user) {
            return false;
        }
        if (Array.isArray(role)) {
            return role.includes(user.role);
        }
        return user.role === role;
    };
    /**
     * Check if the current user has any of the provided roles.
     *
     * @param roles - Array of roles to check against.
     * @returns True if user has any of the specified roles.
     */
    const hasAnyRole = (roles) => {
        if (!user) {
            return false;
        }
        return roles.includes(user.role);
    };
    const _value = {
        user,
        isLoading,
        isAuthenticated: !!user,
        login,
        logout,
        hasRole,
        hasAnyRole,
    };
    return (0, jsx_runtime_1.jsx)(AuthContext.Provider, { value: _value, children: children });
}
/**
 * Hook to access authentication context.
 * Must be used within an AuthProvider.
 *
 * @returns Authentication context with user state and actions.
 * @throws Error if used outside of AuthProvider.
 */
/**
 * UseAuth function.
 * @returns Function result.
 */
/**
 * Use auth function.
 * @returns AuthContextType result.
 */
function useAuth() {
    const context = (0, react_1.useContext)(AuthContext); /**
     * If function.
     * @param context === undefined - context === undefined parameter.
     */ /**
    * If function.
    * @param context === undefined - context === undefined parameter.
    */
    if (context === undefined) {
        throw new Error('useAuth must be used within an AuthProvider');
    }
    return context;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2hvb2tzL3VzZS1hdXRoLnRzeCIsIm1hcHBpbmdzIjoiOztBQWdDQSxvQ0E2TkM7QUFpQkQsMEJBcUJDOztBQW5TRCxpQ0FBdUU7QUFDdkUsdURBQThFO0FBQzlFLG1DQUFxQztBQWtCckM7O0dBRUc7QUFDSCxNQUFNLFdBQVcsR0FBRyxJQUFBLHFCQUFhLEVBQThCLFNBQVMsQ0FBQyxDQUFDO0FBRTFFOzs7Ozs7R0FNRztBQUNILFNBQWdCLFlBQVksQ0FBQyxFQUFFLFFBQVEsRUFBaUM7SUFDdEUsTUFBTSxXQUFXLEdBQUcsSUFBQSw0QkFBYyxHQUFFLENBQUM7SUFDckMsTUFBTSxDQUFDLEVBQUUsV0FBVyxDQUFDLEdBQUcsSUFBQSxvQkFBVyxHQUFFLENBQUM7SUFDdEMsTUFBTSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWMsSUFBSSxDQUFDLENBQUM7SUFFcEQseURBQXlEO0lBQ3pELE1BQU0sWUFBWSxHQUNoQixNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDO1FBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7UUFDM0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDO1FBQ3JELE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQztRQUNwRCxNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUM7UUFDdkQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEtBQUssR0FBRztRQUNoQyxNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsS0FBSyxXQUFXO1FBQ3hDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxLQUFLLFVBQVU7UUFDdkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFR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QVcsRUFBRTtRQUM5QyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDVixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFDRCxPQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLENBQUMsQ0FBQztJQUVGLE1BQU0sTUFBTSxHQUFvQjtRQUM5QixJQUFJO1FBQ0osU0FBUztRQUNULGVBQWUsRUFBRSxDQUFDLENBQUMsSUFBSTtRQUN2QixLQUFLO1FBQ0wsTUFBTTtRQUNOLE9BQU87UUFDUCxVQUFVO0tBQ1gsQ0FBQztJQUVGLE9BQU8sdUJBQUMsV0FBVyxDQUFDLFFBQVEsSUFBQyxLQUFLLEVBQUUsTUFBTSxZQUFHLFFBQVEsR0FBd0IsQ0FBQztBQUNoRixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0g7OztHQUdHO0FBQ0g7OztHQUdHO0FBQ0gsU0FRQSxPQUFPO0lBQ0wsTUFBTSxPQUFPLEdBQUcsSUFBQSxrQkFBVSxFQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7OztPQUd0QyxDQUFDOzs7TUFHRDtJQUVILElBQUksT0FBTyxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzFCLE1BQU0sSUFBSSxLQUFLLENBQUMsNkNBQTZDLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBQ0QsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL2NsaWVudC9zcmMvaG9va3MvdXNlLWF1dGgudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VRdWVyeSwgdXNlTXV0YXRpb24sIHVzZVF1ZXJ5Q2xpZW50IH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IHVzZUxvY2F0aW9uIH0gZnJvbSAnd291dGVyJztcbmltcG9ydCB7IGFwaVJlcXVlc3QgfSBmcm9tICdAL2xpYi9xdWVyeUNsaWVudCc7XG5pbXBvcnQgdHlwZSB7IFVzZXIgfSBmcm9tICdAc2hhcmVkL3NjaGVtYSc7XG5cbi8qKlxuICogQXV0aGVudGljYXRpb24gY29udGV4dCBpbnRlcmZhY2UgZm9yIEtvdmVvIEdlc3Rpb24uXG4gKiBQcm92aWRlcyB1c2VyIGF1dGhlbnRpY2F0aW9uIHN0YXRlIGFuZCBhY3Rpb25zIHRocm91Z2hvdXQgdGhlIGFwcGxpY2F0aW9uLlxuICovXG5pbnRlcmZhY2UgQXV0aENvbnRleHRUeXBlIHtcbiAgdXNlcjogVXNlciB8IG51bGw7XG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbiAgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuO1xuICBsb2dpbjogKGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IFByb21pc2U8eyB1c2VyOiBVc2VyIH0+O1xuICBsb2dvdXQ6ICgpID0+IFByb21pc2U8dm9pZD47XG4gIGhhc1JvbGU6IChyb2xlOiBzdHJpbmcgfCBzdHJpbmdbXSkgPT4gYm9vbGVhbjtcbiAgaGFzQW55Um9sZTogKHJvbGVzOiBzdHJpbmdbXSkgPT4gYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBBdXRoZW50aWNhdGlvbiBjb250ZXh0IGZvciBtYW5hZ2luZyB1c2VyIHN0YXRlIGFjcm9zcyB0aGUgYXBwbGljYXRpb24uXG4gKi9cbmNvbnN0IEF1dGhDb250ZXh0ID0gY3JlYXRlQ29udGV4dDxBdXRoQ29udGV4dFR5cGUgfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG5cbi8qKlxuICogQXV0aGVudGljYXRpb24gcHJvdmlkZXIgY29tcG9uZW50IHRoYXQgd3JhcHMgdGhlIGFwcGxpY2F0aW9uLlxuICogTWFuYWdlcyB1c2VyIGF1dGhlbnRpY2F0aW9uIHN0YXRlIGFuZCBwcm92aWRlcyBhdXRoZW50aWNhdGlvbiBhY3Rpb25zLlxuICogQHBhcmFtIHByb3BzIC0gQ29tcG9uZW50IHByb3BzLlxuICogQHBhcmFtIHByb3BzLmNoaWxkcmVuIC0gQ2hpbGQgY29tcG9uZW50cyB0byB3cmFwIHdpdGggYXV0aGVudGljYXRpb24gY29udGV4dC5cbiAqIEByZXR1cm5zIEpTWCBlbGVtZW50IHByb3ZpZGluZyBhdXRoZW50aWNhdGlvbiBjb250ZXh0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gQXV0aFByb3ZpZGVyKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pIHtcbiAgY29uc3QgcXVlcnlDbGllbnQgPSB1c2VRdWVyeUNsaWVudCgpO1xuICBjb25zdCBbLCBzZXRMb2NhdGlvbl0gPSB1c2VMb2NhdGlvbigpO1xuICBjb25zdCBbdXNlciwgc2V0VXNlcl0gPSB1c2VTdGF0ZTxVc2VyIHwgbnVsbD4obnVsbCk7XG5cbiAgLy8gQ2hlY2sgaWYgd2UncmUgb24gYSBwdWJsaWMgcGFnZSB0aGF0IGRvZXNuJ3QgbmVlZCBhdXRoXG4gIGNvbnN0IGlzUHVibGljUGFnZSA9XG4gICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluY2x1ZGVzKCcvcmVnaXN0ZXInKSB8fFxuICAgIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygnL2xvZ2luJykgfHxcbiAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoJy9mb3Jnb3QtcGFzc3dvcmQnKSB8fFxuICAgIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygnL3Jlc2V0LXBhc3N3b3JkJykgfHxcbiAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoJy9hY2NlcHQtaW52aXRhdGlvbicpIHx8XG4gICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnLycgfHxcbiAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvZmVhdHVyZXMnIHx8XG4gICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL3ByaWNpbmcnIHx8XG4gICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL3NlY3VyaXR5JyB8fFxuICAgIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gJy9zdG9yeScgfHxcbiAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvcHJpdmFjeS1wb2xpY3knIHx8XG4gICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL3Rlcm1zLW9mLXNlcnZpY2UnO1xuXG4gIC8vIFF1ZXJ5IHRvIGdldCBjdXJyZW50IHVzZXIgKGFsd2F5cyBlbmFibGVkLCBidXQgd2UgaGFuZGxlIHB1YmxpYyBwYWdlcyBkaWZmZXJlbnRseSlcbiAgY29uc3Qge1xuICAgIGRhdGE6IHVzZXJEYXRhLFxuICAgIGlzTG9hZGluZyxcbiAgICBpc0Vycm9yLFxuICB9ID0gdXNlUXVlcnk8VXNlciB8IG51bGw+KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2F1dGgvdXNlciddLFxuICAgIGVuYWJsZWQ6IHRydWUsIC8vIEFsd2F5cyBydW4gYXV0aCBxdWVyeSB0byBwcmV2ZW50IHJlbG9hZCByZWRpcmVjdHNcbiAgICBxdWVyeUZuOiBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2F1dGgvdXNlcicsIHtcbiAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gTm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpIGFzIFVzZXI7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBTaWxlbnRseSBoYW5kbGUgYXV0aCBmYWlsdXJlcyBvbiBwdWJsaWMgcGFnZXNcbiAgICAgICAgaWYgKCFpc1B1YmxpY1BhZ2UpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdBdXRoIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJldHJ5OiBmYWxzZSxcbiAgICBzdGFsZVRpbWU6IDYwICogNjAgKiAxMDAwLCAvLyAxIGhvdXIgLSByZWR1Y2VkIGZyZXF1ZW5jeSB0byBwcmV2ZW50IHNlc3Npb24gaXNzdWVzXG4gICAgZ2NUaW1lOiAyICogNjAgKiA2MCAqIDEwMDAsIC8vIDIgaG91cnNcbiAgICByZWZldGNoT25XaW5kb3dGb2N1czogZmFsc2UsIC8vIERpc2FibGUgZnJlcXVlbnQgZm9jdXMgY2hlY2tzIHRvIHByZXZlbnQgc2Vzc2lvbiBpc3N1ZXNcbiAgICByZWZldGNoT25Nb3VudDogdHJ1ZSwgLy8gQWx3YXlzIGNoZWNrIG9uIG1vdW50IHRvIGhhbmRsZSBwYWdlIHJlZnJlc2hlc1xuICAgIHJlZmV0Y2hJbnRlcnZhbDogZmFsc2UsIC8vIERpc2FibGUgYXV0b21hdGljIHJlZmV0Y2ggdG8gcHJldmVudCBmcmVxdWVudCBzZXNzaW9uIHZhbGlkYXRpb25cbiAgfSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRVc2VyKHVzZXJEYXRhIHx8IG51bGwpO1xuXG4gICAgLy8gT25seSByZWRpcmVjdCBpZiB3ZSd2ZSBjb21wbGV0ZWQgdGhlIGF1dGggY2hlY2sgQU5EIHVzZXIgaXMgbnVsbCBBTkQgbm90IG9uIHB1YmxpYyBwYWdlXG4gICAgLy8gSW1wb3J0YW50OiBXYWl0IGZvciBib3RoICFpc0xvYWRpbmcgQU5EICFpc0Vycm9yIHRvIGF2b2lkIHJhY2UgY29uZGl0aW9uc1xuICAgIGlmICh1c2VyRGF0YSA9PT0gbnVsbCAmJiAhaXNQdWJsaWNQYWdlICYmICFpc0xvYWRpbmcgJiYgIWlzRXJyb3IpIHtcbiAgICAgIHNldExvY2F0aW9uKCcvbG9naW4nKTtcbiAgICB9XG4gIH0sIFt1c2VyRGF0YSwgaXNQdWJsaWNQYWdlLCBpc0xvYWRpbmcsIGlzRXJyb3IsIHNldExvY2F0aW9uXSk7XG5cbiAgLy8gTG9naW4gbXV0YXRpb25cbiAgY29uc3QgbG9naW5NdXRhdGlvbiA9IHVzZU11dGF0aW9uKHtcbiAgICBtdXRhdGlvbkZuOiBhc3luYyAoeyBlbWFpbCwgcGFzc3dvcmQgfTogeyBlbWFpbDogc3RyaW5nOyBwYXNzd29yZDogc3RyaW5nIH0pID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBwYXNzd29yZCB9KSxcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSB8fCAnTG9naW4gZmFpbGVkJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBvblN1Y2Nlc3M6IChkYXRhKSA9PiB7XG4gICAgICBzZXRVc2VyKGRhdGEudXNlcik7XG4gICAgICBxdWVyeUNsaWVudC5zZXRRdWVyeURhdGEoWycvYXBpL2F1dGgvdXNlciddLCBkYXRhLnVzZXIpO1xuICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2F1dGgvdXNlciddIH0pO1xuICAgICAgLy8gUmVkaXJlY3QgdG8gZGFzaGJvYXJkIGFmdGVyIHN1Y2Nlc3NmdWwgbG9naW5cbiAgICAgIHNldExvY2F0aW9uKCcvZGFzaGJvYXJkL3F1aWNrLWFjdGlvbnMnKTtcbiAgICB9LFxuICB9KTtcblxuICAvLyBMb2dvdXQgbXV0YXRpb25cbiAgY29uc3QgbG9nb3V0TXV0YXRpb24gPSB1c2VNdXRhdGlvbih7XG4gICAgbXV0YXRpb25GbjogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9hdXRoL2xvZ291dCcsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2dvdXQgZmFpbGVkJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgfSxcbiAgICBvblN1Y2Nlc3M6ICgpID0+IHtcbiAgICAgIHNldFVzZXIobnVsbCk7XG4gICAgICBxdWVyeUNsaWVudC5zZXRRdWVyeURhdGEoWycvYXBpL2F1dGgvdXNlciddLCBudWxsKTtcbiAgICAgIHF1ZXJ5Q2xpZW50LmNsZWFyKCk7XG4gICAgICAvLyBSZWRpcmVjdCB0byBsb2dpbiBwYWdlIGFmdGVyIGxvZ291dFxuICAgICAgc2V0TG9jYXRpb24oJy9sb2dpbicpO1xuICAgIH0sXG4gIH0pO1xuXG4gIC8qKlxuICAgKiBMb2dpbiBmdW5jdGlvbiB0aGF0IGF1dGhlbnRpY2F0ZXMgYSB1c2VyIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkLlxuICAgKlxuICAgKiBAcGFyYW0gZW1haWwgLSBVc2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAgICogQHBhcmFtIHBhc3N3b3JkIC0gVXNlcidzIHBhc3N3b3JkLlxuICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byB1c2VyIGRhdGEuXG4gICAqL1xuICBjb25zdCBsb2dpbiA9XG4gICAgLyoqXG4gICAgICogQXN5bmMgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIGVtYWlsIC0gRW1haWwgcGFyYW1ldGVyLlxuICAgICAqIEBwYXJhbSBwYXNzd29yZCAtIFBhc3N3b3JkIHBhcmFtZXRlci5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byAuXG4gICAgICovIC8qKlxuICAgICAqIEFzeW5jIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBlbWFpbCAtIEVtYWlsIHBhcmFtZXRlci5cbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQgLSBQYXNzd29yZCBwYXJhbWV0ZXIuXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gLlxuICAgICAqL1xuXG4gICAgYXN5bmMgKGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHsgdXNlcjogVXNlciB9PiA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBsb2dpbk11dGF0aW9uLm11dGF0ZUFzeW5jKHsgZW1haWwsIHBhc3N3b3JkIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBMb2dvdXQgZnVuY3Rpb24gdGhhdCBlbmRzIHRoZSB1c2VyIHNlc3Npb24uXG4gICAqL1xuICBjb25zdCBsb2dvdXQgPVxuICAgIC8qKlxuICAgICAqIEFzeW5jIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2aW5nIHRvIHZvaWQ9LlxuICAgICAqLyAvKipcbiAgICAgKiBBc3luYyBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byB2b2lkPS5cbiAgICAgKi9cblxuICAgIGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgIGF3YWl0IGxvZ291dE11dGF0aW9uLm11dGF0ZUFzeW5jKCk7XG4gICAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYSBzcGVjaWZpYyByb2xlIG9yIGFueSBvZiB0aGUgcHJvdmlkZWQgcm9sZXMuXG4gICAqXG4gICAqIEBwYXJhbSByb2xlIC0gU2luZ2xlIHJvbGUgc3RyaW5nIG9yIGFycmF5IG9mIHJvbGVzIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHVzZXIgaGFzIHRoZSByZXF1aXJlZCByb2xlKHMpLlxuICAgKi9cbiAgY29uc3QgaGFzUm9sZSA9IChyb2xlOiBzdHJpbmcgfCBzdHJpbmdbXSk6IGJvb2xlYW4gPT4ge1xuICAgIC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSAhdXNlciAtICF1c2VyIHBhcmFtZXRlci5cbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBJZiBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gIXVzZXIgLSAhdXNlciBwYXJhbWV0ZXIuXG4gICAgICovIC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSAhdXNlciAtICF1c2VyIHBhcmFtZXRlci5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIElmIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSAhdXNlciAtICF1c2VyIHBhcmFtZXRlci5cbiAgICAgKi9cblxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShyb2xlKSkge1xuICAgICAgcmV0dXJuIHJvbGUuaW5jbHVkZXModXNlci5yb2xlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVzZXIucm9sZSA9PT0gcm9sZTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgYW55IG9mIHRoZSBwcm92aWRlZCByb2xlcy5cbiAgICpcbiAgICogQHBhcmFtIHJvbGVzIC0gQXJyYXkgb2Ygcm9sZXMgdG8gY2hlY2sgYWdhaW5zdC5cbiAgICogQHJldHVybnMgVHJ1ZSBpZiB1c2VyIGhhcyBhbnkgb2YgdGhlIHNwZWNpZmllZCByb2xlcy5cbiAgICovXG4gIGNvbnN0IGhhc0FueVJvbGUgPSAocm9sZXM6IHN0cmluZ1tdKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiByb2xlcy5pbmNsdWRlcyh1c2VyLnJvbGUpO1xuICB9O1xuXG4gIGNvbnN0IF92YWx1ZTogQXV0aENvbnRleHRUeXBlID0ge1xuICAgIHVzZXIsXG4gICAgaXNMb2FkaW5nLFxuICAgIGlzQXV0aGVudGljYXRlZDogISF1c2VyLFxuICAgIGxvZ2luLFxuICAgIGxvZ291dCxcbiAgICBoYXNSb2xlLFxuICAgIGhhc0FueVJvbGUsXG4gIH07XG5cbiAgcmV0dXJuIDxBdXRoQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17X3ZhbHVlfT57Y2hpbGRyZW59PC9BdXRoQ29udGV4dC5Qcm92aWRlcj47XG59XG5cbi8qKlxuICogSG9vayB0byBhY2Nlc3MgYXV0aGVudGljYXRpb24gY29udGV4dC5cbiAqIE11c3QgYmUgdXNlZCB3aXRoaW4gYW4gQXV0aFByb3ZpZGVyLlxuICpcbiAqIEByZXR1cm5zIEF1dGhlbnRpY2F0aW9uIGNvbnRleHQgd2l0aCB1c2VyIHN0YXRlIGFuZCBhY3Rpb25zLlxuICogQHRocm93cyBFcnJvciBpZiB1c2VkIG91dHNpZGUgb2YgQXV0aFByb3ZpZGVyLlxuICovXG4vKipcbiAqIFVzZUF1dGggZnVuY3Rpb24uXG4gKiBAcmV0dXJucyBGdW5jdGlvbiByZXN1bHQuXG4gKi9cbi8qKlxuICogVXNlIGF1dGggZnVuY3Rpb24uXG4gKiBAcmV0dXJucyBBdXRoQ29udGV4dFR5cGUgcmVzdWx0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gLyoqXG4gKiBVc2UgYXV0aCBmdW5jdGlvbi5cbiAqIEByZXR1cm5zIEF1dGhDb250ZXh0VHlwZSByZXN1bHQuXG4gKi8gLyoqXG4gKiBVc2UgYXV0aCBmdW5jdGlvbi5cbiAqIEByZXR1cm5zIEF1dGhDb250ZXh0VHlwZSByZXN1bHQuXG4gKi9cblxudXNlQXV0aCgpOiBBdXRoQ29udGV4dFR5cGUge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChBdXRoQ29udGV4dCk7IC8qKlxuICAgKiBJZiBmdW5jdGlvbi5cbiAgICogQHBhcmFtIGNvbnRleHQgPT09IHVuZGVmaW5lZCAtIGNvbnRleHQgPT09IHVuZGVmaW5lZCBwYXJhbWV0ZXIuXG4gICAqLyAvKipcbiAgICogSWYgZnVuY3Rpb24uXG4gICAqIEBwYXJhbSBjb250ZXh0ID09PSB1bmRlZmluZWQgLSBjb250ZXh0ID09PSB1bmRlZmluZWQgcGFyYW1ldGVyLlxuICAgKi9cblxuICBpZiAoY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCd1c2VBdXRoIG11c3QgYmUgdXNlZCB3aXRoaW4gYW4gQXV0aFByb3ZpZGVyJyk7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59XG4iXSwidmVyc2lvbiI6M30=
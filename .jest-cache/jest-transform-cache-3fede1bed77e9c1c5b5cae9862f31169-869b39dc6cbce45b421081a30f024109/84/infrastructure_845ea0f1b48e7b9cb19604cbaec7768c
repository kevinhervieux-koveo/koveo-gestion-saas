82f0ab0ab040b854058662a00950afba
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.insertSessionSchema = exports.insertSslCertificateSchema = exports.sessions = exports.sslCertificates = exports.sslStatusEnum = void 0;
const drizzle_orm_1 = require("drizzle-orm");
const pg_core_1 = require("drizzle-orm/pg-core");
const zod_1 = require("zod");
const core_1 = require("./core");
// Infrastructure enums
exports.sslStatusEnum = (0, pg_core_1.pgEnum)('ssl_status', [
    'active',
    'pending',
    'expired',
    'revoked',
    'failed',
]);
// Infrastructure tables
/**
 * SSL certificates table for managing domain SSL certificates.
 * Supports automated certificate management and renewal tracking.
 */
exports.sslCertificates = (0, pg_core_1.pgTable)('ssl_certificates', {
    id: (0, pg_core_1.uuid)('id')
        .primaryKey()
        .default((0, drizzle_orm_1.sql) `gen_random_uuid()`),
    domain: (0, pg_core_1.text)('domain').notNull().unique(),
    certificateData: (0, pg_core_1.text)('certificate_data').notNull(),
    privateKey: (0, pg_core_1.text)('private_key').notNull(),
    issuer: (0, pg_core_1.text)('issuer').notNull(),
    subject: (0, pg_core_1.text)('subject').notNull(),
    serialNumber: (0, pg_core_1.text)('serial_number').notNull(),
    fingerprint: (0, pg_core_1.text)('fingerprint').notNull(),
    validFrom: (0, pg_core_1.timestamp)('valid_from').notNull(),
    validTo: (0, pg_core_1.timestamp)('valid_to').notNull(),
    status: (0, exports.sslStatusEnum)('status').notNull().default('pending'),
    autoRenew: (0, pg_core_1.boolean)('auto_renew').notNull().default(true),
    renewalAttempts: (0, pg_core_1.integer)('renewal_attempts').notNull().default(0),
    maxRenewalAttempts: (0, pg_core_1.integer)('max_renewal_attempts').notNull().default(3),
    dnsProvider: (0, pg_core_1.text)('dns_provider'),
    lastRenewalAttempt: (0, pg_core_1.timestamp)('last_renewal_attempt'),
    nextRenewalDate: (0, pg_core_1.timestamp)('next_renewal_date'),
    // Additional SSL management fields
    certificateChain: (0, pg_core_1.text)('certificate_chain'),
    renewalError: (0, pg_core_1.text)('renewal_error'),
    dnsCredentials: (0, pg_core_1.text)('dns_credentials'),
    notificationEmails: (0, pg_core_1.text)('notification_emails'),
    createdBy: (0, pg_core_1.varchar)('created_by')
        .notNull()
        .references(() => core_1.users.id),
    createdAt: (0, pg_core_1.timestamp)('created_at').defaultNow(),
    updatedAt: (0, pg_core_1.timestamp)('updated_at').defaultNow(),
});
/**
 * Session table for PostgreSQL session store.
 * This table stores user session data for authentication.
 * CRITICAL: This table must never be deleted as it's required for user sessions.
 */
exports.sessions = (0, pg_core_1.pgTable)('session', {
    sid: (0, pg_core_1.varchar)('sid').primaryKey().notNull(),
    sess: (0, pg_core_1.json)('sess').notNull(),
    expire: (0, pg_core_1.timestamp)('expire', { precision: 6 }).notNull(),
});
// Insert schemas
exports.insertSslCertificateSchema = zod_1.z.object({
    domain: zod_1.z.string(),
    certificateData: zod_1.z.string(),
    privateKey: zod_1.z.string(),
    issuer: zod_1.z.string(),
    subject: zod_1.z.string(),
    serialNumber: zod_1.z.string(),
    fingerprint: zod_1.z.string(),
    validFrom: zod_1.z.date(),
    validTo: zod_1.z.date(),
    status: zod_1.z.string().default('pending'),
    autoRenew: zod_1.z.boolean().default(true),
    renewalAttempts: zod_1.z.number().int().default(0),
    maxRenewalAttempts: zod_1.z.number().int().default(3),
    dnsProvider: zod_1.z.string().optional(),
    lastRenewalAttempt: zod_1.z.date().optional(),
    nextRenewalDate: zod_1.z.date().optional(),
    createdBy: zod_1.z.string().uuid(),
});
// Types
// Session table schema (no insert schema needed - managed by connect-pg-simple)
exports.insertSessionSchema = zod_1.z.object({
    sid: zod_1.z.string(),
    sess: zod_1.z.any(), // JSON data
    expire: zod_1.z.date(),
});
// Relations - temporarily commented out due to drizzle-orm version compatibility
// export const sslCertificatesRelations = relations(sslCertificates, ({ one }) => ({
//   createdBy: one(users, {
//     fields: [sslCertificates.createdBy],
//     references: [users.id],
//   }),
// }));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zaGFyZWQvc2NoZW1hcy9pbmZyYXN0cnVjdHVyZS50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBa0M7QUFDbEMsaURBQThHO0FBRTlHLDZCQUF3QjtBQUV4QixpQ0FBK0I7QUFFL0IsdUJBQXVCO0FBQ1YsUUFBQSxhQUFhLEdBQUcsSUFBQSxnQkFBTSxFQUFDLFlBQVksRUFBRTtJQUNoRCxRQUFRO0lBQ1IsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsUUFBUTtDQUNULENBQUMsQ0FBQztBQUVILHdCQUF3QjtBQUN4Qjs7O0dBR0c7QUFDVSxRQUFBLGVBQWUsR0FBRyxJQUFBLGlCQUFPLEVBQUMsa0JBQWtCLEVBQUU7SUFDekQsRUFBRSxFQUFFLElBQUEsY0FBSSxFQUFDLElBQUksQ0FBQztTQUNYLFVBQVUsRUFBRTtTQUNaLE9BQU8sQ0FBQyxJQUFBLGlCQUFHLEVBQUEsbUJBQW1CLENBQUM7SUFDbEMsTUFBTSxFQUFFLElBQUEsY0FBSSxFQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLE1BQU0sRUFBRTtJQUN6QyxlQUFlLEVBQUUsSUFBQSxjQUFJLEVBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDbkQsVUFBVSxFQUFFLElBQUEsY0FBSSxFQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sRUFBRTtJQUN6QyxNQUFNLEVBQUUsSUFBQSxjQUFJLEVBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQ2hDLE9BQU8sRUFBRSxJQUFBLGNBQUksRUFBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDbEMsWUFBWSxFQUFFLElBQUEsY0FBSSxFQUFDLGVBQWUsQ0FBQyxDQUFDLE9BQU8sRUFBRTtJQUM3QyxXQUFXLEVBQUUsSUFBQSxjQUFJLEVBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQzFDLFNBQVMsRUFBRSxJQUFBLG1CQUFTLEVBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQzVD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QUMsQ0FBQztJQUM1QyxrQkFBa0IsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUMvQyxXQUFXLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtJQUNsQyxrQkFBa0IsRUFBRSxPQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQ3ZDLGVBQWUsRUFBRSxPQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQ3BDLFNBQVMsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxFQUFFO0NBQzdCLENBQUMsQ0FBQztBQUVILFFBQVE7QUFDUixnRkFBZ0Y7QUFDbkUsUUFBQSxtQkFBbUIsR0FBRyxPQUFDLENBQUMsTUFBTSxDQUFDO0lBQzFDLEdBQUcsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFO0lBQ2YsSUFBSSxFQUFFLE9BQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxZQUFZO0lBQzNCLE1BQU0sRUFBRSxPQUFDLENBQUMsSUFBSSxFQUFFO0NBQ2pCLENBQUMsQ0FBQztBQVFILGlGQUFpRjtBQUNqRixxRkFBcUY7QUFDckYsNEJBQTRCO0FBQzVCLDJDQUEyQztBQUMzQyw4QkFBOEI7QUFDOUIsUUFBUTtBQUNSLE9BQU8iLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zaGFyZWQvc2NoZW1hcy9pbmZyYXN0cnVjdHVyZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcWwgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgeyBwZ1RhYmxlLCB0ZXh0LCB0aW1lc3RhbXAsIHV1aWQsIHBnRW51bSwgYm9vbGVhbiwgaW50ZWdlciwgdmFyY2hhciwganNvbiB9IGZyb20gJ2RyaXp6bGUtb3JtL3BnLWNvcmUnO1xuaW1wb3J0IHsgY3JlYXRlSW5zZXJ0U2NoZW1hIH0gZnJvbSAnZHJpenpsZS16b2QnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyByZWxhdGlvbnMgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgeyB1c2VycyB9IGZyb20gJy4vY29yZSc7XG5cbi8vIEluZnJhc3RydWN0dXJlIGVudW1zXG5leHBvcnQgY29uc3Qgc3NsU3RhdHVzRW51bSA9IHBnRW51bSgnc3NsX3N0YXR1cycsIFtcbiAgJ2FjdGl2ZScsXG4gICdwZW5kaW5nJyxcbiAgJ2V4cGlyZWQnLFxuICAncmV2b2tlZCcsXG4gICdmYWlsZWQnLFxuXSk7XG5cbi8vIEluZnJhc3RydWN0dXJlIHRhYmxlc1xuLyoqXG4gKiBTU0wgY2VydGlmaWNhdGVzIHRhYmxlIGZvciBtYW5hZ2luZyBkb21haW4gU1NMIGNlcnRpZmljYXRlcy5cbiAqIFN1cHBvcnRzIGF1dG9tYXRlZCBjZXJ0aWZpY2F0ZSBtYW5hZ2VtZW50IGFuZCByZW5ld2FsIHRyYWNraW5nLlxuICovXG5leHBvcnQgY29uc3Qgc3NsQ2VydGlmaWNhdGVzID0gcGdUYWJsZSgnc3NsX2NlcnRpZmljYXRlcycsIHtcbiAgaWQ6IHV1aWQoJ2lkJylcbiAgICAucHJpbWFyeUtleSgpXG4gICAgLmRlZmF1bHQoc3FsYGdlbl9yYW5kb21fdXVpZCgpYCksXG4gIGRvbWFpbjogdGV4dCgnZG9tYWluJykubm90TnVsbCgpLnVuaXF1ZSgpLFxuICBjZXJ0aWZpY2F0ZURhdGE6IHRleHQoJ2NlcnRpZmljYXRlX2RhdGEnKS5ub3ROdWxsKCksXG4gIHByaXZhdGVLZXk6IHRleHQoJ3ByaXZhdGVfa2V5Jykubm90TnVsbCgpLFxuICBpc3N1ZXI6IHRleHQoJ2lzc3VlcicpLm5vdE51bGwoKSxcbiAgc3ViamVjdDogdGV4dCgnc3ViamVjdCcpLm5vdE51bGwoKSxcbiAgc2VyaWFsTnVtYmVyOiB0ZXh0KCdzZXJpYWxfbnVtYmVyJykubm90TnVsbCgpLFxuICBmaW5nZXJwcmludDogdGV4dCgnZmluZ2VycHJpbnQnKS5ub3ROdWxsKCksXG4gIHZhbGlkRnJvbTogdGltZXN0YW1wKCd2YWxpZF9mcm9tJykubm90TnVsbCgpLFxuICB2YWxpZFRvOiB0aW1lc3RhbXAoJ3ZhbGlkX3RvJykubm90TnVsbCgpLFxuICBzdGF0dXM6IHNzbFN0YXR1c0VudW0oJ3N0YXR1cycpLm5vdE51bGwoKS5kZWZhdWx0KCdwZW5kaW5nJyksXG4gIGF1dG9SZW5ldzogYm9vbGVhbignYXV0b19yZW5ldycpLm5vdE51bGwoKS5kZWZhdWx0KHRydWUpLFxuICByZW5ld2FsQXR0ZW1wdHM6IGludGVnZXIoJ3JlbmV3YWxfYXR0ZW1wdHMnKS5ub3ROdWxsKCkuZGVmYXVsdCgwKSxcbiAgbWF4UmVuZXdhbEF0dGVtcHRzOiBpbnRlZ2VyKCdtYXhfcmVuZXdhbF9hdHRlbXB0cycpLm5vdE51bGwoKS5kZWZhdWx0KDMpLFxuICBkbnNQcm92aWRlcjogdGV4dCgnZG5zX3Byb3ZpZGVyJyksXG4gIGxhc3RSZW5ld2FsQXR0ZW1wdDogdGltZXN0YW1wKCdsYXN0X3JlbmV3YWxfYXR0ZW1wdCcpLFxuICBuZXh0UmVuZXdhbERhdGU6IHRpbWVzdGFtcCgnbmV4dF9yZW5ld2FsX2RhdGUnKSxcbiAgLy8gQWRkaXRpb25hbCBTU0wgbWFuYWdlbWVudCBmaWVsZHNcbiAgY2VydGlmaWNhdGVDaGFpbjogdGV4dCgnY2VydGlmaWNhdGVfY2hhaW4nKSxcbiAgcmVuZXdhbEVycm9yOiB0ZXh0KCdyZW5ld2FsX2Vycm9yJyksXG4gIGRuc0NyZWRlbnRpYWxzOiB0ZXh0KCdkbnNfY3JlZGVudGlhbHMnKSxcbiAgbm90aWZpY2F0aW9uRW1haWxzOiB0ZXh0KCdub3RpZmljYXRpb25fZW1haWxzJyksXG4gIGNyZWF0ZWRCeTogdmFyY2hhcignY3JlYXRlZF9ieScpXG4gICAgLm5vdE51bGwoKVxuICAgIC5yZWZlcmVuY2VzKCgpID0+IHVzZXJzLmlkKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnKS5kZWZhdWx0Tm93KCksXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxufSk7XG5cbi8qKlxuICogU2Vzc2lvbiB0YWJsZSBmb3IgUG9zdGdyZVNRTCBzZXNzaW9uIHN0b3JlLlxuICogVGhpcyB0YWJsZSBzdG9yZXMgdXNlciBzZXNzaW9uIGRhdGEgZm9yIGF1dGhlbnRpY2F0aW9uLlxuICogQ1JJVElDQUw6IFRoaXMgdGFibGUgbXVzdCBuZXZlciBiZSBkZWxldGVkIGFzIGl0J3MgcmVxdWlyZWQgZm9yIHVzZXIgc2Vzc2lvbnMuXG4gKi9cbmV4cG9ydCBjb25zdCBzZXNzaW9ucyA9IHBnVGFibGUoJ3Nlc3Npb24nLCB7XG4gIHNpZDogdmFyY2hhcignc2lkJykucHJpbWFyeUtleSgpLm5vdE51bGwoKSxcbiAgc2VzczoganNvbignc2VzcycpLm5vdE51bGwoKSxcbiAgZXhwaXJlOiB0aW1lc3RhbXAoJ2V4cGlyZScsIHsgcHJlY2lzaW9uOiA2IH0pLm5vdE51bGwoKSxcbn0pO1xuXG4vLyBJbnNlcnQgc2NoZW1hc1xuZXhwb3J0IGNvbnN0IGluc2VydFNzbENlcnRpZmljYXRlU2NoZW1hID0gei5vYmplY3Qoe1xuICBkb21haW46IHouc3RyaW5nKCksXG4gIGNlcnRpZmljYXRlRGF0YTogei5zdHJpbmcoKSxcbiAgcHJpdmF0ZUtleTogei5zdHJpbmcoKSxcbiAgaXNzdWVyOiB6LnN0cmluZygpLFxuICBzdWJqZWN0OiB6LnN0cmluZygpLFxuICBzZXJpYWxOdW1iZXI6IHouc3RyaW5nKCksXG4gIGZpbmdlcnByaW50OiB6LnN0cmluZygpLFxuICB2YWxpZEZyb206IHouZGF0ZSgpLFxuICB2YWxpZFRvOiB6LmRhdGUoKSxcbiAgc3RhdHVzOiB6LnN0cmluZygpLmRlZmF1bHQoJ3BlbmRpbmcnKSxcbiAgYXV0b1JlbmV3OiB6LmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpLFxuICByZW5ld2FsQXR0ZW1wdHM6IHoubnVtYmVyKCkuaW50KCkuZGVmYXVsdCgwKSxcbiAgbWF4UmVuZXdhbEF0dGVtcHRzOiB6Lm51bWJlcigpLmludCgpLmRlZmF1bHQoMyksXG4gIGRuc1Byb3ZpZGVyOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGxhc3RSZW5ld2FsQXR0ZW1wdDogei5kYXRlKCkub3B0aW9uYWwoKSxcbiAgbmV4dFJlbmV3YWxEYXRlOiB6LmRhdGUoKS5vcHRpb25hbCgpLFxuICBjcmVhdGVkQnk6IHouc3RyaW5nKCkudXVpZCgpLFxufSk7XG5cbi8vIFR5cGVzXG4vLyBTZXNzaW9uIHRhYmxlIHNjaGVtYSAobm8gaW5zZXJ0IHNjaGVtYSBuZWVkZWQgLSBtYW5hZ2VkIGJ5IGNvbm5lY3QtcGctc2ltcGxlKVxuZXhwb3J0IGNvbnN0IGluc2VydFNlc3Npb25TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHNpZDogei5zdHJpbmcoKSxcbiAgc2Vzczogei5hbnkoKSwgLy8gSlNPTiBkYXRhXG4gIGV4cGlyZTogei5kYXRlKCksXG59KTtcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIEluc2VydFNzbENlcnRpZmljYXRlID0gei5pbmZlcjx0eXBlb2YgaW5zZXJ0U3NsQ2VydGlmaWNhdGVTY2hlbWE+O1xuZXhwb3J0IHR5cGUgU3NsQ2VydGlmaWNhdGUgPSB0eXBlb2Ygc3NsQ2VydGlmaWNhdGVzLiRpbmZlclNlbGVjdDtcbmV4cG9ydCB0eXBlIEluc2VydFNlc3Npb24gPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRTZXNzaW9uU2NoZW1hPjtcbmV4cG9ydCB0eXBlIFNlc3Npb24gPSB0eXBlb2Ygc2Vzc2lvbnMuJGluZmVyU2VsZWN0O1xuXG4vLyBSZWxhdGlvbnMgLSB0ZW1wb3JhcmlseSBjb21tZW50ZWQgb3V0IGR1ZSB0byBkcml6emxlLW9ybSB2ZXJzaW9uIGNvbXBhdGliaWxpdHlcbi8vIGV4cG9ydCBjb25zdCBzc2xDZXJ0aWZpY2F0ZXNSZWxhdGlvbnMgPSByZWxhdGlvbnMoc3NsQ2VydGlmaWNhdGVzLCAoeyBvbmUgfSkgPT4gKHtcbi8vICAgY3JlYXRlZEJ5OiBvbmUodXNlcnMsIHtcbi8vICAgICBmaWVsZHM6IFtzc2xDZXJ0aWZpY2F0ZXMuY3JlYXRlZEJ5XSxcbi8vICAgICByZWZlcmVuY2VzOiBbdXNlcnMuaWRdLFxuLy8gICB9KSxcbi8vIH0pKTtcbiJdLCJ2ZXJzaW9uIjozfQ==
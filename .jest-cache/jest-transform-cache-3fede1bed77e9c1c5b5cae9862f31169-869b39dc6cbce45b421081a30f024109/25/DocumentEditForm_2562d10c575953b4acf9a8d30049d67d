6b5254905e8c1aef5eeb9650bde0af09
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.DocumentEditForm = DocumentEditForm;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const react_hook_form_1 = require("react-hook-form");
const zod_1 = require("@hookform/resolvers/zod");
const react_query_1 = require("@tanstack/react-query");
const zod_2 = require("zod");
const button_1 = require("@/components/ui/button");
const input_1 = require("@/components/ui/input");
const textarea_1 = require("@/components/ui/textarea");
const label_1 = require("@/components/ui/label");
const switch_1 = require("@/components/ui/switch");
const form_1 = require("@/components/ui/form");
const select_1 = require("@/components/ui/select");
const card_1 = require("@/components/ui/card");
const lucide_react_1 = require("lucide-react");
const use_toast_1 = require("@/hooks/use-toast");
const queryClient_1 = require("@/lib/queryClient");
const SharedUploader_1 = require("./SharedUploader");
// Document categories matching the ones used in DocumentCreateForm
const DOCUMENT_CATEGORIES = [
    { value: 'bylaw', label: 'Bylaws' },
    { value: 'financial', label: 'Financial' },
    { value: 'maintenance', label: 'Maintenance' },
    { value: 'legal', label: 'Legal' },
    { value: 'meeting_minutes', label: 'Meeting Minutes' },
    { value: 'insurance', label: 'Insurance' },
    { value: 'contracts', label: 'Contracts' },
    { value: 'permits', label: 'Permits' },
    { value: 'inspection', label: 'Inspection' },
    { value: 'other', label: 'Other' },
];
// Form schema for document editing
const documentEditSchema = zod_2.z.object({
    name: zod_2.z.string().min(1, 'Document name is required').max(255, 'Name must be less than 255 characters'),
    description: zod_2.z.string().max(1000, 'Description must be less than 1000 characters').optional(),
    category: zod_2.z.enum([
        'bylaw',
        'financial',
        'maintenance',
        'legal',
        'meeting_minutes',
        'insurance',
        'contracts',
        'permits',
        'inspection',
        'other'
    ]),
    isVisibleToTenants: zod_2.z.boolean().optional(),
});
function DocumentEditForm({ document, onSuccess, onCancel, }) {
    const { toast } = (0, use_toast_1.useToast)();
    const queryClient = (0, react_query_1.useQueryClient)();
    // State for file replacement
    const [selectedFile, setSelectedFile] = (0, react_1.useState)(null);
    const [textContent, setTextContent] = (0, react_1.useState)(null);
    const [isReplaceFile, setIsReplaceFile] = (0, react_1.useState)(false);
    // Upload context for secure storage
    const uploadContext = {
        type: document.buildingId ? 'buildings' : 'residences',
        buildingId: document.buildingId || undefined,
        residenceId: document.residenceId || undefined,
        userRole: 'admin', // This would be dynamic based on current user
        userId: 'current-user' // This would be dynamic based on current user
    };
    // Form setup with existing document data
    const form = (0, react_hook_form_1.useForm)({
        resolver: (0, zod_1.zodResolver)(documentEditSchema),
        defaultValues: {
            name: document.name || '',
            description: document.description || '',
            category: document.documentType || document.category || 'other',
            isVisibleToTenants: document.isVisibleToTenants || false,
        }
    });
    // Update document mutation
    const updateDocumentMutation = (0, react_query_1.useMutation)({
        mutationFn: async (data) => {
            const formData = new FormData();
            // Add document metadata
            formData.append('name', data.name);
            formData.append('documentType', data.category);
            if (data.description) {
                formData.append('description', data.description);
            }
            formData.append('isVisibleToTenants', data.isVisibleToTenants ? 'true' : 'false');
            // Add entity associations
            if (document.buildingId) {
                formData.append('buildingId', document.buildingId);
            }
            if (document.residenceId) {
                formData.append('residenceId', document.residenceId);
            }
            // Add file if replacing
            if (isReplaceFile && selectedFile) {
                formData.append('file', selectedFile);
            }
            else if (isReplaceFile && textContent) {
                // Handle text content creation
                const textBlob = new Blob([textContent], { type: 'text/plain' });
                const textFile = new File([textBlob], `${data.name}.txt`, { type: 'text/plain' });
                formData.append('file', textFile);
            }
            const response = await (0, queryClient_1.apiRequest)('PUT', `/api/documents/${document.id}`, {
                body: formData,
            });
            if (!response.ok) {
                const error = await response.json().catch(() => ({ message: 'Unknown error' }));
                throw new Error(error.message || 'Failed to update document');
            }
            return response.json();
        },
        onSuccess: (data) => {
            toast({
                title: 'Document updated',
                description: 'The document has been successfully updated.',
            });
            // Invalidate relevant queries
            queryClient.invalidateQueries({ queryKey: ['/api/documents'] });
            queryClient.invalidateQueries({ queryKey: ['/api/documents', document.id] });
            onSuccess();
        },
        onError: (error) => {
            toast({
                title: 'Update failed',
                description: error.message || 'Failed to update document. Please try again.',
                variant: 'destructive',
            });
        },
    });
    const onSubmit = (data) => {
        updateDocumentMutation.mutate(data);
    };
    const handleFileUpload = (file, textContent) => {
        setSelectedFile(file);
        setTextContent(textContent);
    };
    const handleViewDocument = () => {
        if (document.filePath) {
            // Open document in new tab for viewing
            window.open(`/api/documents/${document.id}/file`, '_blank');
        }
    };
    const handleDownloadDocument = async () => {
        try {
            // Use fetch with credentials to ensure authentication
            const response = await fetch(`/api/documents/${document.id}/file?download=true`, {
                method: 'GET',
                credentials: 'include', // Include authentication cookies
            });
            if (!response.ok) {
                throw new Error(`Download failed: ${response.status} ${response.statusText}`);
            }
            // Get the filename from Content-Disposition header or use document name
            const contentDisposition = response.headers.get('Content-Disposition');
            let fileName = document.fileName || document.name || 'document';
            if (contentDisposition) {
                const fileNameMatch = contentDisposition.match(/filename="([^"]+)"/);
                if (fileNameMatch) {
                    fileName = fileNameMatch[1];
                }
            }
            // Convert response to blob and create download
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            // Clean up
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            toast({
                title: 'Download started',
                description: 'The document download has started.',
            });
        }
        catch (error) {
            console.error('Download failed:', error);
            toast({
                title: 'Download failed',
                description: 'Failed to download document. Please try again.',
                variant: 'destructive',
            });
        }
    };
    return ((0, jsx_runtime_1.jsx)("div", { className: "max-w-2xl mx-auto space-y-6", children: (0, jsx_runtime_1.jsx)(form_1.Form, { ...form, children: (0, jsx_runtime_1.jsxs)("form", { onSubmit: form.handleSubmit(onSubmit), className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsx)(card_1.CardTitle, { className: "text-lg", children: "Document Information" }) }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: "space-y-4", children: [(0, jsx_runtime_1.jsx)(form_1.FormField, { control: form.control, name: "name", render: ({ field }) => ((0, jsx_runtime_1.jsxs)(form_1.FormItem, { children: [(0, jsx_runtime_1.jsx)(form_1.FormLabel, { children: "Document Name *" }), (0, jsx_runtime_1.jsx)(form_1.FormControl, { children: (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: "Enter document name", ...field, "data-testid": "input-document-name" }) }), (0, jsx_runtime_1.jsx)(form_1.FormMessage, {})] })) }), (0, jsx_runtime_1.jsx)(form_1.FormField, { control: form.control, name: "category", render: ({ field }) => ((0, jsx_runtime_1.jsxs)(form_1.FormItem, { children: [(0, jsx_runtime_1.jsx)(form_1.FormLabel, { children: "Category *" }), (0, jsx_runtime_1.jsxs)(select_1.Select, { onValueChange: field.onChange, value: field.value, children: [(0, jsx_runtime_1.jsx)(form_1.FormControl, { children: (0, jsx_runtime_1.jsx)(select_1.SelectTrigger, { "data-testid": "select-document-category", children: (0, jsx_runtime_1.jsx)(select_1.SelectValue, { placeholder: "Select a category" }) }) }), (0, jsx_runtime_1.jsx)(select_1.SelectContent, { children: DOCUMENT_CATEGORIES.map((category) => ((0, jsx_runtime_1.jsx)(select_1.SelectItem, { value: category.value, children: category.label }, category.value))) })] }), (0, jsx_runtime_1.jsx)(form_1.FormMessage, {})] })) }), (0, jsx_runtime_1.jsx)(form_1.FormField, { control: form.control, name: "description", render: ({ field }) => ((0, jsx_runtime_1.jsxs)(form_1.FormItem, { children: [(0, jsx_runtime_1.jsx)(form_1.FormLabel, { children: "Description" }), (0, jsx_runtime_1.jsx)(form_1.FormControl, { children: (0, jsx_runtime_1.jsx)(textarea_1.Textarea, { placeholder: "Enter document description (optional)", className: "resize-none", rows: 3, ...field, "data-testid": "input-document-description" }) }), (0, jsx_runtime_1.jsx)(form_1.FormDescription, { children: "Provide additional details about this document" }), (0, jsx_runtime_1.jsx)(form_1.FormMessage, {})] })) }), (0, jsx_runtime_1.jsx)(form_1.FormField, { control: form.control, name: "isVisibleToTenants", render: ({ field }) => ((0, jsx_runtime_1.jsxs)(form_1.FormItem, { className: "flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm", children: [(0, jsx_runtime_1.jsxs)("div", { className: "space-y-0.5", children: [(0, jsx_runtime_1.jsx)(form_1.FormLabel, { className: "text-base", children: "Visible to Tenants" }), (0, jsx_runtime_1.jsx)(form_1.FormDescription, { children: "Allow tenants to view and download this document" })] }), (0, jsx_runtime_1.jsx)(form_1.FormControl, { children: (0, jsx_runtime_1.jsx)(switch_1.Switch, { checked: field.value || false, onCheckedChange: field.onChange, "data-testid": "switch-visible-to-tenants" }) })] })) })] })] }), (0, jsx_runtime_1.jsxs)(card_1.Card, { children: [(0, jsx_runtime_1.jsx)(card_1.CardHeader, { children: (0, jsx_runtime_1.jsx)(card_1.CardTitle, { className: "text-lg", children: "File Management" }) }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: "space-y-4", children: [document.filePath && ((0, jsx_runtime_1.jsx)("div", { className: "bg-gray-50 p-3 rounded-lg", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium", children: "Current File" }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-600", children: document.fileName || document.name })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { type: "button", variant: "outline", size: "sm", onClick: () => handleViewDocument(), "data-testid": "button-view-document", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Eye, { className: "w-3 h-3 mr-1" }), "View"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { type: "button", variant: "outline", size: "sm", onClick: () => handleDownloadDocument(), "data-testid": "button-download-document", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Download, { className: "w-3 h-3 mr-1" }), "Download"] })] })] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center space-x-2", children: [(0, jsx_runtime_1.jsx)("input", { type: "checkbox", id: "replace-file", checked: isReplaceFile, onChange: (e) => setIsReplaceFile(e.target.checked), className: "rounded", "data-testid": "checkbox-replace-file" }), (0, jsx_runtime_1.jsx)(label_1.Label, { htmlFor: "replace-file", children: "Replace file" })] }), isReplaceFile && ((0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(SharedUploader_1.SharedUploader, { context: uploadContext, onFileSelect: handleFileUpload, maxFiles: 1, "data-testid": "uploader-replace-file" }) }))] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex justify-end gap-3 pt-4", children: [(0, jsx_runtime_1.jsx)(button_1.Button, { type: "button", variant: "outline", onClick: onCancel, disabled: updateDocumentMutation.isPending, "data-testid": "button-cancel", children: "Cancel" }), (0, jsx_runtime_1.jsx)(button_1.Button, { type: "submit", disabled: updateDocumentMutation.isPending, "data-testid": "button-save-document", children: updateDocumentMutation.isPending ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Upload, { className: "w-4 h-4 mr-2 animate-spin" }), "Saving..."] })) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Save, { className: "w-4 h-4 mr-2" }), "Save Changes"] })) })] })] }) }) }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvZG9jdW1lbnQtbWFuYWdlbWVudC9Eb2N1bWVudEVkaXRGb3JtLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTJFQSw0Q0FrWEM7O0FBN2JELCtDQUFtRDtBQUNuRCxxREFBMEM7QUFDMUMsaURBQXNEO0FBQ3RELHVEQUFvRTtBQUNwRSw2QkFBd0I7QUFDeEIsbURBQWdEO0FBQ2hELGlEQUE4QztBQUM5Qyx1REFBb0Q7QUFDcEQsaURBQThDO0FBQzlDLG1EQUFnRDtBQUNoRCwrQ0FROEI7QUFDOUIsbURBTWdDO0FBQ2hDLCtDQUFnRjtBQUNoRiwrQ0FBd0U7QUFDeEUsaURBQTZDO0FBQzdDLG1EQUErQztBQUMvQyxxREFBa0Q7QUFJbEQsbUVBQW1FO0FBQ25FLE1BQU0sbUJBQW1CLEdBQUc7SUFDMUIsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUU7SUFDbkMsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7SUFDMUMsRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxhQUFhLEVBQUU7SUFDOUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUU7SUFDbEMsRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUFFO0lBQ3RELEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFO0lBQzFDLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFO0lBQzFDLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFO0lBQ3RDLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFO0lBQzVDLEVBQUUsS0FBSyxFQUFFLE9B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QUFDLEVBQUUsRUFBRSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQ25ELFNBQVMsRUFBQyxTQUFTLGlCQUNQLHVCQUF1QixHQUNuQyxFQUNGLHVCQUFDLGFBQUssSUFBQyxPQUFPLEVBQUMsY0FBYyw2QkFBcUIsSUFDOUMsRUFHTCxhQUFhLElBQUksQ0FDaEIsMENBQ0UsdUJBQUMsK0JBQWMsSUFDYixPQUFPLEVBQUUsYUFBYSxFQUN0QixZQUFZLEVBQUUsZ0JBQWdCLEVBQzlCLFFBQVEsRUFBRSxDQUFDLGlCQUNDLHVCQUF1QixHQUNuQyxHQUNFLENBQ1AsSUFDVyxJQUNULEVBR1AsaUNBQUssU0FBUyxFQUFDLDZCQUE2QixhQUMxQyx1QkFBQyxlQUFNLElBQ0wsSUFBSSxFQUFDLFFBQVEsRUFDYixPQUFPLEVBQUMsU0FBUyxFQUNqQixPQUFPLEVBQUUsUUFBUSxFQUNqQixRQUFRLEVBQUUsc0JBQXNCLENBQUMsU0FBUyxpQkFDOUIsZUFBZSx1QkFHcEIsRUFDVCx1QkFBQyxlQUFNLElBQ0wsSUFBSSxFQUFDLFFBQVEsRUFDYixRQUFRLEVBQUUsc0JBQXNCLENBQUMsU0FBUyxpQkFDOUIsc0JBQXNCLFlBRWpDLHNCQUFzQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FDbEMsNkRBQ0UsdUJBQUMscUJBQU0sSUFBQyxTQUFTLEVBQUMsMkJBQTJCLEdBQUcsaUJBRS9DLENBQ0osQ0FBQyxDQUFDLENBQUMsQ0FDRiw2REFDRSx1QkFBQyxtQkFBSSxJQUFDLFNBQVMsRUFBQyxjQUFjLEdBQUcsb0JBRWhDLENBQ0osR0FDTSxJQUNMLElBQ0QsR0FDRixHQUNILENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvZG9jdW1lbnQtbWFuYWdlbWVudC9Eb2N1bWVudEVkaXRGb3JtLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZUZvcm0gfSBmcm9tICdyZWFjdC1ob29rLWZvcm0nO1xuaW1wb3J0IHsgem9kUmVzb2x2ZXIgfSBmcm9tICdAaG9va2Zvcm0vcmVzb2x2ZXJzL3pvZCc7XG5pbXBvcnQgeyB1c2VNdXRhdGlvbiwgdXNlUXVlcnlDbGllbnQgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYnV0dG9uJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2lucHV0JztcbmltcG9ydCB7IFRleHRhcmVhIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3RleHRhcmVhJztcbmltcG9ydCB7IExhYmVsIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2xhYmVsJztcbmltcG9ydCB7IFN3aXRjaCB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9zd2l0Y2gnO1xuaW1wb3J0IHtcbiAgRm9ybSxcbiAgRm9ybUNvbnRyb2wsXG4gIEZvcm1GaWVsZCxcbiAgRm9ybUl0ZW0sXG4gIEZvcm1MYWJlbCxcbiAgRm9ybU1lc3NhZ2UsXG4gIEZvcm1EZXNjcmlwdGlvbixcbn0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2Zvcm0nO1xuaW1wb3J0IHtcbiAgU2VsZWN0LFxuICBTZWxlY3RDb250ZW50LFxuICBTZWxlY3RJdGVtLFxuICBTZWxlY3RUcmlnZ2VyLFxuICBTZWxlY3RWYWx1ZSxcbn0gZnJvbSAnQC9jb21wb25lbnRzL3VpL3NlbGVjdCc7XG5pbXBvcnQgeyBDYXJkLCBDYXJkQ29udGVudCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2NhcmQnO1xuaW1wb3J0IHsgRmlsZVRleHQsIFVwbG9hZCwgU2F2ZSwgWCwgRG93bmxvYWQsIEV5ZSB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XG5pbXBvcnQgeyB1c2VUb2FzdCB9IGZyb20gJ0AvaG9va3MvdXNlLXRvYXN0JztcbmltcG9ydCB7IGFwaVJlcXVlc3QgfSBmcm9tICdAL2xpYi9xdWVyeUNsaWVudCc7XG5pbXBvcnQgeyBTaGFyZWRVcGxvYWRlciB9IGZyb20gJy4vU2hhcmVkVXBsb2FkZXInO1xuaW1wb3J0IHR5cGUgeyBEb2N1bWVudCB9IGZyb20gJ0BzaGFyZWQvc2NoZW1hJztcbmltcG9ydCB0eXBlIHsgVXBsb2FkQ29udGV4dCB9IGZyb20gJ0BzaGFyZWQvY29uZmlnL3VwbG9hZC1jb25maWcnO1xuXG4vLyBEb2N1bWVudCBjYXRlZ29yaWVzIG1hdGNoaW5nIHRoZSBvbmVzIHVzZWQgaW4gRG9jdW1lbnRDcmVhdGVGb3JtXG5jb25zdCBET0NVTUVOVF9DQVRFR09SSUVTID0gW1xuICB7IHZhbHVlOiAnYnlsYXcnLCBsYWJlbDogJ0J5bGF3cycgfSxcbiAgeyB2YWx1ZTogJ2ZpbmFuY2lhbCcsIGxhYmVsOiAnRmluYW5jaWFsJyB9LFxuICB7IHZhbHVlOiAnbWFpbnRlbmFuY2UnLCBsYWJlbDogJ01haW50ZW5hbmNlJyB9LFxuICB7IHZhbHVlOiAnbGVnYWwnLCBsYWJlbDogJ0xlZ2FsJyB9LFxuICB7IHZhbHVlOiAnbWVldGluZ19taW51dGVzJywgbGFiZWw6ICdNZWV0aW5nIE1pbnV0ZXMnIH0sXG4gIHsgdmFsdWU6ICdpbnN1cmFuY2UnLCBsYWJlbDogJ0luc3VyYW5jZScgfSxcbiAgeyB2YWx1ZTogJ2NvbnRyYWN0cycsIGxhYmVsOiAnQ29udHJhY3RzJyB9LFxuICB7IHZhbHVlOiAncGVybWl0cycsIGxhYmVsOiAnUGVybWl0cycgfSxcbiAgeyB2YWx1ZTogJ2luc3BlY3Rpb24nLCBsYWJlbDogJ0luc3BlY3Rpb24nIH0sXG4gIHsgdmFsdWU6ICdvdGhlcicsIGxhYmVsOiAnT3RoZXInIH0sXG5dO1xuXG4vLyBGb3JtIHNjaGVtYSBmb3IgZG9jdW1lbnQgZWRpdGluZ1xuY29uc3QgZG9jdW1lbnRFZGl0U2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLm1pbigxLCAnRG9jdW1lbnQgbmFtZSBpcyByZXF1aXJlZCcpLm1heCgyNTUsICdOYW1lIG11c3QgYmUgbGVzcyB0aGFuIDI1NSBjaGFyYWN0ZXJzJyksXG4gIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm1heCgxMDAwLCAnRGVzY3JpcHRpb24gbXVzdCBiZSBsZXNzIHRoYW4gMTAwMCBjaGFyYWN0ZXJzJykub3B0aW9uYWwoKSxcbiAgY2F0ZWdvcnk6IHouZW51bShbXG4gICAgJ2J5bGF3JyxcbiAgICAnZmluYW5jaWFsJywgXG4gICAgJ21haW50ZW5hbmNlJyxcbiAgICAnbGVnYWwnLFxuICAgICdtZWV0aW5nX21pbnV0ZXMnLFxuICAgICdpbnN1cmFuY2UnLFxuICAgICdjb250cmFjdHMnLFxuICAgICdwZXJtaXRzJyxcbiAgICAnaW5zcGVjdGlvbicsXG4gICAgJ290aGVyJ1xuICBdKSxcbiAgaXNWaXNpYmxlVG9UZW5hbnRzOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxufSk7XG5cbnR5cGUgRG9jdW1lbnRFZGl0RGF0YSA9IHouaW5mZXI8dHlwZW9mIGRvY3VtZW50RWRpdFNjaGVtYT47XG5cbmludGVyZmFjZSBEb2N1bWVudEVkaXRGb3JtUHJvcHMge1xuICBkb2N1bWVudDogRG9jdW1lbnQ7XG4gIG9uU3VjY2VzczogKCkgPT4gdm9pZDtcbiAgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBEb2N1bWVudEVkaXRGb3JtKHtcbiAgZG9jdW1lbnQsXG4gIG9uU3VjY2VzcyxcbiAgb25DYW5jZWwsXG59OiBEb2N1bWVudEVkaXRGb3JtUHJvcHMpIHtcbiAgY29uc3QgeyB0b2FzdCB9ID0gdXNlVG9hc3QoKTtcbiAgY29uc3QgcXVlcnlDbGllbnQgPSB1c2VRdWVyeUNsaWVudCgpO1xuICBcbiAgLy8gU3RhdGUgZm9yIGZpbGUgcmVwbGFjZW1lbnRcbiAgY29uc3QgW3NlbGVjdGVkRmlsZSwgc2V0U2VsZWN0ZWRGaWxlXSA9IHVzZVN0YXRlPEZpbGUgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW3RleHRDb250ZW50LCBzZXRUZXh0Q29udGVudF0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2lzUmVwbGFjZUZpbGUsIHNldElzUmVwbGFjZUZpbGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIFVwbG9hZCBjb250ZXh0IGZvciBzZWN1cmUgc3RvcmFnZVxuICBjb25zdCB1cGxvYWRDb250ZXh0OiBVcGxvYWRDb250ZXh0ID0ge1xuICAgIHR5cGU6IGRvY3VtZW50LmJ1aWxkaW5nSWQgPyAnYnVpbGRpbmdzJyA6ICdyZXNpZGVuY2VzJyxcbiAgICBidWlsZGluZ0lkOiBkb2N1bWVudC5idWlsZGluZ0lkIHx8IHVuZGVmaW5lZCxcbiAgICByZXNpZGVuY2VJZDogZG9jdW1lbnQucmVzaWRlbmNlSWQgfHwgdW5kZWZpbmVkLFxuICAgIHVzZXJSb2xlOiAnYWRtaW4nLCAvLyBUaGlzIHdvdWxkIGJlIGR5bmFtaWMgYmFzZWQgb24gY3VycmVudCB1c2VyXG4gICAgdXNlcklkOiAnY3VycmVudC11c2VyJyAvLyBUaGlzIHdvdWxkIGJlIGR5bmFtaWMgYmFzZWQgb24gY3VycmVudCB1c2VyXG4gIH07XG5cbiAgLy8gRm9ybSBzZXR1cCB3aXRoIGV4aXN0aW5nIGRvY3VtZW50IGRhdGFcbiAgY29uc3QgZm9ybSA9IHVzZUZvcm08RG9jdW1lbnRFZGl0RGF0YT4oe1xuICAgIHJlc29sdmVyOiB6b2RSZXNvbHZlcihkb2N1bWVudEVkaXRTY2hlbWEpLFxuICAgIGRlZmF1bHRWYWx1ZXM6IHtcbiAgICAgIG5hbWU6IGRvY3VtZW50Lm5hbWUgfHwgJycsXG4gICAgICBkZXNjcmlwdGlvbjogZG9jdW1lbnQuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICBjYXRlZ29yeTogKGRvY3VtZW50LmRvY3VtZW50VHlwZSBhcyBhbnkpIHx8IGRvY3VtZW50LmNhdGVnb3J5IHx8ICdvdGhlcicsXG4gICAgICBpc1Zpc2libGVUb1RlbmFudHM6IGRvY3VtZW50LmlzVmlzaWJsZVRvVGVuYW50cyB8fCBmYWxzZSxcbiAgICB9XG4gIH0pO1xuXG4gIC8vIFVwZGF0ZSBkb2N1bWVudCBtdXRhdGlvblxuICBjb25zdCB1cGRhdGVEb2N1bWVudE11dGF0aW9uID0gdXNlTXV0YXRpb24oe1xuICAgIG11dGF0aW9uRm46IGFzeW5jIChkYXRhOiBEb2N1bWVudEVkaXREYXRhKSA9PiB7XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgXG4gICAgICAvLyBBZGQgZG9jdW1lbnQgbWV0YWRhdGFcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbmFtZScsIGRhdGEubmFtZSk7XG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2RvY3VtZW50VHlwZScsIGRhdGEuY2F0ZWdvcnkpO1xuICAgICAgaWYgKGRhdGEuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdkZXNjcmlwdGlvbicsIGRhdGEuZGVzY3JpcHRpb24pO1xuICAgICAgfVxuICAgICAgZm9ybURhdGEuYXBwZW5kKCdpc1Zpc2libGVUb1RlbmFudHMnLCBkYXRhLmlzVmlzaWJsZVRvVGVuYW50cyA/ICd0cnVlJyA6ICdmYWxzZScpO1xuICAgICAgXG4gICAgICAvLyBBZGQgZW50aXR5IGFzc29jaWF0aW9uc1xuICAgICAgaWYgKGRvY3VtZW50LmJ1aWxkaW5nSWQpIHtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdidWlsZGluZ0lkJywgZG9jdW1lbnQuYnVpbGRpbmdJZCk7XG4gICAgICB9XG4gICAgICBpZiAoZG9jdW1lbnQucmVzaWRlbmNlSWQpIHtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdyZXNpZGVuY2VJZCcsIGRvY3VtZW50LnJlc2lkZW5jZUlkKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGZpbGUgaWYgcmVwbGFjaW5nXG4gICAgICBpZiAoaXNSZXBsYWNlRmlsZSAmJiBzZWxlY3RlZEZpbGUpIHtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgc2VsZWN0ZWRGaWxlKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNSZXBsYWNlRmlsZSAmJiB0ZXh0Q29udGVudCkge1xuICAgICAgICAvLyBIYW5kbGUgdGV4dCBjb250ZW50IGNyZWF0aW9uXG4gICAgICAgIGNvbnN0IHRleHRCbG9iID0gbmV3IEJsb2IoW3RleHRDb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7XG4gICAgICAgIGNvbnN0IHRleHRGaWxlID0gbmV3IEZpbGUoW3RleHRCbG9iXSwgYCR7ZGF0YS5uYW1lfS50eHRgLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgdGV4dEZpbGUpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaVJlcXVlc3QoJ1BVVCcsIGAvYXBpL2RvY3VtZW50cy8ke2RvY3VtZW50LmlkfWAsIHtcbiAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoeyBtZXNzYWdlOiAnVW5rbm93biBlcnJvcicgfSkpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHVwZGF0ZSBkb2N1bWVudCcpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgIH0sXG4gICAgb25TdWNjZXNzOiAoZGF0YSkgPT4ge1xuICAgICAgdG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ0RvY3VtZW50IHVwZGF0ZWQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1RoZSBkb2N1bWVudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgdXBkYXRlZC4nLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIEludmFsaWRhdGUgcmVsZXZhbnQgcXVlcmllc1xuICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cyddIH0pO1xuICAgICAgcXVlcnlDbGllbnQuaW52YWxpZGF0ZVF1ZXJpZXMoeyBxdWVyeUtleTogWycvYXBpL2RvY3VtZW50cycsIGRvY3VtZW50LmlkXSB9KTtcbiAgICAgIFxuICAgICAgb25TdWNjZXNzKCk7XG4gICAgfSxcbiAgICBvbkVycm9yOiAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnVXBkYXRlIGZhaWxlZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gdXBkYXRlIGRvY3VtZW50LiBQbGVhc2UgdHJ5IGFnYWluLicsXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXG4gICAgICB9KTtcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBvblN1Ym1pdCA9IChkYXRhOiBEb2N1bWVudEVkaXREYXRhKSA9PiB7XG4gICAgdXBkYXRlRG9jdW1lbnRNdXRhdGlvbi5tdXRhdGUoZGF0YSk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRmlsZVVwbG9hZCA9IChmaWxlOiBGaWxlIHwgbnVsbCwgdGV4dENvbnRlbnQ6IHN0cmluZyB8IG51bGwpID0+IHtcbiAgICBzZXRTZWxlY3RlZEZpbGUoZmlsZSk7XG4gICAgc2V0VGV4dENvbnRlbnQodGV4dENvbnRlbnQpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVZpZXdEb2N1bWVudCA9ICgpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQuZmlsZVBhdGgpIHtcbiAgICAgIC8vIE9wZW4gZG9jdW1lbnQgaW4gbmV3IHRhYiBmb3Igdmlld2luZ1xuICAgICAgd2luZG93Lm9wZW4oYC9hcGkvZG9jdW1lbnRzLyR7ZG9jdW1lbnQuaWR9L2ZpbGVgLCAnX2JsYW5rJyk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZURvd25sb2FkRG9jdW1lbnQgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSBmZXRjaCB3aXRoIGNyZWRlbnRpYWxzIHRvIGVuc3VyZSBhdXRoZW50aWNhdGlvblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9kb2N1bWVudHMvJHtkb2N1bWVudC5pZH0vZmlsZT9kb3dubG9hZD10cnVlYCwge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLCAvLyBJbmNsdWRlIGF1dGhlbnRpY2F0aW9uIGNvb2tpZXNcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRG93bmxvYWQgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgdGhlIGZpbGVuYW1lIGZyb20gQ29udGVudC1EaXNwb3NpdGlvbiBoZWFkZXIgb3IgdXNlIGRvY3VtZW50IG5hbWVcbiAgICAgIGNvbnN0IGNvbnRlbnREaXNwb3NpdGlvbiA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdDb250ZW50LURpc3Bvc2l0aW9uJyk7XG4gICAgICBsZXQgZmlsZU5hbWUgPSAoZG9jdW1lbnQgYXMgYW55KS5maWxlTmFtZSB8fCBkb2N1bWVudC5uYW1lIHx8ICdkb2N1bWVudCc7XG4gICAgICBcbiAgICAgIGlmIChjb250ZW50RGlzcG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgZmlsZU5hbWVNYXRjaCA9IGNvbnRlbnREaXNwb3NpdGlvbi5tYXRjaCgvZmlsZW5hbWU9XCIoW15cIl0rKVwiLyk7XG4gICAgICAgIGlmIChmaWxlTmFtZU1hdGNoKSB7XG4gICAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZU1hdGNoWzFdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENvbnZlcnQgcmVzcG9uc2UgdG8gYmxvYiBhbmQgY3JlYXRlIGRvd25sb2FkXG4gICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgY29uc3QgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICBcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSB1cmw7XG4gICAgICBsaW5rLmRvd25sb2FkID0gZmlsZU5hbWU7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICAgICAgbGluay5jbGljaygpO1xuICAgICAgXG4gICAgICAvLyBDbGVhbiB1cFxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcbiAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICBcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICdEb3dubG9hZCBzdGFydGVkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUaGUgZG9jdW1lbnQgZG93bmxvYWQgaGFzIHN0YXJ0ZWQuJyxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdEb3dubG9hZCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgdG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ0Rvd25sb2FkIGZhaWxlZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRmFpbGVkIHRvIGRvd25sb2FkIGRvY3VtZW50LiBQbGVhc2UgdHJ5IGFnYWluLicsXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIm1heC13LTJ4bCBteC1hdXRvIHNwYWNlLXktNlwiPlxuXG4gICAgICA8Rm9ybSB7Li4uZm9ybX0+XG4gICAgICAgIDxmb3JtIG9uU3VibWl0PXtmb3JtLmhhbmRsZVN1Ym1pdChvblN1Ym1pdCl9IGNsYXNzTmFtZT1cInNwYWNlLXktNlwiPlxuICAgICAgICAgIHsvKiBEb2N1bWVudCBJbmZvcm1hdGlvbiBDYXJkICovfVxuICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPVwidGV4dC1sZ1wiPkRvY3VtZW50IEluZm9ybWF0aW9uPC9DYXJkVGl0bGU+XG4gICAgICAgICAgICA8L0NhcmRIZWFkZXI+XG4gICAgICAgICAgICA8Q2FyZENvbnRlbnQgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgICAgIHsvKiBEb2N1bWVudCBOYW1lICovfVxuICAgICAgICAgICAgICA8Rm9ybUZpZWxkXG4gICAgICAgICAgICAgICAgY29udHJvbD17Zm9ybS5jb250cm9sfVxuICAgICAgICAgICAgICAgIG5hbWU9XCJuYW1lXCJcbiAgICAgICAgICAgICAgICByZW5kZXI9eyh7IGZpZWxkIH0pID0+IChcbiAgICAgICAgICAgICAgICAgIDxGb3JtSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1MYWJlbD5Eb2N1bWVudCBOYW1lICo8L0Zvcm1MYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1Db250cm9sPlxuICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBkb2N1bWVudCBuYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsuLi5maWVsZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiaW5wdXQtZG9jdW1lbnQtbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtQ29udHJvbD5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1NZXNzYWdlIC8+XG4gICAgICAgICAgICAgICAgICA8L0Zvcm1JdGVtPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgey8qIENhdGVnb3J5ICovfVxuICAgICAgICAgICAgICA8Rm9ybUZpZWxkXG4gICAgICAgICAgICAgICAgY29udHJvbD17Zm9ybS5jb250cm9sfVxuICAgICAgICAgICAgICAgIG5hbWU9XCJjYXRlZ29yeVwiXG4gICAgICAgICAgICAgICAgcmVuZGVyPXsoeyBmaWVsZCB9KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8Rm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtTGFiZWw+Q2F0ZWdvcnkgKjwvRm9ybUxhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8U2VsZWN0IG9uVmFsdWVDaGFuZ2U9e2ZpZWxkLm9uQ2hhbmdlfSB2YWx1ZT17ZmllbGQudmFsdWV9PlxuICAgICAgICAgICAgICAgICAgICAgIDxGb3JtQ29udHJvbD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RUcmlnZ2VyIGRhdGEtdGVzdGlkPVwic2VsZWN0LWRvY3VtZW50LWNhdGVnb3J5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RWYWx1ZSBwbGFjZWhvbGRlcj1cIlNlbGVjdCBhIGNhdGVnb3J5XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvU2VsZWN0VHJpZ2dlcj5cbiAgICAgICAgICAgICAgICAgICAgICA8L0Zvcm1Db250cm9sPlxuICAgICAgICAgICAgICAgICAgICAgIDxTZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAge0RPQ1VNRU5UX0NBVEVHT1JJRVMubWFwKChjYXRlZ29yeSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VsZWN0SXRlbSBrZXk9e2NhdGVnb3J5LnZhbHVlfSB2YWx1ZT17Y2F0ZWdvcnkudmFsdWV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtjYXRlZ29yeS5sYWJlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RJdGVtPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9TZWxlY3RDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L1NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1NZXNzYWdlIC8+XG4gICAgICAgICAgICAgICAgICA8L0Zvcm1JdGVtPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgey8qIERlc2NyaXB0aW9uICovfVxuICAgICAgICAgICAgICA8Rm9ybUZpZWxkXG4gICAgICAgICAgICAgICAgY29udHJvbD17Zm9ybS5jb250cm9sfVxuICAgICAgICAgICAgICAgIG5hbWU9XCJkZXNjcmlwdGlvblwiXG4gICAgICAgICAgICAgICAgcmVuZGVyPXsoeyBmaWVsZCB9KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8Rm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtTGFiZWw+RGVzY3JpcHRpb248L0Zvcm1MYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1Db250cm9sPlxuICAgICAgICAgICAgICAgICAgICAgIDxUZXh0YXJlYVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBkb2N1bWVudCBkZXNjcmlwdGlvbiAob3B0aW9uYWwpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInJlc2l6ZS1ub25lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9ezN9XG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4uZmllbGR9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImlucHV0LWRvY3VtZW50LWRlc2NyaXB0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0Zvcm1Db250cm9sPlxuICAgICAgICAgICAgICAgICAgICA8Rm9ybURlc2NyaXB0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgIFByb3ZpZGUgYWRkaXRpb25hbCBkZXRhaWxzIGFib3V0IHRoaXMgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtRGVzY3JpcHRpb24+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtTWVzc2FnZSAvPlxuICAgICAgICAgICAgICAgICAgPC9Gb3JtSXRlbT5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICAgIHsvKiBWaXNpYmlsaXR5IHRvIFRlbmFudHMgKi99XG4gICAgICAgICAgICAgIDxGb3JtRmllbGRcbiAgICAgICAgICAgICAgICBjb250cm9sPXtmb3JtLmNvbnRyb2x9XG4gICAgICAgICAgICAgICAgbmFtZT1cImlzVmlzaWJsZVRvVGVuYW50c1wiXG4gICAgICAgICAgICAgICAgcmVuZGVyPXsoeyBmaWVsZCB9KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8Rm9ybUl0ZW0gY2xhc3NOYW1lPVwiZmxleCBmbGV4LXJvdyBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHJvdW5kZWQtbGcgYm9yZGVyIHAtMyBzaGFkb3ctc21cIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTAuNVwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxGb3JtTGFiZWwgY2xhc3NOYW1lPVwidGV4dC1iYXNlXCI+VmlzaWJsZSB0byBUZW5hbnRzPC9Gb3JtTGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgPEZvcm1EZXNjcmlwdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIEFsbG93IHRlbmFudHMgdG8gdmlldyBhbmQgZG93bmxvYWQgdGhpcyBkb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAgIDwvRm9ybURlc2NyaXB0aW9uPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPEZvcm1Db250cm9sPlxuICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2ZpZWxkLnZhbHVlIHx8IGZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGVja2VkQ2hhbmdlPXtmaWVsZC5vbkNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwic3dpdGNoLXZpc2libGUtdG8tdGVuYW50c1wiXG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Gb3JtQ29udHJvbD5cbiAgICAgICAgICAgICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XG4gICAgICAgICAgPC9DYXJkPlxuXG4gICAgICAgICAgey8qIEZpbGUgTWFuYWdlbWVudCBDYXJkICovfVxuICAgICAgICAgIDxDYXJkPlxuICAgICAgICAgICAgPENhcmRIZWFkZXI+XG4gICAgICAgICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPVwidGV4dC1sZ1wiPkZpbGUgTWFuYWdlbWVudDwvQ2FyZFRpdGxlPlxuICAgICAgICAgICAgPC9DYXJkSGVhZGVyPlxuICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT1cInNwYWNlLXktNFwiPlxuICAgICAgICAgICAgICB7LyogQ3VycmVudCBGaWxlIEluZm8gKi99XG4gICAgICAgICAgICAgIHtkb2N1bWVudC5maWxlUGF0aCAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1ncmF5LTUwIHAtMyByb3VuZGVkLWxnXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW1cIj5DdXJyZW50IEZpbGU8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LWdyYXktNjAwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7KGRvY3VtZW50IGFzIGFueSkuZmlsZU5hbWUgfHwgZG9jdW1lbnQubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVWaWV3RG9jdW1lbnQoKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiYnV0dG9uLXZpZXctZG9jdW1lbnRcIlxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxFeWUgY2xhc3NOYW1lPVwidy0zIGgtMyBtci0xXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVEb3dubG9hZERvY3VtZW50KCl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1kb3dubG9hZC1kb2N1bWVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPERvd25sb2FkIGNsYXNzTmFtZT1cInctMyBoLTMgbXItMVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICBEb3dubG9hZFxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgIHsvKiBSZXBsYWNlIEZpbGUgT3B0aW9uICovfVxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiPlxuICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgIGlkPVwicmVwbGFjZS1maWxlXCJcbiAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2lzUmVwbGFjZUZpbGV9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldElzUmVwbGFjZUZpbGUoZS50YXJnZXQuY2hlY2tlZCl9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJyb3VuZGVkXCJcbiAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwiY2hlY2tib3gtcmVwbGFjZS1maWxlXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPVwicmVwbGFjZS1maWxlXCI+UmVwbGFjZSBmaWxlPC9MYWJlbD5cbiAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgey8qIEZpbGUgVXBsb2FkIChvbmx5IGlmIHJlcGxhY2luZykgKi99XG4gICAgICAgICAgICAgIHtpc1JlcGxhY2VGaWxlICYmIChcbiAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgPFNoYXJlZFVwbG9hZGVyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQ9e3VwbG9hZENvbnRleHR9XG4gICAgICAgICAgICAgICAgICAgIG9uRmlsZVNlbGVjdD17aGFuZGxlRmlsZVVwbG9hZH1cbiAgICAgICAgICAgICAgICAgICAgbWF4RmlsZXM9ezF9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwidXBsb2FkZXItcmVwbGFjZS1maWxlXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0NhcmRDb250ZW50PlxuICAgICAgICAgIDwvQ2FyZD5cblxuICAgICAgICAgIHsvKiBBY3Rpb24gQnV0dG9ucyAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1lbmQgZ2FwLTMgcHQtNFwiPlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVcIlxuICAgICAgICAgICAgICBvbkNsaWNrPXtvbkNhbmNlbH1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VwZGF0ZURvY3VtZW50TXV0YXRpb24uaXNQZW5kaW5nfVxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1jYW5jZWxcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICBDYW5jZWxcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICB0eXBlPVwic3VibWl0XCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VwZGF0ZURvY3VtZW50TXV0YXRpb24uaXNQZW5kaW5nfVxuICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImJ1dHRvbi1zYXZlLWRvY3VtZW50XCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3VwZGF0ZURvY3VtZW50TXV0YXRpb24uaXNQZW5kaW5nID8gKFxuICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICA8VXBsb2FkIGNsYXNzTmFtZT1cInctNCBoLTQgbXItMiBhbmltYXRlLXNwaW5cIiAvPlxuICAgICAgICAgICAgICAgICAgU2F2aW5nLi4uXG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgIDxTYXZlIGNsYXNzTmFtZT1cInctNCBoLTQgbXItMlwiIC8+XG4gICAgICAgICAgICAgICAgICBTYXZlIENoYW5nZXNcbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Zvcm0+XG4gICAgICA8L0Zvcm0+XG4gICAgPC9kaXY+XG4gICk7XG59Il0sInZlcnNpb24iOjN9
ecee951f37cf5bb94202437fc7a62252
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
// Mock WebSocket constructor for Jest environment
jest.mock('ws', () => ({
    __esModule: true,
    default: class MockWebSocket {
    }
}));
const express_1 = __importDefault(require("express"));
const supertest_1 = __importDefault(require("supertest"));
const routes_1 = require("../../server/routes");
const db_1 = require("../../server/db");
const schema = __importStar(require("../../shared/schema"));
const drizzle_orm_1 = require("drizzle-orm");
const bcryptjs_1 = __importDefault(require("bcryptjs"));
/**
 * Database Permissions and Access Control Security Tests
 *
 * Validates that:
 * - Users can only access data within their organization
 * - Role-based access controls are properly enforced
 * - Cross-organization data leakage is prevented
 * - Sensitive data is protected according to user roles
 */
const createTestApp = () => {
    const app = (0, express_1.default)();
    app.use(express_1.default.json());
    app.use(express_1.default.urlencoded({ extended: true }));
    (0, routes_1.registerRoutes)(app);
    return app;
};
(0, globals_1.describe)('Database Permissions Security', () => {
    let app;
    let org1, org2;
    let admin1, manager1, resident1;
    let admin2, manager2, resident2;
    (0, globals_1.beforeEach)(async () => {
        app = createTestApp();
        // Clean up test data
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-admin1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-admin2@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-manager1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-manager2@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-resident1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-resident2@test.com'));
        // Create test organizations
        [org1] = await db_1.db.insert(schema.organizations).values({
            name: 'Security Test Org 1',
            type: 'syndicate',
            address: '123 Test St',
            city: 'Montreal',
            province: 'QC',
            postalCode: 'H1A 1A1',
        }).returning();
        [org2] = await db_1.db.insert(schema.organizations).values({
            name: 'Security Test Org 2',
            type: 'syndicate',
            address: '456 Test Ave',
            city: 'Quebec',
            province: 'QC',
            postalCode: 'G1A 1A1',
        }).returning();
        // Create users in different organizations with different roles
        [admin1] = await db_1.db.insert(schema.users).values({
            username: 'admin1',
            email: 'dbperm-admin1@test.com',
            firstName: 'Admin',
            lastName: 'One',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'admin',
            organizationId: org1.id,
        }).returning();
        [manager1] = await db_1.db.insert(schema.users).values({
            username: 'manager1',
            email: 'dbperm-manager1@test.com',
            firstName: 'Manager',
            lastName: 'One',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'manager',
            organizationId: org1.id,
        }).returning();
        [resident1] = await db_1.db.insert(schema.users).values({
            username: 'resident1',
            email: 'dbperm-resident1@test.com',
            firstName: 'Resident',
            lastName: 'One',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'resident',
            organizationId: org1.id,
        }).returning();
        [admin2] = await db_1.db.insert(schema.users).values({
            username: 'admin2',
            email: 'dbperm-admin2@test.com',
            firstName: 'Admin',
            lastName: 'Two',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'admin',
            organizationId: org2.id,
        }).returning();
        [manager2] = await db_1.db.insert(schema.users).values({
            username: 'manager2',
            email: 'dbperm-manager2@test.com',
            firstName: 'Manager',
            lastName: 'Two',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'manager',
            organizationId: org2.id,
        }).returning();
        [resident2] = await db_1.db.insert(schema.users).values({
            username: 'resident2',
            email: 'dbperm-resident2@test.com',
            firstName: 'Resident',
            lastName: 'Two',
            password: await bcryptjs_1.default.hash('password123', 12),
            role: 'resident',
            organizationId: org2.id,
        }).returning();
    });
    (0, globals_1.afterEach)(async () => {
        // Clean up test data
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-admin1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-admin2@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-manager1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-manager2@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-resident1@test.com'));
        await db_1.db.delete(schema.users).where((0, drizzle_orm_1.eq)(schema.users.email, 'dbperm-resident2@test.com'));
        if (org1?.id)
            await db_1.db.delete(schema.organizations).where((0, drizzle_orm_1.eq)(schema.organizations.id, org1.id));
        if (org2?.id)
            await db_1.db.delete(schema.organizations).where((0, drizzle_orm_1.eq)(schema.organizations.id, org2.id));
    });
    (0, globals_1.describe)('Cross-Organization Access Prevention', () => {
        (0, globals_1.it)('should prevent users from accessing data in other organizations', async () => {
            // Attempt to login as user from org1 and access org2 data
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            (0, globals_1.expect)(loginResponse.status).toBe(200);
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Try to access users from org2 (should be forbidden)
            const usersResponse = await (0, supertest_1.default)(app)
                .get('/api/users')
                .set('Cookie', sessionCookie)
                .query({ organizationId: org2.id });
            (0, globals_1.expect)(usersResponse.status).toBe(403);
        });
        (0, globals_1.it)('should prevent cross-organization building access', async () => {
            // Create buildings in both organizations
            const [building1] = await db_1.db.insert(schema.buildings).values({
                name: 'Org 1 Building',
                address: '123 Org1 St',
                city: 'Montreal',
                province: 'QC',
                postalCode: 'H1A 1A1',
                organizationId: org1.id,
            }).returning();
            const [building2] = await db_1.db.insert(schema.buildings).values({
                name: 'Org 2 Building',
                address: '456 Org2 Ave',
                city: 'Quebec',
                province: 'QC',
                postalCode: 'G1A 1A1',
                organizationId: org2.id,
            }).returning();
            // Login as org1 user
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Try to access org2 building (should fail)
            const buildingResponse = await (0, supertest_1.default)(app)
                .get(`/api/buildings/${building2.id}`)
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(buildingResponse.status).toBe(403);
            // Clean up
            await db_1.db.delete(schema.buildings).where((0, drizzle_orm_1.eq)(schema.buildings.id, building1.id));
            await db_1.db.delete(schema.buildings).where((0, drizzle_orm_1.eq)(schema.buildings.id, building2.id));
        });
    });
    (0, globals_1.describe)('Role-Based Data Access', () => {
        (0, globals_1.it)('should enforce document access based on user roles', async () => {
            // Test document access permissions by role
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'resident1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Resident should not be able to access admin documents
            const adminDocsResponse = await (0, supertest_1.default)(app)
                .get('/api/documents')
                .set('Cookie', sessionCookie)
                .query({ category: 'administrative' });
            // Verify access is properly restricted
            (0, globals_1.expect)(adminDocsResponse.status).toBe(200);
            // Residents should only see documents they have access to
        });
        (0, globals_1.it)('should prevent privilege escalation attempts', async () => {
            // Login as resident
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'resident1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Try to update own role (should fail)
            const roleUpdateResponse = await (0, supertest_1.default)(app)
                .patch(`/api/users/${resident1.id}`)
                .set('Cookie', sessionCookie)
                .send({
                role: 'admin'
            });
            (0, globals_1.expect)(roleUpdateResponse.status).toBe(403);
        });
    });
    (0, globals_1.describe)('Data Isolation', () => {
        (0, globals_1.it)('should ensure users only see their organization data in listings', async () => {
            // Login as org1 manager
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Get users list - should only contain org1 users
            const usersResponse = await (0, supertest_1.default)(app)
                .get('/api/users')
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(usersResponse.status).toBe(200);
            const users = usersResponse.body;
            // Verify all returned users belong to org1
            users.forEach((user) => {
                (0, globals_1.expect)(user.organizationId).toBe(org1.id);
            });
        });
        (0, globals_1.it)('should prevent SQL injection in organization filtering', async () => {
            // Login as user
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Try SQL injection attack in query parameters
            const maliciousResponse = await (0, supertest_1.default)(app)
                .get('/api/users')
                .set('Cookie', sessionCookie)
                .query({ organizationId: `${org1.id}' OR '1'='1` });
            // Should still only return org1 users, not all users
            (0, globals_1.expect)(maliciousResponse.status).toBe(200);
            const users = maliciousResponse.body;
            users.forEach((user) => {
                (0, globals_1.expect)(user.organizationId).toBe(org1.id);
            });
        });
    });
    (0, globals_1.describe)('Sensitive Data Protection', () => {
        (0, globals_1.it)('should not expose password hashes in user data', async () => {
            // Login and get user profile
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            const profileResponse = await (0, supertest_1.default)(app)
                .get('/api/auth/profile')
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(profileResponse.status).toBe(200);
            const profile = profileResponse.body;
            // Password should never be included in profile data
            (0, globals_1.expect)(profile.password).toBeUndefined();
        });
        (0, globals_1.it)('should protect session data from unauthorized access', async () => {
            // Try to access session data without authentication
            const sessionResponse = await (0, supertest_1.default)(app)
                .get('/api/auth/profile');
            (0, globals_1.expect)(sessionResponse.status).toBe(401);
        });
        (0, globals_1.it)('should sanitize database error messages', async () => {
            // Try to create user with invalid data to trigger database error
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'admin1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            const createUserResponse = await (0, supertest_1.default)(app)
                .post('/api/users')
                .set('Cookie', sessionCookie)
                .send({
                // Invalid data to trigger database constraints
                username: '', // Empty username should trigger error
                email: 'invalid-email', // Invalid email format
            });
            (0, globals_1.expect)(createUserResponse.status).toBe(400);
            // Error message should not contain internal database details
            const errorMessage = createUserResponse.body.error || createUserResponse.body.message || '';
            (0, globals_1.expect)(errorMessage).not.toContain('constraint');
            (0, globals_1.expect)(errorMessage).not.toContain('violation');
            (0, globals_1.expect)(errorMessage).not.toContain('postgresql');
        });
    });
    (0, globals_1.describe)('Session Security', () => {
        (0, globals_1.it)('should invalidate sessions on logout', async () => {
            // Login
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'manager1',
                password: 'password123',
            });
            (0, globals_1.expect)(loginResponse.status).toBe(200);
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Verify session works
            const profileResponse = await (0, supertest_1.default)(app)
                .get('/api/auth/profile')
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(profileResponse.status).toBe(200);
            // Logout
            const logoutResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/logout')
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(logoutResponse.status).toBe(200);
            // Try to use session after logout (should fail)
            const postLogoutResponse = await (0, supertest_1.default)(app)
                .get('/api/auth/profile')
                .set('Cookie', sessionCookie);
            (0, globals_1.expect)(postLogoutResponse.status).toBe(401);
        });
        (0, globals_1.it)('should prevent session fixation attacks', async () => {
            // Get initial session
            const initialResponse = await (0, supertest_1.default)(app)
                .get('/api/auth/profile');
            const initialCookie = initialResponse.headers['set-cookie'];
            // Login should create new session
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .set('Cookie', initialCookie)
                .send({
                username: 'manager1',
                password: 'password123',
            });
            (0, globals_1.expect)(loginResponse.status).toBe(200);
            const loginCookie = loginResponse.headers['set-cookie'];
            // Session ID should have changed after login
            (0, globals_1.expect)(loginCookie).toBeDefined();
            (0, globals_1.expect)(loginCookie).not.toEqual(initialCookie);
        });
    });
    (0, globals_1.describe)('Input Validation Security', () => {
        (0, globals_1.it)('should prevent NoSQL/SQL injection in user queries', async () => {
            const loginResponse = await (0, supertest_1.default)(app)
                .post('/api/auth/login')
                .send({
                username: 'admin1',
                password: 'password123',
            });
            const sessionCookie = loginResponse.headers['set-cookie'];
            // Try injection attempts in various endpoints
            const injectionAttempts = [
                "'; DROP TABLE users; --",
                "1' OR '1'='1",
                "$where: '1 == 1'",
                "{ $ne: null }",
                "../../../etc/passwd"
            ];
            for (const injection of injectionAttempts) {
                const response = await (0, supertest_1.default)(app)
                    .get('/api/users')
                    .set('Cookie', sessionCookie)
                    .query({ search: injection });
                // Should not cause server errors or return unexpected data
                (0, globals_1.expect)(response.status).toBeLessThan(500);
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9zZWN1cml0eS9kYXRhYmFzZS1wZXJtaXNzaW9ucy50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQTRFO0FBSTVFLGtEQUFrRDtBQUNsRCxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3JCLFVBQVUsRUFBRSxJQUFJO0lBQ2hCLE9BQU8sRUFBRSxNQUFNLGFBQWE7S0FBRztDQUNoQyxDQUFDLENBQUMsQ0FBQztBQVBKLHNEQUE4QjtBQUM5QiwwREFBZ0M7QUFRaEMsZ0RBQXFEO0FBQ3JELHdDQUFxQztBQUNyQyw0REFBOEM7QUFDOUMsNkNBQXNDO0FBQ3RDLHdEQUE4QjtBQUU5Qjs7Ozs7Ozs7R0FRRztBQUVILE1BQU0sYUFBYSxHQUFHLEdBQUcsRUFBRTtJQUN6QixNQUFNLEdBQUcsR0FBRyxJQUFBLGlCQUFPLEdBQUUsQ0FBQztJQUN0QixHQUFHLENBQUMsR0FBRyxDQUFDLGlCQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUN4QixHQUFHLENBQUMsR0FBRyxDQUFDLGlCQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFBLHVCQUFjLEVBQUMsR0FBRyxDQUFDLENBQUM7SUFDcEIsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDLENBQUM7QUFFRixJQUFBLGtCQUFRLEVBQUMsK0JBQStCLEVBQUUsR0FBRyxFQUFFO0lBQzdDLElBQUksR0FBd0IsQ0FBQztJQUM3QixJQUFJLElBQVMsRUFBRSxJQUFTLENBQUM7SUFDekIsSUFBSSxNQUFXLEVBQUUsUUFBYSxFQUFFLFNBQWMsQ0FBQztJQUMvQyxJQUFJLE1BQVcsRUFBRSxRQUFhLEVBQUUsU0FBYyxDQUFDO0lBRS9DLElBQUEsb0JBQVUsRUFBQyxLQUFLLElBQUksRUFBRTtRQUNwQixH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QkFBTSxFQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDNUMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3Rlc3RzL3NlY3VyaXR5L2RhdGFiYXNlLXBlcm1pc3Npb25zLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xuXG4vLyBNb2NrIFdlYlNvY2tldCBjb25zdHJ1Y3RvciBmb3IgSmVzdCBlbnZpcm9ubWVudFxuamVzdC5tb2NrKCd3cycsICgpID0+ICh7XG4gIF9fZXNNb2R1bGU6IHRydWUsXG4gIGRlZmF1bHQ6IGNsYXNzIE1vY2tXZWJTb2NrZXQge31cbn0pKTtcblxuaW1wb3J0IHsgcmVnaXN0ZXJSb3V0ZXMgfSBmcm9tICcuLi8uLi9zZXJ2ZXIvcm91dGVzJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vc2VydmVyL2RiJztcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tICcuLi8uLi9zaGFyZWQvc2NoZW1hJztcbmltcG9ydCB7IGVxLCBhbmQgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcblxuLyoqXG4gKiBEYXRhYmFzZSBQZXJtaXNzaW9ucyBhbmQgQWNjZXNzIENvbnRyb2wgU2VjdXJpdHkgVGVzdHNcbiAqIFxuICogVmFsaWRhdGVzIHRoYXQ6XG4gKiAtIFVzZXJzIGNhbiBvbmx5IGFjY2VzcyBkYXRhIHdpdGhpbiB0aGVpciBvcmdhbml6YXRpb25cbiAqIC0gUm9sZS1iYXNlZCBhY2Nlc3MgY29udHJvbHMgYXJlIHByb3Blcmx5IGVuZm9yY2VkXG4gKiAtIENyb3NzLW9yZ2FuaXphdGlvbiBkYXRhIGxlYWthZ2UgaXMgcHJldmVudGVkXG4gKiAtIFNlbnNpdGl2ZSBkYXRhIGlzIHByb3RlY3RlZCBhY2NvcmRpbmcgdG8gdXNlciByb2xlc1xuICovXG5cbmNvbnN0IGNyZWF0ZVRlc3RBcHAgPSAoKSA9PiB7XG4gIGNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbiAgYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG4gIGFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xuICByZWdpc3RlclJvdXRlcyhhcHApO1xuICByZXR1cm4gYXBwO1xufTtcblxuZGVzY3JpYmUoJ0RhdGFiYXNlIFBlcm1pc3Npb25zIFNlY3VyaXR5JywgKCkgPT4ge1xuICBsZXQgYXBwOiBleHByZXNzLkFwcGxpY2F0aW9uO1xuICBsZXQgb3JnMTogYW55LCBvcmcyOiBhbnk7XG4gIGxldCBhZG1pbjE6IGFueSwgbWFuYWdlcjE6IGFueSwgcmVzaWRlbnQxOiBhbnk7XG4gIGxldCBhZG1pbjI6IGFueSwgbWFuYWdlcjI6IGFueSwgcmVzaWRlbnQyOiBhbnk7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXBwID0gY3JlYXRlVGVzdEFwcCgpO1xuICAgIFxuICAgIC8vIENsZWFuIHVwIHRlc3QgZGF0YVxuICAgIGF3YWl0IGRiLmRlbGV0ZShzY2hlbWEudXNlcnMpLndoZXJlKGVxKHNjaGVtYS51c2Vycy5lbWFpbCwgJ2RicGVybS1hZG1pbjFAdGVzdC5jb20nKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS51c2Vycykud2hlcmUoZXEoc2NoZW1hLnVzZXJzLmVtYWlsLCAnZGJwZXJtLWFkbWluMkB0ZXN0LmNvbScpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLnVzZXJzKS53aGVyZShlcShzY2hlbWEudXNlcnMuZW1haWwsICdkYnBlcm0tbWFuYWdlcjFAdGVzdC5jb20nKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS51c2Vycykud2hlcmUoZXEoc2NoZW1hLnVzZXJzLmVtYWlsLCAnZGJwZXJtLW1hbmFnZXIyQHRlc3QuY29tJykpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShzY2hlbWEudXNlcnMpLndoZXJlKGVxKHNjaGVtYS51c2Vycy5lbWFpbCwgJ2RicGVybS1yZXNpZGVudDFAdGVzdC5jb20nKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS51c2Vycykud2hlcmUoZXEoc2NoZW1hLnVzZXJzLmVtYWlsLCAnZGJwZXJtLXJlc2lkZW50MkB0ZXN0LmNvbScpKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgdGVzdCBvcmdhbml6YXRpb25zXG4gICAgW29yZzFdID0gYXdhaXQgZGIuaW5zZXJ0KHNjaGVtYS5vcmdhbml6YXRpb25zKS52YWx1ZXMoe1xuICAgICAgbmFtZTogJ1NlY3VyaXR5IFRlc3QgT3JnIDEnLFxuICAgICAgdHlwZTogJ3N5bmRpY2F0ZScsXG4gICAgICBhZGRyZXNzOiAnMTIzIFRlc3QgU3QnLFxuICAgICAgY2l0eTogJ01vbnRyZWFsJyxcbiAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgcG9zdGFsQ29kZTogJ0gxQSAxQTEnLFxuICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgW29yZzJdID0gYXdhaXQgZGIuaW5zZXJ0KHNjaGVtYS5vcmdhbml6YXRpb25zKS52YWx1ZXMoe1xuICAgICAgbmFtZTogJ1NlY3VyaXR5IFRlc3QgT3JnIDInLCBcbiAgICAgIHR5cGU6ICdzeW5kaWNhdGUnLFxuICAgICAgYWRkcmVzczogJzQ1NiBUZXN0IEF2ZScsXG4gICAgICBjaXR5OiAnUXVlYmVjJyxcbiAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgcG9zdGFsQ29kZTogJ0cxQSAxQTEnLFxuICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgLy8gQ3JlYXRlIHVzZXJzIGluIGRpZmZlcmVudCBvcmdhbml6YXRpb25zIHdpdGggZGlmZmVyZW50IHJvbGVzXG4gICAgW2FkbWluMV0gPSBhd2FpdCBkYi5pbnNlcnQoc2NoZW1hLnVzZXJzKS52YWx1ZXMoe1xuICAgICAgdXNlcm5hbWU6ICdhZG1pbjEnLFxuICAgICAgZW1haWw6ICdkYnBlcm0tYWRtaW4xQHRlc3QuY29tJyxcbiAgICAgIGZpcnN0TmFtZTogJ0FkbWluJyxcbiAgICAgIGxhc3ROYW1lOiAnT25lJyxcbiAgICAgIHBhc3N3b3JkOiBhd2FpdCBiY3J5cHQuaGFzaCgncGFzc3dvcmQxMjMnLCAxMiksXG4gICAgICByb2xlOiAnYWRtaW4nLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IG9yZzEuaWQsXG4gICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICBbbWFuYWdlcjFdID0gYXdhaXQgZGIuaW5zZXJ0KHNjaGVtYS51c2VycykudmFsdWVzKHtcbiAgICAgIHVzZXJuYW1lOiAnbWFuYWdlcjEnLFxuICAgICAgZW1haWw6ICdkYnBlcm0tbWFuYWdlcjFAdGVzdC5jb20nLFxuICAgICAgZmlyc3ROYW1lOiAnTWFuYWdlcicsXG4gICAgICBsYXN0TmFtZTogJ09uZScsXG4gICAgICBwYXNzd29yZDogYXdhaXQgYmNyeXB0Lmhhc2goJ3Bhc3N3b3JkMTIzJywgMTIpLFxuICAgICAgcm9sZTogJ21hbmFnZXInLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IG9yZzEuaWQsXG4gICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICBbcmVzaWRlbnQxXSA9IGF3YWl0IGRiLmluc2VydChzY2hlbWEudXNlcnMpLnZhbHVlcyh7XG4gICAgICB1c2VybmFtZTogJ3Jlc2lkZW50MScsXG4gICAgICBlbWFpbDogJ2RicGVybS1yZXNpZGVudDFAdGVzdC5jb20nLFxuICAgICAgZmlyc3ROYW1lOiAnUmVzaWRlbnQnLFxuICAgICAgbGFzdE5hbWU6ICdPbmUnLFxuICAgICAgcGFzc3dvcmQ6IGF3YWl0IGJjcnlwdC5oYXNoKCdwYXNzd29yZDEyMycsIDEyKSxcbiAgICAgIHJvbGU6ICdyZXNpZGVudCcsXG4gICAgICBvcmdhbml6YXRpb25JZDogb3JnMS5pZCxcbiAgICB9KS5yZXR1cm5pbmcoKTtcblxuICAgIFthZG1pbjJdID0gYXdhaXQgZGIuaW5zZXJ0KHNjaGVtYS51c2VycykudmFsdWVzKHtcbiAgICAgIHVzZXJuYW1lOiAnYWRtaW4yJyxcbiAgICAgIGVtYWlsOiAnZGJwZXJtLWFkbWluMkB0ZXN0LmNvbScsXG4gICAgICBmaXJzdE5hbWU6ICdBZG1pbicsXG4gICAgICBsYXN0TmFtZTogJ1R3bycsXG4gICAgICBwYXNzd29yZDogYXdhaXQgYmNyeXB0Lmhhc2goJ3Bhc3N3b3JkMTIzJywgMTIpLFxuICAgICAgcm9sZTogJ2FkbWluJyxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmcyLmlkLFxuICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgW21hbmFnZXIyXSA9IGF3YWl0IGRiLmluc2VydChzY2hlbWEudXNlcnMpLnZhbHVlcyh7XG4gICAgICB1c2VybmFtZTogJ21hbmFnZXIyJyxcbiAgICAgIGVtYWlsOiAnZGJwZXJtLW1hbmFnZXIyQHRlc3QuY29tJyxcbiAgICAgIGZpcnN0TmFtZTogJ01hbmFnZXInLFxuICAgICAgbGFzdE5hbWU6ICdUd28nLFxuICAgICAgcGFzc3dvcmQ6IGF3YWl0IGJjcnlwdC5oYXNoKCdwYXNzd29yZDEyMycsIDEyKSxcbiAgICAgIHJvbGU6ICdtYW5hZ2VyJyxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmcyLmlkLFxuICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgW3Jlc2lkZW50Ml0gPSBhd2FpdCBkYi5pbnNlcnQoc2NoZW1hLnVzZXJzKS52YWx1ZXMoe1xuICAgICAgdXNlcm5hbWU6ICdyZXNpZGVudDInLFxuICAgICAgZW1haWw6ICdkYnBlcm0tcmVzaWRlbnQyQHRlc3QuY29tJyxcbiAgICAgIGZpcnN0TmFtZTogJ1Jlc2lkZW50JyxcbiAgICAgIGxhc3ROYW1lOiAnVHdvJyxcbiAgICAgIHBhc3N3b3JkOiBhd2FpdCBiY3J5cHQuaGFzaCgncGFzc3dvcmQxMjMnLCAxMiksXG4gICAgICByb2xlOiAncmVzaWRlbnQnLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IG9yZzIuaWQsXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW4gdXAgdGVzdCBkYXRhXG4gICAgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS51c2Vycykud2hlcmUoZXEoc2NoZW1hLnVzZXJzLmVtYWlsLCAnZGJwZXJtLWFkbWluMUB0ZXN0LmNvbScpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLnVzZXJzKS53aGVyZShlcShzY2hlbWEudXNlcnMuZW1haWwsICdkYnBlcm0tYWRtaW4yQHRlc3QuY29tJykpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShzY2hlbWEudXNlcnMpLndoZXJlKGVxKHNjaGVtYS51c2Vycy5lbWFpbCwgJ2RicGVybS1tYW5hZ2VyMUB0ZXN0LmNvbScpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLnVzZXJzKS53aGVyZShlcShzY2hlbWEudXNlcnMuZW1haWwsICdkYnBlcm0tbWFuYWdlcjJAdGVzdC5jb20nKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS51c2Vycykud2hlcmUoZXEoc2NoZW1hLnVzZXJzLmVtYWlsLCAnZGJwZXJtLXJlc2lkZW50MUB0ZXN0LmNvbScpKTtcbiAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLnVzZXJzKS53aGVyZShlcShzY2hlbWEudXNlcnMuZW1haWwsICdkYnBlcm0tcmVzaWRlbnQyQHRlc3QuY29tJykpO1xuICAgIFxuICAgIGlmIChvcmcxPy5pZCkgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS5vcmdhbml6YXRpb25zKS53aGVyZShlcShzY2hlbWEub3JnYW5pemF0aW9ucy5pZCwgb3JnMS5pZCkpO1xuICAgIGlmIChvcmcyPy5pZCkgYXdhaXQgZGIuZGVsZXRlKHNjaGVtYS5vcmdhbml6YXRpb25zKS53aGVyZShlcShzY2hlbWEub3JnYW5pemF0aW9ucy5pZCwgb3JnMi5pZCkpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ3Jvc3MtT3JnYW5pemF0aW9uIEFjY2VzcyBQcmV2ZW50aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJldmVudCB1c2VycyBmcm9tIGFjY2Vzc2luZyBkYXRhIGluIG90aGVyIG9yZ2FuaXphdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBdHRlbXB0IHRvIGxvZ2luIGFzIHVzZXIgZnJvbSBvcmcxIGFuZCBhY2Nlc3Mgb3JnMiBkYXRhXG4gICAgICBjb25zdCBsb2dpblJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgdXNlcm5hbWU6ICdtYW5hZ2VyMScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobG9naW5SZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGNvbnN0IHNlc3Npb25Db29raWUgPSBsb2dpblJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXTtcblxuICAgICAgLy8gVHJ5IHRvIGFjY2VzcyB1c2VycyBmcm9tIG9yZzIgKHNob3VsZCBiZSBmb3JiaWRkZW4pXG4gICAgICBjb25zdCB1c2Vyc1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvdXNlcnMnKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBzZXNzaW9uQ29va2llKVxuICAgICAgICAucXVlcnkoeyBvcmdhbml6YXRpb25JZDogb3JnMi5pZCB9KTtcblxuICAgICAgZXhwZWN0KHVzZXJzUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgY3Jvc3Mtb3JnYW5pemF0aW9uIGJ1aWxkaW5nIGFjY2VzcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBidWlsZGluZ3MgaW4gYm90aCBvcmdhbml6YXRpb25zXG4gICAgICBjb25zdCBbYnVpbGRpbmcxXSA9IGF3YWl0IGRiLmluc2VydChzY2hlbWEuYnVpbGRpbmdzKS52YWx1ZXMoe1xuICAgICAgICBuYW1lOiAnT3JnIDEgQnVpbGRpbmcnLFxuICAgICAgICBhZGRyZXNzOiAnMTIzIE9yZzEgU3QnLFxuICAgICAgICBjaXR5OiAnTW9udHJlYWwnLFxuICAgICAgICBwcm92aW5jZTogJ1FDJyxcbiAgICAgICAgcG9zdGFsQ29kZTogJ0gxQSAxQTEnLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogb3JnMS5pZCxcbiAgICAgIH0pLnJldHVybmluZygpO1xuXG4gICAgICBjb25zdCBbYnVpbGRpbmcyXSA9IGF3YWl0IGRiLmluc2VydChzY2hlbWEuYnVpbGRpbmdzKS52YWx1ZXMoe1xuICAgICAgICBuYW1lOiAnT3JnIDIgQnVpbGRpbmcnLFxuICAgICAgICBhZGRyZXNzOiAnNDU2IE9yZzIgQXZlJyxcbiAgICAgICAgY2l0eTogJ1F1ZWJlYycsXG4gICAgICAgIHByb3ZpbmNlOiAnUUMnLFxuICAgICAgICBwb3N0YWxDb2RlOiAnRzFBIDFBMScsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiBvcmcyLmlkLFxuICAgICAgfSkucmV0dXJuaW5nKCk7XG5cbiAgICAgIC8vIExvZ2luIGFzIG9yZzEgdXNlclxuICAgICAgY29uc3QgbG9naW5SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHVzZXJuYW1lOiAnbWFuYWdlcjEnLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KTtcblxuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gICAgICAvLyBUcnkgdG8gYWNjZXNzIG9yZzIgYnVpbGRpbmcgKHNob3VsZCBmYWlsKVxuICAgICAgY29uc3QgYnVpbGRpbmdSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2J1aWxkaW5ncy8ke2J1aWxkaW5nMi5pZH1gKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBzZXNzaW9uQ29va2llKTtcblxuICAgICAgZXhwZWN0KGJ1aWxkaW5nUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMyk7XG5cbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLmJ1aWxkaW5ncykud2hlcmUoZXEoc2NoZW1hLmJ1aWxkaW5ncy5pZCwgYnVpbGRpbmcxLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUoc2NoZW1hLmJ1aWxkaW5ncykud2hlcmUoZXEoc2NoZW1hLmJ1aWxkaW5ncy5pZCwgYnVpbGRpbmcyLmlkKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb2xlLUJhc2VkIERhdGEgQWNjZXNzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZW5mb3JjZSBkb2N1bWVudCBhY2Nlc3MgYmFzZWQgb24gdXNlciByb2xlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgZG9jdW1lbnQgYWNjZXNzIHBlcm1pc3Npb25zIGJ5IHJvbGVcbiAgICAgIGNvbnN0IGxvZ2luUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICB1c2VybmFtZTogJ3Jlc2lkZW50MScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gbG9naW5SZXNwb25zZS5oZWFkZXJzWydzZXQtY29va2llJ107XG5cbiAgICAgIC8vIFJlc2lkZW50IHNob3VsZCBub3QgYmUgYWJsZSB0byBhY2Nlc3MgYWRtaW4gZG9jdW1lbnRzXG4gICAgICBjb25zdCBhZG1pbkRvY3NSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2RvY3VtZW50cycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIHNlc3Npb25Db29raWUpXG4gICAgICAgIC5xdWVyeSh7IGNhdGVnb3J5OiAnYWRtaW5pc3RyYXRpdmUnIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgYWNjZXNzIGlzIHByb3Blcmx5IHJlc3RyaWN0ZWRcbiAgICAgIGV4cGVjdChhZG1pbkRvY3NSZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIC8vIFJlc2lkZW50cyBzaG91bGQgb25seSBzZWUgZG9jdW1lbnRzIHRoZXkgaGF2ZSBhY2Nlc3MgdG9cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBwcml2aWxlZ2UgZXNjYWxhdGlvbiBhdHRlbXB0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIExvZ2luIGFzIHJlc2lkZW50XG4gICAgICBjb25zdCBsb2dpblJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxuICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgdXNlcm5hbWU6ICdyZXNpZGVudDEnLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KTtcblxuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gICAgICAvLyBUcnkgdG8gdXBkYXRlIG93biByb2xlIChzaG91bGQgZmFpbClcbiAgICAgIGNvbnN0IHJvbGVVcGRhdGVSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucGF0Y2goYC9hcGkvdXNlcnMvJHtyZXNpZGVudDEuaWR9YClcbiAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSlcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHJvbGU6ICdhZG1pbidcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXBkYXRlUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIElzb2xhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGVuc3VyZSB1c2VycyBvbmx5IHNlZSB0aGVpciBvcmdhbml6YXRpb24gZGF0YSBpbiBsaXN0aW5ncycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIExvZ2luIGFzIG9yZzEgbWFuYWdlclxuICAgICAgY29uc3QgbG9naW5SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHVzZXJuYW1lOiAnbWFuYWdlcjEnLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KTtcblxuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gICAgICAvLyBHZXQgdXNlcnMgbGlzdCAtIHNob3VsZCBvbmx5IGNvbnRhaW4gb3JnMSB1c2Vyc1xuICAgICAgY29uc3QgdXNlcnNSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1Jlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgY29uc3QgdXNlcnMgPSB1c2Vyc1Jlc3BvbnNlLmJvZHk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgcmV0dXJuZWQgdXNlcnMgYmVsb25nIHRvIG9yZzFcbiAgICAgIHVzZXJzLmZvckVhY2goKHVzZXI6IGFueSkgPT4ge1xuICAgICAgICBleHBlY3QodXNlci5vcmdhbml6YXRpb25JZCkudG9CZShvcmcxLmlkKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IFNRTCBpbmplY3Rpb24gaW4gb3JnYW5pemF0aW9uIGZpbHRlcmluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIExvZ2luIGFzIHVzZXJcbiAgICAgIGNvbnN0IGxvZ2luUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICB1c2VybmFtZTogJ21hbmFnZXIxJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNlc3Npb25Db29raWUgPSBsb2dpblJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXTtcblxuICAgICAgLy8gVHJ5IFNRTCBpbmplY3Rpb24gYXR0YWNrIGluIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgIGNvbnN0IG1hbGljaW91c1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvdXNlcnMnKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBzZXNzaW9uQ29va2llKVxuICAgICAgICAucXVlcnkoeyBvcmdhbml6YXRpb25JZDogYCR7b3JnMS5pZH0nIE9SICcxJz0nMWAgfSk7XG5cbiAgICAgIC8vIFNob3VsZCBzdGlsbCBvbmx5IHJldHVybiBvcmcxIHVzZXJzLCBub3QgYWxsIHVzZXJzXG4gICAgICBleHBlY3QobWFsaWNpb3VzUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBjb25zdCB1c2VycyA9IG1hbGljaW91c1Jlc3BvbnNlLmJvZHk7XG4gICAgICB1c2Vycy5mb3JFYWNoKCh1c2VyOiBhbnkpID0+IHtcbiAgICAgICAgZXhwZWN0KHVzZXIub3JnYW5pemF0aW9uSWQpLnRvQmUob3JnMS5pZCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlbnNpdGl2ZSBEYXRhIFByb3RlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBub3QgZXhwb3NlIHBhc3N3b3JkIGhhc2hlcyBpbiB1c2VyIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBMb2dpbiBhbmQgZ2V0IHVzZXIgcHJvZmlsZVxuICAgICAgY29uc3QgbG9naW5SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHVzZXJuYW1lOiAnbWFuYWdlcjEnLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KTtcblxuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuICAgICAgXG4gICAgICBjb25zdCBwcm9maWxlUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9hdXRoL3Byb2ZpbGUnKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBzZXNzaW9uQ29va2llKTtcblxuICAgICAgZXhwZWN0KHByb2ZpbGVSZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBwcm9maWxlUmVzcG9uc2UuYm9keTtcbiAgICAgIFxuICAgICAgLy8gUGFzc3dvcmQgc2hvdWxkIG5ldmVyIGJlIGluY2x1ZGVkIGluIHByb2ZpbGUgZGF0YVxuICAgICAgZXhwZWN0KHByb2ZpbGUucGFzc3dvcmQpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJvdGVjdCBzZXNzaW9uIGRhdGEgZnJvbSB1bmF1dGhvcml6ZWQgYWNjZXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVHJ5IHRvIGFjY2VzcyBzZXNzaW9uIGRhdGEgd2l0aG91dCBhdXRoZW50aWNhdGlvblxuICAgICAgY29uc3Qgc2Vzc2lvblJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvYXV0aC9wcm9maWxlJyk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNhbml0aXplIGRhdGFiYXNlIGVycm9yIG1lc3NhZ2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVHJ5IHRvIGNyZWF0ZSB1c2VyIHdpdGggaW52YWxpZCBkYXRhIHRvIHRyaWdnZXIgZGF0YWJhc2UgZXJyb3JcbiAgICAgIGNvbnN0IGxvZ2luUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICB1c2VybmFtZTogJ2FkbWluMScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gbG9naW5SZXNwb25zZS5oZWFkZXJzWydzZXQtY29va2llJ107XG5cbiAgICAgIGNvbnN0IGNyZWF0ZVVzZXJSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS91c2VycycpXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIHNlc3Npb25Db29raWUpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICAvLyBJbnZhbGlkIGRhdGEgdG8gdHJpZ2dlciBkYXRhYmFzZSBjb25zdHJhaW50c1xuICAgICAgICAgIHVzZXJuYW1lOiAnJywgLy8gRW1wdHkgdXNlcm5hbWUgc2hvdWxkIHRyaWdnZXIgZXJyb3JcbiAgICAgICAgICBlbWFpbDogJ2ludmFsaWQtZW1haWwnLCAvLyBJbnZhbGlkIGVtYWlsIGZvcm1hdFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZVVzZXJSZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIFxuICAgICAgLy8gRXJyb3IgbWVzc2FnZSBzaG91bGQgbm90IGNvbnRhaW4gaW50ZXJuYWwgZGF0YWJhc2UgZGV0YWlsc1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gY3JlYXRlVXNlclJlc3BvbnNlLmJvZHkuZXJyb3IgfHwgY3JlYXRlVXNlclJlc3BvbnNlLmJvZHkubWVzc2FnZSB8fCAnJztcbiAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UpLm5vdC50b0NvbnRhaW4oJ2NvbnN0cmFpbnQnKTtcbiAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UpLm5vdC50b0NvbnRhaW4oJ3Zpb2xhdGlvbicpO1xuICAgICAgZXhwZWN0KGVycm9yTWVzc2FnZSkubm90LnRvQ29udGFpbigncG9zdGdyZXNxbCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2Vzc2lvbiBTZWN1cml0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGludmFsaWRhdGUgc2Vzc2lvbnMgb24gbG9nb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTG9naW5cbiAgICAgIGNvbnN0IGxvZ2luUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICB1c2VybmFtZTogJ21hbmFnZXIxJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChsb2dpblJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gICAgICAvLyBWZXJpZnkgc2Vzc2lvbiB3b3Jrc1xuICAgICAgY29uc3QgcHJvZmlsZVJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvYXV0aC9wcm9maWxlJylcbiAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSk7XG4gICAgICBleHBlY3QocHJvZmlsZVJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuXG4gICAgICAvLyBMb2dvdXRcbiAgICAgIGNvbnN0IGxvZ291dFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9nb3V0JylcbiAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSk7XG4gICAgICBleHBlY3QobG9nb3V0UmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG5cbiAgICAgIC8vIFRyeSB0byB1c2Ugc2Vzc2lvbiBhZnRlciBsb2dvdXQgKHNob3VsZCBmYWlsKVxuICAgICAgY29uc3QgcG9zdExvZ291dFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvYXV0aC9wcm9maWxlJylcbiAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSk7XG4gICAgICBleHBlY3QocG9zdExvZ291dFJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHNlc3Npb24gZml4YXRpb24gYXR0YWNrcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEdldCBpbml0aWFsIHNlc3Npb25cbiAgICAgIGNvbnN0IGluaXRpYWxSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2F1dGgvcHJvZmlsZScpO1xuXG4gICAgICBjb25zdCBpbml0aWFsQ29va2llID0gaW5pdGlhbFJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXTtcblxuICAgICAgLy8gTG9naW4gc2hvdWxkIGNyZWF0ZSBuZXcgc2Vzc2lvblxuICAgICAgY29uc3QgbG9naW5SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcbiAgICAgICAgLnNldCgnQ29va2llJywgaW5pdGlhbENvb2tpZSlcbiAgICAgICAgLnNlbmQoe1xuICAgICAgICAgIHVzZXJuYW1lOiAnbWFuYWdlcjEnLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KGxvZ2luUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBjb25zdCBsb2dpbkNvb2tpZSA9IGxvZ2luUmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gICAgICAvLyBTZXNzaW9uIElEIHNob3VsZCBoYXZlIGNoYW5nZWQgYWZ0ZXIgbG9naW5cbiAgICAgIGV4cGVjdChsb2dpbkNvb2tpZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChsb2dpbkNvb2tpZSkubm90LnRvRXF1YWwoaW5pdGlhbENvb2tpZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnB1dCBWYWxpZGF0aW9uIFNlY3VyaXR5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJldmVudCBOb1NRTC9TUUwgaW5qZWN0aW9uIGluIHVzZXIgcXVlcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXG4gICAgICAgIC5zZW5kKHtcbiAgICAgICAgICB1c2VybmFtZTogJ2FkbWluMScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gbG9naW5SZXNwb25zZS5oZWFkZXJzWydzZXQtY29va2llJ107XG5cbiAgICAgIC8vIFRyeSBpbmplY3Rpb24gYXR0ZW1wdHMgaW4gdmFyaW91cyBlbmRwb2ludHNcbiAgICAgIGNvbnN0IGluamVjdGlvbkF0dGVtcHRzID0gW1xuICAgICAgICBcIic7IERST1AgVEFCTEUgdXNlcnM7IC0tXCIsXG4gICAgICAgIFwiMScgT1IgJzEnPScxXCIsXG4gICAgICAgIFwiJHdoZXJlOiAnMSA9PSAxJ1wiLFxuICAgICAgICBcInsgJG5lOiBudWxsIH1cIixcbiAgICAgICAgXCIuLi8uLi8uLi9ldGMvcGFzc3dkXCJcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgaW5qZWN0aW9uIG9mIGluamVjdGlvbkF0dGVtcHRzKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgICAgLmdldCgnL2FwaS91c2VycycpXG4gICAgICAgICAgLnNldCgnQ29va2llJywgc2Vzc2lvbkNvb2tpZSlcbiAgICAgICAgICAucXVlcnkoeyBzZWFyY2g6IGluamVjdGlvbiB9KTtcblxuICAgICAgICAvLyBTaG91bGQgbm90IGNhdXNlIHNlcnZlciBlcnJvcnMgb3IgcmV0dXJuIHVuZXhwZWN0ZWQgZGF0YVxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlTGVzc1RoYW4oNTAwKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=
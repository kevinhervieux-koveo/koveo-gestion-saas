cae29dd594e8c388ca8ba9a6123380ca
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
/**
 * Quebec Law 25 Compliance Test Suite
 *
 * Validates compliance with Quebec's Law 25 (privacy law):
 * - French language support
 * - Privacy consent mechanisms
 * - Data protection measures
 * - User rights implementation
 */
// Mock language and compliance data for testing
const mockLanguageData = {
    fr: {
        privacy: {
            consent: 'Je consens au traitement de mes données personnelles',
            dataCollection: 'Collecte de données',
            dataUse: 'Utilisation des données',
            userRights: 'Droits des utilisateurs',
        },
        navigation: {
            dashboard: 'Tableau de bord',
            buildings: 'Bâtiments',
            residents: 'Résidents',
            documents: 'Documents',
        },
    },
    en: {
        privacy: {
            consent: 'I consent to the processing of my personal data',
            dataCollection: 'Data Collection',
            dataUse: 'Data Use',
            userRights: 'User Rights',
        },
        navigation: {
            dashboard: 'Dashboard',
            buildings: 'Buildings',
            residents: 'Residents',
            documents: 'Documents',
        },
    },
};
(0, globals_1.describe)('Quebec Law 25 Compliance', () => {
    (0, globals_1.describe)('Language Support', () => {
        (0, globals_1.it)('should provide French translations for all privacy-related terms', () => {
            const frenchPrivacy = mockLanguageData.fr.privacy;
            (0, globals_1.expect)(frenchPrivacy.consent).toBeDefined();
            (0, globals_1.expect)(frenchPrivacy.consent).toContain('consens');
            (0, globals_1.expect)(frenchPrivacy.dataCollection).toBeDefined();
            (0, globals_1.expect)(frenchPrivacy.dataUse).toBeDefined();
            (0, globals_1.expect)(frenchPrivacy.userRights).toBeDefined();
        });
        (0, globals_1.it)('should provide French translations for navigation elements', () => {
            const frenchNav = mockLanguageData.fr.navigation;
            (0, globals_1.expect)(frenchNav.dashboard).toBe('Tableau de bord');
            (0, globals_1.expect)(frenchNav.buildings).toBe('Bâtiments');
            (0, globals_1.expect)(frenchNav.residents).toBe('Résidents');
            (0, globals_1.expect)(frenchNav.documents).toBe('Documents');
        });
        (0, globals_1.it)('should have corresponding English translations', () => {
            const englishPrivacy = mockLanguageData.en.privacy;
            const frenchPrivacy = mockLanguageData.fr.privacy;
            // Every French key should have an English equivalent
            Object.keys(frenchPrivacy).forEach(key => {
                (0, globals_1.expect)(englishPrivacy[key]).toBeDefined();
            });
        });
    });
    (0, globals_1.describe)('Privacy Consent Requirements', () => {
        (0, globals_1.it)('should validate privacy consent is explicit and informed', () => {
            const consentText = mockLanguageData.fr.privacy.consent;
            // Consent must be explicit (not pre-checked)
            (0, globals_1.expect)(consentText).toContain('consens');
            (0, globals_1.expect)(consentText.length).toBeGreaterThan(10); // Meaningful consent text
        });
        (0, globals_1.it)('should provide clear information about data collection', () => {
            const dataCollectionInfo = mockLanguageData.fr.privacy.dataCollection;
            (0, globals_1.expect)(dataCollectionInfo).toBeDefined();
            (0, globals_1.expect)(dataCollectionInfo).toContain('données');
        });
        (0, globals_1.it)('should explain data use purposes clearly', () => {
            const dataUseInfo = mockLanguageData.fr.privacy.dataUse;
            (0, globals_1.expect)(dataUseInfo).toBeDefined();
            (0, globals_1.expect)(dataUseInfo).toContain('données');
        });
    });
    (0, globals_1.describe)('User Rights Implementation', () => {
        (0, globals_1.it)('should implement right to access personal data', () => {
            // Test data access functionality
            const userRightsText = mockLanguageData.fr.privacy.userRights;
            (0, globals_1.expect)(userRightsText).toBeDefined();
        });
        (0, globals_1.it)('should implement right to data portability', () => {
            // Quebec Law 25 requires data portability
            // This would test export functionality when implemented
            (0, globals_1.expect)(true).toBe(true); // Placeholder for actual data export test
        });
        (0, globals_1.it)('should implement right to rectification', () => {
            // Users should be able to correct their personal information
            // This would test profile editing functionality
            (0, globals_1.expect)(true).toBe(true); // Placeholder for actual profile editing test
        });
        (0, globals_1.it)('should implement right to erasure', () => {
            // Users should be able to request data deletion
            // This would test account deletion functionality
            (0, globals_1.expect)(true).toBe(true); // Placeholder for actual account deletion test
        });
    });
    (0, globals_1.describe)('Data Protection Measures', () => {
        (0, globals_1.it)('should ensure data minimization principles', () => {
            // Only collect necessary data
            const requiredFields = ['email', 'firstName', 'lastName', 'role'];
            const optionalFields = ['phone', 'preferredLanguage'];
            // Test that only necessary fields are marked as required
            (0, globals_1.expect)(requiredFields.length).toBeLessThanOrEqual(5);
            (0, globals_1.expect)(optionalFields).toContain('phone'); // Phone should be optional
        });
        (0, globals_1.it)('should implement proper data retention policies', () => {
            // Test that data retention periods are defined and enforced
            const maxRetentionDays = 365 * 7; // 7 years for property management
            (0, globals_1.expect)(maxRetentionDays).toBeDefined();
            (0, globals_1.expect)(maxRetentionDays).toBeLessThanOrEqual(365 * 10); // Not excessive
        });
        (0, globals_1.it)('should encrypt sensitive data at rest', () => {
            // Passwords should be hashed, not plaintext
            const isPasswordHashed = true; // This would check actual password storage
            (0, globals_1.expect)(isPasswordHashed).toBe(true);
        });
    });
    (0, globals_1.describe)('Quebec-Specific Requirements', () => {
        (0, globals_1.it)('should support Quebec postal code format', () => {
            const quebecPostalCodeRegex = /^[A-Za-z]\d[A-Za-z]\s*\d[A-Za-z]\d$/;
            const testPostalCodes = ['H1A 1A1', 'G1A1A1', 'J5R 2B3'];
            testPostalCodes.forEach(postalCode => {
                (0, globals_1.expect)(quebecPostalCodeRegex.test(postalCode)).toBe(true);
            });
        });
        (0, globals_1.it)('should support Quebec phone number formats', () => {
            const quebecPhoneRegex = /^(\+1[-.\s]?)?\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})$/;
            const testPhoneNumbers = [
                '514-555-1234',
                '(418) 555-1234',
                '+1-450-555-1234',
                '819.555.1234',
            ];
            testPhoneNumbers.forEach(phoneNumber => {
                (0, globals_1.expect)(quebecPhoneRegex.test(phoneNumber)).toBe(true);
            });
        });
        (0, globals_1.it)('should default to French language for Quebec users', () => {
            // Quebec users should default to French
            const defaultLanguage = 'fr';
            (0, globals_1.expect)(defaultLanguage).toBe('fr');
        });
        (0, globals_1.it)('should comply with Quebec business hour regulations', () => {
            // Test business hours compliance (example: not sending notifications after 9 PM)
            const businessHourStart = 8; // 8 AM
            const businessHourEnd = 21; // 9 PM
            (0, globals_1.expect)(businessHourStart).toBeGreaterThanOrEqual(6);
            (0, globals_1.expect)(businessHourEnd).toBeLessThanOrEqual(22);
        });
    });
    (0, globals_1.describe)('Consent Management', () => {
        (0, globals_1.it)('should track consent timestamps', () => {
            // Consent should include when it was given
            const consentRecord = {
                userId: 'test-user-id',
                consentType: 'data-processing',
                consentGiven: true,
                timestamp: new Date(),
            };
            (0, globals_1.expect)(consentRecord.timestamp).toBeInstanceOf(Date);
            (0, globals_1.expect)(consentRecord.consentGiven).toBe(true);
        });
        (0, globals_1.it)('should allow consent withdrawal', () => {
            // Users should be able to withdraw consent
            const withdrawalSupported = true; // This would test actual withdrawal functionality
            (0, globals_1.expect)(withdrawalSupported).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2kxOG4vcXVlYmVjLWNvbXBsaWFuY2UudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDJDQUFxRDtBQUVyRDs7Ozs7Ozs7R0FRRztBQUVILGdEQUFnRDtBQUNoRCxNQUFNLGdCQUFnQixHQUFHO0lBQ3ZCLEVBQUUsRUFBRTtRQUNGLE9BQU8sRUFBRTtZQUNQLE9BQU8sRUFBRSxzREFBc0Q7WUFDL0QsY0FBYyxFQUFFLHFCQUFxQjtZQUNyQyxPQUFPLEVBQUUseUJBQXlCO1lBQ2xDLFVBQVUsRUFBRSx5QkFBeUI7U0FDdEM7UUFDRCxVQUFVLEVBQUU7WUFDVixTQUFTLEVBQUUsaUJBQWlCO1lBQzVCLFNBQVMsRUFBRSxXQUFXO1lBQ3RCLFNBQVMsRUFBRSxXQUFXO1lBQ3RCLFNBQVMsRUFBRSxXQUFXO1NBQ3ZCO0tBQ0Y7SUFDRCxFQUFFLEVBQUU7UUFDRixPQUFPLEVBQUU7WUFDUCxPQUFPLEVBQUUsaURBQWlEO1lBQzFELGNBQWMsRUFBRSxpQkFBaUI7WUFDakMsT0FBTyxFQUFFLFVBQVU7WUFDbkIsVUFBVSxFQUFFLGFBQWE7U0FDMUI7UUFDRCxVQUFVLEVBQUU7WUFDVixTQUFTLEVBQUUsV0FBVztZQUN0QixTQUFTLEVBQUUsV0FBVztZQUN0QixTQUFTLEVBQUUsV0FBVztZQUN0QixTQUFTLEVBQUUsV0FBVztTQUN2QjtLQUNGO0NBQ0YsQ0FBQztBQUVGLElBQUEsa0JBQVEsRUFBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7SUFDeEMsSUFBQSxrQkFBUSxFQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtRQUNoQyxJQUFBLFlBQUUsRUFBQyxrRUFBa0UsRUFBRSxHQUFHLEVBQUU7WUFDMUUsTUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQztZQUVsRCxJQUFBLGdCQUFNLEVBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzVDLElBQUEsZ0JBQU0sRUFB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QyxpQkFBaUIsQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BELElBQUEsZ0JBQU0sRUFBQyxlQUFlLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBQSxrQkFBUSxFQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtRQUNsQyxJQUFBLFlBQUUsRUFBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsMkNBQTJDO1lBQzNDLE1BQU0sYUFBYSxHQUFHO2dCQUNwQixNQUFNLEVBQUUsY0FBYztnQkFDdEIsV0FBVyxFQUFFLGlCQUFpQjtnQkFDOUIsWUFBWSxFQUFFLElBQUk7Z0JBQ2xCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTthQUN0QixDQUFDO1lBRUYsSUFBQSxnQkFBTSxFQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDckQsSUFBQSxnQkFBTSxFQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFBLFlBQUUsRUFBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsMkNBQTJDO1lBQzNDLE1BQU0sbUJBQW1CLEdBQUcsSUFBSSxDQUFDLENBQUMsa0RBQWtEO1lBQ3BGLElBQUEsZ0JBQU0sRUFBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy91bml0L2kxOG4vcXVlYmVjLWNvbXBsaWFuY2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG4vKipcbiAqIFF1ZWJlYyBMYXcgMjUgQ29tcGxpYW5jZSBUZXN0IFN1aXRlXG4gKiBcbiAqIFZhbGlkYXRlcyBjb21wbGlhbmNlIHdpdGggUXVlYmVjJ3MgTGF3IDI1IChwcml2YWN5IGxhdyk6XG4gKiAtIEZyZW5jaCBsYW5ndWFnZSBzdXBwb3J0XG4gKiAtIFByaXZhY3kgY29uc2VudCBtZWNoYW5pc21zXG4gKiAtIERhdGEgcHJvdGVjdGlvbiBtZWFzdXJlc1xuICogLSBVc2VyIHJpZ2h0cyBpbXBsZW1lbnRhdGlvblxuICovXG5cbi8vIE1vY2sgbGFuZ3VhZ2UgYW5kIGNvbXBsaWFuY2UgZGF0YSBmb3IgdGVzdGluZ1xuY29uc3QgbW9ja0xhbmd1YWdlRGF0YSA9IHtcbiAgZnI6IHtcbiAgICBwcml2YWN5OiB7XG4gICAgICBjb25zZW50OiAnSmUgY29uc2VucyBhdSB0cmFpdGVtZW50IGRlIG1lcyBkb25uw6llcyBwZXJzb25uZWxsZXMnLFxuICAgICAgZGF0YUNvbGxlY3Rpb246ICdDb2xsZWN0ZSBkZSBkb25uw6llcycsXG4gICAgICBkYXRhVXNlOiAnVXRpbGlzYXRpb24gZGVzIGRvbm7DqWVzJyxcbiAgICAgIHVzZXJSaWdodHM6ICdEcm9pdHMgZGVzIHV0aWxpc2F0ZXVycycsXG4gICAgfSxcbiAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICBkYXNoYm9hcmQ6ICdUYWJsZWF1IGRlIGJvcmQnLFxuICAgICAgYnVpbGRpbmdzOiAnQsOidGltZW50cycsXG4gICAgICByZXNpZGVudHM6ICdSw6lzaWRlbnRzJyxcbiAgICAgIGRvY3VtZW50czogJ0RvY3VtZW50cycsXG4gICAgfSxcbiAgfSxcbiAgZW46IHtcbiAgICBwcml2YWN5OiB7XG4gICAgICBjb25zZW50OiAnSSBjb25zZW50IHRvIHRoZSBwcm9jZXNzaW5nIG9mIG15IHBlcnNvbmFsIGRhdGEnLFxuICAgICAgZGF0YUNvbGxlY3Rpb246ICdEYXRhIENvbGxlY3Rpb24nLFxuICAgICAgZGF0YVVzZTogJ0RhdGEgVXNlJyxcbiAgICAgIHVzZXJSaWdodHM6ICdVc2VyIFJpZ2h0cycsXG4gICAgfSxcbiAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICBkYXNoYm9hcmQ6ICdEYXNoYm9hcmQnLFxuICAgICAgYnVpbGRpbmdzOiAnQnVpbGRpbmdzJyxcbiAgICAgIHJlc2lkZW50czogJ1Jlc2lkZW50cycsXG4gICAgICBkb2N1bWVudHM6ICdEb2N1bWVudHMnLFxuICAgIH0sXG4gIH0sXG59O1xuXG5kZXNjcmliZSgnUXVlYmVjIExhdyAyNSBDb21wbGlhbmNlJywgKCkgPT4ge1xuICBkZXNjcmliZSgnTGFuZ3VhZ2UgU3VwcG9ydCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgRnJlbmNoIHRyYW5zbGF0aW9ucyBmb3IgYWxsIHByaXZhY3ktcmVsYXRlZCB0ZXJtcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZyZW5jaFByaXZhY3kgPSBtb2NrTGFuZ3VhZ2VEYXRhLmZyLnByaXZhY3k7XG4gICAgICBcbiAgICAgIGV4cGVjdChmcmVuY2hQcml2YWN5LmNvbnNlbnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZnJlbmNoUHJpdmFjeS5jb25zZW50KS50b0NvbnRhaW4oJ2NvbnNlbnMnKTtcbiAgICAgIGV4cGVjdChmcmVuY2hQcml2YWN5LmRhdGFDb2xsZWN0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZyZW5jaFByaXZhY3kuZGF0YVVzZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChmcmVuY2hQcml2YWN5LnVzZXJSaWdodHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgRnJlbmNoIHRyYW5zbGF0aW9ucyBmb3IgbmF2aWdhdGlvbiBlbGVtZW50cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZyZW5jaE5hdiA9IG1vY2tMYW5ndWFnZURhdGEuZnIubmF2aWdhdGlvbjtcbiAgICAgIFxuICAgICAgZXhwZWN0KGZyZW5jaE5hdi5kYXNoYm9hcmQpLnRvQmUoJ1RhYmxlYXUgZGUgYm9yZCcpO1xuICAgICAgZXhwZWN0KGZyZW5jaE5hdi5idWlsZGluZ3MpLnRvQmUoJ0LDonRpbWVudHMnKTtcbiAgICAgIGV4cGVjdChmcmVuY2hOYXYucmVzaWRlbnRzKS50b0JlKCdSw6lzaWRlbnRzJyk7XG4gICAgICBleHBlY3QoZnJlbmNoTmF2LmRvY3VtZW50cykudG9CZSgnRG9jdW1lbnRzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgY29ycmVzcG9uZGluZyBFbmdsaXNoIHRyYW5zbGF0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVuZ2xpc2hQcml2YWN5ID0gbW9ja0xhbmd1YWdlRGF0YS5lbi5wcml2YWN5O1xuICAgICAgY29uc3QgZnJlbmNoUHJpdmFjeSA9IG1vY2tMYW5ndWFnZURhdGEuZnIucHJpdmFjeTtcbiAgICAgIFxuICAgICAgLy8gRXZlcnkgRnJlbmNoIGtleSBzaG91bGQgaGF2ZSBhbiBFbmdsaXNoIGVxdWl2YWxlbnRcbiAgICAgIE9iamVjdC5rZXlzKGZyZW5jaFByaXZhY3kpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgZXhwZWN0KGVuZ2xpc2hQcml2YWN5W2tleSBhcyBrZXlvZiB0eXBlb2YgZW5nbGlzaFByaXZhY3ldKS50b0JlRGVmaW5lZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQcml2YWN5IENvbnNlbnQgUmVxdWlyZW1lbnRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcHJpdmFjeSBjb25zZW50IGlzIGV4cGxpY2l0IGFuZCBpbmZvcm1lZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNlbnRUZXh0ID0gbW9ja0xhbmd1YWdlRGF0YS5mci5wcml2YWN5LmNvbnNlbnQ7XG4gICAgICBcbiAgICAgIC8vIENvbnNlbnQgbXVzdCBiZSBleHBsaWNpdCAobm90IHByZS1jaGVja2VkKVxuICAgICAgZXhwZWN0KGNvbnNlbnRUZXh0KS50b0NvbnRhaW4oJ2NvbnNlbnMnKTtcbiAgICAgIGV4cGVjdChjb25zZW50VGV4dC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigxMCk7IC8vIE1lYW5pbmdmdWwgY29uc2VudCB0ZXh0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgY2xlYXIgaW5mb3JtYXRpb24gYWJvdXQgZGF0YSBjb2xsZWN0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YUNvbGxlY3Rpb25JbmZvID0gbW9ja0xhbmd1YWdlRGF0YS5mci5wcml2YWN5LmRhdGFDb2xsZWN0aW9uO1xuICAgICAgXG4gICAgICBleHBlY3QoZGF0YUNvbGxlY3Rpb25JbmZvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRhdGFDb2xsZWN0aW9uSW5mbykudG9Db250YWluKCdkb25uw6llcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHBsYWluIGRhdGEgdXNlIHB1cnBvc2VzIGNsZWFybHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhVXNlSW5mbyA9IG1vY2tMYW5ndWFnZURhdGEuZnIucHJpdmFjeS5kYXRhVXNlO1xuICAgICAgXG4gICAgICBleHBlY3QoZGF0YVVzZUluZm8pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGF0YVVzZUluZm8pLnRvQ29udGFpbignZG9ubsOpZXMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1VzZXIgUmlnaHRzIEltcGxlbWVudGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW1wbGVtZW50IHJpZ2h0IHRvIGFjY2VzcyBwZXJzb25hbCBkYXRhJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCBkYXRhIGFjY2VzcyBmdW5jdGlvbmFsaXR5XG4gICAgICBjb25zdCB1c2VyUmlnaHRzVGV4dCA9IG1vY2tMYW5ndWFnZURhdGEuZnIucHJpdmFjeS51c2VyUmlnaHRzO1xuICAgICAgZXhwZWN0KHVzZXJSaWdodHNUZXh0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbXBsZW1lbnQgcmlnaHQgdG8gZGF0YSBwb3J0YWJpbGl0eScsICgpID0+IHtcbiAgICAgIC8vIFF1ZWJlYyBMYXcgMjUgcmVxdWlyZXMgZGF0YSBwb3J0YWJpbGl0eVxuICAgICAgLy8gVGhpcyB3b3VsZCB0ZXN0IGV4cG9ydCBmdW5jdGlvbmFsaXR5IHdoZW4gaW1wbGVtZW50ZWRcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlciBmb3IgYWN0dWFsIGRhdGEgZXhwb3J0IHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW1wbGVtZW50IHJpZ2h0IHRvIHJlY3RpZmljYXRpb24nLCAoKSA9PiB7XG4gICAgICAvLyBVc2VycyBzaG91bGQgYmUgYWJsZSB0byBjb3JyZWN0IHRoZWlyIHBlcnNvbmFsIGluZm9ybWF0aW9uXG4gICAgICAvLyBUaGlzIHdvdWxkIHRlc3QgcHJvZmlsZSBlZGl0aW5nIGZ1bmN0aW9uYWxpdHlcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlciBmb3IgYWN0dWFsIHByb2ZpbGUgZWRpdGluZyB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGltcGxlbWVudCByaWdodCB0byBlcmFzdXJlJywgKCkgPT4ge1xuICAgICAgLy8gVXNlcnMgc2hvdWxkIGJlIGFibGUgdG8gcmVxdWVzdCBkYXRhIGRlbGV0aW9uXG4gICAgICAvLyBUaGlzIHdvdWxkIHRlc3QgYWNjb3VudCBkZWxldGlvbiBmdW5jdGlvbmFsaXR5XG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gUGxhY2Vob2xkZXIgZm9yIGFjdHVhbCBhY2NvdW50IGRlbGV0aW9uIHRlc3RcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgUHJvdGVjdGlvbiBNZWFzdXJlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGVuc3VyZSBkYXRhIG1pbmltaXphdGlvbiBwcmluY2lwbGVzJywgKCkgPT4ge1xuICAgICAgLy8gT25seSBjb2xsZWN0IG5lY2Vzc2FyeSBkYXRhXG4gICAgICBjb25zdCByZXF1aXJlZEZpZWxkcyA9IFsnZW1haWwnLCAnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJywgJ3JvbGUnXTtcbiAgICAgIGNvbnN0IG9wdGlvbmFsRmllbGRzID0gWydwaG9uZScsICdwcmVmZXJyZWRMYW5ndWFnZSddO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRoYXQgb25seSBuZWNlc3NhcnkgZmllbGRzIGFyZSBtYXJrZWQgYXMgcmVxdWlyZWRcbiAgICAgIGV4cGVjdChyZXF1aXJlZEZpZWxkcy5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoNSk7XG4gICAgICBleHBlY3Qob3B0aW9uYWxGaWVsZHMpLnRvQ29udGFpbigncGhvbmUnKTsgLy8gUGhvbmUgc2hvdWxkIGJlIG9wdGlvbmFsXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGltcGxlbWVudCBwcm9wZXIgZGF0YSByZXRlbnRpb24gcG9saWNpZXMnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgZGF0YSByZXRlbnRpb24gcGVyaW9kcyBhcmUgZGVmaW5lZCBhbmQgZW5mb3JjZWRcbiAgICAgIGNvbnN0IG1heFJldGVudGlvbkRheXMgPSAzNjUgKiA3OyAvLyA3IHllYXJzIGZvciBwcm9wZXJ0eSBtYW5hZ2VtZW50XG4gICAgICBleHBlY3QobWF4UmV0ZW50aW9uRGF5cykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtYXhSZXRlbnRpb25EYXlzKS50b0JlTGVzc1RoYW5PckVxdWFsKDM2NSAqIDEwKTsgLy8gTm90IGV4Y2Vzc2l2ZVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmNyeXB0IHNlbnNpdGl2ZSBkYXRhIGF0IHJlc3QnLCAoKSA9PiB7XG4gICAgICAvLyBQYXNzd29yZHMgc2hvdWxkIGJlIGhhc2hlZCwgbm90IHBsYWludGV4dFxuICAgICAgY29uc3QgaXNQYXNzd29yZEhhc2hlZCA9IHRydWU7IC8vIFRoaXMgd291bGQgY2hlY2sgYWN0dWFsIHBhc3N3b3JkIHN0b3JhZ2VcbiAgICAgIGV4cGVjdChpc1Bhc3N3b3JkSGFzaGVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUXVlYmVjLVNwZWNpZmljIFJlcXVpcmVtZW50cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgUXVlYmVjIHBvc3RhbCBjb2RlIGZvcm1hdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHF1ZWJlY1Bvc3RhbENvZGVSZWdleCA9IC9eW0EtWmEtel1cXGRbQS1aYS16XVxccypcXGRbQS1aYS16XVxcZCQvO1xuICAgICAgY29uc3QgdGVzdFBvc3RhbENvZGVzID0gWydIMUEgMUExJywgJ0cxQTFBMScsICdKNVIgMkIzJ107XG4gICAgICBcbiAgICAgIHRlc3RQb3N0YWxDb2Rlcy5mb3JFYWNoKHBvc3RhbENvZGUgPT4ge1xuICAgICAgICBleHBlY3QocXVlYmVjUG9zdGFsQ29kZVJlZ2V4LnRlc3QocG9zdGFsQ29kZSkpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBRdWViZWMgcGhvbmUgbnVtYmVyIGZvcm1hdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBxdWViZWNQaG9uZVJlZ2V4ID0gL14oXFwrMVstLlxcc10/KT9cXCg/KFswLTldezN9KVxcKT9bLS5cXHNdPyhbMC05XXszfSlbLS5cXHNdPyhbMC05XXs0fSkkLztcbiAgICAgIGNvbnN0IHRlc3RQaG9uZU51bWJlcnMgPSBbXG4gICAgICAgICc1MTQtNTU1LTEyMzQnLFxuICAgICAgICAnKDQxOCkgNTU1LTEyMzQnLFxuICAgICAgICAnKzEtNDUwLTU1NS0xMjM0JyxcbiAgICAgICAgJzgxOS41NTUuMTIzNCcsXG4gICAgICBdO1xuICAgICAgXG4gICAgICB0ZXN0UGhvbmVOdW1iZXJzLmZvckVhY2gocGhvbmVOdW1iZXIgPT4ge1xuICAgICAgICBleHBlY3QocXVlYmVjUGhvbmVSZWdleC50ZXN0KHBob25lTnVtYmVyKSkudG9CZSh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZWZhdWx0IHRvIEZyZW5jaCBsYW5ndWFnZSBmb3IgUXVlYmVjIHVzZXJzJywgKCkgPT4ge1xuICAgICAgLy8gUXVlYmVjIHVzZXJzIHNob3VsZCBkZWZhdWx0IHRvIEZyZW5jaFxuICAgICAgY29uc3QgZGVmYXVsdExhbmd1YWdlID0gJ2ZyJztcbiAgICAgIGV4cGVjdChkZWZhdWx0TGFuZ3VhZ2UpLnRvQmUoJ2ZyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNvbXBseSB3aXRoIFF1ZWJlYyBidXNpbmVzcyBob3VyIHJlZ3VsYXRpb25zJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCBidXNpbmVzcyBob3VycyBjb21wbGlhbmNlIChleGFtcGxlOiBub3Qgc2VuZGluZyBub3RpZmljYXRpb25zIGFmdGVyIDkgUE0pXG4gICAgICBjb25zdCBidXNpbmVzc0hvdXJTdGFydCA9IDg7IC8vIDggQU1cbiAgICAgIGNvbnN0IGJ1c2luZXNzSG91ckVuZCA9IDIxOyAvLyA5IFBNXG4gICAgICBcbiAgICAgIGV4cGVjdChidXNpbmVzc0hvdXJTdGFydCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCg2KTtcbiAgICAgIGV4cGVjdChidXNpbmVzc0hvdXJFbmQpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMjIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29uc2VudCBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdHJhY2sgY29uc2VudCB0aW1lc3RhbXBzJywgKCkgPT4ge1xuICAgICAgLy8gQ29uc2VudCBzaG91bGQgaW5jbHVkZSB3aGVuIGl0IHdhcyBnaXZlblxuICAgICAgY29uc3QgY29uc2VudFJlY29yZCA9IHtcbiAgICAgICAgdXNlcklkOiAndGVzdC11c2VyLWlkJyxcbiAgICAgICAgY29uc2VudFR5cGU6ICdkYXRhLXByb2Nlc3NpbmcnLFxuICAgICAgICBjb25zZW50R2l2ZW46IHRydWUsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zZW50UmVjb3JkLnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gICAgICBleHBlY3QoY29uc2VudFJlY29yZC5jb25zZW50R2l2ZW4pLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGNvbnNlbnQgd2l0aGRyYXdhbCcsICgpID0+IHtcbiAgICAgIC8vIFVzZXJzIHNob3VsZCBiZSBhYmxlIHRvIHdpdGhkcmF3IGNvbnNlbnRcbiAgICAgIGNvbnN0IHdpdGhkcmF3YWxTdXBwb3J0ZWQgPSB0cnVlOyAvLyBUaGlzIHdvdWxkIHRlc3QgYWN0dWFsIHdpdGhkcmF3YWwgZnVuY3Rpb25hbGl0eVxuICAgICAgZXhwZWN0KHdpdGhkcmF3YWxTdXBwb3J0ZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
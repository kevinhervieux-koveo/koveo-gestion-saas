ef372cb67adfc1da462a8013717ed9e9
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.insertSessionSchema = exports.insertSslCertificateSchema = exports.sessions = exports.sslCertificates = exports.sslStatusEnum = void 0;
const drizzle_orm_1 = require("drizzle-orm");
const pg_core_1 = require("drizzle-orm/pg-core");
const zod_1 = require("zod");
const core_1 = require("./core");
// Infrastructure enums
exports.sslStatusEnum = (0, pg_core_1.pgEnum)('ssl_status', [
    'active',
    'pending',
    'expired',
    'revoked',
    'failed',
]);
// Infrastructure tables
/**
 * SSL certificates table for managing domain SSL certificates.
 * Supports automated certificate management and renewal tracking.
 */
exports.sslCertificates = (0, pg_core_1.pgTable)('ssl_certificates', {
    id: (0, pg_core_1.uuid)('id')
        .primaryKey()
        .default((0, drizzle_orm_1.sql) `gen_random_uuid()`),
    domain: (0, pg_core_1.text)('domain').notNull().unique(),
    certificateData: (0, pg_core_1.text)('certificate_data').notNull(),
    privateKey: (0, pg_core_1.text)('private_key').notNull(),
    issuer: (0, pg_core_1.text)('issuer').notNull(),
    subject: (0, pg_core_1.text)('subject').notNull(),
    serialNumber: (0, pg_core_1.text)('serial_number').notNull(),
    fingerprint: (0, pg_core_1.text)('fingerprint').notNull(),
    validFrom: (0, pg_core_1.timestamp)('valid_from').notNull(),
    validTo: (0, pg_core_1.timestamp)('valid_to').notNull(),
    status: (0, exports.sslStatusEnum)('status').notNull().default('pending'),
    autoRenew: (0, pg_core_1.boolean)('auto_renew').notNull().default(true),
    renewalAttempts: (0, pg_core_1.integer)('renewal_attempts').notNull().default(0),
    maxRenewalAttempts: (0, pg_core_1.integer)('max_renewal_attempts').notNull().default(3),
    dnsProvider: (0, pg_core_1.text)('dns_provider'),
    lastRenewalAttempt: (0, pg_core_1.timestamp)('last_renewal_attempt'),
    nextRenewalDate: (0, pg_core_1.timestamp)('next_renewal_date'),
    // Additional SSL management fields
    certificateChain: (0, pg_core_1.text)('certificate_chain'),
    renewalError: (0, pg_core_1.text)('renewal_error'),
    dnsCredentials: (0, pg_core_1.text)('dns_credentials'),
    notificationEmails: (0, pg_core_1.text)('notification_emails'),
    createdBy: (0, pg_core_1.uuid)('created_by')
        .notNull()
        .references(() => core_1.users.id),
    createdAt: (0, pg_core_1.timestamp)('created_at').defaultNow(),
    updatedAt: (0, pg_core_1.timestamp)('updated_at').defaultNow(),
});
/**
 * Session table for PostgreSQL session store.
 * This table stores user session data for authentication.
 * CRITICAL: This table must never be deleted as it's required for user sessions.
 */
exports.sessions = (0, pg_core_1.pgTable)('session', {
    sid: (0, pg_core_1.varchar)('sid').primaryKey().notNull(),
    sess: (0, pg_core_1.json)('sess').notNull(),
    expire: (0, pg_core_1.timestamp)('expire', { precision: 6 }).notNull(),
});
// Insert schemas
exports.insertSslCertificateSchema = zod_1.z.object({
    domain: zod_1.z.string(),
    certificateData: zod_1.z.string(),
    privateKey: zod_1.z.string(),
    issuer: zod_1.z.string(),
    subject: zod_1.z.string(),
    serialNumber: zod_1.z.string(),
    fingerprint: zod_1.z.string(),
    validFrom: zod_1.z.date(),
    validTo: zod_1.z.date(),
    status: zod_1.z.string().default('pending'),
    autoRenew: zod_1.z.boolean().default(true),
    renewalAttempts: zod_1.z.number().int().default(0),
    maxRenewalAttempts: zod_1.z.number().int().default(3),
    dnsProvider: zod_1.z.string().optional(),
    lastRenewalAttempt: zod_1.z.date().optional(),
    nextRenewalDate: zod_1.z.date().optional(),
    createdBy: zod_1.z.string().uuid(),
});
// Types
// Session table schema (no insert schema needed - managed by connect-pg-simple)
exports.insertSessionSchema = zod_1.z.object({
    sid: zod_1.z.string(),
    sess: zod_1.z.any(), // JSON data
    expire: zod_1.z.date(),
});
// Relations - temporarily commented out due to drizzle-orm version compatibility
// export const sslCertificatesRelations = relations(sslCertificates, ({ one }) => ({
//   createdBy: one(users, {
//     fields: [sslCertificates.createdBy],
//     references: [users.id],
//   }),
// }));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9zaGFyZWQvc2NoZW1hcy9pbmZyYXN0cnVjdHVyZS50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBa0M7QUFDbEMsaURBQThHO0FBRTlHLDZCQUF3QjtBQUV4QixpQ0FBK0I7QUFFL0IsdUJBQXVCO0FBQ1YsUUFBQSxhQUFhLEdBQUcsSUFBQSxnQkFBTSxFQUFDLFlBQVksRUFBRTtJQUNoRCxRQUFRO0lBQ1IsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTO0lBQ1QsUUFBUTtDQUNULENBQUMsQ0FBQztBQUVILHdCQUF3QjtBQUN4Qjs7O0dBR0c7QUFDVSxRQUFBLGVBQWUsR0FBRyxJQUFBLGlCQUFPLEVBQUMsa0JBQWtCLEVBQUU7SUFDekQsRUFBRSxFQUFFLElBQUEsY0FBSSxFQUFDLElBQUksQ0FBQztTQUNYLFVBQVUsRUFBRTtTQUNaLE9BQU8sQ0FBQyxJQUFBLGlCQUFHLEVBQUEsbUJBQW1CLENBQUM7SUFDbEMsTUFBTSxFQUFFLElBQUEsY0FBSSxFQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLE1BQU0sRUFBRTtJQUN6QyxlQUFlLEVBQUUsSUFBQSxjQUFJLEVBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDbkQsVUFBVSxFQUFFLElBQUEsY0FBSSxFQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sRUFBRTtJQUN6QyxNQUFNLEVBQUUsSUFBQSxjQUFJLEVBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQ2hDLE9BQU8sRUFBRSxJQUFBLGNBQUksRUFBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLEVBQUU7SUFDbEMsWUFBWSxFQUFFLElBQUEsY0FBSSxFQUFDLGVBQWUsQ0FBQyxDQUFDLE9BQU8sRUFBRTtJQUM3QyxXQUFXLEVBQUUsSUFBQSxjQUFJLEVBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQzFDLFNBQVMsRUFBRSxJQUFBLG1CQUFTLEVBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxFQUFFO0lBQzVD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QyxDQUFDO0lBQzVDLGtCQUFrQixFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQy9DLFdBQVcsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQ2xDLGtCQUFrQixFQUFFLE9BQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUU7SUFDdkMsZUFBZSxFQUFFLE9BQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUU7SUFDcEMsU0FBUyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLEVBQUU7Q0FDN0IsQ0FBQyxDQUFDO0FBRUgsUUFBUTtBQUNSLGdGQUFnRjtBQUNuRSxRQUFBLG1CQUFtQixHQUFHLE9BQUMsQ0FBQyxNQUFNLENBQUM7SUFDMUMsR0FBRyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUU7SUFDZixJQUFJLEVBQUUsT0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLFlBQVk7SUFDM0IsTUFBTSxFQUFFLE9BQUMsQ0FBQyxJQUFJLEVBQUU7Q0FDakIsQ0FBQyxDQUFDO0FBUUgsaUZBQWlGO0FBQ2pGLHFGQUFxRjtBQUNyRiw0QkFBNEI7QUFDNUIsMkNBQTJDO0FBQzNDLDhCQUE4QjtBQUM5QixRQUFRO0FBQ1IsT0FBTyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3NoYXJlZC9zY2hlbWFzL2luZnJhc3RydWN0dXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNxbCB9IGZyb20gJ2RyaXp6bGUtb3JtJztcbmltcG9ydCB7IHBnVGFibGUsIHRleHQsIHRpbWVzdGFtcCwgdXVpZCwgcGdFbnVtLCBib29sZWFuLCBpbnRlZ2VyLCB2YXJjaGFyLCBqc29uIH0gZnJvbSAnZHJpenpsZS1vcm0vcGctY29yZSc7XG5pbXBvcnQgeyBjcmVhdGVJbnNlcnRTY2hlbWEgfSBmcm9tICdkcml6emxlLXpvZCc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IHJlbGF0aW9ucyB9IGZyb20gJ2RyaXp6bGUtb3JtJztcbmltcG9ydCB7IHVzZXJzIH0gZnJvbSAnLi9jb3JlJztcblxuLy8gSW5mcmFzdHJ1Y3R1cmUgZW51bXNcbmV4cG9ydCBjb25zdCBzc2xTdGF0dXNFbnVtID0gcGdFbnVtKCdzc2xfc3RhdHVzJywgW1xuICAnYWN0aXZlJyxcbiAgJ3BlbmRpbmcnLFxuICAnZXhwaXJlZCcsXG4gICdyZXZva2VkJyxcbiAgJ2ZhaWxlZCcsXG5dKTtcblxuLy8gSW5mcmFzdHJ1Y3R1cmUgdGFibGVzXG4vKipcbiAqIFNTTCBjZXJ0aWZpY2F0ZXMgdGFibGUgZm9yIG1hbmFnaW5nIGRvbWFpbiBTU0wgY2VydGlmaWNhdGVzLlxuICogU3VwcG9ydHMgYXV0b21hdGVkIGNlcnRpZmljYXRlIG1hbmFnZW1lbnQgYW5kIHJlbmV3YWwgdHJhY2tpbmcuXG4gKi9cbmV4cG9ydCBjb25zdCBzc2xDZXJ0aWZpY2F0ZXMgPSBwZ1RhYmxlKCdzc2xfY2VydGlmaWNhdGVzJywge1xuICBpZDogdXVpZCgnaWQnKVxuICAgIC5wcmltYXJ5S2V5KClcbiAgICAuZGVmYXVsdChzcWxgZ2VuX3JhbmRvbV91dWlkKClgKSxcbiAgZG9tYWluOiB0ZXh0KCdkb21haW4nKS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIGNlcnRpZmljYXRlRGF0YTogdGV4dCgnY2VydGlmaWNhdGVfZGF0YScpLm5vdE51bGwoKSxcbiAgcHJpdmF0ZUtleTogdGV4dCgncHJpdmF0ZV9rZXknKS5ub3ROdWxsKCksXG4gIGlzc3VlcjogdGV4dCgnaXNzdWVyJykubm90TnVsbCgpLFxuICBzdWJqZWN0OiB0ZXh0KCdzdWJqZWN0Jykubm90TnVsbCgpLFxuICBzZXJpYWxOdW1iZXI6IHRleHQoJ3NlcmlhbF9udW1iZXInKS5ub3ROdWxsKCksXG4gIGZpbmdlcnByaW50OiB0ZXh0KCdmaW5nZXJwcmludCcpLm5vdE51bGwoKSxcbiAgdmFsaWRGcm9tOiB0aW1lc3RhbXAoJ3ZhbGlkX2Zyb20nKS5ub3ROdWxsKCksXG4gIHZhbGlkVG86IHRpbWVzdGFtcCgndmFsaWRfdG8nKS5ub3ROdWxsKCksXG4gIHN0YXR1czogc3NsU3RhdHVzRW51bSgnc3RhdHVzJykubm90TnVsbCgpLmRlZmF1bHQoJ3BlbmRpbmcnKSxcbiAgYXV0b1JlbmV3OiBib29sZWFuKCdhdXRvX3JlbmV3Jykubm90TnVsbCgpLmRlZmF1bHQodHJ1ZSksXG4gIHJlbmV3YWxBdHRlbXB0czogaW50ZWdlcigncmVuZXdhbF9hdHRlbXB0cycpLm5vdE51bGwoKS5kZWZhdWx0KDApLFxuICBtYXhSZW5ld2FsQXR0ZW1wdHM6IGludGVnZXIoJ21heF9yZW5ld2FsX2F0dGVtcHRzJykubm90TnVsbCgpLmRlZmF1bHQoMyksXG4gIGRuc1Byb3ZpZGVyOiB0ZXh0KCdkbnNfcHJvdmlkZXInKSxcbiAgbGFzdFJlbmV3YWxBdHRlbXB0OiB0aW1lc3RhbXAoJ2xhc3RfcmVuZXdhbF9hdHRlbXB0JyksXG4gIG5leHRSZW5ld2FsRGF0ZTogdGltZXN0YW1wKCduZXh0X3JlbmV3YWxfZGF0ZScpLFxuICAvLyBBZGRpdGlvbmFsIFNTTCBtYW5hZ2VtZW50IGZpZWxkc1xuICBjZXJ0aWZpY2F0ZUNoYWluOiB0ZXh0KCdjZXJ0aWZpY2F0ZV9jaGFpbicpLFxuICByZW5ld2FsRXJyb3I6IHRleHQoJ3JlbmV3YWxfZXJyb3InKSxcbiAgZG5zQ3JlZGVudGlhbHM6IHRleHQoJ2Ruc19jcmVkZW50aWFscycpLFxuICBub3RpZmljYXRpb25FbWFpbHM6IHRleHQoJ25vdGlmaWNhdGlvbl9lbWFpbHMnKSxcbiAgY3JlYXRlZEJ5OiB1dWlkKCdjcmVhdGVkX2J5JylcbiAgICAubm90TnVsbCgpXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gdXNlcnMuaWQpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcpLmRlZmF1bHROb3coKSxcbiAgdXBkYXRlZEF0OiB0aW1lc3RhbXAoJ3VwZGF0ZWRfYXQnKS5kZWZhdWx0Tm93KCksXG59KTtcblxuLyoqXG4gKiBTZXNzaW9uIHRhYmxlIGZvciBQb3N0Z3JlU1FMIHNlc3Npb24gc3RvcmUuXG4gKiBUaGlzIHRhYmxlIHN0b3JlcyB1c2VyIHNlc3Npb24gZGF0YSBmb3IgYXV0aGVudGljYXRpb24uXG4gKiBDUklUSUNBTDogVGhpcyB0YWJsZSBtdXN0IG5ldmVyIGJlIGRlbGV0ZWQgYXMgaXQncyByZXF1aXJlZCBmb3IgdXNlciBzZXNzaW9ucy5cbiAqL1xuZXhwb3J0IGNvbnN0IHNlc3Npb25zID0gcGdUYWJsZSgnc2Vzc2lvbicsIHtcbiAgc2lkOiB2YXJjaGFyKCdzaWQnKS5wcmltYXJ5S2V5KCkubm90TnVsbCgpLFxuICBzZXNzOiBqc29uKCdzZXNzJykubm90TnVsbCgpLFxuICBleHBpcmU6IHRpbWVzdGFtcCgnZXhwaXJlJywgeyBwcmVjaXNpb246IDYgfSkubm90TnVsbCgpLFxufSk7XG5cbi8vIEluc2VydCBzY2hlbWFzXG5leHBvcnQgY29uc3QgaW5zZXJ0U3NsQ2VydGlmaWNhdGVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGRvbWFpbjogei5zdHJpbmcoKSxcbiAgY2VydGlmaWNhdGVEYXRhOiB6LnN0cmluZygpLFxuICBwcml2YXRlS2V5OiB6LnN0cmluZygpLFxuICBpc3N1ZXI6IHouc3RyaW5nKCksXG4gIHN1YmplY3Q6IHouc3RyaW5nKCksXG4gIHNlcmlhbE51bWJlcjogei5zdHJpbmcoKSxcbiAgZmluZ2VycHJpbnQ6IHouc3RyaW5nKCksXG4gIHZhbGlkRnJvbTogei5kYXRlKCksXG4gIHZhbGlkVG86IHouZGF0ZSgpLFxuICBzdGF0dXM6IHouc3RyaW5nKCkuZGVmYXVsdCgncGVuZGluZycpLFxuICBhdXRvUmVuZXc6IHouYm9vbGVhbigpLmRlZmF1bHQodHJ1ZSksXG4gIHJlbmV3YWxBdHRlbXB0czogei5udW1iZXIoKS5pbnQoKS5kZWZhdWx0KDApLFxuICBtYXhSZW5ld2FsQXR0ZW1wdHM6IHoubnVtYmVyKCkuaW50KCkuZGVmYXVsdCgzKSxcbiAgZG5zUHJvdmlkZXI6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgbGFzdFJlbmV3YWxBdHRlbXB0OiB6LmRhdGUoKS5vcHRpb25hbCgpLFxuICBuZXh0UmVuZXdhbERhdGU6IHouZGF0ZSgpLm9wdGlvbmFsKCksXG4gIGNyZWF0ZWRCeTogei5zdHJpbmcoKS51dWlkKCksXG59KTtcblxuLy8gVHlwZXNcbi8vIFNlc3Npb24gdGFibGUgc2NoZW1hIChubyBpbnNlcnQgc2NoZW1hIG5lZWRlZCAtIG1hbmFnZWQgYnkgY29ubmVjdC1wZy1zaW1wbGUpXG5leHBvcnQgY29uc3QgaW5zZXJ0U2Vzc2lvblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgc2lkOiB6LnN0cmluZygpLFxuICBzZXNzOiB6LmFueSgpLCAvLyBKU09OIGRhdGFcbiAgZXhwaXJlOiB6LmRhdGUoKSxcbn0pO1xuXG4vLyBUeXBlc1xuZXhwb3J0IHR5cGUgSW5zZXJ0U3NsQ2VydGlmaWNhdGUgPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRTc2xDZXJ0aWZpY2F0ZVNjaGVtYT47XG5leHBvcnQgdHlwZSBTc2xDZXJ0aWZpY2F0ZSA9IHR5cGVvZiBzc2xDZXJ0aWZpY2F0ZXMuJGluZmVyU2VsZWN0O1xuZXhwb3J0IHR5cGUgSW5zZXJ0U2Vzc2lvbiA9IHouaW5mZXI8dHlwZW9mIGluc2VydFNlc3Npb25TY2hlbWE+O1xuZXhwb3J0IHR5cGUgU2Vzc2lvbiA9IHR5cGVvZiBzZXNzaW9ucy4kaW5mZXJTZWxlY3Q7XG5cbi8vIFJlbGF0aW9ucyAtIHRlbXBvcmFyaWx5IGNvbW1lbnRlZCBvdXQgZHVlIHRvIGRyaXp6bGUtb3JtIHZlcnNpb24gY29tcGF0aWJpbGl0eVxuLy8gZXhwb3J0IGNvbnN0IHNzbENlcnRpZmljYXRlc1JlbGF0aW9ucyA9IHJlbGF0aW9ucyhzc2xDZXJ0aWZpY2F0ZXMsICh7IG9uZSB9KSA9PiAoe1xuLy8gICBjcmVhdGVkQnk6IG9uZSh1c2Vycywge1xuLy8gICAgIGZpZWxkczogW3NzbENlcnRpZmljYXRlcy5jcmVhdGVkQnldLFxuLy8gICAgIHJlZmVyZW5jZXM6IFt1c2Vycy5pZF0sXG4vLyAgIH0pLFxuLy8gfSkpO1xuIl0sInZlcnNpb24iOjN9
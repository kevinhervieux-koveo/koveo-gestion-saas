e7d369214385e8a2d0f79444638b99f6
"use strict";
/**
 * @file Demand Comment Integration Tests
 * @description Comprehensive tests for demand comment API endpoints and workflow
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const supertest_1 = __importDefault(require("supertest"));
const db_1 = require("../../server/db");
const schema_1 = require("../../shared/schema");
const drizzle_orm_1 = require("drizzle-orm");
// Mock Express app setup
function createTestApp() {
    const express = require('express');
    const app = express();
    app.use(express.json());
    // Mock session middleware for testing
    app.use((req, res, next) => {
        // testUser will be set in beforeEach
        req.user = { id: 'user-123', role: 'resident' };
        next();
    });
    const { registerDemandRoutes } = require('../../server/api/demands');
    registerDemandRoutes(app);
    return app;
}
(0, globals_1.describe)('Demand Comment Integration Tests', () => {
    let app;
    let testUser;
    let testDemand;
    let testBuilding;
    let testResidence;
    let testOrganization;
    let authCookie;
    (0, globals_1.beforeEach)(async () => {
        app = createTestApp();
        // Create test organization
        const orgResult = await db_1.db.insert(schema_1.organizations).values({
            name: 'Test Organization',
            type: 'residential',
            address: '123 Test St',
            city: 'Test City',
            province: 'QC',
            postalCode: 'H1H 1H1',
            isActive: true,
        }).returning();
        testOrganization = orgResult[0];
        // Create test building
        const buildingResult = await db_1.db.insert(schema_1.buildings).values({
            name: 'Test Building',
            address: '456 Test Ave',
            city: 'Test City',
            province: 'QC',
            postalCode: 'H2H 2H2',
            buildingType: 'condo',
            organizationId: testOrganization.id,
            totalUnits: 10,
            isActive: true,
        }).returning();
        testBuilding = buildingResult[0];
        // Create test residence
        const residenceResult = await db_1.db.insert(schema_1.residences).values({
            buildingId: testBuilding.id,
            unitNumber: '101',
            floor: 1,
            squareFootage: '1000',
            bedrooms: 2,
            bathrooms: '1',
            balcony: false,
            isActive: true,
        }).returning();
        testResidence = residenceResult[0];
        // Create test user
        const userResult = await db_1.db.insert(schema_1.users).values({
            username: 'testuser',
            firstName: 'Test',
            lastName: 'User',
            email: 'test@example.com',
            password: 'hashed_password',
            role: 'resident',
            isActive: true,
        }).returning();
        testUser = userResult[0];
        // Associate user with residence
        await db_1.db.insert(schema_1.userResidences).values({
            userId: testUser.id,
            residenceId: testResidence.id,
            relationshipType: 'resident',
            startDate: new Date().toISOString().split('T')[0],
            isActive: true,
        });
        // Create test demand
        const demandResult = await db_1.db.insert(schema_1.demands).values({
            submitterId: testUser.id,
            type: 'maintenance',
            description: 'Test demand for comment testing',
            buildingId: testBuilding.id,
            residenceId: testResidence.id,
            status: 'submitted',
        }).returning();
        testDemand = demandResult[0];
        authCookie = 'test-session-cookie';
    });
    (0, globals_1.afterEach)(async () => {
        // Clean up test data in proper order
        try {
            await db_1.db.delete(schema_1.demandComments).where((0, drizzle_orm_1.eq)(schema_1.demandComments.demandId, testDemand.id));
            await db_1.db.delete(schema_1.demands).where((0, drizzle_orm_1.eq)(schema_1.demands.id, testDemand.id));
            await db_1.db.delete(schema_1.userResidences).where((0, drizzle_orm_1.eq)(schema_1.userResidences.userId, testUser.id));
            await db_1.db.delete(schema_1.users).where((0, drizzle_orm_1.eq)(schema_1.users.id, testUser.id));
            await db_1.db.delete(schema_1.residences).where((0, drizzle_orm_1.eq)(schema_1.residences.id, testResidence.id));
            await db_1.db.delete(schema_1.buildings).where((0, drizzle_orm_1.eq)(schema_1.buildings.id, testBuilding.id));
            await db_1.db.delete(schema_1.organizations).where((0, drizzle_orm_1.eq)(schema_1.organizations.id, testOrganization.id));
        }
        catch (error) {
            console.error('Cleanup error:', error);
        }
    });
    (0, globals_1.describe)('GET /api/demands/:id/comments', () => {
        (0, globals_1.it)('should retrieve comments for a demand', async () => {
            // First create a comment
            await db_1.db.insert(schema_1.demandComments).values({
                demandId: testDemand.id,
                commenterId: testUser.id,
                commentText: 'Test comment for retrieval',
                isInternal: false,
            });
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body).toBeInstanceOf(Array);
            (0, globals_1.expect)(response.body.length).toBeGreaterThan(0);
            const comment = response.body[0];
            (0, globals_1.expect)(comment.commentText).toBe('Test comment for retrieval');
            (0, globals_1.expect)(comment.demandId).toBe(testDemand.id);
            (0, globals_1.expect)(comment.commenterId).toBe(testUser.id);
            (0, globals_1.expect)(comment.author).toBeDefined();
            (0, globals_1.expect)(comment.author.email).toBe(testUser.email);
        });
        (0, globals_1.it)('should return empty array for demand with no comments', async () => {
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body).toBeInstanceOf(Array);
            (0, globals_1.expect)(response.body.length).toBe(0);
        });
        (0, globals_1.it)('should return 404 for non-existent demand', async () => {
            const fakeId = '123e4567-e89b-12d3-a456-426614174000';
            await (0, supertest_1.default)(app)
                .get(`/api/demands/${fakeId}/comments`)
                .set('Cookie', authCookie)
                .expect(404);
        });
        (0, globals_1.it)('should return comments in chronological order', async () => {
            // Create multiple comments with different timestamps
            const comments = [
                { text: 'First comment', delay: 0 },
                { text: 'Second comment', delay: 100 },
                { text: 'Third comment', delay: 200 },
            ];
            for (const comment of comments) {
                await new Promise(resolve => setTimeout(resolve, comment.delay));
                await db_1.db.insert(schema_1.demandComments).values({
                    demandId: testDemand.id,
                    commenterId: testUser.id,
                    commentText: comment.text,
                    isInternal: false,
                });
            }
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body.length).toBe(3);
            (0, globals_1.expect)(response.body[0].commentText).toBe('First comment');
            (0, globals_1.expect)(response.body[1].commentText).toBe('Second comment');
            (0, globals_1.expect)(response.body[2].commentText).toBe('Third comment');
        });
        (0, globals_1.it)('should include author information in comments', async () => {
            await db_1.db.insert(schema_1.demandComments).values({
                demandId: testDemand.id,
                commenterId: testUser.id,
                commentText: 'Comment with author info',
                isInternal: false,
            });
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            const comment = response.body[0];
            (0, globals_1.expect)(comment.author).toEqual({
                id: testUser.id,
                firstName: testUser.firstName,
                lastName: testUser.lastName,
                email: testUser.email,
            });
        });
        (0, globals_1.it)('should handle internal vs external comments', async () => {
            // Create both internal and external comments
            await db_1.db.insert(schema_1.demandComments).values([
                {
                    demandId: testDemand.id,
                    commenterId: testUser.id,
                    commentText: 'External comment',
                    isInternal: false,
                },
                {
                    demandId: testDemand.id,
                    commenterId: testUser.id,
                    commentText: 'Internal comment',
                    isInternal: true,
                },
            ]);
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body.length).toBe(2);
            const externalComment = response.body.find((c) => c.commentText === 'External comment');
            const internalComment = response.body.find((c) => c.commentText === 'Internal comment');
            (0, globals_1.expect)(externalComment.isInternal).toBe(false);
            (0, globals_1.expect)(internalComment.isInternal).toBe(true);
        });
    });
    (0, globals_1.describe)('POST /api/demands/:id/comments', () => {
        (0, globals_1.it)('should create a new comment successfully', async () => {
            const commentData = {
                commentText: 'This is a new comment on the demand',
            };
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
            (0, globals_1.expect)(response.body).toMatchObject({
                demandId: testDemand.id,
                commenterId: testUser.id,
                commentText: 'This is a new comment on the demand',
                isInternal: false,
            });
            (0, globals_1.expect)(response.body.id).toBeDefined();
            (0, globals_1.expect)(response.body.createdAt).toBeDefined();
        });
        (0, globals_1.it)('should create comment with optional fields', async () => {
            const commentData = {
                commentText: 'Comment with all optional fields',
                commentType: 'status_update',
                isInternal: true,
            };
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
            (0, globals_1.expect)(response.body.commentText).toBe('Comment with all optional fields');
            (0, globals_1.expect)(response.body.commentType).toBe('status_update');
            (0, globals_1.expect)(response.body.isInternal).toBe(true);
        });
        (0, globals_1.it)('should auto-populate demandId and commenterId', async () => {
            const commentData = {
                commentText: 'Comment with auto-populated IDs',
            };
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
            (0, globals_1.expect)(response.body.demandId).toBe(testDemand.id);
            (0, globals_1.expect)(response.body.commenterId).toBe(testUser.id);
        });
        (0, globals_1.it)('should validate required commentText field', async () => {
            const commentData = {
                // Missing commentText
                commentType: 'update',
            };
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(400);
        });
        (0, globals_1.it)('should validate commentText length constraints', async () => {
            // Test empty comment
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: '' })
                .expect(400);
            // Test too long comment
            const tooLongComment = 'A'.repeat(1001);
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: tooLongComment })
                .expect(400);
            // Test valid length comment
            const validComment = 'A'.repeat(1000);
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: validComment })
                .expect(201);
        });
        (0, globals_1.it)('should return 404 for non-existent demand', async () => {
            const fakeId = '123e4567-e89b-12d3-a456-426614174000';
            const commentData = {
                commentText: 'Comment on non-existent demand',
            };
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${fakeId}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(404);
        });
        (0, globals_1.it)('should handle French characters and special symbols', async () => {
            const commentData = {
                commentText: 'Commentaire en français avec caractères spéciaux: éàùç! 🏠 @#$%^&*()',
            };
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
            (0, globals_1.expect)(response.body.commentText).toBe(commentData.commentText);
        });
        (0, globals_1.it)('should handle multiline comments', async () => {
            const multilineComment = `This is a multiline comment.
      
      It contains multiple paragraphs.
      
      End of comment.`;
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: multilineComment })
                .expect(201);
            (0, globals_1.expect)(response.body.commentText).toBe(multilineComment);
        });
        (0, globals_1.it)('should create internal comments for authorized users', async () => {
            const commentData = {
                commentText: 'This is an internal comment',
                isInternal: true,
            };
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
            (0, globals_1.expect)(response.body.isInternal).toBe(true);
        });
        (0, globals_1.it)('should handle different comment types', async () => {
            const commentTypes = ['update', 'question', 'answer', 'status_change'];
            for (const type of commentTypes) {
                const response = await (0, supertest_1.default)(app)
                    .post(`/api/demands/${testDemand.id}/comments`)
                    .set('Cookie', authCookie)
                    .send({
                    commentText: `Comment of type ${type}`,
                    commentType: type,
                })
                    .expect(201);
                (0, globals_1.expect)(response.body.commentType).toBe(type);
            }
        });
        (0, globals_1.it)('should validate UUID format in URL parameter', async () => {
            const invalidId = 'invalid-uuid';
            const commentData = {
                commentText: 'Valid comment text',
            };
            // This might return 400 or 404 depending on route validation
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${invalidId}/comments`)
                .set('Cookie', authCookie)
                .send(commentData);
            (0, globals_1.expect)([400, 404]).toContain(response.status);
        });
    });
    (0, globals_1.describe)('Comment Workflow Integration', () => {
        (0, globals_1.it)('should maintain comment thread integrity', async () => {
            // Create multiple comments and verify they stay linked to the demand
            const comments = [
                'Initial comment',
                'Follow-up comment',
                'Final comment',
            ];
            for (const commentText of comments) {
                await (0, supertest_1.default)(app)
                    .post(`/api/demands/${testDemand.id}/comments`)
                    .set('Cookie', authCookie)
                    .send({ commentText })
                    .expect(201);
            }
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body.length).toBe(3);
            response.body.forEach((comment) => {
                (0, globals_1.expect)(comment.demandId).toBe(testDemand.id);
            });
        });
        (0, globals_1.it)('should handle concurrent comment creation', async () => {
            // Create multiple comments simultaneously
            const commentPromises = Array.from({ length: 3 }, (_, i) => (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: `Concurrent comment ${i + 1}` }));
            const responses = await Promise.all(commentPromises);
            responses.forEach(response => {
                (0, globals_1.expect)(response.status).toBe(201);
                (0, globals_1.expect)(response.body.demandId).toBe(testDemand.id);
            });
            // Verify all comments were created
            const getResponse = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(getResponse.body.length).toBe(3);
        });
        (0, globals_1.it)('should handle comment creation and retrieval workflow', async () => {
            // Step 1: Create initial comment
            const createResponse = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: 'Workflow test comment' })
                .expect(201);
            const commentId = createResponse.body.id;
            // Step 2: Retrieve comments and verify the new comment is included
            const getResponse = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            const createdComment = getResponse.body.find((c) => c.id === commentId);
            (0, globals_1.expect)(createdComment).toBeDefined();
            (0, globals_1.expect)(createdComment.commentText).toBe('Workflow test comment');
        });
        (0, globals_1.it)('should preserve comment order across multiple operations', async () => {
            const commentTexts = [
                'First comment in sequence',
                'Second comment in sequence',
                'Third comment in sequence',
            ];
            // Create comments with small delays to ensure ordering
            for (const text of commentTexts) {
                await (0, supertest_1.default)(app)
                    .post(`/api/demands/${testDemand.id}/comments`)
                    .set('Cookie', authCookie)
                    .send({ commentText: text })
                    .expect(201);
                // Small delay to ensure different timestamps
                await new Promise(resolve => setTimeout(resolve, 50));
            }
            const response = await (0, supertest_1.default)(app)
                .get(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .expect(200);
            (0, globals_1.expect)(response.body.length).toBe(3);
            commentTexts.forEach((text, index) => {
                (0, globals_1.expect)(response.body[index].commentText).toBe(text);
            });
        });
    });
    (0, globals_1.describe)('Error Handling and Edge Cases', () => {
        (0, globals_1.it)('should handle database connection errors gracefully', async () => {
            // This test would require mocking database failures
            // For now, we test general error handling patterns
            const commentData = {
                commentText: 'Test comment for error handling',
            };
            // Normal case should work
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send(commentData)
                .expect(201);
        });
        (0, globals_1.it)('should handle malformed JSON in request body', async () => {
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .set('Content-Type', 'application/json')
                .send('{ invalid json }');
            (0, globals_1.expect)([400, 500]).toContain(response.status);
        });
        (0, globals_1.it)('should handle missing Content-Type header', async () => {
            const response = await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send('commentText=Test comment');
            // Should handle this gracefully
            (0, globals_1.expect)([200, 201, 400]).toContain(response.status);
        });
        (0, globals_1.it)('should validate comment length at boundary conditions', async () => {
            // Test exact maximum length
            const maxLengthComment = 'A'.repeat(1000);
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: maxLengthComment })
                .expect(201);
            // Test one character over maximum
            const overLimitComment = 'A'.repeat(1001);
            await (0, supertest_1.default)(app)
                .post(`/api/demands/${testDemand.id}/comments`)
                .set('Cookie', authCookie)
                .send({ commentText: overLimitComment })
                .expect(400);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9kZW1hbmQtY29tbWVudC1mbG93LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7QUFFSCwyQ0FBNEU7QUFDNUUsMERBQWdDO0FBQ2hDLHdDQUFxQztBQUNyQyxnREFBMkg7QUFDM0gsNkNBQWlDO0FBRWpDLHlCQUF5QjtBQUN6QixTQUFTLGFBQWE7SUFDcEIsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ25DLE1BQU0sR0FBRyxHQUFHLE9BQU8sRUFBRSxDQUFDO0lBRXRCLEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7SUFFeEIsc0NBQXNDO0lBQ3RDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFRLEVBQUUsR0FBUSxFQUFFLElBQVMsRUFBRSxFQUFFO1FBQ3hDLHFDQUFxQztRQUNyQyxHQUFHLENBQUMsSUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUM7UUFDaEQsSUFBSSxFQUFFLENBQUM7SUFDVCxDQUFDLENBQUMsQ0FBQztJQUVILE1BQU0sRUFBRSxvQkFBb0IsRUFBRSxHQUFHLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQ3JFLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRTFCLE9BQU8sR0FBRyxDQUFDO0FBQ2IsQ0FBQztBQUVELElBQUEsa0JBQVEsRUFBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7SUFDaEQsSUFBSSxHQUFRLENBQUM7SUFDYixJQUFJLFFBQWEsQ0FBQztJQUNsQixJQUFJLFVBQWUsQ0FBQztJQUNwQixJQUFJLFlBQWlCLENBQUM7SUFDdEIsSUFBSSxhQUFrQixDQUFDO0lBQ3ZCLElBQUksZ0JBQXFCLENBQUM7SUFDMUIsSUFBSSxVQUFrQixDQUFDO0lBRXZCLElBQUEsb0JBQVUsRUFBQyxLQUFLLElBQUksRUFB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WUFFZixrQ0FBa0M7WUFDbEMsTUFBTSxnQkFBZ0IsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzFDLE1BQU0sSUFBQSxtQkFBTyxFQUFDLEdBQUcsQ0FBQztpQkFDZixJQUFJLENBQUMsZ0JBQWdCLFVBQVUsQ0FBQyxFQUFFLFdBQVcsQ0FBQztpQkFDOUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUM7aUJBQ3pCLElBQUksQ0FBQyxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDO2lCQUN2QyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2UvdGVzdHMvaW50ZWdyYXRpb24vZGVtYW5kLWNvbW1lbnQtZmxvdy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGUgRGVtYW5kIENvbW1lbnQgSW50ZWdyYXRpb24gVGVzdHNcbiAqIEBkZXNjcmlwdGlvbiBDb21wcmVoZW5zaXZlIHRlc3RzIGZvciBkZW1hbmQgY29tbWVudCBBUEkgZW5kcG9pbnRzIGFuZCB3b3JrZmxvd1xuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2ggfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uL3NlcnZlci9kYic7XG5pbXBvcnQgeyBkZW1hbmRzLCBkZW1hbmRDb21tZW50cywgdXNlcnMsIHJlc2lkZW5jZXMsIGJ1aWxkaW5ncywgb3JnYW5pemF0aW9ucywgdXNlclJlc2lkZW5jZXMgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2NoZW1hJztcbmltcG9ydCB7IGVxIH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuXG4vLyBNb2NrIEV4cHJlc3MgYXBwIHNldHVwXG5mdW5jdGlvbiBjcmVhdGVUZXN0QXBwKCkge1xuICBjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuICBjb25zdCBhcHAgPSBleHByZXNzKCk7XG4gIFxuICBhcHAudXNlKGV4cHJlc3MuanNvbigpKTtcbiAgXG4gIC8vIE1vY2sgc2Vzc2lvbiBtaWRkbGV3YXJlIGZvciB0ZXN0aW5nXG4gIGFwcC51c2UoKHJlcTogYW55LCByZXM6IGFueSwgbmV4dDogYW55KSA9PiB7XG4gICAgLy8gdGVzdFVzZXIgd2lsbCBiZSBzZXQgaW4gYmVmb3JlRWFjaFxuICAgIHJlcS51c2VyID0geyBpZDogJ3VzZXItMTIzJywgcm9sZTogJ3Jlc2lkZW50JyB9OyBcbiAgICBuZXh0KCk7XG4gIH0pO1xuICBcbiAgY29uc3QgeyByZWdpc3RlckRlbWFuZFJvdXRlcyB9ID0gcmVxdWlyZSgnLi4vLi4vc2VydmVyL2FwaS9kZW1hbmRzJyk7XG4gIHJlZ2lzdGVyRGVtYW5kUm91dGVzKGFwcCk7XG4gIFxuICByZXR1cm4gYXBwO1xufVxuXG5kZXNjcmliZSgnRGVtYW5kIENvbW1lbnQgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBhcHA6IGFueTtcbiAgbGV0IHRlc3RVc2VyOiBhbnk7XG4gIGxldCB0ZXN0RGVtYW5kOiBhbnk7XG4gIGxldCB0ZXN0QnVpbGRpbmc6IGFueTtcbiAgbGV0IHRlc3RSZXNpZGVuY2U6IGFueTtcbiAgbGV0IHRlc3RPcmdhbml6YXRpb246IGFueTtcbiAgbGV0IGF1dGhDb29raWU6IHN0cmluZztcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBhcHAgPSBjcmVhdGVUZXN0QXBwKCk7XG5cbiAgICAvLyBDcmVhdGUgdGVzdCBvcmdhbml6YXRpb25cbiAgICBjb25zdCBvcmdSZXN1bHQgPSBhd2FpdCBkYi5pbnNlcnQob3JnYW5pemF0aW9ucykudmFsdWVzKHtcbiAgICAgIG5hbWU6ICdUZXN0IE9yZ2FuaXphdGlvbicsXG4gICAgICB0eXBlOiAncmVzaWRlbnRpYWwnLFxuICAgICAgYWRkcmVzczogJzEyMyBUZXN0IFN0JyxcbiAgICAgIGNpdHk6ICdUZXN0IENpdHknLFxuICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICBwb3N0YWxDb2RlOiAnSDFIIDFIMScsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0T3JnYW5pemF0aW9uID0gb3JnUmVzdWx0WzBdO1xuXG4gICAgLy8gQ3JlYXRlIHRlc3QgYnVpbGRpbmdcbiAgICBjb25zdCBidWlsZGluZ1Jlc3VsdCA9IGF3YWl0IGRiLmluc2VydChidWlsZGluZ3MpLnZhbHVlcyh7XG4gICAgICBuYW1lOiAnVGVzdCBCdWlsZGluZycsXG4gICAgICBhZGRyZXNzOiAnNDU2IFRlc3QgQXZlJyxcbiAgICAgIGNpdHk6ICdUZXN0IENpdHknLFxuICAgICAgcHJvdmluY2U6ICdRQycsXG4gICAgICBwb3N0YWxDb2RlOiAnSDJIIDJIMicsXG4gICAgICBidWlsZGluZ1R5cGU6ICdjb25kbycsXG4gICAgICBvcmdhbml6YXRpb25JZDogdGVzdE9yZ2FuaXphdGlvbi5pZCxcbiAgICAgIHRvdGFsVW5pdHM6IDEwLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gICAgdGVzdEJ1aWxkaW5nID0gYnVpbGRpbmdSZXN1bHRbMF07XG5cbiAgICAvLyBDcmVhdGUgdGVzdCByZXNpZGVuY2VcbiAgICBjb25zdCByZXNpZGVuY2VSZXN1bHQgPSBhd2FpdCBkYi5pbnNlcnQocmVzaWRlbmNlcykudmFsdWVzKHtcbiAgICAgIGJ1aWxkaW5nSWQ6IHRlc3RCdWlsZGluZy5pZCxcbiAgICAgIHVuaXROdW1iZXI6ICcxMDEnLFxuICAgICAgZmxvb3I6IDEsXG4gICAgICBzcXVhcmVGb290YWdlOiAnMTAwMCcsXG4gICAgICBiZWRyb29tczogMixcbiAgICAgIGJhdGhyb29tczogJzEnLFxuICAgICAgYmFsY29ueTogZmFsc2UsXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0UmVzaWRlbmNlID0gcmVzaWRlbmNlUmVzdWx0WzBdO1xuXG4gICAgLy8gQ3JlYXRlIHRlc3QgdXNlclxuICAgIGNvbnN0IHVzZXJSZXN1bHQgPSBhd2FpdCBkYi5pbnNlcnQodXNlcnMpLnZhbHVlcyh7XG4gICAgICB1c2VybmFtZTogJ3Rlc3R1c2VyJyxcbiAgICAgIGZpcnN0TmFtZTogJ1Rlc3QnLFxuICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICBwYXNzd29yZDogJ2hhc2hlZF9wYXNzd29yZCcsXG4gICAgICByb2xlOiAncmVzaWRlbnQnLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgfSkucmV0dXJuaW5nKCk7XG4gICAgdGVzdFVzZXIgPSB1c2VyUmVzdWx0WzBdO1xuXG4gICAgLy8gQXNzb2NpYXRlIHVzZXIgd2l0aCByZXNpZGVuY2VcbiAgICBhd2FpdCBkYi5pbnNlcnQodXNlclJlc2lkZW5jZXMpLnZhbHVlcyh7XG4gICAgICB1c2VySWQ6IHRlc3RVc2VyLmlkLFxuICAgICAgcmVzaWRlbmNlSWQ6IHRlc3RSZXNpZGVuY2UuaWQsXG4gICAgICByZWxhdGlvbnNoaXBUeXBlOiAncmVzaWRlbnQnLFxuICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIHRlc3QgZGVtYW5kXG4gICAgY29uc3QgZGVtYW5kUmVzdWx0ID0gYXdhaXQgZGIuaW5zZXJ0KGRlbWFuZHMpLnZhbHVlcyh7XG4gICAgICBzdWJtaXR0ZXJJZDogdGVzdFVzZXIuaWQsXG4gICAgICB0eXBlOiAnbWFpbnRlbmFuY2UnLFxuICAgICAgZGVzY3JpcHRpb246ICdUZXN0IGRlbWFuZCBmb3IgY29tbWVudCB0ZXN0aW5nJyxcbiAgICAgIGJ1aWxkaW5nSWQ6IHRlc3RCdWlsZGluZy5pZCxcbiAgICAgIHJlc2lkZW5jZUlkOiB0ZXN0UmVzaWRlbmNlLmlkLFxuICAgICAgc3RhdHVzOiAnc3VibWl0dGVkJyxcbiAgICB9KS5yZXR1cm5pbmcoKTtcbiAgICB0ZXN0RGVtYW5kID0gZGVtYW5kUmVzdWx0WzBdO1xuXG4gICAgYXV0aENvb2tpZSA9ICd0ZXN0LXNlc3Npb24tY29va2llJztcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDbGVhbiB1cCB0ZXN0IGRhdGEgaW4gcHJvcGVyIG9yZGVyXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZShkZW1hbmRDb21tZW50cykud2hlcmUoZXEoZGVtYW5kQ29tbWVudHMuZGVtYW5kSWQsIHRlc3REZW1hbmQuaWQpKTtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZShkZW1hbmRzKS53aGVyZShlcShkZW1hbmRzLmlkLCB0ZXN0RGVtYW5kLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUodXNlclJlc2lkZW5jZXMpLndoZXJlKGVxKHVzZXJSZXNpZGVuY2VzLnVzZXJJZCwgdGVzdFVzZXIuaWQpKTtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZSh1c2Vycykud2hlcmUoZXEodXNlcnMuaWQsIHRlc3RVc2VyLmlkKSk7XG4gICAgICBhd2FpdCBkYi5kZWxldGUocmVzaWRlbmNlcykud2hlcmUoZXEocmVzaWRlbmNlcy5pZCwgdGVzdFJlc2lkZW5jZS5pZCkpO1xuICAgICAgYXdhaXQgZGIuZGVsZXRlKGJ1aWxkaW5ncykud2hlcmUoZXEoYnVpbGRpbmdzLmlkLCB0ZXN0QnVpbGRpbmcuaWQpKTtcbiAgICAgIGF3YWl0IGRiLmRlbGV0ZShvcmdhbml6YXRpb25zKS53aGVyZShlcShvcmdhbml6YXRpb25zLmlkLCB0ZXN0T3JnYW5pemF0aW9uLmlkKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NsZWFudXAgZXJyb3I6JywgZXJyb3IpO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL2RlbWFuZHMvOmlkL2NvbW1lbnRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgY29tbWVudHMgZm9yIGEgZGVtYW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRmlyc3QgY3JlYXRlIGEgY29tbWVudFxuICAgICAgYXdhaXQgZGIuaW5zZXJ0KGRlbWFuZENvbW1lbnRzKS52YWx1ZXMoe1xuICAgICAgICBkZW1hbmRJZDogdGVzdERlbWFuZC5pZCxcbiAgICAgICAgY29tbWVudGVySWQ6IHRlc3RVc2VyLmlkLFxuICAgICAgICBjb21tZW50VGV4dDogJ1Rlc3QgY29tbWVudCBmb3IgcmV0cmlldmFsJyxcbiAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0JlSW5zdGFuY2VPZihBcnJheSk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIFxuICAgICAgY29uc3QgY29tbWVudCA9IHJlc3BvbnNlLmJvZHlbMF07XG4gICAgICBleHBlY3QoY29tbWVudC5jb21tZW50VGV4dCkudG9CZSgnVGVzdCBjb21tZW50IGZvciByZXRyaWV2YWwnKTtcbiAgICAgIGV4cGVjdChjb21tZW50LmRlbWFuZElkKS50b0JlKHRlc3REZW1hbmQuaWQpO1xuICAgICAgZXhwZWN0KGNvbW1lbnQuY29tbWVudGVySWQpLnRvQmUodGVzdFVzZXIuaWQpO1xuICAgICAgZXhwZWN0KGNvbW1lbnQuYXV0aG9yKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGNvbW1lbnQuYXV0aG9yLmVtYWlsKS50b0JlKHRlc3RVc2VyLmVtYWlsKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IGZvciBkZW1hbmQgd2l0aCBubyBjb21tZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGZvciBub24tZXhpc3RlbnQgZGVtYW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmFrZUlkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCc7XG4gICAgICBcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2RlbWFuZHMvJHtmYWtlSWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLmV4cGVjdCg0MDQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29tbWVudHMgaW4gY2hyb25vbG9naWNhbCBvcmRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBtdWx0aXBsZSBjb21tZW50cyB3aXRoIGRpZmZlcmVudCB0aW1lc3RhbXBzXG4gICAgICBjb25zdCBjb21tZW50cyA9IFtcbiAgICAgICAgeyB0ZXh0OiAnRmlyc3QgY29tbWVudCcsIGRlbGF5OiAwIH0sXG4gICAgICAgIHsgdGV4dDogJ1NlY29uZCBjb21tZW50JywgZGVsYXk6IDEwMCB9LFxuICAgICAgICB7IHRleHQ6ICdUaGlyZCBjb21tZW50JywgZGVsYXk6IDIwMCB9LFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBjb21tZW50IG9mIGNvbW1lbnRzKSB7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBjb21tZW50LmRlbGF5KSk7XG4gICAgICAgIGF3YWl0IGRiLmluc2VydChkZW1hbmRDb21tZW50cykudmFsdWVzKHtcbiAgICAgICAgICBkZW1hbmRJZDogdGVzdERlbWFuZC5pZCxcbiAgICAgICAgICBjb21tZW50ZXJJZDogdGVzdFVzZXIuaWQsXG4gICAgICAgICAgY29tbWVudFRleHQ6IGNvbW1lbnQudGV4dCxcbiAgICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5sZW5ndGgpLnRvQmUoMyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keVswXS5jb21tZW50VGV4dCkudG9CZSgnRmlyc3QgY29tbWVudCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHlbMV0uY29tbWVudFRleHQpLnRvQmUoJ1NlY29uZCBjb21tZW50Jyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keVsyXS5jb21tZW50VGV4dCkudG9CZSgnVGhpcmQgY29tbWVudCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIGF1dGhvciBpbmZvcm1hdGlvbiBpbiBjb21tZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRiLmluc2VydChkZW1hbmRDb21tZW50cykudmFsdWVzKHtcbiAgICAgICAgZGVtYW5kSWQ6IHRlc3REZW1hbmQuaWQsXG4gICAgICAgIGNvbW1lbnRlcklkOiB0ZXN0VXNlci5pZCxcbiAgICAgICAgY29tbWVudFRleHQ6ICdDb21tZW50IHdpdGggYXV0aG9yIGluZm8nLFxuICAgICAgICBpc0ludGVybmFsOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgY29tbWVudCA9IHJlc3BvbnNlLmJvZHlbMF07XG4gICAgICBleHBlY3QoY29tbWVudC5hdXRob3IpLnRvRXF1YWwoe1xuICAgICAgICBpZDogdGVzdFVzZXIuaWQsXG4gICAgICAgIGZpcnN0TmFtZTogdGVzdFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogdGVzdFVzZXIubGFzdE5hbWUsXG4gICAgICAgIGVtYWlsOiB0ZXN0VXNlci5lbWFpbCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW50ZXJuYWwgdnMgZXh0ZXJuYWwgY29tbWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYm90aCBpbnRlcm5hbCBhbmQgZXh0ZXJuYWwgY29tbWVudHNcbiAgICAgIGF3YWl0IGRiLmluc2VydChkZW1hbmRDb21tZW50cykudmFsdWVzKFtcbiAgICAgICAge1xuICAgICAgICAgIGRlbWFuZElkOiB0ZXN0RGVtYW5kLmlkLFxuICAgICAgICAgIGNvbW1lbnRlcklkOiB0ZXN0VXNlci5pZCxcbiAgICAgICAgICBjb21tZW50VGV4dDogJ0V4dGVybmFsIGNvbW1lbnQnLFxuICAgICAgICAgIGlzSW50ZXJuYWw6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZGVtYW5kSWQ6IHRlc3REZW1hbmQuaWQsXG4gICAgICAgICAgY29tbWVudGVySWQ6IHRlc3RVc2VyLmlkLFxuICAgICAgICAgIGNvbW1lbnRUZXh0OiAnSW50ZXJuYWwgY29tbWVudCcsXG4gICAgICAgICAgaXNJbnRlcm5hbDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubGVuZ3RoKS50b0JlKDIpO1xuICAgICAgXG4gICAgICBjb25zdCBleHRlcm5hbENvbW1lbnQgPSByZXNwb25zZS5ib2R5LmZpbmQoKGM6IGFueSkgPT4gYy5jb21tZW50VGV4dCA9PT0gJ0V4dGVybmFsIGNvbW1lbnQnKTtcbiAgICAgIGNvbnN0IGludGVybmFsQ29tbWVudCA9IHJlc3BvbnNlLmJvZHkuZmluZCgoYzogYW55KSA9PiBjLmNvbW1lbnRUZXh0ID09PSAnSW50ZXJuYWwgY29tbWVudCcpO1xuICAgICAgXG4gICAgICBleHBlY3QoZXh0ZXJuYWxDb21tZW50LmlzSW50ZXJuYWwpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGludGVybmFsQ29tbWVudC5pc0ludGVybmFsKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUE9TVCAvYXBpL2RlbWFuZHMvOmlkL2NvbW1lbnRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IGNvbW1lbnQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbWVudERhdGEgPSB7XG4gICAgICAgIGNvbW1lbnRUZXh0OiAnVGhpcyBpcyBhIG5ldyBjb21tZW50IG9uIHRoZSBkZW1hbmQnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoY29tbWVudERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAxKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgICBkZW1hbmRJZDogdGVzdERlbWFuZC5pZCxcbiAgICAgICAgY29tbWVudGVySWQ6IHRlc3RVc2VyLmlkLFxuICAgICAgICBjb21tZW50VGV4dDogJ1RoaXMgaXMgYSBuZXcgY29tbWVudCBvbiB0aGUgZGVtYW5kJyxcbiAgICAgICAgaXNJbnRlcm5hbDogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuaWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5jcmVhdGVkQXQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb21tZW50IHdpdGggb3B0aW9uYWwgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbWVudERhdGEgPSB7XG4gICAgICAgIGNvbW1lbnRUZXh0OiAnQ29tbWVudCB3aXRoIGFsbCBvcHRpb25hbCBmaWVsZHMnLFxuICAgICAgICBjb21tZW50VHlwZTogJ3N0YXR1c191cGRhdGUnLFxuICAgICAgICBpc0ludGVybmFsOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoY29tbWVudERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAxKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuY29tbWVudFRleHQpLnRvQmUoJ0NvbW1lbnQgd2l0aCBhbGwgb3B0aW9uYWwgZmllbGRzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5jb21tZW50VHlwZSkudG9CZSgnc3RhdHVzX3VwZGF0ZScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuaXNJbnRlcm5hbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXV0by1wb3B1bGF0ZSBkZW1hbmRJZCBhbmQgY29tbWVudGVySWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50RGF0YSA9IHtcbiAgICAgICAgY29tbWVudFRleHQ6ICdDb21tZW50IHdpdGggYXV0by1wb3B1bGF0ZWQgSURzJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKGNvbW1lbnREYXRhKVxuICAgICAgICAuZXhwZWN0KDIwMSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRlbWFuZElkKS50b0JlKHRlc3REZW1hbmQuaWQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuY29tbWVudGVySWQpLnRvQmUodGVzdFVzZXIuaWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXF1aXJlZCBjb21tZW50VGV4dCBmaWVsZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1lbnREYXRhID0ge1xuICAgICAgICAvLyBNaXNzaW5nIGNvbW1lbnRUZXh0XG4gICAgICAgIGNvbW1lbnRUeXBlOiAndXBkYXRlJyxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChjb21tZW50RGF0YSlcbiAgICAgICAgLmV4cGVjdCg0MDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb21tZW50VGV4dCBsZW5ndGggY29uc3RyYWludHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IGVtcHR5IGNvbW1lbnRcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZCh7IGNvbW1lbnRUZXh0OiAnJyB9KVxuICAgICAgICAuZXhwZWN0KDQwMCk7XG5cbiAgICAgIC8vIFRlc3QgdG9vIGxvbmcgY29tbWVudFxuICAgICAgY29uc3QgdG9vTG9uZ0NvbW1lbnQgPSAnQScucmVwZWF0KDEwMDEpO1xuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKHsgY29tbWVudFRleHQ6IHRvb0xvbmdDb21tZW50IH0pXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgLy8gVGVzdCB2YWxpZCBsZW5ndGggY29tbWVudFxuICAgICAgY29uc3QgdmFsaWRDb21tZW50ID0gJ0EnLnJlcGVhdCgxMDAwKTtcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZCh7IGNvbW1lbnRUZXh0OiB2YWxpZENvbW1lbnQgfSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGZvciBub24tZXhpc3RlbnQgZGVtYW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmFrZUlkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCc7XG4gICAgICBjb25zdCBjb21tZW50RGF0YSA9IHtcbiAgICAgICAgY29tbWVudFRleHQ6ICdDb21tZW50IG9uIG5vbi1leGlzdGVudCBkZW1hbmQnLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHtmYWtlSWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoY29tbWVudERhdGEpXG4gICAgICAgIC5leHBlY3QoNDA0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEZyZW5jaCBjaGFyYWN0ZXJzIGFuZCBzcGVjaWFsIHN5bWJvbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50RGF0YSA9IHtcbiAgICAgICAgY29tbWVudFRleHQ6ICdDb21tZW50YWlyZSBlbiBmcmFuw6dhaXMgYXZlYyBjYXJhY3TDqHJlcyBzcMOpY2lhdXg6IMOpw6DDucOnISDwn4+gIEAjJCVeJiooKScsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChjb21tZW50RGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5jb21tZW50VGV4dCkudG9CZShjb21tZW50RGF0YS5jb21tZW50VGV4dCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aWxpbmUgY29tbWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtdWx0aWxpbmVDb21tZW50ID0gYFRoaXMgaXMgYSBtdWx0aWxpbmUgY29tbWVudC5cbiAgICAgIFxuICAgICAgSXQgY29udGFpbnMgbXVsdGlwbGUgcGFyYWdyYXBocy5cbiAgICAgIFxuICAgICAgRW5kIG9mIGNvbW1lbnQuYDtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoeyBjb21tZW50VGV4dDogbXVsdGlsaW5lQ29tbWVudCB9KVxuICAgICAgICAuZXhwZWN0KDIwMSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmNvbW1lbnRUZXh0KS50b0JlKG11bHRpbGluZUNvbW1lbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgaW50ZXJuYWwgY29tbWVudHMgZm9yIGF1dGhvcml6ZWQgdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50RGF0YSA9IHtcbiAgICAgICAgY29tbWVudFRleHQ6ICdUaGlzIGlzIGFuIGludGVybmFsIGNvbW1lbnQnLFxuICAgICAgICBpc0ludGVybmFsOiB0cnVlLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoY29tbWVudERhdGEpXG4gICAgICAgIC5leHBlY3QoMjAxKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuaXNJbnRlcm5hbCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBjb21tZW50IHR5cGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbWVudFR5cGVzID0gWyd1cGRhdGUnLCAncXVlc3Rpb24nLCAnYW5zd2VyJywgJ3N0YXR1c19jaGFuZ2UnXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCB0eXBlIG9mIGNvbW1lbnRUeXBlcykge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgICAuc2VuZCh7XG4gICAgICAgICAgICBjb21tZW50VGV4dDogYENvbW1lbnQgb2YgdHlwZSAke3R5cGV9YCxcbiAgICAgICAgICAgIGNvbW1lbnRUeXBlOiB0eXBlLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmNvbW1lbnRUeXBlKS50b0JlKHR5cGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBVVUlEIGZvcm1hdCBpbiBVUkwgcGFyYW1ldGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZElkID0gJ2ludmFsaWQtdXVpZCc7XG4gICAgICBjb25zdCBjb21tZW50RGF0YSA9IHtcbiAgICAgICAgY29tbWVudFRleHQ6ICdWYWxpZCBjb21tZW50IHRleHQnLFxuICAgICAgfTtcblxuICAgICAgLy8gVGhpcyBtaWdodCByZXR1cm4gNDAwIG9yIDQwNCBkZXBlbmRpbmcgb24gcm91dGUgdmFsaWRhdGlvblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke2ludmFsaWRJZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChjb21tZW50RGF0YSk7XG5cbiAgICAgIGV4cGVjdChbNDAwLCA0MDRdKS50b0NvbnRhaW4ocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbW1lbnQgV29ya2Zsb3cgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBtYWludGFpbiBjb21tZW50IHRocmVhZCBpbnRlZ3JpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbXVsdGlwbGUgY29tbWVudHMgYW5kIHZlcmlmeSB0aGV5IHN0YXkgbGlua2VkIHRvIHRoZSBkZW1hbmRcbiAgICAgIGNvbnN0IGNvbW1lbnRzID0gW1xuICAgICAgICAnSW5pdGlhbCBjb21tZW50JyxcbiAgICAgICAgJ0ZvbGxvdy11cCBjb21tZW50JyxcbiAgICAgICAgJ0ZpbmFsIGNvbW1lbnQnLFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBjb21tZW50VGV4dCBvZiBjb21tZW50cykge1xuICAgICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgICAgLnNlbmQoeyBjb21tZW50VGV4dCB9KVxuICAgICAgICAgIC5leHBlY3QoMjAxKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lmxlbmd0aCkudG9CZSgzKTtcbiAgICAgIHJlc3BvbnNlLmJvZHkuZm9yRWFjaCgoY29tbWVudDogYW55KSA9PiB7XG4gICAgICAgIGV4cGVjdChjb21tZW50LmRlbWFuZElkKS50b0JlKHRlc3REZW1hbmQuaWQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGNvbW1lbnQgY3JlYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgbXVsdGlwbGUgY29tbWVudHMgc2ltdWx0YW5lb3VzbHlcbiAgICAgIGNvbnN0IGNvbW1lbnRQcm9taXNlcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDMgfSwgKF8sIGkpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgICAuc2VuZCh7IGNvbW1lbnRUZXh0OiBgQ29uY3VycmVudCBjb21tZW50ICR7aSArIDF9YCB9KVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoY29tbWVudFByb21pc2VzKTtcbiAgICAgIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kZW1hbmRJZCkudG9CZSh0ZXN0RGVtYW5kLmlkKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgYWxsIGNvbW1lbnRzIHdlcmUgY3JlYXRlZFxuICAgICAgY29uc3QgZ2V0UmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChnZXRSZXNwb25zZS5ib2R5Lmxlbmd0aCkudG9CZSgzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbW1lbnQgY3JlYXRpb24gYW5kIHJldHJpZXZhbCB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFN0ZXAgMTogQ3JlYXRlIGluaXRpYWwgY29tbWVudFxuICAgICAgY29uc3QgY3JlYXRlUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNlbmQoeyBjb21tZW50VGV4dDogJ1dvcmtmbG93IHRlc3QgY29tbWVudCcgfSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICBjb25zdCBjb21tZW50SWQgPSBjcmVhdGVSZXNwb25zZS5ib2R5LmlkO1xuXG4gICAgICAvLyBTdGVwIDI6IFJldHJpZXZlIGNvbW1lbnRzIGFuZCB2ZXJpZnkgdGhlIG5ldyBjb21tZW50IGlzIGluY2x1ZGVkXG4gICAgICBjb25zdCBnZXRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgY3JlYXRlZENvbW1lbnQgPSBnZXRSZXNwb25zZS5ib2R5LmZpbmQoKGM6IGFueSkgPT4gYy5pZCA9PT0gY29tbWVudElkKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkQ29tbWVudCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChjcmVhdGVkQ29tbWVudC5jb21tZW50VGV4dCkudG9CZSgnV29ya2Zsb3cgdGVzdCBjb21tZW50Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIGNvbW1lbnQgb3JkZXIgYWNyb3NzIG11bHRpcGxlIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50VGV4dHMgPSBbXG4gICAgICAgICdGaXJzdCBjb21tZW50IGluIHNlcXVlbmNlJyxcbiAgICAgICAgJ1NlY29uZCBjb21tZW50IGluIHNlcXVlbmNlJyxcbiAgICAgICAgJ1RoaXJkIGNvbW1lbnQgaW4gc2VxdWVuY2UnLFxuICAgICAgXTtcblxuICAgICAgLy8gQ3JlYXRlIGNvbW1lbnRzIHdpdGggc21hbGwgZGVsYXlzIHRvIGVuc3VyZSBvcmRlcmluZ1xuICAgICAgZm9yIChjb25zdCB0ZXh0IG9mIGNvbW1lbnRUZXh0cykge1xuICAgICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgICAgLnNlbmQoeyBjb21tZW50VGV4dDogdGV4dCB9KVxuICAgICAgICAgIC5leHBlY3QoMjAxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBkaWZmZXJlbnQgdGltZXN0YW1wc1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lmxlbmd0aCkudG9CZSgzKTtcbiAgICAgIGNvbW1lbnRUZXh0cy5mb3JFYWNoKCh0ZXh0LCBpbmRleCkgPT4ge1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keVtpbmRleF0uY29tbWVudFRleHQpLnRvQmUodGV4dCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nIGFuZCBFZGdlIENhc2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUaGlzIHRlc3Qgd291bGQgcmVxdWlyZSBtb2NraW5nIGRhdGFiYXNlIGZhaWx1cmVzXG4gICAgICAvLyBGb3Igbm93LCB3ZSB0ZXN0IGdlbmVyYWwgZXJyb3IgaGFuZGxpbmcgcGF0dGVybnNcbiAgICAgIGNvbnN0IGNvbW1lbnREYXRhID0ge1xuICAgICAgICBjb21tZW50VGV4dDogJ1Rlc3QgY29tbWVudCBmb3IgZXJyb3IgaGFuZGxpbmcnLFxuICAgICAgfTtcblxuICAgICAgLy8gTm9ybWFsIGNhc2Ugc2hvdWxkIHdvcmtcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZChjb21tZW50RGF0YSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIEpTT04gaW4gcmVxdWVzdCBib2R5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoYC9hcGkvZGVtYW5kcy8ke3Rlc3REZW1hbmQuaWR9L2NvbW1lbnRzYClcbiAgICAgICAgLnNldCgnQ29va2llJywgYXV0aENvb2tpZSlcbiAgICAgICAgLnNldCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKVxuICAgICAgICAuc2VuZCgneyBpbnZhbGlkIGpzb24gfScpO1xuXG4gICAgICBleHBlY3QoWzQwMCwgNTAwXSkudG9Db250YWluKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIENvbnRlbnQtVHlwZSBoZWFkZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZCgnY29tbWVudFRleHQ9VGVzdCBjb21tZW50Jyk7XG5cbiAgICAgIC8vIFNob3VsZCBoYW5kbGUgdGhpcyBncmFjZWZ1bGx5XG4gICAgICBleHBlY3QoWzIwMCwgMjAxLCA0MDBdKS50b0NvbnRhaW4ocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgY29tbWVudCBsZW5ndGggYXQgYm91bmRhcnkgY29uZGl0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgZXhhY3QgbWF4aW11bSBsZW5ndGhcbiAgICAgIGNvbnN0IG1heExlbmd0aENvbW1lbnQgPSAnQScucmVwZWF0KDEwMDApO1xuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KGAvYXBpL2RlbWFuZHMvJHt0ZXN0RGVtYW5kLmlkfS9jb21tZW50c2ApXG4gICAgICAgIC5zZXQoJ0Nvb2tpZScsIGF1dGhDb29raWUpXG4gICAgICAgIC5zZW5kKHsgY29tbWVudFRleHQ6IG1heExlbmd0aENvbW1lbnQgfSlcbiAgICAgICAgLmV4cGVjdCgyMDEpO1xuXG4gICAgICAvLyBUZXN0IG9uZSBjaGFyYWN0ZXIgb3ZlciBtYXhpbXVtXG4gICAgICBjb25zdCBvdmVyTGltaXRDb21tZW50ID0gJ0EnLnJlcGVhdCgxMDAxKTtcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdChgL2FwaS9kZW1hbmRzLyR7dGVzdERlbWFuZC5pZH0vY29tbWVudHNgKVxuICAgICAgICAuc2V0KCdDb29raWUnLCBhdXRoQ29va2llKVxuICAgICAgICAuc2VuZCh7IGNvbW1lbnRUZXh0OiBvdmVyTGltaXRDb21tZW50IH0pXG4gICAgICAgIC5leHBlY3QoNDAwKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=
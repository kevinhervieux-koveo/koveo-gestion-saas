3b9117d0e4e461ec75f1cdec78e0f7f8
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.RegistrationWizard = RegistrationWizard;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const card_1 = require("@/components/ui/card");
const button_1 = require("@/components/ui/button");
const progress_1 = require("@/components/ui/progress");
const badge_1 = require("@/components/ui/badge");
const lucide_react_1 = require("lucide-react");
const use_language_1 = require("@/hooks/use-language");
/**
 * Multi-Step Registration Wizard Component.
 *
 * Provides a guided registration flow with step validation,
 * progress tracking, and Quebec compliance features.
 * @param root0 - Component props object.
 * @param root0.steps - Array of wizard steps to render.
 * @param root0.initialData - Initial data for the wizard.
 * @param root0.onComplete - Function called when wizard is completed.
 * @param root0.onCancel - Function called when wizard is cancelled.
 * @param root0.title - Optional title for the wizard.
 * @param root0.className - Optional CSS class name.
 * @returns JSX element for the registration wizard.
 */
function RegistrationWizard({ steps: initialSteps, initialData = {}, onComplete, onCancel, title = 'Inscription', className = '', }) {
    const { t: _t } = (0, use_language_1.useLanguage)();
    const [currentStepIndex, setCurrentStepIndex] = (0, react_1.useState)(0);
    const [steps, setSteps] = (0, react_1.useState)(initialSteps);
    const [wizardData, setWizardData] = (0, react_1.useState)(initialData);
    const [isSubmitting, setIsSubmitting] = (0, react_1.useState)(false);
    const currentStep = steps[currentStepIndex];
    const isFirstStep = currentStepIndex === 0;
    const isLastStep = currentStepIndex === steps.length - 1;
    const completedSteps = steps.filter((step) => step.isComplete).length;
    const progress = (completedSteps / steps.length) * 100;
    // Update step validation status
    const updateStepValidation = (stepId, isValid) => {
        setSteps((prevSteps) => prevSteps.map((step) => (step.id === stepId ? { ...step, isValid } : step)));
    };
    // Update step completion status
    const updateStepCompletion = (stepId, isComplete) => {
        setSteps((prevSteps) => prevSteps.map((step) => (step.id === stepId ? { ...step, isComplete } : step)));
    };
    // Handle data changes from step components - memoized to prevent infinite loops
    const handleDataChange = (0, react_1.useCallback)((stepData) => {
        setWizardData((prevData) => ({
            ...prevData,
            [currentStep.id]: stepData,
        }));
    }, [currentStep.id]);
    // Handle validation changes from step components - memoized to prevent infinite loops
    const handleValidationChange = (0, react_1.useCallback)((isValid) => {
        setSteps((prevSteps) => prevSteps.map((step) => (step.id === currentStep.id ? { ...step, isValid } : step)));
        // Auto-complete step if valid and has required data
        if (isValid) {
            setSteps((prevSteps) => prevSteps.map((step) => (step.id === currentStep.id ? { ...step, isComplete: true } : step)));
        }
    }, [currentStep.id]);
    // Navigate to next step
    const handleNext = () => {
        if (currentStep.isValid && !isLastStep) {
            updateStepCompletion(currentStep.id, true);
            setCurrentStepIndex((prev) => prev + 1);
        }
        else if (isLastStep && currentStep.isValid) {
            handleComplete();
        }
    };
    // Navigate to previous step
    const handlePrevious = () => {
        if (!isFirstStep) {
            setCurrentStepIndex((prev) => prev - 1);
        }
    };
    // Complete the wizard
    const handleComplete = async () => {
        setIsSubmitting(true);
        try {
            // Combine all wizard data
            const completeData = {
                ...wizardData,
                [currentStep.id]: wizardData[currentStep.id] || {},
            };
            await onComplete(completeData);
            // Only mark final step as complete after successful submission
            updateStepCompletion(currentStep.id, true);
        }
        catch (error) {
            console.error('Wizard completion error:', error);
            // Reset step completion on error to allow retry
            updateStepCompletion(currentStep.id, false);
        }
        finally {
            setIsSubmitting(false);
        }
    };
    // Jump to specific step (only if previous steps are complete)
    const jumpToStep = (stepIndex) => {
        // Can only go to completed steps or the next uncompleted step
        const canJump = stepIndex <= currentStepIndex || steps.slice(0, stepIndex).every((step) => step.isComplete);
        if (canJump) {
            setCurrentStepIndex(stepIndex);
        }
    };
    return ((0, jsx_runtime_1.jsx)("div", { className: `max-w-4xl mx-auto p-6 ${className}`, children: (0, jsx_runtime_1.jsxs)(card_1.Card, { className: 'shadow-xl border-0', children: [(0, jsx_runtime_1.jsxs)(card_1.CardHeader, { className: 'text-center pb-6', children: [(0, jsx_runtime_1.jsx)(card_1.CardTitle, { className: 'text-2xl font-bold text-gray-900', children: title }), (0, jsx_runtime_1.jsxs)("div", { className: 'mt-4', children: [(0, jsx_runtime_1.jsx)(progress_1.Progress, { value: progress, className: 'h-2' }), (0, jsx_runtime_1.jsxs)("p", { className: 'text-sm text-gray-600 mt-2', children: ["\u00C9tape ", currentStepIndex + 1, " sur ", steps.length, " \u2022 ", Math.round(progress), "% termin\u00E9"] })] })] }), (0, jsx_runtime_1.jsxs)(card_1.CardContent, { className: 'space-y-6', children: [(0, jsx_runtime_1.jsx)("div", { className: 'flex justify-center', children: (0, jsx_runtime_1.jsx)("div", { className: 'flex items-center space-x-2 md:space-x-4 overflow-x-auto pb-2', children: steps.map((step, _index) => ((0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center', children: [(0, jsx_runtime_1.jsx)("button", { onClick: () => jumpToStep(_index), disabled: _index > currentStepIndex &&
                                                !steps.slice(0, _index).every((s) => s.isComplete), className: `
                      flex items-center justify-center w-8 h-8 rounded-full border-2 transition-all
                      ${_index === currentStepIndex
                                                ? 'border-primary bg-primary text-white'
                                                : step.isComplete
                                                    ? 'border-green-500 bg-green-500 text-white cursor-pointer hover:bg-green-600'
                                                    : 'border-gray-300 bg-white text-gray-400'}
                      ${_index <= currentStepIndex || step.isComplete ? 'cursor-pointer' : 'cursor-not-allowed'}
                    `, "aria-label": `${step.title} - ${step.isComplete ? 'TerminÃ©' : _index === currentStepIndex ? 'En cours' : 'En attente'}`, children: step.isComplete ? ((0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: 'w-5 h-5' })) : ((0, jsx_runtime_1.jsx)("span", { className: 'text-sm font-medium', children: _index + 1 })) }), _index < steps.length - 1 && ((0, jsx_runtime_1.jsx)("div", { className: `w-8 md:w-16 h-0.5 ${steps[_index + 1].isComplete || _index < currentStepIndex
                                                ? 'bg-green-500'
                                                : 'bg-gray-300'}` }))] }, step.id))) }) }), (0, jsx_runtime_1.jsxs)("div", { className: 'min-h-[400px]', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'text-center mb-6', children: [(0, jsx_runtime_1.jsx)("h3", { className: 'text-xl font-semibold text-gray-900 mb-2', children: currentStep.title }), (0, jsx_runtime_1.jsx)("p", { className: 'text-gray-600', children: currentStep.description }), currentStep.isValid && ((0, jsx_runtime_1.jsxs)(badge_1.Badge, { variant: 'secondary', className: 'mt-2 bg-green-100 text-green-800', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: 'w-4 h-4 mr-1' }), "Valid\u00E9"] }))] }), (0, jsx_runtime_1.jsx)(currentStep.component, { _data: wizardData[currentStep.id] || {}, onDataChange: handleDataChange, onValidationChange: handleValidationChange, onNext: handleNext, onPrevious: handlePrevious, isActive: true })] }), (0, jsx_runtime_1.jsxs)("div", { className: 'flex items-center justify-between pt-6 border-t border-gray-200', children: [(0, jsx_runtime_1.jsxs)("div", { className: 'flex space-x-3', children: [!isFirstStep && ((0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handlePrevious, variant: 'outline', className: 'flex items-center', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: 'w-4 h-4 mr-2' }), "Pr\u00E9c\u00E9dent"] })), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: onCancel, variant: 'ghost', className: 'text-gray-600', children: "Annuler" })] }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: handleNext, disabled: !currentStep.isValid || isSubmitting, className: 'flex items-center min-w-[120px]', children: isSubmitting ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)("div", { className: 'animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2' }), "Traitement..."] })) : isLastStep ? ('Terminer') : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: ["Suivant", (0, jsx_runtime_1.jsx)(lucide_react_1.ArrowRight, { className: 'w-4 h-4 ml-2' })] })) })] })] })] }) }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvYXV0aC9yZWdpc3RyYXRpb24td2l6YXJkLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQThEQSxnREFvT0M7O0FBbFNELCtDQUFxRDtBQUNyRCwrQ0FBZ0Y7QUFDaEYsbURBQWdEO0FBQ2hELHVEQUFvRDtBQUNwRCxpREFBOEM7QUFDOUMsK0NBQWtFO0FBQ2xFLHVEQUFtRDtBQTBDbkQ7Ozs7Ozs7Ozs7Ozs7R0FhRztBQUNILFNBQWdCLGtCQUFrQixDQUFDLEVBQ2pDLEtBQUssRUFBRSxZQUFZLEVBQ25CLFdBQVcsR0FBRyxFQUFFLEVBQ2hCLFVBQVUsRUFDVixRQUFRLEVBQ1IsS0FBSyxHQUFHLGFBQWEsRUFDckIsU0FBUyxHQUFHLEVBQUUsR0FDVTtJQUN4QixNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLElBQUEsMEJBQVcsR0FBRSxDQUFDO0lBQ2hDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxtQkFBbUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxDQUFDLENBQUMsQ0FBQztJQUM1RCxNQUFNLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBZSxZQUFZLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxXQUFXLENBQUMsQ0FBQztJQUMxRCxNQUFNLENBQUMsWUFBWSxFQUFFLGVBQWUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUV4RCxNQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUM1QyxNQUFNLFdBQVcsR0FBRyxnQkFBZ0IsS0FBSyxDQUFDLENBQUM7SUFDM0MsTUFBTSxVQUFVLEdBQUcsZ0JBQWdCLEtBQUssS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7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QUFZLEVBQzlDLFNBQVMsRUFBQyxpQ0FBaUMsWUFFMUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUNkLDZEQUNFLGdDQUFLLFNBQVMsRUFBQyxnRUFBZ0UsR0FBRyxxQkFFakYsQ0FDSixDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQ2YsVUFBVSxDQUNYLENBQUMsQ0FBQyxDQUFDLENBQ0Ysd0VBRUUsdUJBQUMseUJBQVUsSUFBQyxTQUFTLEVBQUMsY0FBYyxHQUFHLElBQ3RDLENBQ0osR0FDTSxJQUNMLElBQ00sSUFDVCxHQUNILENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL2NvbXBvbmVudHMvYXV0aC9yZWdpc3RyYXRpb24td2l6YXJkLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ2FyZCwgQ2FyZENvbnRlbnQsIENhcmRIZWFkZXIsIENhcmRUaXRsZSB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9jYXJkJztcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9idXR0b24nO1xuaW1wb3J0IHsgUHJvZ3Jlc3MgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvcHJvZ3Jlc3MnO1xuaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvYmFkZ2UnO1xuaW1wb3J0IHsgQ2hlY2tDaXJjbGUsIEFycm93TGVmdCwgQXJyb3dSaWdodCB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XG5pbXBvcnQgeyB1c2VMYW5ndWFnZSB9IGZyb20gJ0AvaG9va3MvdXNlLWxhbmd1YWdlJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgc2luZ2xlIHN0ZXAgaW4gdGhlIHJlZ2lzdHJhdGlvbiB3aXphcmQgcHJvY2Vzcy5cbiAqIENvbnRhaW5zIG1ldGFkYXRhIGFuZCB2YWxpZGF0aW9uIHN0YXRlIGZvciBlYWNoIHN0ZXAuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgV2l6YXJkU3RlcCB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGNvbXBvbmVudDogUmVhY3QuQ29tcG9uZW50VHlwZTxXaXphcmRTdGVwUHJvcHM+O1xuICBpc0NvbXBsZXRlOiBib29sZWFuO1xuICBpc1ZhbGlkOiBib29sZWFuO1xuICBjYW5Ta2lwPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBQcm9wcyBwYXNzZWQgdG8gZWFjaCB3aXphcmQgc3RlcCBjb21wb25lbnQuXG4gKiBQcm92aWRlcyBkYXRhIGhhbmRsaW5nIGFuZCBuYXZpZ2F0aW9uIGNhbGxiYWNrcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXaXphcmRTdGVwUHJvcHMge1xuICBfZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gIG9uRGF0YUNoYW5nZTogKF9kYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgPT4gdm9pZDtcbiAgb25WYWxpZGF0aW9uQ2hhbmdlOiAoX2lzVmFsaWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIG9uTmV4dDogKCkgPT4gdm9pZDtcbiAgb25QcmV2aW91czogKCkgPT4gdm9pZDtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG59XG5cbi8qKlxuICogUHJvcHMgZm9yIHRoZSBtYWluIFJlZ2lzdHJhdGlvbldpemFyZCBjb21wb25lbnQuXG4gKiBDb25maWd1cmVzIHRoZSB3aXphcmQgc3RlcHMgYW5kIGNvbXBsZXRpb24gaGFuZGxlcnMuXG4gKi9cbmludGVyZmFjZSBSZWdpc3RyYXRpb25XaXphcmRQcm9wcyB7XG4gIHN0ZXBzOiBXaXphcmRTdGVwW107XG4gIGluaXRpYWxEYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gIG9uQ29tcGxldGU6IChfZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pID0+IHZvaWQ7XG4gIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuICB0aXRsZT86IHN0cmluZztcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIE11bHRpLVN0ZXAgUmVnaXN0cmF0aW9uIFdpemFyZCBDb21wb25lbnQuXG4gKlxuICogUHJvdmlkZXMgYSBndWlkZWQgcmVnaXN0cmF0aW9uIGZsb3cgd2l0aCBzdGVwIHZhbGlkYXRpb24sXG4gKiBwcm9ncmVzcyB0cmFja2luZywgYW5kIFF1ZWJlYyBjb21wbGlhbmNlIGZlYXR1cmVzLlxuICogQHBhcmFtIHJvb3QwIC0gQ29tcG9uZW50IHByb3BzIG9iamVjdC5cbiAqIEBwYXJhbSByb290MC5zdGVwcyAtIEFycmF5IG9mIHdpemFyZCBzdGVwcyB0byByZW5kZXIuXG4gKiBAcGFyYW0gcm9vdDAuaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgZm9yIHRoZSB3aXphcmQuXG4gKiBAcGFyYW0gcm9vdDAub25Db21wbGV0ZSAtIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIHdpemFyZCBpcyBjb21wbGV0ZWQuXG4gKiBAcGFyYW0gcm9vdDAub25DYW5jZWwgLSBGdW5jdGlvbiBjYWxsZWQgd2hlbiB3aXphcmQgaXMgY2FuY2VsbGVkLlxuICogQHBhcmFtIHJvb3QwLnRpdGxlIC0gT3B0aW9uYWwgdGl0bGUgZm9yIHRoZSB3aXphcmQuXG4gKiBAcGFyYW0gcm9vdDAuY2xhc3NOYW1lIC0gT3B0aW9uYWwgQ1NTIGNsYXNzIG5hbWUuXG4gKiBAcmV0dXJucyBKU1ggZWxlbWVudCBmb3IgdGhlIHJlZ2lzdHJhdGlvbiB3aXphcmQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBSZWdpc3RyYXRpb25XaXphcmQoe1xuICBzdGVwczogaW5pdGlhbFN0ZXBzLFxuICBpbml0aWFsRGF0YSA9IHt9LFxuICBvbkNvbXBsZXRlLFxuICBvbkNhbmNlbCxcbiAgdGl0bGUgPSAnSW5zY3JpcHRpb24nLFxuICBjbGFzc05hbWUgPSAnJyxcbn06IFJlZ2lzdHJhdGlvbldpemFyZFByb3BzKSB7XG4gIGNvbnN0IHsgdDogX3QgfSA9IHVzZUxhbmd1YWdlKCk7XG4gIGNvbnN0IFtjdXJyZW50U3RlcEluZGV4LCBzZXRDdXJyZW50U3RlcEluZGV4XSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbc3RlcHMsIHNldFN0ZXBzXSA9IHVzZVN0YXRlPFdpemFyZFN0ZXBbXT4oaW5pdGlhbFN0ZXBzKTtcbiAgY29uc3QgW3dpemFyZERhdGEsIHNldFdpemFyZERhdGFdID0gdXNlU3RhdGUoaW5pdGlhbERhdGEpO1xuICBjb25zdCBbaXNTdWJtaXR0aW5nLCBzZXRJc1N1Ym1pdHRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIGNvbnN0IGN1cnJlbnRTdGVwID0gc3RlcHNbY3VycmVudFN0ZXBJbmRleF07XG4gIGNvbnN0IGlzRmlyc3RTdGVwID0gY3VycmVudFN0ZXBJbmRleCA9PT0gMDtcbiAgY29uc3QgaXNMYXN0U3RlcCA9IGN1cnJlbnRTdGVwSW5kZXggPT09IHN0ZXBzLmxlbmd0aCAtIDE7XG4gIGNvbnN0IGNvbXBsZXRlZFN0ZXBzID0gc3RlcHMuZmlsdGVyKChzdGVwKSA9PiBzdGVwLmlzQ29tcGxldGUpLmxlbmd0aDtcbiAgY29uc3QgcHJvZ3Jlc3MgPSAoY29tcGxldGVkU3RlcHMgLyBzdGVwcy5sZW5ndGgpICogMTAwO1xuXG4gIC8vIFVwZGF0ZSBzdGVwIHZhbGlkYXRpb24gc3RhdHVzXG4gIGNvbnN0IHVwZGF0ZVN0ZXBWYWxpZGF0aW9uID0gKHN0ZXBJZDogc3RyaW5nLCBpc1ZhbGlkOiBib29sZWFuKSA9PiB7XG4gICAgc2V0U3RlcHMoKHByZXZTdGVwcykgPT5cbiAgICAgIHByZXZTdGVwcy5tYXAoKHN0ZXApID0+IChzdGVwLmlkID09PSBzdGVwSWQgPyB7IC4uLnN0ZXAsIGlzVmFsaWQgfSA6IHN0ZXApKVxuICAgICk7XG4gIH07XG5cbiAgLy8gVXBkYXRlIHN0ZXAgY29tcGxldGlvbiBzdGF0dXNcbiAgY29uc3QgdXBkYXRlU3RlcENvbXBsZXRpb24gPSAoc3RlcElkOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcbiAgICBzZXRTdGVwcygocHJldlN0ZXBzKSA9PlxuICAgICAgcHJldlN0ZXBzLm1hcCgoc3RlcCkgPT4gKHN0ZXAuaWQgPT09IHN0ZXBJZCA/IHsgLi4uc3RlcCwgaXNDb21wbGV0ZSB9IDogc3RlcCkpXG4gICAgKTtcbiAgfTtcblxuICAvLyBIYW5kbGUgZGF0YSBjaGFuZ2VzIGZyb20gc3RlcCBjb21wb25lbnRzIC0gbWVtb2l6ZWQgdG8gcHJldmVudCBpbmZpbml0ZSBsb29wc1xuICBjb25zdCBoYW5kbGVEYXRhQ2hhbmdlID0gdXNlQ2FsbGJhY2soKHN0ZXBEYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgPT4ge1xuICAgIHNldFdpemFyZERhdGEoKHByZXZEYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgPT4gKHtcbiAgICAgIC4uLnByZXZEYXRhLFxuICAgICAgW2N1cnJlbnRTdGVwLmlkXTogc3RlcERhdGEsXG4gICAgfSkpO1xuICB9LCBbY3VycmVudFN0ZXAuaWRdKTtcblxuICAvLyBIYW5kbGUgdmFsaWRhdGlvbiBjaGFuZ2VzIGZyb20gc3RlcCBjb21wb25lbnRzIC0gbWVtb2l6ZWQgdG8gcHJldmVudCBpbmZpbml0ZSBsb29wc1xuICBjb25zdCBoYW5kbGVWYWxpZGF0aW9uQ2hhbmdlID0gdXNlQ2FsbGJhY2soKGlzVmFsaWQ6IGJvb2xlYW4pID0+IHtcbiAgICBzZXRTdGVwcygocHJldlN0ZXBzKSA9PlxuICAgICAgcHJldlN0ZXBzLm1hcCgoc3RlcCkgPT4gKHN0ZXAuaWQgPT09IGN1cnJlbnRTdGVwLmlkID8geyAuLi5zdGVwLCBpc1ZhbGlkIH0gOiBzdGVwKSlcbiAgICApO1xuICAgIC8vIEF1dG8tY29tcGxldGUgc3RlcCBpZiB2YWxpZCBhbmQgaGFzIHJlcXVpcmVkIGRhdGFcbiAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgc2V0U3RlcHMoKHByZXZTdGVwcykgPT5cbiAgICAgICAgcHJldlN0ZXBzLm1hcCgoc3RlcCkgPT4gKHN0ZXAuaWQgPT09IGN1cnJlbnRTdGVwLmlkID8geyAuLi5zdGVwLCBpc0NvbXBsZXRlOiB0cnVlIH0gOiBzdGVwKSlcbiAgICAgICk7XG4gICAgfVxuICB9LCBbY3VycmVudFN0ZXAuaWRdKTtcblxuICAvLyBOYXZpZ2F0ZSB0byBuZXh0IHN0ZXBcbiAgY29uc3QgaGFuZGxlTmV4dCA9ICgpID0+IHtcbiAgICBpZiAoY3VycmVudFN0ZXAuaXNWYWxpZCAmJiAhaXNMYXN0U3RlcCkge1xuICAgICAgdXBkYXRlU3RlcENvbXBsZXRpb24oY3VycmVudFN0ZXAuaWQsIHRydWUpO1xuICAgICAgc2V0Q3VycmVudFN0ZXBJbmRleCgocHJldikgPT4gcHJldiArIDEpO1xuICAgIH0gZWxzZSBpZiAoaXNMYXN0U3RlcCAmJiBjdXJyZW50U3RlcC5pc1ZhbGlkKSB7XG4gICAgICBoYW5kbGVDb21wbGV0ZSgpO1xuICAgIH1cbiAgfTtcblxuICAvLyBOYXZpZ2F0ZSB0byBwcmV2aW91cyBzdGVwXG4gIGNvbnN0IGhhbmRsZVByZXZpb3VzID0gKCkgPT4ge1xuICAgIGlmICghaXNGaXJzdFN0ZXApIHtcbiAgICAgIHNldEN1cnJlbnRTdGVwSW5kZXgoKHByZXYpID0+IHByZXYgLSAxKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gQ29tcGxldGUgdGhlIHdpemFyZFxuICBjb25zdCBoYW5kbGVDb21wbGV0ZSA9IGFzeW5jICgpID0+IHtcbiAgICBzZXRJc1N1Ym1pdHRpbmcodHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbWJpbmUgYWxsIHdpemFyZCBkYXRhXG4gICAgICBjb25zdCBjb21wbGV0ZURhdGEgPSB7XG4gICAgICAgIC4uLndpemFyZERhdGEsXG4gICAgICAgIFtjdXJyZW50U3RlcC5pZF06IHdpemFyZERhdGFbY3VycmVudFN0ZXAuaWRdIHx8IHt9LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgb25Db21wbGV0ZShjb21wbGV0ZURhdGEpO1xuXG4gICAgICAvLyBPbmx5IG1hcmsgZmluYWwgc3RlcCBhcyBjb21wbGV0ZSBhZnRlciBzdWNjZXNzZnVsIHN1Ym1pc3Npb25cbiAgICAgIHVwZGF0ZVN0ZXBDb21wbGV0aW9uKGN1cnJlbnRTdGVwLmlkLCB0cnVlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignV2l6YXJkIGNvbXBsZXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgLy8gUmVzZXQgc3RlcCBjb21wbGV0aW9uIG9uIGVycm9yIHRvIGFsbG93IHJldHJ5XG4gICAgICB1cGRhdGVTdGVwQ29tcGxldGlvbihjdXJyZW50U3RlcC5pZCwgZmFsc2UpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc1N1Ym1pdHRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICAvLyBKdW1wIHRvIHNwZWNpZmljIHN0ZXAgKG9ubHkgaWYgcHJldmlvdXMgc3RlcHMgYXJlIGNvbXBsZXRlKVxuICBjb25zdCBqdW1wVG9TdGVwID0gKHN0ZXBJbmRleDogbnVtYmVyKSA9PiB7XG4gICAgLy8gQ2FuIG9ubHkgZ28gdG8gY29tcGxldGVkIHN0ZXBzIG9yIHRoZSBuZXh0IHVuY29tcGxldGVkIHN0ZXBcbiAgICBjb25zdCBjYW5KdW1wID1cbiAgICAgIHN0ZXBJbmRleCA8PSBjdXJyZW50U3RlcEluZGV4IHx8IHN0ZXBzLnNsaWNlKDAsIHN0ZXBJbmRleCkuZXZlcnkoKHN0ZXApID0+IHN0ZXAuaXNDb21wbGV0ZSk7XG5cbiAgICBpZiAoY2FuSnVtcCkge1xuICAgICAgc2V0Q3VycmVudFN0ZXBJbmRleChzdGVwSW5kZXgpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPXtgbWF4LXctNHhsIG14LWF1dG8gcC02ICR7Y2xhc3NOYW1lfWB9PlxuICAgICAgPENhcmQgY2xhc3NOYW1lPSdzaGFkb3cteGwgYm9yZGVyLTAnPlxuICAgICAgICA8Q2FyZEhlYWRlciBjbGFzc05hbWU9J3RleHQtY2VudGVyIHBiLTYnPlxuICAgICAgICAgIDxDYXJkVGl0bGUgY2xhc3NOYW1lPSd0ZXh0LTJ4bCBmb250LWJvbGQgdGV4dC1ncmF5LTkwMCc+e3RpdGxlfTwvQ2FyZFRpdGxlPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtdC00Jz5cbiAgICAgICAgICAgIDxQcm9ncmVzcyB2YWx1ZT17cHJvZ3Jlc3N9IGNsYXNzTmFtZT0naC0yJyAvPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS02MDAgbXQtMic+XG4gICAgICAgICAgICAgIMOJdGFwZSB7Y3VycmVudFN0ZXBJbmRleCArIDF9IHN1ciB7c3RlcHMubGVuZ3RofSDigKIge01hdGgucm91bmQocHJvZ3Jlc3MpfSUgdGVybWluw6lcbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9DYXJkSGVhZGVyPlxuXG4gICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9J3NwYWNlLXktNic+XG4gICAgICAgICAgey8qIFN0ZXAgTmF2aWdhdGlvbiAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBqdXN0aWZ5LWNlbnRlcic+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0yIG1kOnNwYWNlLXgtNCBvdmVyZmxvdy14LWF1dG8gcGItMic+XG4gICAgICAgICAgICAgIHtzdGVwcy5tYXAoKHN0ZXAsIF9pbmRleCkgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtzdGVwLmlkfSBjbGFzc05hbWU9J2ZsZXggaXRlbXMtY2VudGVyJz5cbiAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ganVtcFRvU3RlcChfaW5kZXgpfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17XG4gICAgICAgICAgICAgICAgICAgICAgX2luZGV4ID4gY3VycmVudFN0ZXBJbmRleCAmJlxuICAgICAgICAgICAgICAgICAgICAgICFzdGVwcy5zbGljZSgwLCBfaW5kZXgpLmV2ZXJ5KChzKSA9PiBzLmlzQ29tcGxldGUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgXG4gICAgICAgICAgICAgICAgICAgICAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdy04IGgtOCByb3VuZGVkLWZ1bGwgYm9yZGVyLTIgdHJhbnNpdGlvbi1hbGxcbiAgICAgICAgICAgICAgICAgICAgICAke1xuICAgICAgICAgICAgICAgICAgICAgICAgX2luZGV4ID09PSBjdXJyZW50U3RlcEluZGV4XG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2JvcmRlci1wcmltYXJ5IGJnLXByaW1hcnkgdGV4dC13aGl0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiBzdGVwLmlzQ29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdib3JkZXItZ3JlZW4tNTAwIGJnLWdyZWVuLTUwMCB0ZXh0LXdoaXRlIGN1cnNvci1wb2ludGVyIGhvdmVyOmJnLWdyZWVuLTYwMCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdib3JkZXItZ3JheS0zMDAgYmctd2hpdGUgdGV4dC1ncmF5LTQwMCdcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgJHtfaW5kZXggPD0gY3VycmVudFN0ZXBJbmRleCB8fCBzdGVwLmlzQ29tcGxldGUgPyAnY3Vyc29yLXBvaW50ZXInIDogJ2N1cnNvci1ub3QtYWxsb3dlZCd9XG4gICAgICAgICAgICAgICAgICAgIGB9XG4gICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e2Ake3N0ZXAudGl0bGV9IC0gJHtzdGVwLmlzQ29tcGxldGUgPyAnVGVybWluw6knIDogX2luZGV4ID09PSBjdXJyZW50U3RlcEluZGV4ID8gJ0VuIGNvdXJzJyA6ICdFbiBhdHRlbnRlJ31gfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7c3RlcC5pc0NvbXBsZXRlID8gKFxuICAgICAgICAgICAgICAgICAgICAgIDxDaGVja0NpcmNsZSBjbGFzc05hbWU9J3ctNSBoLTUnIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSd0ZXh0LXNtIGZvbnQtbWVkaXVtJz57X2luZGV4ICsgMX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgICAgICAge19pbmRleCA8IHN0ZXBzLmxlbmd0aCAtIDEgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgdy04IG1kOnctMTYgaC0wLjUgJHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBzW19pbmRleCArIDFdLmlzQ29tcGxldGUgfHwgX2luZGV4IDwgY3VycmVudFN0ZXBJbmRleFxuICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdiZy1ncmVlbi01MDAnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLWdyYXktMzAwJ1xuICAgICAgICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiBDdXJyZW50IFN0ZXAgQ29udGVudCAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbWluLWgtWzQwMHB4XSc+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC1jZW50ZXIgbWItNic+XG4gICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9J3RleHQteGwgZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktOTAwIG1iLTInPntjdXJyZW50U3RlcC50aXRsZX08L2gzPlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS02MDAnPntjdXJyZW50U3RlcC5kZXNjcmlwdGlvbn08L3A+XG4gICAgICAgICAgICAgIHtjdXJyZW50U3RlcC5pc1ZhbGlkICYmIChcbiAgICAgICAgICAgICAgICA8QmFkZ2UgdmFyaWFudD0nc2Vjb25kYXJ5JyBjbGFzc05hbWU9J210LTIgYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwJz5cbiAgICAgICAgICAgICAgICAgIDxDaGVja0NpcmNsZSBjbGFzc05hbWU9J3ctNCBoLTQgbXItMScgLz5cbiAgICAgICAgICAgICAgICAgIFZhbGlkw6lcbiAgICAgICAgICAgICAgICA8L0JhZGdlPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHsvKiBSZW5kZXIgY3VycmVudCBzdGVwIGNvbXBvbmVudCAqL31cbiAgICAgICAgICAgIDxjdXJyZW50U3RlcC5jb21wb25lbnRcbiAgICAgICAgICAgICAgX2RhdGE9eyh3aXphcmREYXRhW2N1cnJlbnRTdGVwLmlkXSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgfHwge319XG4gICAgICAgICAgICAgIG9uRGF0YUNoYW5nZT17aGFuZGxlRGF0YUNoYW5nZX1cbiAgICAgICAgICAgICAgb25WYWxpZGF0aW9uQ2hhbmdlPXtoYW5kbGVWYWxpZGF0aW9uQ2hhbmdlfVxuICAgICAgICAgICAgICBvbk5leHQ9e2hhbmRsZU5leHR9XG4gICAgICAgICAgICAgIG9uUHJldmlvdXM9e2hhbmRsZVByZXZpb3VzfVxuICAgICAgICAgICAgICBpc0FjdGl2ZT17dHJ1ZX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogTmF2aWdhdGlvbiBCdXR0b25zICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gcHQtNiBib3JkZXItdCBib3JkZXItZ3JheS0yMDAnPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXggc3BhY2UteC0zJz5cbiAgICAgICAgICAgICAgeyFpc0ZpcnN0U3RlcCAmJiAoXG4gICAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVQcmV2aW91c30gdmFyaWFudD0nb3V0bGluZScgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlcic+XG4gICAgICAgICAgICAgICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT0ndy00IGgtNCBtci0yJyAvPlxuICAgICAgICAgICAgICAgICAgUHLDqWPDqWRlbnRcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e29uQ2FuY2VsfSB2YXJpYW50PSdnaG9zdCcgY2xhc3NOYW1lPSd0ZXh0LWdyYXktNjAwJz5cbiAgICAgICAgICAgICAgICBBbm51bGVyXG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlTmV4dH1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFjdXJyZW50U3RlcC5pc1ZhbGlkIHx8IGlzU3VibWl0dGluZ31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPSdmbGV4IGl0ZW1zLWNlbnRlciBtaW4tdy1bMTIwcHhdJ1xuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXNTdWJtaXR0aW5nID8gKFxuICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTQgdy00IGJvcmRlci1iLTIgYm9yZGVyLXdoaXRlIG1yLTInIC8+XG4gICAgICAgICAgICAgICAgICBUcmFpdGVtZW50Li4uXG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICkgOiBpc0xhc3RTdGVwID8gKFxuICAgICAgICAgICAgICAgICdUZXJtaW5lcidcbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgU3VpdmFudFxuICAgICAgICAgICAgICAgICAgPEFycm93UmlnaHQgY2xhc3NOYW1lPSd3LTQgaC00IG1sLTInIC8+XG4gICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9DYXJkQ29udGVudD5cbiAgICAgIDwvQ2FyZD5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==
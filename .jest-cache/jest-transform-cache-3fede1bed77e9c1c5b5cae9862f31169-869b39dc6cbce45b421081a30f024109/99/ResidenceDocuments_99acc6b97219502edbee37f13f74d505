115e0e77c1f5c40654dbafc0a3a1ff60
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = ResidenceDocuments;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_query_1 = require("@tanstack/react-query");
const wouter_1 = require("wouter");
const queryClient_1 = require("@/lib/queryClient");
const DocumentManager_1 = __importDefault(require("@/components/common/DocumentManager"));
const button_1 = require("@/components/ui/button");
const lucide_react_1 = require("lucide-react");
const use_language_1 = require("@/hooks/use-language");
function ResidenceDocuments() {
    const [, navigate] = (0, wouter_1.useLocation)();
    const params = (0, wouter_1.useParams)();
    const { t } = (0, use_language_1.useLanguage)();
    // Get residenceId from URL (both path param and query param)
    const urlParams = new URLSearchParams(window.location.search);
    const residenceId = params.residenceId || urlParams.get('residenceId');
    // Get current user
    const { data: user } = (0, react_query_1.useQuery)({
        queryKey: ['/api/auth/user'],
        queryFn: () => (0, queryClient_1.apiRequest)('GET', '/api/auth/user'),
    });
    // Get residence info
    const { data: residence, isError: residenceError, error, } = (0, react_query_1.useQuery)({
        queryKey: ['/api/residences', residenceId],
        queryFn: async () => {
            console.log('ðŸ” ResidenceDocuments: Fetching residence data for ID:', residenceId);
            const response = await fetch(`/api/residences/${residenceId}`, {
                credentials: 'include',
            });
            if (!response.ok) {
                if (response.status === 404) {
                    throw new Error('RESIDENCE_NOT_FOUND');
                }
                throw new Error('Failed to fetch residence');
            }
            const data = await response.json();
            console.log('ðŸ” ResidenceDocuments: Residence API response:', data);
            return data;
        },
        enabled: !!residenceId,
        retry: false, // Don't retry on 404s
    });
    if (!residenceId) {
        return ((0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex items-center justify-center', children: (0, jsx_runtime_1.jsxs)("div", { className: 'text-center', children: [(0, jsx_runtime_1.jsx)("p", { className: 'text-gray-500 mb-4', children: "Residence ID is required" }), (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'outline', onClick: () => navigate('/residents/residence'), "data-testid": 'button-back-to-residences', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: 'w-4 h-4 mr-2' }), "Back to Residences"] })] }) }) }));
    }
    // Handle residence not found
    if (residenceError && error?.message === 'RESIDENCE_NOT_FOUND') {
        return ((0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: (0, jsx_runtime_1.jsx)("div", { className: 'flex-1 flex items-center justify-center', children: (0, jsx_runtime_1.jsxs)("div", { className: 'text-center max-w-md', children: [(0, jsx_runtime_1.jsx)("h2", { className: 'text-xl font-semibold mb-4', children: "Residence Not Found" }), (0, jsx_runtime_1.jsxs)("p", { className: 'text-gray-500 mb-4', children: ["The residence ID \"", residenceId, "\" doesn't exist in the development database."] }), (0, jsx_runtime_1.jsx)("p", { className: 'text-sm text-gray-400 mb-6', children: "This might be a production database ID. Please use a valid development residence ID." }), (0, jsx_runtime_1.jsxs)("div", { className: 'space-y-2', children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'default', onClick: () => navigate('/residents/residence'), "data-testid": 'button-back-to-residences', className: 'w-full', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: 'w-4 h-4 mr-2' }), "Back to Residences"] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: 'outline', onClick: () => navigate('/residents/residences/e27ac924-8120-4904-a791-d1e9db544d58/documents'), "data-testid": 'button-go-to-valid-residence', className: 'w-full', children: "Go to Unit 101 (Test Residence)" })] })] }) }) }));
    }
    const isUserTenant = user?.role === 'tenant';
    const residenceName = residence?.unitNumber || residence?.unit_number
        ? `Unit ${residence.unitNumber || residence.unit_number}`
        : 'Residence';
    return ((0, jsx_runtime_1.jsxs)("div", { className: 'flex-1 flex flex-col overflow-hidden', children: [(0, jsx_runtime_1.jsx)("div", { className: 'p-6 pb-0', children: (0, jsx_runtime_1.jsxs)(button_1.Button, { variant: 'outline', onClick: () => navigate('/residents/residence'), className: 'mb-4', "data-testid": 'button-back', children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: 'w-4 h-4 mr-2' }), t('backToResidences')] }) }), (0, jsx_runtime_1.jsx)(DocumentManager_1.default, { config: {
                    type: 'residence',
                    userRole: 'resident',
                    entityId: residenceId,
                    entityName: residenceName,
                    entityAddress: residence?.address,
                    allowCreate: !isUserTenant,
                    allowEdit: !isUserTenant,
                    allowDelete: !isUserTenant,
                    showVisibilityToggle: !isUserTenant,
                } })] }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL3Jlc2lkZW50cy9SZXNpZGVuY2VEb2N1bWVudHMudHN4IiwibWFwcGluZ3MiOiI7Ozs7O0FBUUEscUNBeUlDOztBQWpKRCx1REFBaUQ7QUFDakQsbUNBQWdEO0FBQ2hELG1EQUErQztBQUMvQywwRkFBa0U7QUFDbEUsbURBQWdEO0FBQ2hELCtDQUF5QztBQUN6Qyx1REFBbUQ7QUFFbkQsU0FBd0Isa0JBQWtCO0lBQ3hDLE1BQU0sQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUEsb0JBQVcsR0FBRSxDQUFDO0lBQ25DLE1BQU0sTUFBTSxHQUFHLElBQUEsa0JBQVMsR0FBRSxDQUFDO0lBQzNCLE1BQU0sRUFBRSxDQUFDLEVBQUUsR0FBRyxJQUFBLDBCQUFXLEdBQUUsQ0FBQztJQUU1Qiw2REFBNkQ7SUFDN0QsTUFBTSxTQUFTLEdBQUcsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM5RCxNQUFNLFdBQVcsR0FBSSxNQUFjLENBQUMsV0FBVyxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7SUFFaEYsbUJBQW1CO0lBQ25CLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBQSxzQkFBUSxFQUFDO1FBQzlCLFFBQVEsRUFBRSxDQUFDLGdCQUFnQixDQUFDO1FBQzVCLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFBLHdCQUFVLEVBQUMsS0FBSyxFQUFFLGdCQUFnQixDQUFpQjtLQUNuRSxDQUFDLENBQUM7SUFFSCxxQkFBcUI7SUFDckIsTUFBTSxFQUNKLElBQUksRUFBRSxTQUFTLEVBQ2YsT0FBTyxFQUFFLGNBQWMsRUFDdkIsS0FBSyxHQUNOLEdBQUcsSUFBQSxzQkFBUSxFQUFDO1FBQ1gsUUFBUSxFQUFFLENBQUMsaUJBQWlCLEVBQUUsV0FBVyxDQUFDO1FBQzFDLE9BQU8sRUFBRSxLQUFLLElBQUksRUFBRTtZQUNs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Z0NBQUssU0FBUyxFQUFDLFVBQVUsWUFDdkIsd0JBQUMsZUFBTSxJQUNMLE9BQU8sRUFBQyxTQUFTLEVBQ2pCLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsc0JBQXNCLENBQUMsRUFDL0MsU0FBUyxFQUFDLE1BQU0saUJBQ0osYUFBYSxhQUV6Qix1QkFBQyx3QkFBUyxJQUFDLFNBQVMsRUFBQyxjQUFjLEdBQUcsRUFDckMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLElBQ2YsR0FDTCxFQUVOLHVCQUFDLHlCQUFlLElBQ2QsTUFBTSxFQUFFO29CQUNOLElBQUksRUFBRSxXQUFXO29CQUNqQixRQUFRLEVBQUUsVUFBVTtvQkFDcEIsUUFBUSxFQUFFLFdBQVc7b0JBQ3JCLFVBQVUsRUFBRSxhQUFhO29CQUN6QixhQUFhLEVBQUUsU0FBUyxFQUFFLE9BQU87b0JBQ2pDLFdBQVcsRUFBRSxDQUFDLFlBQVk7b0JBQzFCLFNBQVMsRUFBRSxDQUFDLFlBQVk7b0JBQ3hCLFdBQVcsRUFBRSxDQUFDLFlBQVk7b0JBQzFCLG9CQUFvQixFQUFFLENBQUMsWUFBWTtpQkFDcEMsR0FDRCxJQUNFLENBQ1AsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9jbGllbnQvc3JjL3BhZ2VzL3Jlc2lkZW50cy9SZXNpZGVuY2VEb2N1bWVudHMudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVF1ZXJ5IH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmltcG9ydCB7IHVzZUxvY2F0aW9uLCB1c2VQYXJhbXMgfSBmcm9tICd3b3V0ZXInO1xuaW1wb3J0IHsgYXBpUmVxdWVzdCB9IGZyb20gJ0AvbGliL3F1ZXJ5Q2xpZW50JztcbmltcG9ydCBEb2N1bWVudE1hbmFnZXIgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9Eb2N1bWVudE1hbmFnZXInO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL2J1dHRvbic7XG5pbXBvcnQgeyBBcnJvd0xlZnQgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgdXNlTGFuZ3VhZ2UgfSBmcm9tICdAL2hvb2tzL3VzZS1sYW5ndWFnZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFJlc2lkZW5jZURvY3VtZW50cygpIHtcbiAgY29uc3QgWywgbmF2aWdhdGVdID0gdXNlTG9jYXRpb24oKTtcbiAgY29uc3QgcGFyYW1zID0gdXNlUGFyYW1zKCk7XG4gIGNvbnN0IHsgdCB9ID0gdXNlTGFuZ3VhZ2UoKTtcblxuICAvLyBHZXQgcmVzaWRlbmNlSWQgZnJvbSBVUkwgKGJvdGggcGF0aCBwYXJhbSBhbmQgcXVlcnkgcGFyYW0pXG4gIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG4gIGNvbnN0IHJlc2lkZW5jZUlkID0gKHBhcmFtcyBhcyBhbnkpLnJlc2lkZW5jZUlkIHx8IHVybFBhcmFtcy5nZXQoJ3Jlc2lkZW5jZUlkJyk7XG5cbiAgLy8gR2V0IGN1cnJlbnQgdXNlclxuICBjb25zdCB7IGRhdGE6IHVzZXIgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogWycvYXBpL2F1dGgvdXNlciddLFxuICAgIHF1ZXJ5Rm46ICgpID0+IGFwaVJlcXVlc3QoJ0dFVCcsICcvYXBpL2F1dGgvdXNlcicpIGFzIFByb21pc2U8YW55PixcbiAgfSk7XG5cbiAgLy8gR2V0IHJlc2lkZW5jZSBpbmZvXG4gIGNvbnN0IHtcbiAgICBkYXRhOiByZXNpZGVuY2UsXG4gICAgaXNFcnJvcjogcmVzaWRlbmNlRXJyb3IsXG4gICAgZXJyb3IsXG4gIH0gPSB1c2VRdWVyeSh7XG4gICAgcXVlcnlLZXk6IFsnL2FwaS9yZXNpZGVuY2VzJywgcmVzaWRlbmNlSWRdLFxuICAgIHF1ZXJ5Rm46IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFJlc2lkZW5jZURvY3VtZW50czogRmV0Y2hpbmcgcmVzaWRlbmNlIGRhdGEgZm9yIElEOicsIHJlc2lkZW5jZUlkKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvcmVzaWRlbmNlcy8ke3Jlc2lkZW5jZUlkfWAsIHtcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAgIH0pO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JFU0lERU5DRV9OT1RfRk9VTkQnKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCByZXNpZGVuY2UnKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBSZXNpZGVuY2VEb2N1bWVudHM6IFJlc2lkZW5jZSBBUEkgcmVzcG9uc2U6JywgZGF0YSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIGVuYWJsZWQ6ICEhcmVzaWRlbmNlSWQsXG4gICAgcmV0cnk6IGZhbHNlLCAvLyBEb24ndCByZXRyeSBvbiA0MDRzXG4gIH0pO1xuXG4gIGlmICghcmVzaWRlbmNlSWQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9J2ZsZXgtMSBmbGV4IGZsZXgtY29sIG92ZXJmbG93LWhpZGRlbic+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXInPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS01MDAgbWItNCc+UmVzaWRlbmNlIElEIGlzIHJlcXVpcmVkPC9wPlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICB2YXJpYW50PSdvdXRsaW5lJ1xuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBuYXZpZ2F0ZSgnL3Jlc2lkZW50cy9yZXNpZGVuY2UnKX1cbiAgICAgICAgICAgICAgZGF0YS10ZXN0aWQ9J2J1dHRvbi1iYWNrLXRvLXJlc2lkZW5jZXMnXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxBcnJvd0xlZnQgY2xhc3NOYW1lPSd3LTQgaC00IG1yLTInIC8+XG4gICAgICAgICAgICAgIEJhY2sgdG8gUmVzaWRlbmNlc1xuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSByZXNpZGVuY2Ugbm90IGZvdW5kXG4gIGlmIChyZXNpZGVuY2VFcnJvciAmJiBlcnJvcj8ubWVzc2FnZSA9PT0gJ1JFU0lERU5DRV9OT1RfRk9VTkQnKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdmbGV4LTEgZmxleCBmbGV4LWNvbCBvdmVyZmxvdy1oaWRkZW4nPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleC0xIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyJz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGV4dC1jZW50ZXIgbWF4LXctbWQnPlxuICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT0ndGV4dC14bCBmb250LXNlbWlib2xkIG1iLTQnPlJlc2lkZW5jZSBOb3QgRm91bmQ8L2gyPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LWdyYXktNTAwIG1iLTQnPlxuICAgICAgICAgICAgICBUaGUgcmVzaWRlbmNlIElEIFwie3Jlc2lkZW5jZUlkfVwiIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIGRldmVsb3BtZW50IGRhdGFiYXNlLlxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LXNtIHRleHQtZ3JheS00MDAgbWItNic+XG4gICAgICAgICAgICAgIFRoaXMgbWlnaHQgYmUgYSBwcm9kdWN0aW9uIGRhdGFiYXNlIElELiBQbGVhc2UgdXNlIGEgdmFsaWQgZGV2ZWxvcG1lbnQgcmVzaWRlbmNlIElELlxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NwYWNlLXktMic+XG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PSdkZWZhdWx0J1xuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKCcvcmVzaWRlbnRzL3Jlc2lkZW5jZScpfVxuICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPSdidXR0b24tYmFjay10by1yZXNpZGVuY2VzJ1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0ndy1mdWxsJ1xuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEFycm93TGVmdCBjbGFzc05hbWU9J3ctNCBoLTQgbXItMicgLz5cbiAgICAgICAgICAgICAgICBCYWNrIHRvIFJlc2lkZW5jZXNcbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB2YXJpYW50PSdvdXRsaW5lJ1xuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+XG4gICAgICAgICAgICAgICAgICBuYXZpZ2F0ZSgnL3Jlc2lkZW50cy9yZXNpZGVuY2VzL2UyN2FjOTI0LTgxMjAtNDkwNC1hNzkxLWQxZTlkYjU0NGQ1OC9kb2N1bWVudHMnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD0nYnV0dG9uLWdvLXRvLXZhbGlkLXJlc2lkZW5jZSdcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctZnVsbCdcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIEdvIHRvIFVuaXQgMTAxIChUZXN0IFJlc2lkZW5jZSlcbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgY29uc3QgaXNVc2VyVGVuYW50ID0gdXNlcj8ucm9sZSA9PT0gJ3RlbmFudCc7XG4gIGNvbnN0IHJlc2lkZW5jZU5hbWUgPVxuICAgIHJlc2lkZW5jZT8udW5pdE51bWJlciB8fCByZXNpZGVuY2U/LnVuaXRfbnVtYmVyXG4gICAgICA/IGBVbml0ICR7cmVzaWRlbmNlLnVuaXROdW1iZXIgfHwgcmVzaWRlbmNlLnVuaXRfbnVtYmVyfWBcbiAgICAgIDogJ1Jlc2lkZW5jZSc7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT0nZmxleC0xIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuJz5cbiAgICAgIHsvKiBCYWNrIGJ1dHRvbiAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdwLTYgcGItMCc+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICB2YXJpYW50PSdvdXRsaW5lJ1xuICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKCcvcmVzaWRlbnRzL3Jlc2lkZW5jZScpfVxuICAgICAgICAgIGNsYXNzTmFtZT0nbWItNCdcbiAgICAgICAgICBkYXRhLXRlc3RpZD0nYnV0dG9uLWJhY2snXG4gICAgICAgID5cbiAgICAgICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT0ndy00IGgtNCBtci0yJyAvPlxuICAgICAgICAgIHt0KCdiYWNrVG9SZXNpZGVuY2VzJyl9XG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxEb2N1bWVudE1hbmFnZXJcbiAgICAgICAgY29uZmlnPXt7XG4gICAgICAgICAgdHlwZTogJ3Jlc2lkZW5jZScsXG4gICAgICAgICAgdXNlclJvbGU6ICdyZXNpZGVudCcsXG4gICAgICAgICAgZW50aXR5SWQ6IHJlc2lkZW5jZUlkLFxuICAgICAgICAgIGVudGl0eU5hbWU6IHJlc2lkZW5jZU5hbWUsXG4gICAgICAgICAgZW50aXR5QWRkcmVzczogcmVzaWRlbmNlPy5hZGRyZXNzLFxuICAgICAgICAgIGFsbG93Q3JlYXRlOiAhaXNVc2VyVGVuYW50LFxuICAgICAgICAgIGFsbG93RWRpdDogIWlzVXNlclRlbmFudCxcbiAgICAgICAgICBhbGxvd0RlbGV0ZTogIWlzVXNlclRlbmFudCxcbiAgICAgICAgICBzaG93VmlzaWJpbGl0eVRvZ2dsZTogIWlzVXNlclRlbmFudCxcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXSwidmVyc2lvbiI6M30=